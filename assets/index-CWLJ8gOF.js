var CA=Object.defineProperty;var kA=(e,t,r)=>t in e?CA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Eo=(e,t,r)=>kA(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var OA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gw={exports:{}},Id={},Hw={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zc=Symbol.for("react.element"),FA=Symbol.for("react.portal"),PA=Symbol.for("react.fragment"),IA=Symbol.for("react.strict_mode"),RA=Symbol.for("react.profiler"),jA=Symbol.for("react.provider"),MA=Symbol.for("react.context"),LA=Symbol.for("react.forward_ref"),BA=Symbol.for("react.suspense"),UA=Symbol.for("react.memo"),zA=Symbol.for("react.lazy"),fv=Symbol.iterator;function qA(e){return e===null||typeof e!="object"?null:(e=fv&&e[fv]||e["@@iterator"],typeof e=="function"?e:null)}var Vw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yw=Object.assign,Xw={};function Cl(e,t,r){this.props=e,this.context=t,this.refs=Xw,this.updater=r||Vw}Cl.prototype.isReactComponent={};Cl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Cl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Kw(){}Kw.prototype=Cl.prototype;function qg(e,t,r){this.props=e,this.context=t,this.refs=Xw,this.updater=r||Vw}var Wg=qg.prototype=new Kw;Wg.constructor=qg;Yw(Wg,Cl.prototype);Wg.isPureReactComponent=!0;var dv=Array.isArray,Zw=Object.prototype.hasOwnProperty,$g={current:null},Qw={key:!0,ref:!0,__self:!0,__source:!0};function Jw(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)Zw.call(t,n)&&!Qw.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:zc,type:e,key:i,ref:s,props:a,_owner:$g.current}}function WA(e,t){return{$$typeof:zc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Gg(e){return typeof e=="object"&&e!==null&&e.$$typeof===zc}function $A(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hv=/\/+/g;function Rh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?$A(""+e.key):t.toString(36)}function c0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case zc:case FA:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Rh(s,0):n,dv(a)?(r="",e!=null&&(r=e.replace(hv,"$&/")+"/"),c0(a,t,r,"",function(u){return u})):a!=null&&(Gg(a)&&(a=WA(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(hv,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",dv(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+Rh(i,o);s+=c0(i,t,r,l,a)}else if(l=qA(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+Rh(i,o++),s+=c0(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Ef(e,t,r){if(e==null)return e;var n=[],a=0;return c0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function GA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sn={current:null},f0={transition:null},HA={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:f0,ReactCurrentOwner:$g};function eb(){throw Error("act(...) is not supported in production builds of React.")}Pt.Children={map:Ef,forEach:function(e,t,r){Ef(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ef(e,function(){t++}),t},toArray:function(e){return Ef(e,function(t){return t})||[]},only:function(e){if(!Gg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pt.Component=Cl;Pt.Fragment=PA;Pt.Profiler=RA;Pt.PureComponent=qg;Pt.StrictMode=IA;Pt.Suspense=BA;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HA;Pt.act=eb;Pt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Yw({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=$g.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Zw.call(t,l)&&!Qw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:zc,type:e.type,key:a,ref:i,props:n,_owner:s}};Pt.createContext=function(e){return e={$$typeof:MA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jA,_context:e},e.Consumer=e};Pt.createElement=Jw;Pt.createFactory=function(e){var t=Jw.bind(null,e);return t.type=e,t};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(e){return{$$typeof:LA,render:e}};Pt.isValidElement=Gg;Pt.lazy=function(e){return{$$typeof:zA,_payload:{_status:-1,_result:e},_init:GA}};Pt.memo=function(e,t){return{$$typeof:UA,type:e,compare:t===void 0?null:t}};Pt.startTransition=function(e){var t=f0.transition;f0.transition={};try{e()}finally{f0.transition=t}};Pt.unstable_act=eb;Pt.useCallback=function(e,t){return Sn.current.useCallback(e,t)};Pt.useContext=function(e){return Sn.current.useContext(e)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(e){return Sn.current.useDeferredValue(e)};Pt.useEffect=function(e,t){return Sn.current.useEffect(e,t)};Pt.useId=function(){return Sn.current.useId()};Pt.useImperativeHandle=function(e,t,r){return Sn.current.useImperativeHandle(e,t,r)};Pt.useInsertionEffect=function(e,t){return Sn.current.useInsertionEffect(e,t)};Pt.useLayoutEffect=function(e,t){return Sn.current.useLayoutEffect(e,t)};Pt.useMemo=function(e,t){return Sn.current.useMemo(e,t)};Pt.useReducer=function(e,t,r){return Sn.current.useReducer(e,t,r)};Pt.useRef=function(e){return Sn.current.useRef(e)};Pt.useState=function(e){return Sn.current.useState(e)};Pt.useSyncExternalStore=function(e,t,r){return Sn.current.useSyncExternalStore(e,t,r)};Pt.useTransition=function(){return Sn.current.useTransition()};Pt.version="18.3.1";Hw.exports=Pt;var _e=Hw.exports;const Fs=zg(_e);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VA=_e,YA=Symbol.for("react.element"),XA=Symbol.for("react.fragment"),KA=Object.prototype.hasOwnProperty,ZA=VA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QA={key:!0,ref:!0,__self:!0,__source:!0};function tb(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)KA.call(t,n)&&!QA.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:YA,type:e,key:i,ref:s,props:a,_owner:ZA.current}}Id.Fragment=XA;Id.jsx=tb;Id.jsxs=tb;Gw.exports=Id;var f=Gw.exports,im={},rb={exports:{}},ea={},nb={exports:{}},ab={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(fe,de){var Ce=fe.length;fe.push(de);e:for(;0<Ce;){var Ye=Ce-1>>>1,V=fe[Ye];if(0<a(V,de))fe[Ye]=de,fe[Ce]=V,Ce=Ye;else break e}}function r(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var de=fe[0],Ce=fe.pop();if(Ce!==de){fe[0]=Ce;e:for(var Ye=0,V=fe.length,se=V>>>1;Ye<se;){var ee=2*(Ye+1)-1,C=fe[ee],R=ee+1,X=fe[R];if(0>a(C,Ce))R<V&&0>a(X,C)?(fe[Ye]=X,fe[R]=Ce,Ye=R):(fe[Ye]=C,fe[ee]=Ce,Ye=ee);else if(R<V&&0>a(X,Ce))fe[Ye]=X,fe[R]=Ce,Ye=R;else break e}}return de}function a(fe,de){var Ce=fe.sortIndex-de.sortIndex;return Ce!==0?Ce:fe.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,h=null,p=3,v=!1,E=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(fe){for(var de=r(u);de!==null;){if(de.callback===null)n(u);else if(de.startTime<=fe)n(u),de.sortIndex=de.expirationTime,t(l,de);else break;de=r(u)}}function _(fe){if(g=!1,b(fe),!E)if(r(l)!==null)E=!0,me(N);else{var de=r(u);de!==null&&Ee(_,de.startTime-fe)}}function N(fe,de){E=!1,g&&(g=!1,x(A),A=-1),v=!0;var Ce=p;try{for(b(de),h=r(l);h!==null&&(!(h.expirationTime>de)||fe&&!F());){var Ye=h.callback;if(typeof Ye=="function"){h.callback=null,p=h.priorityLevel;var V=Ye(h.expirationTime<=de);de=e.unstable_now(),typeof V=="function"?h.callback=V:h===r(l)&&n(l),b(de)}else n(l);h=r(l)}if(h!==null)var se=!0;else{var ee=r(u);ee!==null&&Ee(_,ee.startTime-de),se=!1}return se}finally{h=null,p=Ce,v=!1}}var k=!1,T=null,A=-1,S=5,P=-1;function F(){return!(e.unstable_now()-P<S)}function U(){if(T!==null){var fe=e.unstable_now();P=fe;var de=!0;try{de=T(!0,fe)}finally{de?re():(k=!1,T=null)}}else k=!1}var re;if(typeof y=="function")re=function(){y(U)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,pe=le.port2;le.port1.onmessage=U,re=function(){pe.postMessage(null)}}else re=function(){w(U,0)};function me(fe){T=fe,k||(k=!0,re())}function Ee(fe,de){A=w(function(){fe(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(fe){fe.callback=null},e.unstable_continueExecution=function(){E||v||(E=!0,me(N))},e.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<fe?Math.floor(1e3/fe):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(fe){switch(p){case 1:case 2:case 3:var de=3;break;default:de=p}var Ce=p;p=de;try{return fe()}finally{p=Ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(fe,de){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Ce=p;p=fe;try{return de()}finally{p=Ce}},e.unstable_scheduleCallback=function(fe,de,Ce){var Ye=e.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Ye+Ce:Ye):Ce=Ye,fe){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=Ce+V,fe={id:c++,callback:de,priorityLevel:fe,startTime:Ce,expirationTime:V,sortIndex:-1},Ce>Ye?(fe.sortIndex=Ce,t(u,fe),r(l)===null&&fe===r(u)&&(g?(x(A),A=-1):g=!0,Ee(_,Ce-Ye))):(fe.sortIndex=V,t(l,fe),E||v||(E=!0,me(N))),fe},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(fe){var de=p;return function(){var Ce=p;p=de;try{return fe.apply(this,arguments)}finally{p=Ce}}}})(ab);nb.exports=ab;var JA=nb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e4=_e,Zn=JA;function Ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ib=new Set,Vu={};function uo(e,t){pl(e,t),pl(e+"Capture",t)}function pl(e,t){for(Vu[e]=t,e=0;e<t.length;e++)ib.add(t[e])}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sm=Object.prototype.hasOwnProperty,t4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pv={},mv={};function r4(e){return sm.call(mv,e)?!0:sm.call(pv,e)?!1:t4.test(e)?mv[e]=!0:(pv[e]=!0,!1)}function n4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function a4(e,t,r,n){if(t===null||typeof t>"u"||n4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var nn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nn[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nn[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nn[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nn[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nn[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nn[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nn[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nn[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nn[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hg=/[\-:]([a-z])/g;function Vg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hg,Vg);nn[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hg,Vg);nn[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hg,Vg);nn[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nn[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});nn.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nn[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yg(e,t,r,n){var a=nn.hasOwnProperty(t)?nn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(a4(t,r,a,n)&&(r=null),n||a===null?r4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ai=e4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_f=Symbol.for("react.element"),jo=Symbol.for("react.portal"),Mo=Symbol.for("react.fragment"),Xg=Symbol.for("react.strict_mode"),om=Symbol.for("react.profiler"),sb=Symbol.for("react.provider"),ob=Symbol.for("react.context"),Kg=Symbol.for("react.forward_ref"),lm=Symbol.for("react.suspense"),um=Symbol.for("react.suspense_list"),Zg=Symbol.for("react.memo"),Ri=Symbol.for("react.lazy"),lb=Symbol.for("react.offscreen"),gv=Symbol.iterator;function Kl(e){return e===null||typeof e!="object"?null:(e=gv&&e[gv]||e["@@iterator"],typeof e=="function"?e:null)}var mr=Object.assign,jh;function hu(e){if(jh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);jh=t&&t[1]||""}return`
`+jh+e}var Mh=!1;function Lh(e,t){if(!e||Mh)return"";Mh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Mh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?hu(e):""}function i4(e){switch(e.tag){case 5:return hu(e.type);case 16:return hu("Lazy");case 13:return hu("Suspense");case 19:return hu("SuspenseList");case 0:case 2:case 15:return e=Lh(e.type,!1),e;case 11:return e=Lh(e.type.render,!1),e;case 1:return e=Lh(e.type,!0),e;default:return""}}function cm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mo:return"Fragment";case jo:return"Portal";case om:return"Profiler";case Xg:return"StrictMode";case lm:return"Suspense";case um:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ob:return(e.displayName||"Context")+".Consumer";case sb:return(e._context.displayName||"Context")+".Provider";case Kg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Zg:return t=e.displayName||null,t!==null?t:cm(e.type)||"Memo";case Ri:t=e._payload,e=e._init;try{return cm(e(t))}catch{}}return null}function s4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cm(t);case 8:return t===Xg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function rs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ub(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function o4(e){var t=ub(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tf(e){e._valueTracker||(e._valueTracker=o4(e))}function cb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ub(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function F0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function fm(e,t){var r=t.checked;return mr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function xv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=rs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function fb(e,t){t=t.checked,t!=null&&Yg(e,"checked",t,!1)}function dm(e,t){fb(e,t);var r=rs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hm(e,t.type,r):t.hasOwnProperty("defaultValue")&&hm(e,t.type,rs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function vv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function hm(e,t,r){(t!=="number"||F0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var pu=Array.isArray;function Qo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+rs(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function pm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ie(91));return mr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function yv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ie(92));if(pu(r)){if(1<r.length)throw Error(Ie(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:rs(r)}}function db(e,t){var r=rs(t.value),n=rs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function wv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hb(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sf,pb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sf=Sf||document.createElement("div"),Sf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Yu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _u={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},l4=["Webkit","ms","Moz","O"];Object.keys(_u).forEach(function(e){l4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_u[t]=_u[e]})});function mb(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_u.hasOwnProperty(e)&&_u[e]?(""+t).trim():t+"px"}function gb(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=mb(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var u4=mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gm(e,t){if(t){if(u4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ie(62))}}function xm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vm=null;function Qg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ym=null,Jo=null,el=null;function bv(e){if(e=$c(e)){if(typeof ym!="function")throw Error(Ie(280));var t=e.stateNode;t&&(t=Bd(t),ym(e.stateNode,e.type,t))}}function xb(e){Jo?el?el.push(e):el=[e]:Jo=e}function vb(){if(Jo){var e=Jo,t=el;if(el=Jo=null,bv(e),t)for(e=0;e<t.length;e++)bv(t[e])}}function yb(e,t){return e(t)}function wb(){}var Bh=!1;function bb(e,t,r){if(Bh)return e(t,r);Bh=!0;try{return yb(e,t,r)}finally{Bh=!1,(Jo!==null||el!==null)&&(wb(),vb())}}function Xu(e,t){var r=e.stateNode;if(r===null)return null;var n=Bd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ie(231,t,typeof r));return r}var wm=!1;if(yi)try{var Zl={};Object.defineProperty(Zl,"passive",{get:function(){wm=!0}}),window.addEventListener("test",Zl,Zl),window.removeEventListener("test",Zl,Zl)}catch{wm=!1}function c4(e,t,r,n,a,i,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(c){this.onError(c)}}var Tu=!1,P0=null,I0=!1,bm=null,f4={onError:function(e){Tu=!0,P0=e}};function d4(e,t,r,n,a,i,s,o,l){Tu=!1,P0=null,c4.apply(f4,arguments)}function h4(e,t,r,n,a,i,s,o,l){if(d4.apply(this,arguments),Tu){if(Tu){var u=P0;Tu=!1,P0=null}else throw Error(Ie(198));I0||(I0=!0,bm=u)}}function co(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Eb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ev(e){if(co(e)!==e)throw Error(Ie(188))}function p4(e){var t=e.alternate;if(!t){if(t=co(e),t===null)throw Error(Ie(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Ev(a),e;if(i===n)return Ev(a),t;i=i.sibling}throw Error(Ie(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Ie(189))}}if(r.alternate!==n)throw Error(Ie(190))}if(r.tag!==3)throw Error(Ie(188));return r.stateNode.current===r?e:t}function _b(e){return e=p4(e),e!==null?Tb(e):null}function Tb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Tb(e);if(t!==null)return t;e=e.sibling}return null}var Sb=Zn.unstable_scheduleCallback,_v=Zn.unstable_cancelCallback,m4=Zn.unstable_shouldYield,g4=Zn.unstable_requestPaint,_r=Zn.unstable_now,x4=Zn.unstable_getCurrentPriorityLevel,Jg=Zn.unstable_ImmediatePriority,Ab=Zn.unstable_UserBlockingPriority,R0=Zn.unstable_NormalPriority,v4=Zn.unstable_LowPriority,Nb=Zn.unstable_IdlePriority,Rd=null,Xa=null;function y4(e){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(Rd,e,void 0,(e.current.flags&128)===128)}catch{}}var Pa=Math.clz32?Math.clz32:E4,w4=Math.log,b4=Math.LN2;function E4(e){return e>>>=0,e===0?32:31-(w4(e)/b4|0)|0}var Af=64,Nf=4194304;function mu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function j0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=mu(o):(i&=s,i!==0&&(n=mu(i)))}else s=r&~a,s!==0?n=mu(s):i!==0&&(n=mu(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pa(t),a=1<<r,n|=e[r],t&=~a;return n}function _4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Pa(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=_4(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function Em(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Db(){var e=Af;return Af<<=1,!(Af&4194240)&&(Af=64),e}function Uh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function qc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pa(t),e[t]=r}function S4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Pa(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function e1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pa(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Yt=0;function Cb(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var kb,t1,Ob,Fb,Pb,_m=!1,Df=[],Vi=null,Yi=null,Xi=null,Ku=new Map,Zu=new Map,Li=[],A4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tv(e,t){switch(e){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Ku.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(t.pointerId)}}function Ql(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=$c(t),t!==null&&t1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function N4(e,t,r,n,a){switch(t){case"focusin":return Vi=Ql(Vi,e,t,r,n,a),!0;case"dragenter":return Yi=Ql(Yi,e,t,r,n,a),!0;case"mouseover":return Xi=Ql(Xi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Ku.set(i,Ql(Ku.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Zu.set(i,Ql(Zu.get(i)||null,e,t,r,n,a)),!0}return!1}function Ib(e){var t=Is(e.target);if(t!==null){var r=co(t);if(r!==null){if(t=r.tag,t===13){if(t=Eb(r),t!==null){e.blockedOn=t,Pb(e.priority,function(){Ob(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function d0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Tm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);vm=n,r.target.dispatchEvent(n),vm=null}else return t=$c(r),t!==null&&t1(t),e.blockedOn=r,!1;t.shift()}return!0}function Sv(e,t,r){d0(e)&&r.delete(t)}function D4(){_m=!1,Vi!==null&&d0(Vi)&&(Vi=null),Yi!==null&&d0(Yi)&&(Yi=null),Xi!==null&&d0(Xi)&&(Xi=null),Ku.forEach(Sv),Zu.forEach(Sv)}function Jl(e,t){e.blockedOn===t&&(e.blockedOn=null,_m||(_m=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,D4)))}function Qu(e){function t(a){return Jl(a,e)}if(0<Df.length){Jl(Df[0],e);for(var r=1;r<Df.length;r++){var n=Df[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Vi!==null&&Jl(Vi,e),Yi!==null&&Jl(Yi,e),Xi!==null&&Jl(Xi,e),Ku.forEach(t),Zu.forEach(t),r=0;r<Li.length;r++)n=Li[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Li.length&&(r=Li[0],r.blockedOn===null);)Ib(r),r.blockedOn===null&&Li.shift()}var tl=Ai.ReactCurrentBatchConfig,M0=!0;function C4(e,t,r,n){var a=Yt,i=tl.transition;tl.transition=null;try{Yt=1,r1(e,t,r,n)}finally{Yt=a,tl.transition=i}}function k4(e,t,r,n){var a=Yt,i=tl.transition;tl.transition=null;try{Yt=4,r1(e,t,r,n)}finally{Yt=a,tl.transition=i}}function r1(e,t,r,n){if(M0){var a=Tm(e,t,r,n);if(a===null)Kh(e,t,n,L0,r),Tv(e,n);else if(N4(a,e,t,r,n))n.stopPropagation();else if(Tv(e,n),t&4&&-1<A4.indexOf(e)){for(;a!==null;){var i=$c(a);if(i!==null&&kb(i),i=Tm(e,t,r,n),i===null&&Kh(e,t,n,L0,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Kh(e,t,n,null,r)}}var L0=null;function Tm(e,t,r,n){if(L0=null,e=Qg(n),e=Is(e),e!==null)if(t=co(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Eb(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return L0=e,null}function Rb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x4()){case Jg:return 1;case Ab:return 4;case R0:case v4:return 16;case Nb:return 536870912;default:return 16}default:return 16}}var zi=null,n1=null,h0=null;function jb(){if(h0)return h0;var e,t=n1,r=t.length,n,a="value"in zi?zi.value:zi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return h0=a.slice(e,1<n?1-n:void 0)}function p0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cf(){return!0}function Av(){return!1}function ta(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cf:Av,this.isPropagationStopped=Av,this}return mr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cf)},persist:function(){},isPersistent:Cf}),t}var kl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},a1=ta(kl),Wc=mr({},kl,{view:0,detail:0}),O4=ta(Wc),zh,qh,eu,jd=mr({},Wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:i1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==eu&&(eu&&e.type==="mousemove"?(zh=e.screenX-eu.screenX,qh=e.screenY-eu.screenY):qh=zh=0,eu=e),zh)},movementY:function(e){return"movementY"in e?e.movementY:qh}}),Nv=ta(jd),F4=mr({},jd,{dataTransfer:0}),P4=ta(F4),I4=mr({},Wc,{relatedTarget:0}),Wh=ta(I4),R4=mr({},kl,{animationName:0,elapsedTime:0,pseudoElement:0}),j4=ta(R4),M4=mr({},kl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),L4=ta(M4),B4=mr({},kl,{data:0}),Dv=ta(B4),U4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=q4[e])?!!t[e]:!1}function i1(){return W4}var $4=mr({},Wc,{key:function(e){if(e.key){var t=U4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=p0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?z4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:i1,charCode:function(e){return e.type==="keypress"?p0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?p0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G4=ta($4),H4=mr({},jd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cv=ta(H4),V4=mr({},Wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:i1}),Y4=ta(V4),X4=mr({},kl,{propertyName:0,elapsedTime:0,pseudoElement:0}),K4=ta(X4),Z4=mr({},jd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Q4=ta(Z4),J4=[9,13,27,32],s1=yi&&"CompositionEvent"in window,Su=null;yi&&"documentMode"in document&&(Su=document.documentMode);var eN=yi&&"TextEvent"in window&&!Su,Mb=yi&&(!s1||Su&&8<Su&&11>=Su),kv=" ",Ov=!1;function Lb(e,t){switch(e){case"keyup":return J4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lo=!1;function tN(e,t){switch(e){case"compositionend":return Bb(t);case"keypress":return t.which!==32?null:(Ov=!0,kv);case"textInput":return e=t.data,e===kv&&Ov?null:e;default:return null}}function rN(e,t){if(Lo)return e==="compositionend"||!s1&&Lb(e,t)?(e=jb(),h0=n1=zi=null,Lo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mb&&t.locale!=="ko"?null:t.data;default:return null}}var nN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nN[e.type]:t==="textarea"}function Ub(e,t,r,n){xb(n),t=B0(t,"onChange"),0<t.length&&(r=new a1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Au=null,Ju=null;function aN(e){Zb(e,0)}function Md(e){var t=zo(e);if(cb(t))return e}function iN(e,t){if(e==="change")return t}var zb=!1;if(yi){var $h;if(yi){var Gh="oninput"in document;if(!Gh){var Pv=document.createElement("div");Pv.setAttribute("oninput","return;"),Gh=typeof Pv.oninput=="function"}$h=Gh}else $h=!1;zb=$h&&(!document.documentMode||9<document.documentMode)}function Iv(){Au&&(Au.detachEvent("onpropertychange",qb),Ju=Au=null)}function qb(e){if(e.propertyName==="value"&&Md(Ju)){var t=[];Ub(t,Ju,e,Qg(e)),bb(aN,t)}}function sN(e,t,r){e==="focusin"?(Iv(),Au=t,Ju=r,Au.attachEvent("onpropertychange",qb)):e==="focusout"&&Iv()}function oN(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Md(Ju)}function lN(e,t){if(e==="click")return Md(t)}function uN(e,t){if(e==="input"||e==="change")return Md(t)}function cN(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ma=typeof Object.is=="function"?Object.is:cN;function ec(e,t){if(Ma(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!sm.call(t,a)||!Ma(e[a],t[a]))return!1}return!0}function Rv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function jv(e,t){var r=Rv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Rv(r)}}function Wb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $b(){for(var e=window,t=F0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=F0(e.document)}return t}function o1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function fN(e){var t=$b(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Wb(r.ownerDocument.documentElement,r)){if(n!==null&&o1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=jv(r,i);var s=jv(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dN=yi&&"documentMode"in document&&11>=document.documentMode,Bo=null,Sm=null,Nu=null,Am=!1;function Mv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Am||Bo==null||Bo!==F0(n)||(n=Bo,"selectionStart"in n&&o1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Nu&&ec(Nu,n)||(Nu=n,n=B0(Sm,"onSelect"),0<n.length&&(t=new a1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Bo)))}function kf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Uo={animationend:kf("Animation","AnimationEnd"),animationiteration:kf("Animation","AnimationIteration"),animationstart:kf("Animation","AnimationStart"),transitionend:kf("Transition","TransitionEnd")},Hh={},Gb={};yi&&(Gb=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function Ld(e){if(Hh[e])return Hh[e];if(!Uo[e])return e;var t=Uo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Gb)return Hh[e]=t[r];return e}var Hb=Ld("animationend"),Vb=Ld("animationiteration"),Yb=Ld("animationstart"),Xb=Ld("transitionend"),Kb=new Map,Lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ps(e,t){Kb.set(e,t),uo(t,[e])}for(var Vh=0;Vh<Lv.length;Vh++){var Yh=Lv[Vh],hN=Yh.toLowerCase(),pN=Yh[0].toUpperCase()+Yh.slice(1);ps(hN,"on"+pN)}ps(Hb,"onAnimationEnd");ps(Vb,"onAnimationIteration");ps(Yb,"onAnimationStart");ps("dblclick","onDoubleClick");ps("focusin","onFocus");ps("focusout","onBlur");ps(Xb,"onTransitionEnd");pl("onMouseEnter",["mouseout","mouseover"]);pl("onMouseLeave",["mouseout","mouseover"]);pl("onPointerEnter",["pointerout","pointerover"]);pl("onPointerLeave",["pointerout","pointerover"]);uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mN=new Set("cancel close invalid load scroll toggle".split(" ").concat(gu));function Bv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,h4(n,t,void 0,e),e.currentTarget=null}function Zb(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Bv(a,o,u),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Bv(a,o,u),i=l}}}if(I0)throw e=bm,I0=!1,bm=null,e}function ir(e,t){var r=t[Om];r===void 0&&(r=t[Om]=new Set);var n=e+"__bubble";r.has(n)||(Qb(t,e,2,!1),r.add(n))}function Xh(e,t,r){var n=0;t&&(n|=4),Qb(r,e,n,t)}var Of="_reactListening"+Math.random().toString(36).slice(2);function tc(e){if(!e[Of]){e[Of]=!0,ib.forEach(function(r){r!=="selectionchange"&&(mN.has(r)||Xh(r,!1,e),Xh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Of]||(t[Of]=!0,Xh("selectionchange",!1,t))}}function Qb(e,t,r,n){switch(Rb(t)){case 1:var a=C4;break;case 4:a=k4;break;default:a=r1}r=a.bind(null,t,r,e),a=void 0,!wm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Kh(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Is(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}bb(function(){var u=i,c=Qg(r),h=[];e:{var p=Kb.get(e);if(p!==void 0){var v=a1,E=e;switch(e){case"keypress":if(p0(r)===0)break e;case"keydown":case"keyup":v=G4;break;case"focusin":E="focus",v=Wh;break;case"focusout":E="blur",v=Wh;break;case"beforeblur":case"afterblur":v=Wh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=Nv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=P4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Y4;break;case Hb:case Vb:case Yb:v=j4;break;case Xb:v=K4;break;case"scroll":v=O4;break;case"wheel":v=Q4;break;case"copy":case"cut":case"paste":v=L4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Cv}var g=(t&4)!==0,w=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var y=u,b;y!==null;){b=y;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,x!==null&&(_=Xu(y,x),_!=null&&g.push(rc(y,_,b)))),w)break;y=y.return}0<g.length&&(p=new v(p,E,null,r,c),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",p&&r!==vm&&(E=r.relatedTarget||r.fromElement)&&(Is(E)||E[wi]))break e;if((v||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,v?(E=r.relatedTarget||r.toElement,v=u,E=E?Is(E):null,E!==null&&(w=co(E),E!==w||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=u),v!==E)){if(g=Nv,_="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=Cv,_="onPointerLeave",x="onPointerEnter",y="pointer"),w=v==null?p:zo(v),b=E==null?p:zo(E),p=new g(_,y+"leave",v,r,c),p.target=w,p.relatedTarget=b,_=null,Is(c)===u&&(g=new g(x,y+"enter",E,r,c),g.target=b,g.relatedTarget=w,_=g),w=_,v&&E)t:{for(g=v,x=E,y=0,b=g;b;b=_o(b))y++;for(b=0,_=x;_;_=_o(_))b++;for(;0<y-b;)g=_o(g),y--;for(;0<b-y;)x=_o(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=_o(g),x=_o(x)}g=null}else g=null;v!==null&&Uv(h,p,v,g,!1),E!==null&&w!==null&&Uv(h,w,E,g,!0)}}e:{if(p=u?zo(u):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var N=iN;else if(Fv(p))if(zb)N=uN;else{N=oN;var k=sN}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=lN);if(N&&(N=N(e,u))){Ub(h,N,r,c);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&hm(p,"number",p.value)}switch(k=u?zo(u):window,e){case"focusin":(Fv(k)||k.contentEditable==="true")&&(Bo=k,Sm=u,Nu=null);break;case"focusout":Nu=Sm=Bo=null;break;case"mousedown":Am=!0;break;case"contextmenu":case"mouseup":case"dragend":Am=!1,Mv(h,r,c);break;case"selectionchange":if(dN)break;case"keydown":case"keyup":Mv(h,r,c)}var T;if(s1)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Lo?Lb(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(Mb&&r.locale!=="ko"&&(Lo||A!=="onCompositionStart"?A==="onCompositionEnd"&&Lo&&(T=jb()):(zi=c,n1="value"in zi?zi.value:zi.textContent,Lo=!0)),k=B0(u,A),0<k.length&&(A=new Dv(A,e,null,r,c),h.push({event:A,listeners:k}),T?A.data=T:(T=Bb(r),T!==null&&(A.data=T)))),(T=eN?tN(e,r):rN(e,r))&&(u=B0(u,"onBeforeInput"),0<u.length&&(c=new Dv("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=T))}Zb(h,t)})}function rc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function B0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Xu(e,r),i!=null&&n.unshift(rc(e,i,a)),i=Xu(e,t),i!=null&&n.push(rc(e,i,a))),e=e.return}return n}function _o(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Uv(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,a?(l=Xu(r,i),l!=null&&s.unshift(rc(r,l,o))):a||(l=Xu(r,i),l!=null&&s.push(rc(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var gN=/\r\n?/g,xN=/\u0000|\uFFFD/g;function zv(e){return(typeof e=="string"?e:""+e).replace(gN,`
`).replace(xN,"")}function Ff(e,t,r){if(t=zv(t),zv(e)!==t&&r)throw Error(Ie(425))}function U0(){}var Nm=null,Dm=null;function Cm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var km=typeof setTimeout=="function"?setTimeout:void 0,vN=typeof clearTimeout=="function"?clearTimeout:void 0,qv=typeof Promise=="function"?Promise:void 0,yN=typeof queueMicrotask=="function"?queueMicrotask:typeof qv<"u"?function(e){return qv.resolve(null).then(e).catch(wN)}:km;function wN(e){setTimeout(function(){throw e})}function Zh(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Qu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Qu(t)}function Ki(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Wv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ol=Math.random().toString(36).slice(2),Ya="__reactFiber$"+Ol,nc="__reactProps$"+Ol,wi="__reactContainer$"+Ol,Om="__reactEvents$"+Ol,bN="__reactListeners$"+Ol,EN="__reactHandles$"+Ol;function Is(e){var t=e[Ya];if(t)return t;for(var r=e.parentNode;r;){if(t=r[wi]||r[Ya]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Wv(e);e!==null;){if(r=e[Ya])return r;e=Wv(e)}return t}e=r,r=e.parentNode}return null}function $c(e){return e=e[Ya]||e[wi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ie(33))}function Bd(e){return e[nc]||null}var Fm=[],qo=-1;function ms(e){return{current:e}}function or(e){0>qo||(e.current=Fm[qo],Fm[qo]=null,qo--)}function rr(e,t){qo++,Fm[qo]=e.current,e.current=t}var ns={},pn=ms(ns),kn=ms(!1),Ys=ns;function ml(e,t){var r=e.type.contextTypes;if(!r)return ns;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function On(e){return e=e.childContextTypes,e!=null}function z0(){or(kn),or(pn)}function $v(e,t,r){if(pn.current!==ns)throw Error(Ie(168));rr(pn,t),rr(kn,r)}function Jb(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ie(108,s4(e)||"Unknown",a));return mr({},r,n)}function q0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ns,Ys=pn.current,rr(pn,e),rr(kn,kn.current),!0}function Gv(e,t,r){var n=e.stateNode;if(!n)throw Error(Ie(169));r?(e=Jb(e,t,Ys),n.__reactInternalMemoizedMergedChildContext=e,or(kn),or(pn),rr(pn,e)):or(kn),rr(kn,r)}var si=null,Ud=!1,Qh=!1;function eE(e){si===null?si=[e]:si.push(e)}function _N(e){Ud=!0,eE(e)}function gs(){if(!Qh&&si!==null){Qh=!0;var e=0,t=Yt;try{var r=si;for(Yt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}si=null,Ud=!1}catch(a){throw si!==null&&(si=si.slice(e+1)),Sb(Jg,gs),a}finally{Yt=t,Qh=!1}}return null}var Wo=[],$o=0,W0=null,$0=0,la=[],ua=0,Xs=null,ui=1,ci="";function Cs(e,t){Wo[$o++]=$0,Wo[$o++]=W0,W0=e,$0=t}function tE(e,t,r){la[ua++]=ui,la[ua++]=ci,la[ua++]=Xs,Xs=e;var n=ui;e=ci;var a=32-Pa(n)-1;n&=~(1<<a),r+=1;var i=32-Pa(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ui=1<<32-Pa(t)+a|r<<a|n,ci=i+e}else ui=1<<i|r<<a|n,ci=e}function l1(e){e.return!==null&&(Cs(e,1),tE(e,1,0))}function u1(e){for(;e===W0;)W0=Wo[--$o],Wo[$o]=null,$0=Wo[--$o],Wo[$o]=null;for(;e===Xs;)Xs=la[--ua],la[ua]=null,ci=la[--ua],la[ua]=null,ui=la[--ua],la[ua]=null}var Kn=null,Xn=null,fr=!1,Ca=null;function rE(e,t){var r=ca(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Hv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kn=e,Xn=Ki(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kn=e,Xn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Xs!==null?{id:ui,overflow:ci}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ca(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Kn=e,Xn=null,!0):!1;default:return!1}}function Pm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Im(e){if(fr){var t=Xn;if(t){var r=t;if(!Hv(e,t)){if(Pm(e))throw Error(Ie(418));t=Ki(r.nextSibling);var n=Kn;t&&Hv(e,t)?rE(n,r):(e.flags=e.flags&-4097|2,fr=!1,Kn=e)}}else{if(Pm(e))throw Error(Ie(418));e.flags=e.flags&-4097|2,fr=!1,Kn=e}}}function Vv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kn=e}function Pf(e){if(e!==Kn)return!1;if(!fr)return Vv(e),fr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cm(e.type,e.memoizedProps)),t&&(t=Xn)){if(Pm(e))throw nE(),Error(Ie(418));for(;t;)rE(e,t),t=Ki(t.nextSibling)}if(Vv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Xn=Ki(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Xn=null}}else Xn=Kn?Ki(e.stateNode.nextSibling):null;return!0}function nE(){for(var e=Xn;e;)e=Ki(e.nextSibling)}function gl(){Xn=Kn=null,fr=!1}function c1(e){Ca===null?Ca=[e]:Ca.push(e)}var TN=Ai.ReactCurrentBatchConfig;function tu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ie(309));var n=r.stateNode}if(!n)throw Error(Ie(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ie(284));if(!r._owner)throw Error(Ie(290,e))}return e}function If(e,t){throw e=Object.prototype.toString.call(t),Error(Ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yv(e){var t=e._init;return t(e._payload)}function aE(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=es(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,b,_){return y===null||y.tag!==6?(y=ip(b,x.mode,_),y.return=x,y):(y=a(y,b),y.return=x,y)}function l(x,y,b,_){var N=b.type;return N===Mo?c(x,y,b.props.children,_,b.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ri&&Yv(N)===y.type)?(_=a(y,b.props),_.ref=tu(x,y,b),_.return=x,_):(_=b0(b.type,b.key,b.props,null,x.mode,_),_.ref=tu(x,y,b),_.return=x,_)}function u(x,y,b,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=sp(b,x.mode,_),y.return=x,y):(y=a(y,b.children||[]),y.return=x,y)}function c(x,y,b,_,N){return y===null||y.tag!==7?(y=zs(b,x.mode,_,N),y.return=x,y):(y=a(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ip(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case _f:return b=b0(y.type,y.key,y.props,null,x.mode,b),b.ref=tu(x,null,y),b.return=x,b;case jo:return y=sp(y,x.mode,b),y.return=x,y;case Ri:var _=y._init;return h(x,_(y._payload),b)}if(pu(y)||Kl(y))return y=zs(y,x.mode,b,null),y.return=x,y;If(x,y)}return null}function p(x,y,b,_){var N=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:o(x,y,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _f:return b.key===N?l(x,y,b,_):null;case jo:return b.key===N?u(x,y,b,_):null;case Ri:return N=b._init,p(x,y,N(b._payload),_)}if(pu(b)||Kl(b))return N!==null?null:c(x,y,b,_,null);If(x,b)}return null}function v(x,y,b,_,N){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(b)||null,o(y,x,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _f:return x=x.get(_.key===null?b:_.key)||null,l(y,x,_,N);case jo:return x=x.get(_.key===null?b:_.key)||null,u(y,x,_,N);case Ri:var k=_._init;return v(x,y,b,k(_._payload),N)}if(pu(_)||Kl(_))return x=x.get(b)||null,c(y,x,_,N,null);If(y,_)}return null}function E(x,y,b,_){for(var N=null,k=null,T=y,A=y=0,S=null;T!==null&&A<b.length;A++){T.index>A?(S=T,T=null):S=T.sibling;var P=p(x,T,b[A],_);if(P===null){T===null&&(T=S);break}e&&T&&P.alternate===null&&t(x,T),y=i(P,y,A),k===null?N=P:k.sibling=P,k=P,T=S}if(A===b.length)return r(x,T),fr&&Cs(x,A),N;if(T===null){for(;A<b.length;A++)T=h(x,b[A],_),T!==null&&(y=i(T,y,A),k===null?N=T:k.sibling=T,k=T);return fr&&Cs(x,A),N}for(T=n(x,T);A<b.length;A++)S=v(T,x,A,b[A],_),S!==null&&(e&&S.alternate!==null&&T.delete(S.key===null?A:S.key),y=i(S,y,A),k===null?N=S:k.sibling=S,k=S);return e&&T.forEach(function(F){return t(x,F)}),fr&&Cs(x,A),N}function g(x,y,b,_){var N=Kl(b);if(typeof N!="function")throw Error(Ie(150));if(b=N.call(b),b==null)throw Error(Ie(151));for(var k=N=null,T=y,A=y=0,S=null,P=b.next();T!==null&&!P.done;A++,P=b.next()){T.index>A?(S=T,T=null):S=T.sibling;var F=p(x,T,P.value,_);if(F===null){T===null&&(T=S);break}e&&T&&F.alternate===null&&t(x,T),y=i(F,y,A),k===null?N=F:k.sibling=F,k=F,T=S}if(P.done)return r(x,T),fr&&Cs(x,A),N;if(T===null){for(;!P.done;A++,P=b.next())P=h(x,P.value,_),P!==null&&(y=i(P,y,A),k===null?N=P:k.sibling=P,k=P);return fr&&Cs(x,A),N}for(T=n(x,T);!P.done;A++,P=b.next())P=v(T,x,A,P.value,_),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?A:P.key),y=i(P,y,A),k===null?N=P:k.sibling=P,k=P);return e&&T.forEach(function(U){return t(x,U)}),fr&&Cs(x,A),N}function w(x,y,b,_){if(typeof b=="object"&&b!==null&&b.type===Mo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case _f:e:{for(var N=b.key,k=y;k!==null;){if(k.key===N){if(N=b.type,N===Mo){if(k.tag===7){r(x,k.sibling),y=a(k,b.props.children),y.return=x,x=y;break e}}else if(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ri&&Yv(N)===k.type){r(x,k.sibling),y=a(k,b.props),y.ref=tu(x,k,b),y.return=x,x=y;break e}r(x,k);break}else t(x,k);k=k.sibling}b.type===Mo?(y=zs(b.props.children,x.mode,_,b.key),y.return=x,x=y):(_=b0(b.type,b.key,b.props,null,x.mode,_),_.ref=tu(x,y,b),_.return=x,x=_)}return s(x);case jo:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=a(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=sp(b,x.mode,_),y.return=x,x=y}return s(x);case Ri:return k=b._init,w(x,y,k(b._payload),_)}if(pu(b))return E(x,y,b,_);if(Kl(b))return g(x,y,b,_);If(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=a(y,b),y.return=x,x=y):(r(x,y),y=ip(b,x.mode,_),y.return=x,x=y),s(x)):r(x,y)}return w}var xl=aE(!0),iE=aE(!1),G0=ms(null),H0=null,Go=null,f1=null;function d1(){f1=Go=H0=null}function h1(e){var t=G0.current;or(G0),e._currentValue=t}function Rm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function rl(e,t){H0=e,f1=Go=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Cn=!0),e.firstContext=null)}function pa(e){var t=e._currentValue;if(f1!==e)if(e={context:e,memoizedValue:t,next:null},Go===null){if(H0===null)throw Error(Ie(308));Go=e,H0.dependencies={lanes:0,firstContext:e}}else Go=Go.next=e;return t}var Rs=null;function p1(e){Rs===null?Rs=[e]:Rs.push(e)}function sE(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,p1(t)):(r.next=a.next,a.next=r),t.interleaved=r,bi(e,n)}function bi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ji=!1;function m1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Bt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,bi(e,r)}return a=n.interleaved,a===null?(t.next=t,p1(n)):(t.next=a.next,a.next=t),n.interleaved=t,bi(e,r)}function m0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e1(e,r)}}function Xv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function V0(e,t,r,n){var a=e.updateQueue;ji=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?i=u:s.next=u,s=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(i!==null){var h=a.baseState;s=0,c=u=l=null,o=i;do{var p=o.lane,v=o.eventTime;if((n&p)===p){c!==null&&(c=c.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var E=e,g=o;switch(p=t,v=r,g.tag){case 1:if(E=g.payload,typeof E=="function"){h=E.call(v,h,p);break e}h=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=g.payload,p=typeof E=="function"?E.call(v,h,p):E,p==null)break e;h=mr({},h,p);break e;case 2:ji=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else v={eventTime:v,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=v,l=h):c=c.next=v,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=h),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Zs|=s,e.lanes=s,e.memoizedState=h}}function Kv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ie(191,a));a.call(n)}}}var Gc={},Ka=ms(Gc),ac=ms(Gc),ic=ms(Gc);function js(e){if(e===Gc)throw Error(Ie(174));return e}function g1(e,t){switch(rr(ic,t),rr(ac,e),rr(Ka,Gc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:mm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=mm(t,e)}or(Ka),rr(Ka,t)}function vl(){or(Ka),or(ac),or(ic)}function lE(e){js(ic.current);var t=js(Ka.current),r=mm(t,e.type);t!==r&&(rr(ac,e),rr(Ka,r))}function x1(e){ac.current===e&&(or(Ka),or(ac))}var dr=ms(0);function Y0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jh=[];function v1(){for(var e=0;e<Jh.length;e++)Jh[e]._workInProgressVersionPrimary=null;Jh.length=0}var g0=Ai.ReactCurrentDispatcher,ep=Ai.ReactCurrentBatchConfig,Ks=0,pr=null,Pr=null,Br=null,X0=!1,Du=!1,sc=0,SN=0;function sn(){throw Error(Ie(321))}function y1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ma(e[r],t[r]))return!1;return!0}function w1(e,t,r,n,a,i){if(Ks=i,pr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,g0.current=e===null||e.memoizedState===null?CN:kN,e=r(n,a),Du){i=0;do{if(Du=!1,sc=0,25<=i)throw Error(Ie(301));i+=1,Br=Pr=null,t.updateQueue=null,g0.current=ON,e=r(n,a)}while(Du)}if(g0.current=K0,t=Pr!==null&&Pr.next!==null,Ks=0,Br=Pr=pr=null,X0=!1,t)throw Error(Ie(300));return e}function b1(){var e=sc!==0;return sc=0,e}function Ga(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?pr.memoizedState=Br=e:Br=Br.next=e,Br}function ma(){if(Pr===null){var e=pr.alternate;e=e!==null?e.memoizedState:null}else e=Pr.next;var t=Br===null?pr.memoizedState:Br.next;if(t!==null)Br=t,Pr=e;else{if(e===null)throw Error(Ie(310));Pr=e,e={memoizedState:Pr.memoizedState,baseState:Pr.baseState,baseQueue:Pr.baseQueue,queue:Pr.queue,next:null},Br===null?pr.memoizedState=Br=e:Br=Br.next=e}return Br}function oc(e,t){return typeof t=="function"?t(e):t}function tp(e){var t=ma(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=Pr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,u=i;do{var c=u.lane;if((Ks&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,pr.lanes|=c,Zs|=c}u=u.next}while(u!==null&&u!==i);l===null?s=n:l.next=o,Ma(n,t.memoizedState)||(Cn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,pr.lanes|=i,Zs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function rp(e){var t=ma(),r=t.queue;if(r===null)throw Error(Ie(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Ma(i,t.memoizedState)||(Cn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function uE(){}function cE(e,t){var r=pr,n=ma(),a=t(),i=!Ma(n.memoizedState,a);if(i&&(n.memoizedState=a,Cn=!0),n=n.queue,E1(hE.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Br!==null&&Br.memoizedState.tag&1){if(r.flags|=2048,lc(9,dE.bind(null,r,n,a,t),void 0,null),Wr===null)throw Error(Ie(349));Ks&30||fE(r,t,a)}return a}function fE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=pr.updateQueue,t===null?(t={lastEffect:null,stores:null},pr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function dE(e,t,r,n){t.value=r,t.getSnapshot=n,pE(t)&&mE(e)}function hE(e,t,r){return r(function(){pE(t)&&mE(e)})}function pE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ma(e,r)}catch{return!0}}function mE(e){var t=bi(e,1);t!==null&&Ia(t,e,1,-1)}function Zv(e){var t=Ga();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oc,lastRenderedState:e},t.queue=e,e=e.dispatch=DN.bind(null,pr,e),[t.memoizedState,e]}function lc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=pr.updateQueue,t===null?(t={lastEffect:null,stores:null},pr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function gE(){return ma().memoizedState}function x0(e,t,r,n){var a=Ga();pr.flags|=e,a.memoizedState=lc(1|t,r,void 0,n===void 0?null:n)}function zd(e,t,r,n){var a=ma();n=n===void 0?null:n;var i=void 0;if(Pr!==null){var s=Pr.memoizedState;if(i=s.destroy,n!==null&&y1(n,s.deps)){a.memoizedState=lc(t,r,i,n);return}}pr.flags|=e,a.memoizedState=lc(1|t,r,i,n)}function Qv(e,t){return x0(8390656,8,e,t)}function E1(e,t){return zd(2048,8,e,t)}function xE(e,t){return zd(4,2,e,t)}function vE(e,t){return zd(4,4,e,t)}function yE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wE(e,t,r){return r=r!=null?r.concat([e]):null,zd(4,4,yE.bind(null,t,e),r)}function _1(){}function bE(e,t){var r=ma();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function EE(e,t){var r=ma();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&y1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function _E(e,t,r){return Ks&21?(Ma(r,t)||(r=Db(),pr.lanes|=r,Zs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Cn=!0),e.memoizedState=r)}function AN(e,t){var r=Yt;Yt=r!==0&&4>r?r:4,e(!0);var n=ep.transition;ep.transition={};try{e(!1),t()}finally{Yt=r,ep.transition=n}}function TE(){return ma().memoizedState}function NN(e,t,r){var n=Ji(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},SE(e))AE(t,r);else if(r=sE(e,t,r,n),r!==null){var a=En();Ia(r,e,n,a),NE(r,t,n)}}function DN(e,t,r){var n=Ji(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(SE(e))AE(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Ma(o,s)){var l=t.interleaved;l===null?(a.next=a,p1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=sE(e,t,a,n),r!==null&&(a=En(),Ia(r,e,n,a),NE(r,t,n))}}function SE(e){var t=e.alternate;return e===pr||t!==null&&t===pr}function AE(e,t){Du=X0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function NE(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e1(e,r)}}var K0={readContext:pa,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},CN={readContext:pa,useCallback:function(e,t){return Ga().memoizedState=[e,t===void 0?null:t],e},useContext:pa,useEffect:Qv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,x0(4194308,4,yE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return x0(4194308,4,e,t)},useInsertionEffect:function(e,t){return x0(4,2,e,t)},useMemo:function(e,t){var r=Ga();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ga();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=NN.bind(null,pr,e),[n.memoizedState,e]},useRef:function(e){var t=Ga();return e={current:e},t.memoizedState=e},useState:Zv,useDebugValue:_1,useDeferredValue:function(e){return Ga().memoizedState=e},useTransition:function(){var e=Zv(!1),t=e[0];return e=AN.bind(null,e[1]),Ga().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=pr,a=Ga();if(fr){if(r===void 0)throw Error(Ie(407));r=r()}else{if(r=t(),Wr===null)throw Error(Ie(349));Ks&30||fE(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,Qv(hE.bind(null,n,i,e),[e]),n.flags|=2048,lc(9,dE.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ga(),t=Wr.identifierPrefix;if(fr){var r=ci,n=ui;r=(n&~(1<<32-Pa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=sc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=SN++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},kN={readContext:pa,useCallback:bE,useContext:pa,useEffect:E1,useImperativeHandle:wE,useInsertionEffect:xE,useLayoutEffect:vE,useMemo:EE,useReducer:tp,useRef:gE,useState:function(){return tp(oc)},useDebugValue:_1,useDeferredValue:function(e){var t=ma();return _E(t,Pr.memoizedState,e)},useTransition:function(){var e=tp(oc)[0],t=ma().memoizedState;return[e,t]},useMutableSource:uE,useSyncExternalStore:cE,useId:TE,unstable_isNewReconciler:!1},ON={readContext:pa,useCallback:bE,useContext:pa,useEffect:E1,useImperativeHandle:wE,useInsertionEffect:xE,useLayoutEffect:vE,useMemo:EE,useReducer:rp,useRef:gE,useState:function(){return rp(oc)},useDebugValue:_1,useDeferredValue:function(e){var t=ma();return Pr===null?t.memoizedState=e:_E(t,Pr.memoizedState,e)},useTransition:function(){var e=rp(oc)[0],t=ma().memoizedState;return[e,t]},useMutableSource:uE,useSyncExternalStore:cE,useId:TE,unstable_isNewReconciler:!1};function Na(e,t){if(e&&e.defaultProps){t=mr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function jm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:mr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var qd={isMounted:function(e){return(e=e._reactInternals)?co(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=En(),a=Ji(e),i=di(n,a);i.payload=t,r!=null&&(i.callback=r),t=Zi(e,i,a),t!==null&&(Ia(t,e,a,n),m0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=En(),a=Ji(e),i=di(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Zi(e,i,a),t!==null&&(Ia(t,e,a,n),m0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=En(),n=Ji(e),a=di(r,n);a.tag=2,t!=null&&(a.callback=t),t=Zi(e,a,n),t!==null&&(Ia(t,e,n,r),m0(t,e,n))}};function Jv(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!ec(r,n)||!ec(a,i):!0}function DE(e,t,r){var n=!1,a=ns,i=t.contextType;return typeof i=="object"&&i!==null?i=pa(i):(a=On(t)?Ys:pn.current,n=t.contextTypes,i=(n=n!=null)?ml(e,a):ns),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function e2(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&qd.enqueueReplaceState(t,t.state,null)}function Mm(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},m1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=pa(i):(i=On(t)?Ys:pn.current,a.context=ml(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(jm(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&qd.enqueueReplaceState(a,a.state,null),V0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function yl(e,t){try{var r="",n=t;do r+=i4(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function np(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Lm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var FN=typeof WeakMap=="function"?WeakMap:Map;function CE(e,t,r){r=di(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Q0||(Q0=!0,Ym=n),Lm(e,t)},r}function kE(e,t,r){r=di(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Lm(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Lm(e,t),typeof n!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function t2(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new FN;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=HN.bind(null,e,t,r),t.then(e,e))}function r2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function n2(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=di(-1,1),t.tag=2,Zi(r,t,1))),r.lanes|=1),e)}var PN=Ai.ReactCurrentOwner,Cn=!1;function vn(e,t,r,n){t.child=e===null?iE(t,null,r,n):xl(t,e.child,r,n)}function a2(e,t,r,n,a){r=r.render;var i=t.ref;return rl(t,a),n=w1(e,t,r,n,i,a),r=b1(),e!==null&&!Cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ei(e,t,a)):(fr&&r&&l1(t),t.flags|=1,vn(e,t,n,a),t.child)}function i2(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!O1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,OE(e,t,i,n,a)):(e=b0(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:ec,r(s,n)&&e.ref===t.ref)return Ei(e,t,a)}return t.flags|=1,e=es(i,n),e.ref=t.ref,e.return=t,t.child=e}function OE(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(ec(i,n)&&e.ref===t.ref)if(Cn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Cn=!0);else return t.lanes=e.lanes,Ei(e,t,a)}return Bm(e,t,r,n,a)}function FE(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr(Vo,Gn),Gn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rr(Vo,Gn),Gn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,rr(Vo,Gn),Gn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,rr(Vo,Gn),Gn|=n;return vn(e,t,a,r),t.child}function PE(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Bm(e,t,r,n,a){var i=On(r)?Ys:pn.current;return i=ml(t,i),rl(t,a),r=w1(e,t,r,n,i,a),n=b1(),e!==null&&!Cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ei(e,t,a)):(fr&&n&&l1(t),t.flags|=1,vn(e,t,r,a),t.child)}function s2(e,t,r,n,a){if(On(r)){var i=!0;q0(t)}else i=!1;if(rl(t,a),t.stateNode===null)v0(e,t),DE(t,r,n),Mm(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=pa(u):(u=On(r)?Ys:pn.current,u=ml(t,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==u)&&e2(t,s,n,u),ji=!1;var p=t.memoizedState;s.state=p,V0(t,n,s,a),l=t.memoizedState,o!==n||p!==l||kn.current||ji?(typeof c=="function"&&(jm(t,r,c,n),l=t.memoizedState),(o=ji||Jv(t,r,o,n,p,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,oE(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Na(t.type,o),s.props=u,h=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=pa(l):(l=On(r)?Ys:pn.current,l=ml(t,l));var v=r.getDerivedStateFromProps;(c=typeof v=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||p!==l)&&e2(t,s,n,l),ji=!1,p=t.memoizedState,s.state=p,V0(t,n,s,a);var E=t.memoizedState;o!==h||p!==E||kn.current||ji?(typeof v=="function"&&(jm(t,r,v,n),E=t.memoizedState),(u=ji||Jv(t,r,u,n,p,E,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,E,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,E,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=E),s.props=n,s.state=E,s.context=l,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Um(e,t,r,n,i,a)}function Um(e,t,r,n,a,i){PE(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&Gv(t,r,!1),Ei(e,t,i);n=t.stateNode,PN.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=xl(t,e.child,null,i),t.child=xl(t,null,o,i)):vn(e,t,o,i),t.memoizedState=n.state,a&&Gv(t,r,!0),t.child}function IE(e){var t=e.stateNode;t.pendingContext?$v(e,t.pendingContext,t.pendingContext!==t.context):t.context&&$v(e,t.context,!1),g1(e,t.containerInfo)}function o2(e,t,r,n,a){return gl(),c1(a),t.flags|=256,vn(e,t,r,n),t.child}var zm={dehydrated:null,treeContext:null,retryLane:0};function qm(e){return{baseLanes:e,cachePool:null,transitions:null}}function RE(e,t,r){var n=t.pendingProps,a=dr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),rr(dr,a&1),e===null)return Im(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Gd(s,n,0,null),e=zs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=qm(r),t.memoizedState=zm,e):T1(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return IN(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=es(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=es(o,i):(i=zs(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?qm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=zm,n}return i=e.child,e=i.sibling,n=es(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function T1(e,t){return t=Gd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rf(e,t,r,n){return n!==null&&c1(n),xl(t,e.child,null,r),e=T1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function IN(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=np(Error(Ie(422))),Rf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Gd({mode:"visible",children:n.children},a,0,null),i=zs(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&xl(t,e.child,null,s),t.child.memoizedState=qm(s),t.memoizedState=zm,i);if(!(t.mode&1))return Rf(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Ie(419)),n=np(i,n,void 0),Rf(e,t,s,n)}if(o=(s&e.childLanes)!==0,Cn||o){if(n=Wr,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,bi(e,a),Ia(n,e,a,-1))}return k1(),n=np(Error(Ie(421))),Rf(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=VN.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Xn=Ki(a.nextSibling),Kn=t,fr=!0,Ca=null,e!==null&&(la[ua++]=ui,la[ua++]=ci,la[ua++]=Xs,ui=e.id,ci=e.overflow,Xs=t),t=T1(t,n.children),t.flags|=4096,t)}function l2(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Rm(e.return,t,r)}function ap(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function jE(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(vn(e,t,n.children,r),n=dr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l2(e,r,t);else if(e.tag===19)l2(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(rr(dr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Y0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ap(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Y0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ap(t,!0,r,null,i);break;case"together":ap(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function v0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ei(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Zs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ie(153));if(t.child!==null){for(e=t.child,r=es(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=es(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function RN(e,t,r){switch(t.tag){case 3:IE(t),gl();break;case 5:lE(t);break;case 1:On(t.type)&&q0(t);break;case 4:g1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;rr(G0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(rr(dr,dr.current&1),t.flags|=128,null):r&t.child.childLanes?RE(e,t,r):(rr(dr,dr.current&1),e=Ei(e,t,r),e!==null?e.sibling:null);rr(dr,dr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return jE(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),rr(dr,dr.current),n)break;return null;case 22:case 23:return t.lanes=0,FE(e,t,r)}return Ei(e,t,r)}var ME,Wm,LE,BE;ME=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Wm=function(){};LE=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,js(Ka.current);var i=null;switch(r){case"input":a=fm(e,a),n=fm(e,n),i=[];break;case"select":a=mr({},a,{value:void 0}),n=mr({},n,{value:void 0}),i=[];break;case"textarea":a=pm(e,a),n=pm(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=U0)}gm(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Vu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Vu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ir("scroll",e),i||o===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};BE=function(e,t,r,n){r!==n&&(t.flags|=4)};function ru(e,t){if(!fr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function on(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function jN(e,t,r){var n=t.pendingProps;switch(u1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(t),null;case 1:return On(t.type)&&z0(),on(t),null;case 3:return n=t.stateNode,vl(),or(kn),or(pn),v1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Pf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ca!==null&&(Zm(Ca),Ca=null))),Wm(e,t),on(t),null;case 5:x1(t);var a=js(ic.current);if(r=t.type,e!==null&&t.stateNode!=null)LE(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ie(166));return on(t),null}if(e=js(Ka.current),Pf(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Ya]=t,n[nc]=i,e=(t.mode&1)!==0,r){case"dialog":ir("cancel",n),ir("close",n);break;case"iframe":case"object":case"embed":ir("load",n);break;case"video":case"audio":for(a=0;a<gu.length;a++)ir(gu[a],n);break;case"source":ir("error",n);break;case"img":case"image":case"link":ir("error",n),ir("load",n);break;case"details":ir("toggle",n);break;case"input":xv(n,i),ir("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ir("invalid",n);break;case"textarea":yv(n,i),ir("invalid",n)}gm(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Ff(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Ff(n.textContent,o,e),a=["children",""+o]):Vu.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&ir("scroll",n)}switch(r){case"input":Tf(n),vv(n,i,!0);break;case"textarea":Tf(n),wv(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=U0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hb(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Ya]=t,e[nc]=n,ME(e,t,!1,!1),t.stateNode=e;e:{switch(s=xm(r,n),r){case"dialog":ir("cancel",e),ir("close",e),a=n;break;case"iframe":case"object":case"embed":ir("load",e),a=n;break;case"video":case"audio":for(a=0;a<gu.length;a++)ir(gu[a],e);a=n;break;case"source":ir("error",e),a=n;break;case"img":case"image":case"link":ir("error",e),ir("load",e),a=n;break;case"details":ir("toggle",e),a=n;break;case"input":xv(e,n),a=fm(e,n),ir("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=mr({},n,{value:void 0}),ir("invalid",e);break;case"textarea":yv(e,n),a=pm(e,n),ir("invalid",e);break;default:a=n}gm(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?gb(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pb(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Yu(e,l):typeof l=="number"&&Yu(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Vu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&ir("scroll",e):l!=null&&Yg(e,i,l,s))}switch(r){case"input":Tf(e),vv(e,n,!1);break;case"textarea":Tf(e),wv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+rs(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Qo(e,!!n.multiple,i,!1):n.defaultValue!=null&&Qo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=U0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return on(t),null;case 6:if(e&&t.stateNode!=null)BE(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ie(166));if(r=js(ic.current),js(Ka.current),Pf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ya]=t,(i=n.nodeValue!==r)&&(e=Kn,e!==null))switch(e.tag){case 3:Ff(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ff(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ya]=t,t.stateNode=n}return on(t),null;case 13:if(or(dr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(fr&&Xn!==null&&t.mode&1&&!(t.flags&128))nE(),gl(),t.flags|=98560,i=!1;else if(i=Pf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ie(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ie(317));i[Ya]=t}else gl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;on(t),i=!1}else Ca!==null&&(Zm(Ca),Ca=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||dr.current&1?Ir===0&&(Ir=3):k1())),t.updateQueue!==null&&(t.flags|=4),on(t),null);case 4:return vl(),Wm(e,t),e===null&&tc(t.stateNode.containerInfo),on(t),null;case 10:return h1(t.type._context),on(t),null;case 17:return On(t.type)&&z0(),on(t),null;case 19:if(or(dr),i=t.memoizedState,i===null)return on(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)ru(i,!1);else{if(Ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Y0(e),s!==null){for(t.flags|=128,ru(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return rr(dr,dr.current&1|2),t.child}e=e.sibling}i.tail!==null&&_r()>wl&&(t.flags|=128,n=!0,ru(i,!1),t.lanes=4194304)}else{if(!n)if(e=Y0(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ru(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!fr)return on(t),null}else 2*_r()-i.renderingStartTime>wl&&r!==1073741824&&(t.flags|=128,n=!0,ru(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=_r(),t.sibling=null,r=dr.current,rr(dr,n?r&1|2:r&1),t):(on(t),null);case 22:case 23:return C1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Gn&1073741824&&(on(t),t.subtreeFlags&6&&(t.flags|=8192)):on(t),null;case 24:return null;case 25:return null}throw Error(Ie(156,t.tag))}function MN(e,t){switch(u1(t),t.tag){case 1:return On(t.type)&&z0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vl(),or(kn),or(pn),v1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x1(t),null;case 13:if(or(dr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ie(340));gl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return or(dr),null;case 4:return vl(),null;case 10:return h1(t.type._context),null;case 22:case 23:return C1(),null;case 24:return null;default:return null}}var jf=!1,ln=!1,LN=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Ho(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vr(e,t,n)}else r.current=null}function $m(e,t,r){try{r()}catch(n){vr(e,t,n)}}var u2=!1;function BN(e,t){if(Nm=M0,e=$b(),o1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,u=0,c=0,h=e,p=null;t:for(;;){for(var v;h!==r||a!==0&&h.nodeType!==3||(o=s+a),h!==i||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(v=h.firstChild)!==null;)p=h,h=v;for(;;){if(h===e)break t;if(p===r&&++u===a&&(o=s),p===i&&++c===n&&(l=s),(v=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=v}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Dm={focusedElem:e,selectionRange:r},M0=!1,nt=t;nt!==null;)if(t=nt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,nt=e;else for(;nt!==null;){t=nt;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var g=E.memoizedProps,w=E.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Na(t.type,g),w);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ie(163))}}catch(_){vr(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,nt=e;break}nt=t.return}return E=u2,u2=!1,E}function Cu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&$m(t,r,i)}a=a.next}while(a!==n)}}function Wd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Gm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function UE(e){var t=e.alternate;t!==null&&(e.alternate=null,UE(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ya],delete t[nc],delete t[Om],delete t[bN],delete t[EN])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zE(e){return e.tag===5||e.tag===3||e.tag===4}function c2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zE(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=U0));else if(n!==4&&(e=e.child,e!==null))for(Hm(e,t,r),e=e.sibling;e!==null;)Hm(e,t,r),e=e.sibling}function Vm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vm(e,t,r),e=e.sibling;e!==null;)Vm(e,t,r),e=e.sibling}var Xr=null,Da=!1;function Ci(e,t,r){for(r=r.child;r!==null;)qE(e,t,r),r=r.sibling}function qE(e,t,r){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(Rd,r)}catch{}switch(r.tag){case 5:ln||Ho(r,t);case 6:var n=Xr,a=Da;Xr=null,Ci(e,t,r),Xr=n,Da=a,Xr!==null&&(Da?(e=Xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Xr.removeChild(r.stateNode));break;case 18:Xr!==null&&(Da?(e=Xr,r=r.stateNode,e.nodeType===8?Zh(e.parentNode,r):e.nodeType===1&&Zh(e,r),Qu(e)):Zh(Xr,r.stateNode));break;case 4:n=Xr,a=Da,Xr=r.stateNode.containerInfo,Da=!0,Ci(e,t,r),Xr=n,Da=a;break;case 0:case 11:case 14:case 15:if(!ln&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&$m(r,t,s),a=a.next}while(a!==n)}Ci(e,t,r);break;case 1:if(!ln&&(Ho(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vr(r,t,o)}Ci(e,t,r);break;case 21:Ci(e,t,r);break;case 22:r.mode&1?(ln=(n=ln)||r.memoizedState!==null,Ci(e,t,r),ln=n):Ci(e,t,r);break;default:Ci(e,t,r)}}function f2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new LN),t.forEach(function(n){var a=YN.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ea(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Xr=o.stateNode,Da=!1;break e;case 3:Xr=o.stateNode.containerInfo,Da=!0;break e;case 4:Xr=o.stateNode.containerInfo,Da=!0;break e}o=o.return}if(Xr===null)throw Error(Ie(160));qE(i,s,a),Xr=null,Da=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){vr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)WE(t,e),t=t.sibling}function WE(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ea(t,e),qa(e),n&4){try{Cu(3,e,e.return),Wd(3,e)}catch(g){vr(e,e.return,g)}try{Cu(5,e,e.return)}catch(g){vr(e,e.return,g)}}break;case 1:Ea(t,e),qa(e),n&512&&r!==null&&Ho(r,r.return);break;case 5:if(Ea(t,e),qa(e),n&512&&r!==null&&Ho(r,r.return),e.flags&32){var a=e.stateNode;try{Yu(a,"")}catch(g){vr(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&fb(a,i),xm(o,s);var u=xm(o,i);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?gb(a,h):c==="dangerouslySetInnerHTML"?pb(a,h):c==="children"?Yu(a,h):Yg(a,c,h,u)}switch(o){case"input":dm(a,i);break;case"textarea":db(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Qo(a,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?Qo(a,!!i.multiple,i.defaultValue,!0):Qo(a,!!i.multiple,i.multiple?[]:"",!1))}a[nc]=i}catch(g){vr(e,e.return,g)}}break;case 6:if(Ea(t,e),qa(e),n&4){if(e.stateNode===null)throw Error(Ie(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vr(e,e.return,g)}}break;case 3:if(Ea(t,e),qa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Qu(t.containerInfo)}catch(g){vr(e,e.return,g)}break;case 4:Ea(t,e),qa(e);break;case 13:Ea(t,e),qa(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(N1=_r())),n&4&&f2(e);break;case 22:if(c=r!==null&&r.memoizedState!==null,e.mode&1?(ln=(u=ln)||c,Ea(t,e),ln=u):Ea(t,e),qa(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(nt=e,c=e.child;c!==null;){for(h=nt=c;nt!==null;){switch(p=nt,v=p.child,p.tag){case 0:case 11:case 14:case 15:Cu(4,p,p.return);break;case 1:Ho(p,p.return);var E=p.stateNode;if(typeof E.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(g){vr(n,r,g)}}break;case 5:Ho(p,p.return);break;case 22:if(p.memoizedState!==null){h2(h);continue}}v!==null?(v.return=p,nt=v):h2(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{a=h.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=mb("display",s))}catch(g){vr(e,e.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){vr(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ea(t,e),qa(e),n&4&&f2(e);break;case 21:break;default:Ea(t,e),qa(e)}}function qa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(zE(r)){var n=r;break e}r=r.return}throw Error(Ie(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Yu(a,""),n.flags&=-33);var i=c2(e);Vm(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=c2(e);Hm(e,o,s);break;default:throw Error(Ie(161))}}catch(l){vr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function UN(e,t,r){nt=e,$E(e)}function $E(e,t,r){for(var n=(e.mode&1)!==0;nt!==null;){var a=nt,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||jf;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||ln;o=jf;var u=ln;if(jf=s,(ln=l)&&!u)for(nt=a;nt!==null;)s=nt,l=s.child,s.tag===22&&s.memoizedState!==null?p2(a):l!==null?(l.return=s,nt=l):p2(a);for(;i!==null;)nt=i,$E(i),i=i.sibling;nt=a,jf=o,ln=u}d2(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,nt=i):d2(e)}}function d2(e){for(;nt!==null;){var t=nt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ln||Wd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ln)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Na(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Kv(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Kv(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Qu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ie(163))}ln||t.flags&512&&Gm(t)}catch(p){vr(t,t.return,p)}}if(t===e){nt=null;break}if(r=t.sibling,r!==null){r.return=t.return,nt=r;break}nt=t.return}}function h2(e){for(;nt!==null;){var t=nt;if(t===e){nt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,nt=r;break}nt=t.return}}function p2(e){for(;nt!==null;){var t=nt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Wd(4,t)}catch(l){vr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){vr(t,a,l)}}var i=t.return;try{Gm(t)}catch(l){vr(t,i,l)}break;case 5:var s=t.return;try{Gm(t)}catch(l){vr(t,s,l)}}}catch(l){vr(t,t.return,l)}if(t===e){nt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,nt=o;break}nt=t.return}}var zN=Math.ceil,Z0=Ai.ReactCurrentDispatcher,S1=Ai.ReactCurrentOwner,fa=Ai.ReactCurrentBatchConfig,Bt=0,Wr=null,Ar=null,tn=0,Gn=0,Vo=ms(0),Ir=0,uc=null,Zs=0,$d=0,A1=0,ku=null,Dn=null,N1=0,wl=1/0,ii=null,Q0=!1,Ym=null,Qi=null,Mf=!1,qi=null,J0=0,Ou=0,Xm=null,y0=-1,w0=0;function En(){return Bt&6?_r():y0!==-1?y0:y0=_r()}function Ji(e){return e.mode&1?Bt&2&&tn!==0?tn&-tn:TN.transition!==null?(w0===0&&(w0=Db()),w0):(e=Yt,e!==0||(e=window.event,e=e===void 0?16:Rb(e.type)),e):1}function Ia(e,t,r,n){if(50<Ou)throw Ou=0,Xm=null,Error(Ie(185));qc(e,r,n),(!(Bt&2)||e!==Wr)&&(e===Wr&&(!(Bt&2)&&($d|=r),Ir===4&&Bi(e,tn)),Fn(e,n),r===1&&Bt===0&&!(t.mode&1)&&(wl=_r()+500,Ud&&gs()))}function Fn(e,t){var r=e.callbackNode;T4(e,t);var n=j0(e,e===Wr?tn:0);if(n===0)r!==null&&_v(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_v(r),t===1)e.tag===0?_N(m2.bind(null,e)):eE(m2.bind(null,e)),yN(function(){!(Bt&6)&&gs()}),r=null;else{switch(Cb(n)){case 1:r=Jg;break;case 4:r=Ab;break;case 16:r=R0;break;case 536870912:r=Nb;break;default:r=R0}r=QE(r,GE.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function GE(e,t){if(y0=-1,w0=0,Bt&6)throw Error(Ie(327));var r=e.callbackNode;if(nl()&&e.callbackNode!==r)return null;var n=j0(e,e===Wr?tn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ed(e,n);else{t=n;var a=Bt;Bt|=2;var i=VE();(Wr!==e||tn!==t)&&(ii=null,wl=_r()+500,Us(e,t));do try{$N();break}catch(o){HE(e,o)}while(!0);d1(),Z0.current=i,Bt=a,Ar!==null?t=0:(Wr=null,tn=0,t=Ir)}if(t!==0){if(t===2&&(a=Em(e),a!==0&&(n=a,t=Km(e,a))),t===1)throw r=uc,Us(e,0),Bi(e,n),Fn(e,_r()),r;if(t===6)Bi(e,n);else{if(a=e.current.alternate,!(n&30)&&!qN(a)&&(t=ed(e,n),t===2&&(i=Em(e),i!==0&&(n=i,t=Km(e,i))),t===1))throw r=uc,Us(e,0),Bi(e,n),Fn(e,_r()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ie(345));case 2:ks(e,Dn,ii);break;case 3:if(Bi(e,n),(n&130023424)===n&&(t=N1+500-_r(),10<t)){if(j0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){En(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=km(ks.bind(null,e,Dn,ii),t);break}ks(e,Dn,ii);break;case 4:if(Bi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Pa(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=_r()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*zN(n/1960))-n,10<n){e.timeoutHandle=km(ks.bind(null,e,Dn,ii),n);break}ks(e,Dn,ii);break;case 5:ks(e,Dn,ii);break;default:throw Error(Ie(329))}}}return Fn(e,_r()),e.callbackNode===r?GE.bind(null,e):null}function Km(e,t){var r=ku;return e.current.memoizedState.isDehydrated&&(Us(e,t).flags|=256),e=ed(e,t),e!==2&&(t=Dn,Dn=r,t!==null&&Zm(t)),e}function Zm(e){Dn===null?Dn=e:Dn.push.apply(Dn,e)}function qN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ma(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bi(e,t){for(t&=~A1,t&=~$d,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pa(t),n=1<<r;e[r]=-1,t&=~n}}function m2(e){if(Bt&6)throw Error(Ie(327));nl();var t=j0(e,0);if(!(t&1))return Fn(e,_r()),null;var r=ed(e,t);if(e.tag!==0&&r===2){var n=Em(e);n!==0&&(t=n,r=Km(e,n))}if(r===1)throw r=uc,Us(e,0),Bi(e,t),Fn(e,_r()),r;if(r===6)throw Error(Ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ks(e,Dn,ii),Fn(e,_r()),null}function D1(e,t){var r=Bt;Bt|=1;try{return e(t)}finally{Bt=r,Bt===0&&(wl=_r()+500,Ud&&gs())}}function Qs(e){qi!==null&&qi.tag===0&&!(Bt&6)&&nl();var t=Bt;Bt|=1;var r=fa.transition,n=Yt;try{if(fa.transition=null,Yt=1,e)return e()}finally{Yt=n,fa.transition=r,Bt=t,!(Bt&6)&&gs()}}function C1(){Gn=Vo.current,or(Vo)}function Us(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,vN(r)),Ar!==null)for(r=Ar.return;r!==null;){var n=r;switch(u1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&z0();break;case 3:vl(),or(kn),or(pn),v1();break;case 5:x1(n);break;case 4:vl();break;case 13:or(dr);break;case 19:or(dr);break;case 10:h1(n.type._context);break;case 22:case 23:C1()}r=r.return}if(Wr=e,Ar=e=es(e.current,null),tn=Gn=t,Ir=0,uc=null,A1=$d=Zs=0,Dn=ku=null,Rs!==null){for(t=0;t<Rs.length;t++)if(r=Rs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Rs=null}return e}function HE(e,t){do{var r=Ar;try{if(d1(),g0.current=K0,X0){for(var n=pr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}X0=!1}if(Ks=0,Br=Pr=pr=null,Du=!1,sc=0,S1.current=null,r===null||r.return===null){Ir=1,uc=t,Ar=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=tn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var v=r2(s);if(v!==null){v.flags&=-257,n2(v,s,o,i,t),v.mode&1&&t2(i,u,t),t=v,l=u;var E=t.updateQueue;if(E===null){var g=new Set;g.add(l),t.updateQueue=g}else E.add(l);break e}else{if(!(t&1)){t2(i,u,t),k1();break e}l=Error(Ie(426))}}else if(fr&&o.mode&1){var w=r2(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),n2(w,s,o,i,t),c1(yl(l,o));break e}}i=l=yl(l,o),Ir!==4&&(Ir=2),ku===null?ku=[i]:ku.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=CE(i,l,t);Xv(i,x);break e;case 1:o=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qi===null||!Qi.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=kE(i,o,t);Xv(i,_);break e}}i=i.return}while(i!==null)}XE(r)}catch(N){t=N,Ar===r&&r!==null&&(Ar=r=r.return);continue}break}while(!0)}function VE(){var e=Z0.current;return Z0.current=K0,e===null?K0:e}function k1(){(Ir===0||Ir===3||Ir===2)&&(Ir=4),Wr===null||!(Zs&268435455)&&!($d&268435455)||Bi(Wr,tn)}function ed(e,t){var r=Bt;Bt|=2;var n=VE();(Wr!==e||tn!==t)&&(ii=null,Us(e,t));do try{WN();break}catch(a){HE(e,a)}while(!0);if(d1(),Bt=r,Z0.current=n,Ar!==null)throw Error(Ie(261));return Wr=null,tn=0,Ir}function WN(){for(;Ar!==null;)YE(Ar)}function $N(){for(;Ar!==null&&!m4();)YE(Ar)}function YE(e){var t=ZE(e.alternate,e,Gn);e.memoizedProps=e.pendingProps,t===null?XE(e):Ar=t,S1.current=null}function XE(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=MN(r,t),r!==null){r.flags&=32767,Ar=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ir=6,Ar=null;return}}else if(r=jN(r,t,Gn),r!==null){Ar=r;return}if(t=t.sibling,t!==null){Ar=t;return}Ar=t=e}while(t!==null);Ir===0&&(Ir=5)}function ks(e,t,r){var n=Yt,a=fa.transition;try{fa.transition=null,Yt=1,GN(e,t,r,n)}finally{fa.transition=a,Yt=n}return null}function GN(e,t,r,n){do nl();while(qi!==null);if(Bt&6)throw Error(Ie(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ie(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(S4(e,i),e===Wr&&(Ar=Wr=null,tn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Mf||(Mf=!0,QE(R0,function(){return nl(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=fa.transition,fa.transition=null;var s=Yt;Yt=1;var o=Bt;Bt|=4,S1.current=null,BN(e,r),WE(r,e),fN(Dm),M0=!!Nm,Dm=Nm=null,e.current=r,UN(r),g4(),Bt=o,Yt=s,fa.transition=i}else e.current=r;if(Mf&&(Mf=!1,qi=e,J0=a),i=e.pendingLanes,i===0&&(Qi=null),y4(r.stateNode),Fn(e,_r()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Q0)throw Q0=!1,e=Ym,Ym=null,e;return J0&1&&e.tag!==0&&nl(),i=e.pendingLanes,i&1?e===Xm?Ou++:(Ou=0,Xm=e):Ou=0,gs(),null}function nl(){if(qi!==null){var e=Cb(J0),t=fa.transition,r=Yt;try{if(fa.transition=null,Yt=16>e?16:e,qi===null)var n=!1;else{if(e=qi,qi=null,J0=0,Bt&6)throw Error(Ie(331));var a=Bt;for(Bt|=4,nt=e.current;nt!==null;){var i=nt,s=i.child;if(nt.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(nt=u;nt!==null;){var c=nt;switch(c.tag){case 0:case 11:case 15:Cu(8,c,i)}var h=c.child;if(h!==null)h.return=c,nt=h;else for(;nt!==null;){c=nt;var p=c.sibling,v=c.return;if(UE(c),c===u){nt=null;break}if(p!==null){p.return=v,nt=p;break}nt=v}}}var E=i.alternate;if(E!==null){var g=E.child;if(g!==null){E.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}nt=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,nt=s;else e:for(;nt!==null;){if(i=nt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Cu(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,nt=x;break e}nt=i.return}}var y=e.current;for(nt=y;nt!==null;){s=nt;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,nt=b;else e:for(s=y;nt!==null;){if(o=nt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Wd(9,o)}}catch(N){vr(o,o.return,N)}if(o===s){nt=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,nt=_;break e}nt=o.return}}if(Bt=a,gs(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(Rd,e)}catch{}n=!0}return n}finally{Yt=r,fa.transition=t}}return!1}function g2(e,t,r){t=yl(r,t),t=CE(e,t,1),e=Zi(e,t,1),t=En(),e!==null&&(qc(e,1,t),Fn(e,t))}function vr(e,t,r){if(e.tag===3)g2(e,e,r);else for(;t!==null;){if(t.tag===3){g2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qi===null||!Qi.has(n))){e=yl(r,e),e=kE(t,e,1),t=Zi(t,e,1),e=En(),t!==null&&(qc(t,1,e),Fn(t,e));break}}t=t.return}}function HN(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=En(),e.pingedLanes|=e.suspendedLanes&r,Wr===e&&(tn&r)===r&&(Ir===4||Ir===3&&(tn&130023424)===tn&&500>_r()-N1?Us(e,0):A1|=r),Fn(e,t)}function KE(e,t){t===0&&(e.mode&1?(t=Nf,Nf<<=1,!(Nf&130023424)&&(Nf=4194304)):t=1);var r=En();e=bi(e,t),e!==null&&(qc(e,t,r),Fn(e,r))}function VN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),KE(e,r)}function YN(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ie(314))}n!==null&&n.delete(t),KE(e,r)}var ZE;ZE=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||kn.current)Cn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Cn=!1,RN(e,t,r);Cn=!!(e.flags&131072)}else Cn=!1,fr&&t.flags&1048576&&tE(t,$0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;v0(e,t),e=t.pendingProps;var a=ml(t,pn.current);rl(t,r),a=w1(null,t,n,e,a,r);var i=b1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,On(n)?(i=!0,q0(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,m1(t),a.updater=qd,t.stateNode=a,a._reactInternals=t,Mm(t,n,e,r),t=Um(null,t,n,!0,i,r)):(t.tag=0,fr&&i&&l1(t),vn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(v0(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=KN(n),e=Na(n,e),a){case 0:t=Bm(null,t,n,e,r);break e;case 1:t=s2(null,t,n,e,r);break e;case 11:t=a2(null,t,n,e,r);break e;case 14:t=i2(null,t,n,Na(n.type,e),r);break e}throw Error(Ie(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Na(n,a),Bm(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Na(n,a),s2(e,t,n,a,r);case 3:e:{if(IE(t),e===null)throw Error(Ie(387));n=t.pendingProps,i=t.memoizedState,a=i.element,oE(e,t),V0(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=yl(Error(Ie(423)),t),t=o2(e,t,n,r,a);break e}else if(n!==a){a=yl(Error(Ie(424)),t),t=o2(e,t,n,r,a);break e}else for(Xn=Ki(t.stateNode.containerInfo.firstChild),Kn=t,fr=!0,Ca=null,r=iE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gl(),n===a){t=Ei(e,t,r);break e}vn(e,t,n,r)}t=t.child}return t;case 5:return lE(t),e===null&&Im(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,Cm(n,a)?s=null:i!==null&&Cm(n,i)&&(t.flags|=32),PE(e,t),vn(e,t,s,r),t.child;case 6:return e===null&&Im(t),null;case 13:return RE(e,t,r);case 4:return g1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xl(t,null,n,r):vn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Na(n,a),a2(e,t,n,a,r);case 7:return vn(e,t,t.pendingProps,r),t.child;case 8:return vn(e,t,t.pendingProps.children,r),t.child;case 12:return vn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,rr(G0,n._currentValue),n._currentValue=s,i!==null)if(Ma(i.value,s)){if(i.children===a.children&&!kn.current){t=Ei(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=di(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Rm(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Ie(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Rm(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}vn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,rl(t,r),a=pa(a),n=n(a),t.flags|=1,vn(e,t,n,r),t.child;case 14:return n=t.type,a=Na(n,t.pendingProps),a=Na(n.type,a),i2(e,t,n,a,r);case 15:return OE(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Na(n,a),v0(e,t),t.tag=1,On(n)?(e=!0,q0(t)):e=!1,rl(t,r),DE(t,n,a),Mm(t,n,a,r),Um(null,t,n,!0,e,r);case 19:return jE(e,t,r);case 22:return FE(e,t,r)}throw Error(Ie(156,t.tag))};function QE(e,t){return Sb(e,t)}function XN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ca(e,t,r,n){return new XN(e,t,r,n)}function O1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function KN(e){if(typeof e=="function")return O1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Kg)return 11;if(e===Zg)return 14}return 2}function es(e,t){var r=e.alternate;return r===null?(r=ca(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function b0(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")O1(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Mo:return zs(r.children,a,i,t);case Xg:s=8,a|=8;break;case om:return e=ca(12,r,t,a|2),e.elementType=om,e.lanes=i,e;case lm:return e=ca(13,r,t,a),e.elementType=lm,e.lanes=i,e;case um:return e=ca(19,r,t,a),e.elementType=um,e.lanes=i,e;case lb:return Gd(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case sb:s=10;break e;case ob:s=9;break e;case Kg:s=11;break e;case Zg:s=14;break e;case Ri:s=16,n=null;break e}throw Error(Ie(130,e==null?e:typeof e,""))}return t=ca(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function zs(e,t,r,n){return e=ca(7,e,n,t),e.lanes=r,e}function Gd(e,t,r,n){return e=ca(22,e,n,t),e.elementType=lb,e.lanes=r,e.stateNode={isHidden:!1},e}function ip(e,t,r){return e=ca(6,e,null,t),e.lanes=r,e}function sp(e,t,r){return t=ca(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ZN(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Uh(0),this.expirationTimes=Uh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Uh(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function F1(e,t,r,n,a,i,s,o,l){return e=new ZN(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ca(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},m1(i),e}function QN(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function JE(e){if(!e)return ns;e=e._reactInternals;e:{if(co(e)!==e||e.tag!==1)throw Error(Ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(On(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ie(171))}if(e.tag===1){var r=e.type;if(On(r))return Jb(e,r,t)}return t}function e_(e,t,r,n,a,i,s,o,l){return e=F1(r,n,!0,e,a,i,s,o,l),e.context=JE(null),r=e.current,n=En(),a=Ji(r),i=di(n,a),i.callback=t??null,Zi(r,i,a),e.current.lanes=a,qc(e,a,n),Fn(e,n),e}function Hd(e,t,r,n){var a=t.current,i=En(),s=Ji(a);return r=JE(r),t.context===null?t.context=r:t.pendingContext=r,t=di(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zi(a,t,s),e!==null&&(Ia(e,a,s,i),m0(e,a,s)),s}function td(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function x2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function P1(e,t){x2(e,t),(e=e.alternate)&&x2(e,t)}function JN(){return null}var t_=typeof reportError=="function"?reportError:function(e){console.error(e)};function I1(e){this._internalRoot=e}Vd.prototype.render=I1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ie(409));Hd(e,t,null,null)};Vd.prototype.unmount=I1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Qs(function(){Hd(null,e,null,null)}),t[wi]=null}};function Vd(e){this._internalRoot=e}Vd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fb();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Li.length&&t!==0&&t<Li[r].priority;r++);Li.splice(r,0,e),r===0&&Ib(e)}};function R1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Yd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function v2(){}function eD(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=td(s);i.call(u)}}var s=e_(t,n,e,0,null,!1,!1,"",v2);return e._reactRootContainer=s,e[wi]=s.current,tc(e.nodeType===8?e.parentNode:e),Qs(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=td(l);o.call(u)}}var l=F1(e,0,!1,null,null,!1,!1,"",v2);return e._reactRootContainer=l,e[wi]=l.current,tc(e.nodeType===8?e.parentNode:e),Qs(function(){Hd(t,l,r,n)}),l}function Xd(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=td(s);o.call(l)}}Hd(t,s,e,a)}else s=eD(r,t,e,a,n);return td(s)}kb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=mu(t.pendingLanes);r!==0&&(e1(t,r|1),Fn(t,_r()),!(Bt&6)&&(wl=_r()+500,gs()))}break;case 13:Qs(function(){var n=bi(e,1);if(n!==null){var a=En();Ia(n,e,1,a)}}),P1(e,1)}};t1=function(e){if(e.tag===13){var t=bi(e,134217728);if(t!==null){var r=En();Ia(t,e,134217728,r)}P1(e,134217728)}};Ob=function(e){if(e.tag===13){var t=Ji(e),r=bi(e,t);if(r!==null){var n=En();Ia(r,e,t,n)}P1(e,t)}};Fb=function(){return Yt};Pb=function(e,t){var r=Yt;try{return Yt=e,t()}finally{Yt=r}};ym=function(e,t,r){switch(t){case"input":if(dm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Bd(n);if(!a)throw Error(Ie(90));cb(n),dm(n,a)}}}break;case"textarea":db(e,r);break;case"select":t=r.value,t!=null&&Qo(e,!!r.multiple,t,!1)}};yb=D1;wb=Qs;var tD={usingClientEntryPoint:!1,Events:[$c,zo,Bd,xb,vb,D1]},nu={findFiberByHostInstance:Is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rD={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ai.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_b(e),e===null?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||JN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lf.isDisabled&&Lf.supportsFiber)try{Rd=Lf.inject(rD),Xa=Lf}catch{}}ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tD;ea.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!R1(t))throw Error(Ie(200));return QN(e,t,null,r)};ea.createRoot=function(e,t){if(!R1(e))throw Error(Ie(299));var r=!1,n="",a=t_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=F1(e,1,!1,null,null,r,!1,n,a),e[wi]=t.current,tc(e.nodeType===8?e.parentNode:e),new I1(t)};ea.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ie(188)):(e=Object.keys(e).join(","),Error(Ie(268,e)));return e=_b(t),e=e===null?null:e.stateNode,e};ea.flushSync=function(e){return Qs(e)};ea.hydrate=function(e,t,r){if(!Yd(t))throw Error(Ie(200));return Xd(null,e,t,!0,r)};ea.hydrateRoot=function(e,t,r){if(!R1(e))throw Error(Ie(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=t_;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=e_(t,null,e,1,r??null,a,!1,i,s),e[wi]=t.current,tc(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Vd(t)};ea.render=function(e,t,r){if(!Yd(t))throw Error(Ie(200));return Xd(null,e,t,!1,r)};ea.unmountComponentAtNode=function(e){if(!Yd(e))throw Error(Ie(40));return e._reactRootContainer?(Qs(function(){Xd(null,null,e,!1,function(){e._reactRootContainer=null,e[wi]=null})}),!0):!1};ea.unstable_batchedUpdates=D1;ea.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Yd(r))throw Error(Ie(200));if(e==null||e._reactInternals===void 0)throw Error(Ie(38));return Xd(e,t,r,!1,n)};ea.version="18.3.1-next-f1338f8080-20240426";function r_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r_)}catch(e){console.error(e)}}r_(),rb.exports=ea;var nD=rb.exports,y2=nD;im.createRoot=y2.createRoot,im.hydrateRoot=y2.hydrateRoot;const aD="modulepreload",iD=function(e){return"/Certify-app/"+e},w2={},Pn=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=iD(l),l in w2)return;w2[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":aD,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((p,v)=>{h.addEventListener("load",p),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},sr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Nr=Object.keys,cn=Array.isArray;function Tn(e,t){return typeof t!="object"||Nr(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||sr.Promise||(sr.Promise=Promise);const cc=Object.getPrototypeOf,sD={}.hasOwnProperty;function Qn(e,t){return sD.call(e,t)}function bl(e,t){typeof t=="function"&&(t=t(cc(e))),(typeof Reflect>"u"?Nr:Reflect.ownKeys)(t).forEach(r=>{hi(e,r,t[r])})}const n_=Object.defineProperty;function hi(e,t,r,n){n_(e,t,Tn(r&&Qn(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function al(e){return{from:function(t){return e.prototype=Object.create(t.prototype),hi(e.prototype,"constructor",e),{extend:bl.bind(null,e.prototype)}}}}const oD=Object.getOwnPropertyDescriptor;function j1(e,t){let r;return oD(e,t)||(r=cc(e))&&j1(r,t)}const lD=[].slice;function rd(e,t,r){return lD.call(e,t,r)}function a_(e,t){return t(e)}function xu(e){if(!e)throw new Error("Assertion Failed")}function i_(e){sr.setImmediate?setImmediate(e):setTimeout(e,0)}function s_(e,t){return e.reduce((r,n,a)=>{var i=t(n,a);return i&&(r[i[0]]=i[1]),r},{})}function pi(e,t){if(typeof t=="string"&&Qn(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,a=t.length;n<a;++n){var i=pi(e,t[n]);r.push(i)}return r}var s=t.indexOf(".");if(s!==-1){var o=e[t.substr(0,s)];return o==null?void 0:pi(o,t.substr(s+1))}}function Ra(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){xu(typeof r!="string"&&"length"in r);for(var n=0,a=t.length;n<a;++n)Ra(e,t[n],r[n])}else{var i=t.indexOf(".");if(i!==-1){var s=t.substr(0,i),o=t.substr(i+1);if(o==="")r===void 0?cn(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=r;else{var l=e[s];l&&Qn(e,s)||(l=e[s]={}),Ra(l,o,r)}}else r===void 0?cn(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function o_(e){var t={};for(var r in e)Qn(e,r)&&(t[r]=e[r]);return t}const uD=[].concat;function l_(e){return uD.apply([],e)}const u_="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(l_([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>sr[e]),cD=u_.map(e=>sr[e]);s_(u_,e=>[e,!0]);let Mi=null;function Hc(e){Mi=typeof WeakMap<"u"&&new WeakMap;const t=Qm(e);return Mi=null,t}function Qm(e){if(!e||typeof e!="object")return e;let t=Mi&&Mi.get(e);if(t)return t;if(cn(e)){t=[],Mi&&Mi.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Qm(e[r]))}else if(cD.indexOf(e.constructor)>=0)t=e;else{const i=cc(e);for(var a in t=i===Object.prototype?{}:Object.create(i),Mi&&Mi.set(e,t),e)Qn(e,a)&&(t[a]=Qm(e[a]))}return t}const{toString:fD}={};function Jm(e){return fD.call(e).slice(8,-1)}const eg=typeof Symbol<"u"?Symbol.iterator:"@@iterator",dD=typeof eg=="symbol"?function(e){var t;return e!=null&&(t=e[eg])&&t.apply(e)}:function(){return null},Io={};function li(e){var t,r,n,a;if(arguments.length===1){if(cn(e))return e.slice();if(this===Io&&typeof e=="string")return[e];if(a=dD(e)){for(r=[];!(n=a.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const M1=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var ei=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function c_(e,t){ei=e,f_=t}var f_=()=>!0;const hD=!new Error("").stack;function fo(){if(hD)try{throw fo.arguments,new Error}catch(e){return e}return new Error}function tg(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(f_).map(n=>`
`+n).join("")):""}var d_=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],L1=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(d_),pD={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function il(e,t){this._e=fo(),this.name=e,this.message=t}function h_(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,a)=>a.indexOf(r)===n).join(`
`)}function nd(e,t,r,n){this._e=fo(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=h_(e,t)}function Fu(e,t){this._e=fo(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=h_(e,t)}al(il).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+tg(this._e,2))}},toString:function(){return this.name+": "+this.message}}),al(nd).from(il),al(Fu).from(il);var B1=L1.reduce((e,t)=>(e[t]=t+"Error",e),{});const mD=il;var mt=L1.reduce((e,t)=>{var r=t+"Error";function n(a,i){this._e=fo(),this.name=r,a?typeof a=="string"?(this.message=`${a}${i?`
 `+i:""}`,this.inner=i||null):typeof a=="object"&&(this.message=`${a.name} ${a.message}`,this.inner=a):(this.message=pD[t]||r,this.inner=null)}return al(n).from(mD),e[t]=n,e},{});mt.Syntax=SyntaxError,mt.Type=TypeError,mt.Range=RangeError;var b2=d_.reduce((e,t)=>(e[t+"Error"]=mt[t],e),{}),E0=L1.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=mt[t]),e),{});function er(){}function fc(e){return e}function gD(e,t){return e==null||e===fc?t:function(r){return t(e(r))}}function Js(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function xD(e,t){return e===er?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Js(n,this.onsuccess):n),a&&(this.onerror=this.onerror?Js(a,this.onerror):a),i!==void 0?i:r}}function vD(e,t){return e===er?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Js(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Js(n,this.onerror):n)}}function yD(e,t){return e===er?t:function(r){var n=e.apply(this,arguments);Tn(r,n);var a=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Js(a,this.onsuccess):a),i&&(this.onerror=this.onerror?Js(i,this.onerror):i),n===void 0?s===void 0?void 0:s:Tn(n,s)}}function wD(e,t){return e===er?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function U1(e,t){return e===er?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,a=arguments.length,i=new Array(a);a--;)i[a]=arguments[a];return r.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}E0.ModifyError=nd,E0.DexieError=il,E0.BulkError=Fu;var dc={};const p_=100,[rg,ad,ng]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,cc(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,cc(t),e]})(),m_=ad&&ad.then,_0=rg&&rg.constructor,z1=!!ng;var ag=!1,bD=ng?()=>{ng.then(Bf)}:sr.setImmediate?setImmediate.bind(null,Bf):sr.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Bf(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Bf,0)},Pu=function(e,t){vu.push([e,t]),id&&(bD(),id=!1)},ig=!0,id=!0,qs=[],T0=[],sg=null,og=fc,sl={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:T2,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{T2(e[0],e[1])}catch{}})}},ot=sl,vu=[],Ws=0,S0=[];function tt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=er,this._lib=!1;var t=this._PSD=ot;if(ei&&(this._stackHolder=fo(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==dc)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ug(this,this._value))}this._state=null,this._value=null,++t.ref,x_(this,e)}const lg={get:function(){var e=ot,t=sd;function r(n,a){var i=!e.global&&(e!==ot||t!==sd);const s=i&&!_i();var o=new tt((l,u)=>{q1(this,new g_(od(n,e,i,s),od(a,e,i,s),l,u,e))});return ei&&w_(o,this),o}return r.prototype=dc,r},set:function(e){hi(this,"then",e&&e.prototype===dc?lg:{get:function(){return e},set:lg.set})}};function g_(e,t,r,n,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=a}function x_(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Vc();r&&typeof r.then=="function"?x_(e,(a,i)=>{r instanceof tt?r._then(a,i):r.then(a,i)}):(e._state=!0,e._value=r,v_(e)),n&&Yc()}},ug.bind(null,e))}catch(r){ug(e,r)}}function ug(e,t){if(T0.push(t),e._state===null){var r=e._lib&&Vc();t=og(t),e._state=!1,e._value=t,ei&&t!==null&&typeof t=="object"&&!t._promise&&function(n,a,i){try{n.apply(null,i)}catch{}}(()=>{var n=j1(t,"stack");t._promise=e,hi(t,"stack",{get:()=>ag?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){qs.some(a=>a._value===n._value)||qs.push(n)}(e),v_(e),r&&Yc()}}function v_(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)q1(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),Ws===0&&(++Ws,Pu(()=>{--Ws==0&&W1()},[]))}function q1(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ws,Pu(ED,[r,e,t])}else e._listeners.push(t)}function ED(e,t,r){try{sg=t;var n,a=t._value;t._state?n=e(a):(T0.length&&(T0=[]),n=e(a),T0.indexOf(a)===-1&&function(i){for(var s=qs.length;s;)if(qs[--s]._value===i._value)return void qs.splice(s,1)}(t)),r.resolve(n)}catch(i){r.reject(i)}finally{sg=null,--Ws==0&&W1(),--r.psd.ref||r.psd.finalize()}}function y_(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var a,i,s=e._value;s!=null?(a=s.name||"Error",i=s.message||s,n=tg(s,0)):(a=s,i=""),t.push(a+(i?": "+i:"")+n)}return ei&&((n=tg(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&y_(e._prev,t,r)),t}function w_(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Bf(){Vc()&&Yc()}function Vc(){var e=ig;return ig=!1,id=!1,e}function Yc(){var e,t,r;do for(;vu.length>0;)for(e=vu,vu=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(vu.length>0);ig=!0,id=!0}function W1(){var e=qs;qs=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=S0.slice(0),r=t.length;r;)t[--r]()}function Uf(e){return new tt(dc,!1,e)}function cr(e,t){var r=ot;return function(){var n=Vc(),a=ot;try{return is(r,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{is(a,!1),n&&Yc()}}}bl(tt.prototype,{then:lg,_then:function(e,t){q1(this,new g_(null,null,e,t,ot))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):Uf(n)):this.then(null,n=>n&&n.name===t?r(n):Uf(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),Uf(t)))},stack:{get:function(){if(this._stack)return this._stack;try{ag=!0;var e=y_(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{ag=!1}}},timeout:function(e,t){return e<1/0?new tt((r,n)=>{var a=setTimeout(()=>n(new mt.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&hi(tt.prototype,Symbol.toStringTag,"Dexie.Promise"),sl.env=b_(),bl(tt,{all:function(){var e=li.apply(null,arguments).map(zf);return new tt(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((a,i)=>tt.resolve(a).then(s=>{e[i]=s,--n||t(e)},r))})},resolve:e=>{if(e instanceof tt)return e;if(e&&typeof e.then=="function")return new tt((r,n)=>{e.then(r,n)});var t=new tt(dc,!0,e);return w_(t,sg),t},reject:Uf,race:function(){var e=li.apply(null,arguments).map(zf);return new tt((t,r)=>{e.map(n=>tt.resolve(n).then(t,r))})},PSD:{get:()=>ot,set:e=>ot=e},totalEchoes:{get:()=>sd},newPSD:as,usePSD:Pl,scheduler:{get:()=>Pu,set:e=>{Pu=e}},rejectionMapper:{get:()=>og,set:e=>{og=e}},follow:(e,t)=>new tt((r,n)=>as((a,i)=>{var s=ot;s.unhandleds=[],s.onunhandled=i,s.finalize=Js(function(){(function(o){function l(){o(),S0.splice(S0.indexOf(l),1)}S0.push(l),++Ws,Pu(()=>{--Ws==0&&W1()},[])})(()=>{this.unhandleds.length===0?a():i(this.unhandleds[0])})},s.finalize),e()},t,r,n))}),_0&&(_0.allSettled&&hi(tt,"allSettled",function(){const e=li.apply(null,arguments).map(zf);return new tt(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((a,i)=>tt.resolve(a).then(s=>n[i]={status:"fulfilled",value:s},s=>n[i]={status:"rejected",reason:s}).then(()=>--r||t(n)))})}),_0.any&&typeof AggregateError<"u"&&hi(tt,"any",function(){const e=li.apply(null,arguments).map(zf);return new tt((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const a=new Array(n);e.forEach((i,s)=>tt.resolve(i).then(o=>t(o),o=>{a[s]=o,--n||r(new AggregateError(a))}))})}));const un={awaits:0,echoes:0,id:0};var _D=0,A0=[],op=0,sd=0,TD=0;function as(e,t,r,n){var a=ot,i=Object.create(a);i.parent=a,i.ref=0,i.global=!1,i.id=++TD;var s=sl.env;i.env=z1?{Promise:tt,PromiseProp:{value:tt,configurable:!0,writable:!0},all:tt.all,race:tt.race,allSettled:tt.allSettled,any:tt.any,resolve:tt.resolve,reject:tt.reject,nthen:E2(s.nthen,i),gthen:E2(s.gthen,i)}:{},t&&Tn(i,t),++a.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Pl(i,e,r,n);return i.ref===0&&i.finalize(),o}function Fl(){return un.id||(un.id=++_D),++un.awaits,un.echoes+=p_,un.id}function _i(){return!!un.awaits&&(--un.awaits==0&&(un.id=0),un.echoes=un.awaits*p_,!0)}function zf(e){return un.echoes&&e&&e.constructor===_0?(Fl(),e.then(t=>(_i(),t),t=>(_i(),Rr(t)))):e}function SD(e){++sd,un.echoes&&--un.echoes!=0||(un.echoes=un.id=0),A0.push(ot),is(e,!0)}function AD(){var e=A0[A0.length-1];A0.pop(),is(e,!1)}function is(e,t){var r=ot;if((t?!un.echoes||op++&&e===ot:!op||--op&&e===ot)||E_(t?SD.bind(null,e):AD),e!==ot&&(ot=e,r===sl&&(sl.env=b_()),z1)){var n=sl.env.Promise,a=e.env;ad.then=a.nthen,n.prototype.then=a.gthen,(r.global||e.global)&&(Object.defineProperty(sr,"Promise",a.PromiseProp),n.all=a.all,n.race=a.race,n.resolve=a.resolve,n.reject=a.reject,a.allSettled&&(n.allSettled=a.allSettled),a.any&&(n.any=a.any))}}function b_(){var e=sr.Promise;return z1?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(sr,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:ad.then,gthen:e.prototype.then}:{}}function Pl(e,t,r,n,a){var i=ot;try{return is(e,!0),t(r,n,a)}finally{is(i,!1)}}function E_(e){m_.call(rg,e)}function od(e,t,r,n){return typeof e!="function"?e:function(){var a=ot;r&&Fl(),is(t,!0);try{return e.apply(this,arguments)}finally{is(a,!1),n&&E_(_i)}}}function E2(e,t){return function(r,n){return e.call(this,od(r,t),od(n,t))}}(""+m_).indexOf("[native code]")===-1&&(Fl=_i=er);const _2="unhandledrejection";function T2(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,a={promise:t,reason:e};if(sr.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(_2,!0,!0),Tn(n,a)):sr.CustomEvent&&Tn(n=new CustomEvent(_2,{detail:a}),a),n&&sr.dispatchEvent&&(dispatchEvent(n),!sr.PromiseRejectionEvent&&sr.onunhandledrejection))try{sr.onunhandledrejection(n)}catch{}ei&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Rr=tt.reject;function cg(e,t,r,n){if(e.idbdb&&(e._state.openComplete||ot.letThrough||e._vip)){var a=e._createTransaction(t,r,e._dbSchema);try{a.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===B1.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>cg(e,t,r,n))):Rr(i)}return a._promise(t,(i,s)=>as(()=>(ot.trans=a,n(i,s,a)))).then(i=>a._completion.then(()=>i))}if(e._state.openComplete)return Rr(new mt.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Rr(new mt.DatabaseClosed);e.open().catch(er)}return e._state.dbReadyPromise.then(()=>cg(e,t,r,n))}const S2="3.2.7",Ms="",fg=-1/0,ai="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",__="String expected.",Iu=[],Kd=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ND=Kd,DD=Kd,T_=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),Zd="__dbnames",lp="readonly",up="readwrite";function eo(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const S_={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function qf(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=Hc(t))[e],t)}class CD{_trans(t,r,n){const a=this._tx||ot.trans,i=this.name;function s(l,u,c){if(!c.schema[i])throw new mt.NotFound("Table "+i+" not part of transaction");return r(c.idbtrans,c)}const o=Vc();try{return a&&a.db===this.db?a===ot.trans?a._promise(t,s,n):as(()=>a._promise(t,s,n),{trans:a,transless:ot.transless||ot}):cg(this.db,t,[this.name],s)}finally{o&&Yc()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(a=>this.hook.reading.fire(a))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(cn(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Nr(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&r.every(c=>u.keyPath.indexOf(c)>=0)){for(let c=0;c<r.length;++c)if(r.indexOf(u.keyPath[c])===-1)return!1;return!0}return!1}).sort((u,c)=>u.keyPath.length-c.keyPath.length)[0];if(n&&this.db._maxKey!==Ms){const u=n.keyPath.slice(0,r.length);return this.where(u).equals(u.map(c=>t[c]))}!n&&ei&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:a}=this.schema,i=this.db._deps.indexedDB;function s(u,c){try{return i.cmp(u,c)===0}catch{return!1}}const[o,l]=r.reduce(([u,c],h)=>{const p=a[h],v=t[h];return[u||p,u||!p?eo(c,p&&p.multi?E=>{const g=pi(E,h);return cn(g)&&g.some(w=>s(v,w))}:E=>s(v,pi(E,h))):c]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,cn(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const a=Object.create(t.prototype);for(var i in n)if(Qn(n,i))try{a[i]=n[i]}catch{}return a};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Tn(this,t)})}add(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let i=t;return a&&n&&(i=qf(a)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:r!=null?[r]:null,values:[i]})).then(s=>s.numFailures?tt.reject(s.failures[0]):s.lastResult).then(s=>{if(a)try{Ra(t,a,s)}catch{}return s})}update(t,r){if(typeof t!="object"||cn(t))return this.where(":id").equals(t).modify(r);{const n=pi(t,this.schema.primKey.keyPath);if(n===void 0)return Rr(new mt.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Nr(r).forEach(a=>{Ra(t,a,r[a])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let i=t;return a&&n&&(i=qf(a)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[i],keys:r!=null?[r]:null})).then(s=>s.numFailures?tt.reject(s.failures[0]):s.lastResult).then(s=>{if(a)try{Ra(t,a,s)}catch{}return s})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?tt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:S_})).then(t=>t.numFailures?tt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(a=>this.hook.reading.fire(a))))}bulkAdd(t,r,n){const a=Array.isArray(r)?r:void 0,i=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&a)throw new mt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new mt.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(qf(l)):t;return this.core.mutate({trans:s,type:"add",keys:a,values:c,wantResults:i}).then(({numFailures:h,results:p,lastResult:v,failures:E})=>{if(h===0)return i?p:v;throw new Fu(`${this.name}.bulkAdd(): ${h} of ${u} operations failed`,E)})})}bulkPut(t,r,n){const a=Array.isArray(r)?r:void 0,i=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&a)throw new mt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new mt.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(qf(l)):t;return this.core.mutate({trans:s,type:"put",keys:a,values:c,wantResults:i}).then(({numFailures:h,results:p,lastResult:v,failures:E})=>{if(h===0)return i?p:v;throw new Fu(`${this.name}.bulkPut(): ${h} of ${u} operations failed`,E)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:a,failures:i})=>{if(n===0)return a;throw new Fu(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,i)})}}function Ru(e){var t={},r=function(s,o){if(o){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return t[s].subscribe.apply(null,u),e}if(typeof s=="string")return t[s]};r.addEventType=i;for(var n=1,a=arguments.length;n<a;++n)i(arguments[n]);return r;function i(s,o,l){if(typeof s!="object"){var u;o||(o=wD),l||(l=er);var c={subscribers:[],fire:l,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=o(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(p){return p!==h}),c.fire=c.subscribers.reduce(o,l)}};return t[s]=r[s]=c,c}Nr(u=s).forEach(function(h){var p=u[h];if(cn(p))i(h,u[h][0],u[h][1]);else{if(p!=="asap")throw new mt.InvalidArgument("Invalid event config");var v=i(h,fc,function(){for(var E=arguments.length,g=new Array(E);E--;)g[E]=arguments[E];v.subscribers.forEach(function(w){i_(function(){w.apply(null,g)})})})}})}}function au(e,t){return al(t).from({prototype:e}),t}function To(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function cp(e,t){e.filter=eo(e.filter,t)}function fp(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>eo(n(),t()):t,e.justLimit=r&&!n}function N0(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new mt.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function A2(e,t,r){const n=N0(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function Wf(e,t,r,n){const a=e.replayFilter?eo(e.filter,e.replayFilter()):e.filter;if(e.or){const i={},s=(o,l,u)=>{if(!a||a(l,u,p=>l.stop(p),p=>l.fail(p))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),Qn(i,h)||(i[h]=!0,t(o,l,u))}};return Promise.all([e.or._iterate(s,r),N2(A2(e,n,r),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return N2(A2(e,n,r),eo(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function N2(e,t,r,n){var a=cr(n?(i,s,o)=>r(n(i),s,o):r);return e.then(i=>{if(i)return i.start(()=>{var s=()=>i.continue();t&&!t(i,o=>s=o,o=>{i.stop(o),s=er},o=>{i.fail(o),s=er})||a(i.value,i,o=>s=o),s()})})}function bn(e,t){try{const r=D2(e),n=D2(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(a,i){const s=a.length,o=i.length,l=s<o?s:o;for(let u=0;u<l;++u)if(a[u]!==i[u])return a[u]<i[u]?-1:1;return s===o?0:s<o?-1:1}(C2(e),C2(t));case"Array":return function(a,i){const s=a.length,o=i.length,l=s<o?s:o;for(let u=0;u<l;++u){const c=bn(a[u],i[u]);if(c!==0)return c}return s===o?0:s<o?-1:1}(e,t)}}catch{}return NaN}function D2(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=Jm(e);return r==="ArrayBuffer"?"binary":r}function C2(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class kD{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Rr.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Rr.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=eo(r.algorithm,t)}_iterate(t,r){return Wf(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Tn(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>Wf(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,a=n.table.core;if(To(n,!0))return a.count({trans:r,query:{index:N0(n,a.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var i=0;return Wf(n,()=>(++i,!1),r,a).then(()=>i)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),a=n[0],i=n.length-1;function s(u,c){return c?s(u[n[c]],c-1):u[a]}var o=this._ctx.dir==="next"?1:-1;function l(u,c){var h=s(u,i),p=s(c,i);return h<p?-o:h>p?o:0}return this.toArray(function(u){return u.sort(l)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&To(n,!0)&&n.limit>0){const{valueMapper:a}=n,i=N0(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(({result:s})=>a?s.map(a):s)}{const a=[];return Wf(n,i=>a.push(i),r,n.table.core).then(()=>a)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,To(r)?fp(r,()=>{var n=t;return(a,i)=>n===0||(n===1?(--n,!1):(i(()=>{a.advance(n),n=0}),!1))}):fp(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),fp(this._ctx,()=>{var r=t;return function(n,a,i){return--r<=0&&a(i),r>=0}},!0),this}until(t,r){return cp(this._ctx,function(n,a,i){return!t(n.value)||(a(i),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return cp(this._ctx,function(a){return t(a.value)}),r=this._ctx,n=t,r.isMatch=eo(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.key,a)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.primaryKey,a)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,i){n.push(i.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&To(r,!0)&&r.limit>0)return this._read(a=>{var i=N0(r,r.table.core.schema);return r.table.core.query({trans:a,values:!1,limit:r.limit,query:{index:i,range:r.range}})}).then(({result:a})=>a).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,i){n.push(i.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return cp(this._ctx,function(a){var i=a.primaryKey.toString(),s=Qn(n,i);return n[i]=!0,!s}),this}modify(t){var r=this._ctx;return this._write(n=>{var a;if(typeof t=="function")a=t;else{var i=Nr(t),s=i.length;a=function(g){for(var w=!1,x=0;x<s;++x){var y=i[x],b=t[y];pi(g,y)!==b&&(Ra(g,y,b),w=!0)}return w}}const o=r.table.core,{outbound:l,extractKey:u}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[];let p=0;const v=[],E=(g,w)=>{const{failures:x,numFailures:y}=w;p+=g-y;for(let b of Nr(x))h.push(x[b])};return this.clone().primaryKeys().then(g=>{const w=x=>{const y=Math.min(c,g.length-x);return o.getMany({trans:n,keys:g.slice(x,x+y),cache:"immutable"}).then(b=>{const _=[],N=[],k=l?[]:null,T=[];for(let S=0;S<y;++S){const P=b[S],F={value:Hc(P),primKey:g[x+S]};a.call(F,F.value,F)!==!1&&(F.value==null?T.push(g[x+S]):l||bn(u(P),u(F.value))===0?(N.push(F.value),l&&k.push(g[x+S])):(T.push(g[x+S]),_.push(F.value)))}const A=To(r)&&r.limit===1/0&&(typeof t!="function"||t===dp)&&{index:r.index,range:r.range};return Promise.resolve(_.length>0&&o.mutate({trans:n,type:"add",values:_}).then(S=>{for(let P in S.failures)T.splice(parseInt(P),1);E(_.length,S)})).then(()=>(N.length>0||A&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:k,values:N,criteria:A,changeSpec:typeof t!="function"&&t}).then(S=>E(N.length,S))).then(()=>(T.length>0||A&&t===dp)&&o.mutate({trans:n,type:"delete",keys:T,criteria:A}).then(S=>E(T.length,S))).then(()=>g.length>x+y&&w(x+c))})};return w(0).then(()=>{if(h.length>0)throw new nd("Error modifying one or more objects",h,p,v);return g.length})})})}delete(){var t=this._ctx,r=t.range;return To(t)&&(t.isPrimKey&&!DD||r.type===3)?this._write(n=>{const{primaryKey:a}=t.table.core.schema,i=r;return t.table.core.count({trans:n,query:{index:a,range:i}}).then(s=>t.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:o,lastResult:l,results:u,numFailures:c})=>{if(c)throw new nd("Could not delete some values",Object.keys(o).map(h=>o[h]),s-c);return s-c}))}):this.modify(dp)}}const dp=(e,t)=>t.value=null;function OD(e,t){return e<t?-1:e===t?0:1}function FD(e,t){return e>t?-1:e===t?0:1}function Wn(e,t,r){var n=e instanceof N_?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function So(e){return new e.Collection(e,()=>A_("")).limit(0)}function PD(e,t,r,n,a,i){for(var s=Math.min(e.length,n.length),o=-1,l=0;l<s;++l){var u=t[l];if(u!==n[l])return a(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):a(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;a(e[l],u)<0&&(o=l)}return s<n.length&&i==="next"?e+r.substr(e.length):s<e.length&&i==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function $f(e,t,r,n){var a,i,s,o,l,u,c,h=r.length;if(!r.every(g=>typeof g=="string"))return Wn(e,__);function p(g){a=function(x){return x==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(g),i=function(x){return x==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(g),s=g==="next"?OD:FD;var w=r.map(function(x){return{lower:i(x),upper:a(x)}}).sort(function(x,y){return s(x.lower,y.lower)});o=w.map(function(x){return x.upper}),l=w.map(function(x){return x.lower}),u=g,c=g==="next"?"":n}p("next");var v=new e.Collection(e,()=>Ii(o[0],l[h-1]+n));v._ondirectionchange=function(g){p(g)};var E=0;return v._addAlgorithm(function(g,w,x){var y=g.key;if(typeof y!="string")return!1;var b=i(y);if(t(b,l,E))return!0;for(var _=null,N=E;N<h;++N){var k=PD(y,b,o[N],l[N],s,u);k===null&&_===null?E=N+1:(_===null||s(_,k)>0)&&(_=k)}return w(_!==null?function(){g.continue(_+c)}:x),!1}),v}function Ii(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function A_(e){return{type:1,lower:e,upper:e}}class N_{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,a){n=n!==!1,a=a===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||a)&&(!n||!a)?So(this):new this.Collection(this,()=>Ii(t,r,!n,!a))}catch{return Wn(this,ai)}}equals(t){return t==null?Wn(this,ai):new this.Collection(this,()=>A_(t))}above(t){return t==null?Wn(this,ai):new this.Collection(this,()=>Ii(t,void 0,!0))}aboveOrEqual(t){return t==null?Wn(this,ai):new this.Collection(this,()=>Ii(t,void 0,!1))}below(t){return t==null?Wn(this,ai):new this.Collection(this,()=>Ii(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Wn(this,ai):new this.Collection(this,()=>Ii(void 0,t))}startsWith(t){return typeof t!="string"?Wn(this,__):this.between(t,t+Ms,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):$f(this,(r,n)=>r.indexOf(n[0])===0,[t],Ms)}equalsIgnoreCase(t){return $f(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=li.apply(Io,arguments);return t.length===0?So(this):$f(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=li.apply(Io,arguments);return t.length===0?So(this):$f(this,(r,n)=>n.some(a=>r.indexOf(a)===0),t,Ms)}anyOf(){const t=li.apply(Io,arguments);let r=this._cmp;try{t.sort(r)}catch{return Wn(this,ai)}if(t.length===0)return So(this);const n=new this.Collection(this,()=>Ii(t[0],t[t.length-1]));n._ondirectionchange=i=>{r=i==="next"?this._ascending:this._descending,t.sort(r)};let a=0;return n._addAlgorithm((i,s,o)=>{const l=i.key;for(;r(l,t[a])>0;)if(++a,a===t.length)return s(o),!1;return r(l,t[a])===0||(s(()=>{i.continue(t[a])}),!1)}),n}notEqual(t){return this.inAnyRange([[fg,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=li.apply(Io,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Wn(this,ai)}const r=t.reduce((n,a)=>n?n.concat([[n[n.length-1][1],a]]):[[fg,a]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,a=this._ascending,i=this._descending,s=this._min,o=this._max;if(t.length===0)return So(this);if(!t.every(y=>y[0]!==void 0&&y[1]!==void 0&&a(y[0],y[1])<=0))return Wn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",mt.InvalidArgument);const l=!r||r.includeLowers!==!1,u=r&&r.includeUppers===!0;let c,h=a;function p(y,b){return h(y[0],b[0])}try{c=t.reduce(function(y,b){let _=0,N=y.length;for(;_<N;++_){const k=y[_];if(n(b[0],k[1])<0&&n(b[1],k[0])>0){k[0]=s(k[0],b[0]),k[1]=o(k[1],b[1]);break}}return _===N&&y.push(b),y},[]),c.sort(p)}catch{return Wn(this,ai)}let v=0;const E=u?y=>a(y,c[v][1])>0:y=>a(y,c[v][1])>=0,g=l?y=>i(y,c[v][0])>0:y=>i(y,c[v][0])>=0;let w=E;const x=new this.Collection(this,()=>Ii(c[0][0],c[c.length-1][1],!l,!u));return x._ondirectionchange=y=>{y==="next"?(w=E,h=a):(w=g,h=i),c.sort(p)},x._addAlgorithm((y,b,_)=>{for(var N=y.key;w(N);)if(++v,v===c.length)return b(_),!1;return!!function(k){return!E(k)&&!g(k)}(N)||(this._cmp(N,c[v][1])===0||this._cmp(N,c[v][0])===0||b(()=>{h===a?y.continue(c[v][0]):y.continue(c[v][1])}),!1)}),x}startsWithAnyOf(){const t=li.apply(Io,arguments);return t.every(r=>typeof r=="string")?t.length===0?So(this):this.inAnyRange(t.map(r=>[r,r+Ms])):Wn(this,"startsWithAnyOf() only works with strings")}}function Ha(e){return cr(function(t){return hc(t),e(t.target.error),!1})}function hc(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const pc="storagemutated",Ui="x-storagemutated-1",ss=Ru(null,pc);class ID{_lock(){return xu(!ot.global),++this._reculock,this._reculock!==1||ot.global||(ot.lockOwnerFor=this),this}_unlock(){if(xu(!ot.global),--this._reculock==0)for(ot.global||(ot.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Pl(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&ot.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(xu(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new mt.DatabaseClosed(n);case"MissingAPIError":throw new mt.MissingAPI(n.message,n);default:throw new mt.OpenFailed(n)}if(!this.active)throw new mt.TransactionInactive;return xu(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=cr(a=>{hc(a),this._reject(t.error)}),t.onabort=cr(a=>{hc(a),this.active&&this._reject(new mt.Abort(t.error)),this.active=!1,this.on("abort").fire(a)}),t.oncomplete=cr(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&ss.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Rr(new mt.ReadOnly("Transaction is readonly"));if(!this.active)return Rr(new mt.TransactionInactive);if(this._locked())return new tt((i,s)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(i,s)},ot])});if(n)return as(()=>{var i=new tt((s,o)=>{this._lock();const l=r(s,o,this);l&&l.then&&l.then(s,o)});return i.finally(()=>this._unlock()),i._lib=!0,i});var a=new tt((i,s)=>{var o=r(i,s,this);o&&o.then&&o.then(i,s)});return a._lib=!0,a}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=tt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var a=r.idbtrans.objectStore(r.storeNames[0]);(function s(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(a.get(-1/0).onsuccess=s)})()}var i=r._waitingFor;return new tt((s,o)=>{n.then(l=>r._waitingQueue.push(cr(s.bind(null,l))),l=>r._waitingQueue.push(cr(o.bind(null,l)))).finally(()=>{r._waitingFor===i&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new mt.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Qn(r,t))return r[t];const n=this.schema[t];if(!n)throw new mt.NotFound("Table "+t+" not part of transaction");const a=new this.db.Table(t,n,this);return a.core=this.db.core.table(t),r[t]=a,a}}function dg(e,t,r,n,a,i,s){return{name:e,keyPath:t,unique:r,multi:n,auto:a,compound:i,src:(r&&!s?"&":"")+(n?"*":"")+(a?"++":"")+D_(t)}}function D_(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function C_(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:s_(r,n=>[n.name,n])}}let mc=e=>{try{return e.only([[]]),mc=()=>[[]],[[]]}catch{return mc=()=>Ms,Ms}};function hg(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>pi(n,t)}(e):t=>pi(t,e)}function k2(e){return[].slice.call(e)}let RD=0;function ju(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function jD(e,t,r){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:h,upperOpen:p}=l;return u===void 0?c===void 0?null:t.upperBound(c,!!p):c===void 0?t.lowerBound(u,!!h):t.bound(u,c,!!h,!!p)}const{schema:a,hasGetAll:i}=function(l,u){const c=k2(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(h=>u.objectStore(h)).map(h=>{const{keyPath:p,autoIncrement:v}=h,E=cn(p),g=p==null,w={},x={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:E,keyPath:p,autoIncrement:v,unique:!0,extractKey:hg(p)},indexes:k2(h.indexNames).map(y=>h.index(y)).map(y=>{const{name:b,unique:_,multiEntry:N,keyPath:k}=y,T={name:b,compound:cn(k),keyPath:k,unique:_,multiEntry:N,extractKey:hg(k)};return w[ju(k)]=T,T}),getIndexByKeyPath:y=>w[ju(y)]};return w[":id"]=x.primaryKey,p!=null&&(w[ju(p)]=x.primaryKey),x})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=a.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:h,type:p,keys:v,values:E,range:g}){return new Promise((w,x)=>{w=cr(w);const y=h.objectStore(c),b=y.keyPath==null,_=p==="put"||p==="add";if(!_&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:N}=v||E||{length:1};if(v&&E&&v.length!==E.length)throw new Error("Given keys array must have same length as given values array.");if(N===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let k;const T=[],A=[];let S=0;const P=U=>{++S,hc(U)};if(p==="deleteRange"){if(g.type===4)return w({numFailures:S,failures:A,results:[],lastResult:void 0});g.type===3?T.push(k=y.clear()):T.push(k=y.delete(n(g)))}else{const[U,re]=_?b?[E,v]:[E,null]:[v,null];if(_)for(let le=0;le<N;++le)T.push(k=re&&re[le]!==void 0?y[p](U[le],re[le]):y[p](U[le])),k.onerror=P;else for(let le=0;le<N;++le)T.push(k=y[p](U[le])),k.onerror=P}const F=U=>{const re=U.target.result;T.forEach((le,pe)=>le.error!=null&&(A[pe]=le.error)),w({numFailures:S,failures:A,results:p==="delete"?v:T.map(le=>le.result),lastResult:re})};k.onerror=U=>{P(U),F(U)},k.onsuccess=F})},getMany:({trans:h,keys:p})=>new Promise((v,E)=>{v=cr(v);const g=h.objectStore(c),w=p.length,x=new Array(w);let y,b=0,_=0;const N=T=>{const A=T.target;x[A._pos]=A.result,++_===b&&v(x)},k=Ha(E);for(let T=0;T<w;++T)p[T]!=null&&(y=g.get(p[T]),y._pos=T,y.onsuccess=N,y.onerror=k,++b);b===0&&v(x)}),get:({trans:h,key:p})=>new Promise((v,E)=>{v=cr(v);const g=h.objectStore(c).get(p);g.onsuccess=w=>v(w.target.result),g.onerror=Ha(E)}),query:function(h){return p=>new Promise((v,E)=>{v=cr(v);const{trans:g,values:w,limit:x,query:y}=p,b=x===1/0?void 0:x,{index:_,range:N}=y,k=g.objectStore(c),T=_.isPrimaryKey?k:k.index(_.name),A=n(N);if(x===0)return v({result:[]});if(h){const S=w?T.getAll(A,b):T.getAllKeys(A,b);S.onsuccess=P=>v({result:P.target.result}),S.onerror=Ha(E)}else{let S=0;const P=w||!("openKeyCursor"in T)?T.openCursor(A):T.openKeyCursor(A),F=[];P.onsuccess=U=>{const re=P.result;return re?(F.push(w?re.value:re.primaryKey),++S===x?v({result:F}):void re.continue()):v({result:F})},P.onerror=Ha(E)}})}(i),openCursor:function({trans:h,values:p,query:v,reverse:E,unique:g}){return new Promise((w,x)=>{w=cr(w);const{index:y,range:b}=v,_=h.objectStore(c),N=y.isPrimaryKey?_:_.index(y.name),k=E?g?"prevunique":"prev":g?"nextunique":"next",T=p||!("openKeyCursor"in N)?N.openCursor(n(b),k):N.openKeyCursor(n(b),k);T.onerror=Ha(x),T.onsuccess=cr(A=>{const S=T.result;if(!S)return void w(null);S.___id=++RD,S.done=!1;const P=S.continue.bind(S);let F=S.continuePrimaryKey;F&&(F=F.bind(S));const U=S.advance.bind(S),re=()=>{throw new Error("Cursor not stopped")};S.trans=h,S.stop=S.continue=S.continuePrimaryKey=S.advance=()=>{throw new Error("Cursor not started")},S.fail=cr(x),S.next=function(){let le=1;return this.start(()=>le--?this.continue():this.stop()).then(()=>this)},S.start=le=>{const pe=new Promise((Ee,fe)=>{Ee=cr(Ee),T.onerror=Ha(fe),S.fail=fe,S.stop=de=>{S.stop=S.continue=S.continuePrimaryKey=S.advance=re,Ee(de)}}),me=()=>{if(T.result)try{le()}catch(Ee){S.fail(Ee)}else S.done=!0,S.start=()=>{throw new Error("Cursor behind last entry")},S.stop()};return T.onsuccess=cr(Ee=>{T.onsuccess=me,me()}),S.continue=P,S.continuePrimaryKey=F,S.advance=U,me(),pe},w(S)},x)})},count({query:h,trans:p}){const{index:v,range:E}=h;return new Promise((g,w)=>{const x=p.objectStore(c),y=v.isPrimaryKey?x:x.index(v.name),b=n(E),_=b?y.count(b):y.count();_.onsuccess=cr(N=>g(N.target.result)),_.onerror=Ha(w)})}}}(l)),o={};return s.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:e.transaction.bind(e),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:mc(t),schema:a}}function pg({_novip:e},t){const r=t.db,n=function(a,i,{IDBKeyRange:s,indexedDB:o},l){return{dbcore:function(c,h){return h.reduce((p,{create:v})=>({...p,...v(p)}),c)}(jD(i,s,l),a.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(a=>{const i=a.name;e.core.schema.tables.some(s=>s.name===i)&&(a.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=a.core))})}function ld({_novip:e},t,r,n){r.forEach(a=>{const i=n[a];t.forEach(s=>{const o=j1(s,a);(!o||"value"in o&&o.value===void 0)&&(s===e.Transaction.prototype||s instanceof e.Transaction?hi(s,a,{get(){return this.table(a)},set(l){n_(this,a,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):s[a]=new e.Table(a,i))})})}function mg({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function MD(e,t){return e._cfg.version-t._cfg.version}function LD(e,t,r,n){const a=e._dbSchema,i=e._createTransaction("readwrite",e._storeNames,a);i.create(r),i._completion.catch(n);const s=i._reject.bind(i),o=ot.transless||ot;as(()=>{ot.trans=i,ot.transless=o,t===0?(Nr(a).forEach(l=>{hp(r,l,a[l].primKey,a[l].indexes)}),pg(e,r),tt.follow(()=>e.on.populate.fire(i)).catch(s)):function({_novip:l},u,c,h){const p=[],v=l._versions;let E=l._dbSchema=xg(l,l.idbdb,h),g=!1;const w=v.filter(y=>y._cfg.version>=u);function x(){return p.length?tt.resolve(p.shift()(c.idbtrans)).then(x):tt.resolve()}return w.forEach(y=>{p.push(()=>{const b=E,_=y._cfg.dbschema;vg(l,b,h),vg(l,_,h),E=l._dbSchema=_;const N=k_(b,_);N.add.forEach(T=>{hp(h,T[0],T[1].primKey,T[1].indexes)}),N.change.forEach(T=>{if(T.recreate)throw new mt.Upgrade("Not yet support for changing primary key");{const A=h.objectStore(T.name);T.add.forEach(S=>gg(A,S)),T.change.forEach(S=>{A.deleteIndex(S.name),gg(A,S)}),T.del.forEach(S=>A.deleteIndex(S))}});const k=y._cfg.contentUpgrade;if(k&&y._cfg.version>u){pg(l,h),c._memoizedTables={},g=!0;let T=o_(_);N.del.forEach(F=>{T[F]=b[F]}),mg(l,[l.Transaction.prototype]),ld(l,[l.Transaction.prototype],Nr(T),T),c.schema=T;const A=M1(k);let S;A&&Fl();const P=tt.follow(()=>{if(S=k(c),S&&A){var F=_i.bind(null,null);S.then(F,F)}});return S&&typeof S.then=="function"?tt.resolve(S):P.then(()=>S)}}),p.push(b=>{(!g||!ND)&&function(_,N){[].slice.call(N.db.objectStoreNames).forEach(k=>_[k]==null&&N.db.deleteObjectStore(k))}(y._cfg.dbschema,b),mg(l,[l.Transaction.prototype]),ld(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),x().then(()=>{var y,b;b=h,Nr(y=E).forEach(_=>{b.db.objectStoreNames.contains(_)||hp(b,_,y[_].primKey,y[_].indexes)})})}(e,t,i,r).catch(s)})}function k_(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const a=e[n],i=t[n];if(a){const s={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||a.primKey.auto!==i.primKey.auto&&!Kd)s.recreate=!0,r.change.push(s);else{const o=a.idxByName,l=i.idxByName;let u;for(u in o)l[u]||s.del.push(u);for(u in l){const c=o[u],h=l[u];c?c.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,i])}return r}function hp(e,t,r,n){const a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(i=>gg(a,i)),a}function gg(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function xg(e,t,r){const n={};return rd(t.objectStoreNames,0).forEach(a=>{const i=r.objectStore(a);let s=i.keyPath;const o=dg(D_(s),s||"",!1,!1,!!i.autoIncrement,s&&typeof s!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const h=i.index(i.indexNames[c]);s=h.keyPath;var u=dg(h.name,s,!!h.unique,!!h.multiEntry,!1,s&&typeof s!="string",!1);l.push(u)}n[a]=C_(a,o,l)}),n}function vg({_novip:e},t,r){const n=r.db.objectStoreNames;for(let a=0;a<n.length;++a){const i=n[a],s=r.objectStore(i);e._hasGetAll="getAll"in s;for(let o=0;o<s.indexNames.length;++o){const l=s.indexNames[o],u=s.index(l).keyPath,c=typeof u=="string"?u:"["+rd(u).join("+")+"]";if(t[i]){const h=t[i].idxByName[c];h&&(h.name=l,delete t[i].idxByName[c],t[i].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&sr.WorkerGlobalScope&&sr instanceof sr.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class BD{_parseStoresSpec(t,r){Nr(t).forEach(n=>{if(t[n]!==null){var a=t[n].split(",").map((s,o)=>{const l=(s=s.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return dg(l,u||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),cn(u),o===0)}),i=a.shift();if(i.multi)throw new mt.Schema("Primary key cannot be multi-valued");a.forEach(s=>{if(s.auto)throw new mt.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new mt.Schema("Index must have a name and cannot be an empty string")}),r[n]=C_(n,i,a)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Tn(this._cfg.storesSource,t):t;const n=r._versions,a={};let i={};return n.forEach(s=>{Tn(a,s._cfg.storesSource),i=s._cfg.dbschema={},s._parseStoresSpec(a,i)}),r._dbSchema=i,mg(r,[r._allTables,r,r.Transaction.prototype]),ld(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Nr(i),i),r._storeNames=Nr(i),this}upgrade(t){return this._cfg.contentUpgrade=U1(this._cfg.contentUpgrade||er,t),this}}function $1(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new $s(Zd,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function G1(e){return e&&typeof e.databases=="function"}function yg(e){return as(function(){return ot.letThrough=!0,e()})}function UD(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function zD(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Rr(t.dbOpenError):e);ei&&(t.openCanceller._stackHolder=fo()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function a(){if(t.openCanceller!==n)throw new mt.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,s=null,o=!1;const l=()=>new tt((u,c)=>{if(a(),!r)throw new mt.MissingAPI;const h=e.name,p=t.autoSchema?r.open(h):r.open(h,Math.round(10*e.verno));if(!p)throw new mt.MissingAPI;p.onerror=Ha(c),p.onblocked=cr(e._fireOnBlocked),p.onupgradeneeded=cr(v=>{if(s=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=hc,s.abort(),p.result.close();const g=r.deleteDatabase(h);g.onsuccess=g.onerror=cr(()=>{c(new mt.NoSuchDatabase(`Database ${h} doesnt exist`))})}else{s.onerror=Ha(c);var E=v.oldVersion>Math.pow(2,62)?0:v.oldVersion;o=E<1,e._novip.idbdb=p.result,LD(e,E/10,s,c)}},c),p.onsuccess=cr(()=>{s=null;const v=e._novip.idbdb=p.result,E=rd(v.objectStoreNames);if(E.length>0)try{const w=v.transaction((g=E).length===1?g[0]:g,"readonly");t.autoSchema?function({_novip:x},y,b){x.verno=y.version/10;const _=x._dbSchema=xg(0,y,b);x._storeNames=rd(y.objectStoreNames,0),ld(x,[x._allTables],Nr(_),_)}(e,v,w):(vg(e,e._dbSchema,w),function(x,y){const b=k_(xg(0,x.idbdb,y),x._dbSchema);return!(b.add.length||b.change.some(_=>_.add.length||_.change.length))}(e,w)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),pg(e,w)}catch{}var g;Iu.push(e),v.onversionchange=cr(w=>{t.vcFired=!0,e.on("versionchange").fire(w)}),v.onclose=cr(w=>{e.on("close").fire(w)}),o&&function({indexedDB:w,IDBKeyRange:x},y){!G1(w)&&y!==Zd&&$1(w,x).put({name:y}).catch(er)}(e._deps,h),u()},c)}).catch(u=>u&&u.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):tt.reject(u));return tt.race([n,(typeof navigator>"u"?tt.resolve():UD()).then(l)]).then(()=>(a(),t.onReadyBeingFired=[],tt.resolve(yg(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let c=t.onReadyBeingFired.reduce(U1,er);return t.onReadyBeingFired=[],tt.resolve(yg(()=>c(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{s&&s.abort()}catch{}return n===t.openCanceller&&e._close(),Rr(u)}).finally(()=>{t.openComplete=!0,i()})}function wg(e){var t=i=>e.next(i),r=a(t),n=a(i=>e.throw(i));function a(i){return s=>{var o=i(s),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(r,n):cn(l)?Promise.all(l).then(r,n):r(l)}}return a(t)()}function qD(e,t,r){var n=arguments.length;if(n<2)throw new mt.InvalidArgument("Too few arguments");for(var a=new Array(n-1);--n;)a[n-1]=arguments[n];return r=a.pop(),[e,l_(a),r]}function O_(e,t,r,n,a){return tt.resolve().then(()=>{const i=ot.transless||ot,s=e._createTransaction(t,r,e._dbSchema,n),o={trans:s,transless:i};if(n)s.idbtrans=n.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===B1.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>O_(e,t,r,null,a))):Rr(h)}const l=M1(a);let u;l&&Fl();const c=tt.follow(()=>{if(u=a.call(s,s),u)if(l){var h=_i.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=wg(u))},o);return(u&&typeof u.then=="function"?tt.resolve(u).then(h=>s.active?h:Rr(new mt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(h=>(n&&s._resolve(),s._completion.then(()=>h))).catch(h=>(s._reject(h),Rr(h)))})}function Gf(e,t,r){const n=cn(e)?e.slice():[e];for(let a=0;a<r;++a)n.push(t);return n}const WD={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,a={},i=[];function s(c,h,p){const v=ju(c),E=a[v]=a[v]||[],g=c==null?0:typeof c=="string"?1:c.length,w=h>0,x={...p,isVirtual:w,keyTail:h,keyLength:g,extractKey:hg(c),unique:!w&&p.unique};return E.push(x),x.isPrimaryKey||i.push(x),g>1&&s(g===2?c[0]:c.slice(0,g-1),h+1,p),E.sort((y,b)=>y.keyTail-b.keyTail),x}const o=s(n.primaryKey.keyPath,0,n.primaryKey);a[":id"]=[o];for(const c of n.indexes)s(c.keyPath,0,c);function l(c){const h=c.query.index;return h.isVirtual?{...c,query:{index:h,range:(p=c.query.range,v=h.keyTail,{type:p.type===1?2:p.type,lower:Gf(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,v),lowerOpen:!0,upper:Gf(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,v),upperOpen:!0})}}:c;var p,v}return{...r,schema:{...n,primaryKey:o,indexes:i,getIndexByKeyPath:function(c){const h=a[ju(c)];return h&&h[0]}},count:c=>r.count(l(c)),query:c=>r.query(l(c)),openCursor(c){const{keyTail:h,isVirtual:p,keyLength:v}=c.query.index;return p?r.openCursor(l(c)).then(E=>E&&function(g){return Object.create(g,{continue:{value:function(x){x!=null?g.continue(Gf(x,c.reverse?e.MAX_KEY:e.MIN_KEY,h)):c.unique?g.continue(g.key.slice(0,v).concat(c.reverse?e.MIN_KEY:e.MAX_KEY,h)):g.continue()}},continuePrimaryKey:{value(x,y){g.continuePrimaryKey(Gf(x,e.MAX_KEY,h),y)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const x=g.key;return v===1?x[0]:x.slice(0,v)}},value:{get:()=>g.value}})}(E)):r.openCursor(c)}}}}}};function H1(e,t,r,n){return r=r||{},n=n||"",Nr(e).forEach(a=>{if(Qn(t,a)){var i=e[a],s=t[a];if(typeof i=="object"&&typeof s=="object"&&i&&s){const o=Jm(i);o!==Jm(s)?r[n+a]=t[a]:o==="Object"?H1(i,s,r,n+a+"."):i!==s&&(r[n+a]=t[a])}else i!==s&&(r[n+a]=t[a])}else r[n+a]=void 0}),Nr(t).forEach(a=>{Qn(e,a)||(r[n+a]=t[a])}),r}const $D={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(i){const s=ot.trans,{deleting:o,creating:l,updating:u}=s.table(t).hook;switch(i.type){case"add":if(l.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===er&&u.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"delete":if(o.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"deleteRange":if(o.fire===er)break;return s._promise("readwrite",()=>function(p){return h(p.trans,p.range,1e4)}(i),!0)}return r.mutate(i);function c(p){const v=ot.trans,E=p.keys||function(g,w){return w.type==="delete"?w.keys:w.keys||w.values.map(g.extractKey)}(n,p);if(!E)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:E}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(g,w,x){return w.type==="add"?Promise.resolve([]):g.getMany({trans:w.trans,keys:x,cache:"immutable"})}(r,p,E).then(g=>{const w=E.map((x,y)=>{const b=g[y],_={onerror:null,onsuccess:null};if(p.type==="delete")o.fire.call(_,x,b,v);else if(p.type==="add"||b===void 0){const N=l.fire.call(_,x,p.values[y],v);x==null&&N!=null&&(x=N,p.keys[y]=x,n.outbound||Ra(p.values[y],n.keyPath,x))}else{const N=H1(b,p.values[y]),k=u.fire.call(_,N,x,b,v);if(k){const T=p.values[y];Object.keys(k).forEach(A=>{Qn(T,A)?T[A]=k[A]:Ra(T,A,k[A])})}}return _});return r.mutate(p).then(({failures:x,results:y,numFailures:b,lastResult:_})=>{for(let N=0;N<E.length;++N){const k=y?y[N]:E[N],T=w[N];k==null?T.onerror&&T.onerror(x[N]):T.onsuccess&&T.onsuccess(p.type==="put"&&g[N]?p.values[N]:k)}return{failures:x,results:y,numFailures:b,lastResult:_}}).catch(x=>(w.forEach(y=>y.onerror&&y.onerror(x)),Promise.reject(x)))})}function h(p,v,E){return r.query({trans:p,values:!1,query:{index:n,range:v},limit:E}).then(({result:g})=>c({type:"delete",keys:g,trans:p}).then(w=>w.numFailures>0?Promise.reject(w.failures[0]):g.length<E?{failures:[],numFailures:0,lastResult:void 0}:h(p,{...v,lower:g[g.length-1],lowerOpen:!0},E)))}}}}})};function F_(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let a=0,i=0;a<t.keys.length&&i<e.length;++a)bn(t.keys[a],e[i])===0&&(n.push(r?Hc(t.values[a]):t.values[a]),++i);return n.length===e.length?n:null}catch{return null}}const GD={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const a=F_(n.keys,n.trans._cache,n.cache==="clone");return a?tt.resolve(a):r.getMany(n).then(i=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Hc(i):i},i))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function V1(e){return!("from"in e)}const oi=function(e,t){if(!this){const r=new oi;return e&&"d"in e&&Tn(r,e),r}Tn(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function gc(e,t,r){const n=bn(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(V1(e))return Tn(e,{from:t,to:r,d:1});const a=e.l,i=e.r;if(bn(r,e.from)<0)return a?gc(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},O2(e);if(bn(t,e.to)>0)return i?gc(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},O2(e);bn(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),bn(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const s=!e.r;a&&!e.l&&ud(e,a),i&&s&&ud(e,i)}function ud(e,t){V1(t)||function r(n,{from:a,to:i,l:s,r:o}){gc(n,a,i),s&&r(n,s),o&&r(n,o)}(e,t)}function HD(e,t){const r=bg(t);let n=r.next();if(n.done)return!1;let a=n.value;const i=bg(e);let s=i.next(a.from),o=s.value;for(;!n.done&&!s.done;){if(bn(o.from,a.to)<=0&&bn(o.to,a.from)>=0)return!0;bn(a.from,o.from)<0?a=(n=r.next(o.from)).value:o=(s=i.next(a.from)).value}return!1}function bg(e){let t=V1(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&bn(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||bn(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function O2(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=n>1?"r":n<-1?"l":"";if(a){const i=a==="r"?"l":"r",s={...e},o=e[a];e.from=o.from,e.to=o.to,e[a]=o[a],s[a]=o[i],e[i]=s,s.d=F2(s)}e.d=F2(e)}function F2({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}bl(oi.prototype,{add(e){return ud(this,e),this},addKey(e){return gc(this,e,e),this},addKeys(e){return e.forEach(t=>gc(this,t,t)),this},[eg](){return bg(this)}});const VD={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new oi(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const a=e.table(n),{schema:i}=a,{primaryKey:s}=i,{extractKey:o,outbound:l}=s,u={...a,mutate:p=>{const v=p.trans,E=v.mutatedParts||(v.mutatedParts={}),g=k=>{const T=`idb://${t}/${n}/${k}`;return E[T]||(E[T]=new oi)},w=g(""),x=g(":dels"),{type:y}=p;let[b,_]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const N=p.trans._cache;return a.mutate(p).then(k=>{if(cn(b)){y!=="delete"&&(b=k.results),w.addKeys(b);const T=F_(b,N);T||y==="add"||x.addKeys(b),(T||_)&&function(A,S,P,F){function U(re){const le=A(re.name||"");function pe(Ee){return Ee!=null?re.extractKey(Ee):null}const me=Ee=>re.multiEntry&&cn(Ee)?Ee.forEach(fe=>le.addKey(fe)):le.addKey(Ee);(P||F).forEach((Ee,fe)=>{const de=P&&pe(P[fe]),Ce=F&&pe(F[fe]);bn(de,Ce)!==0&&(de!=null&&me(de),Ce!=null&&me(Ce))})}S.indexes.forEach(U)}(g,i,T,_)}else if(b){const T={from:b.lower,to:b.upper};x.add(T),w.add(T)}else w.add(r),x.add(r),i.indexes.forEach(T=>g(T.name).add(r));return k})}},c=({query:{index:p,range:v}})=>{var E,g;return[p,new oi((E=v.lower)!==null&&E!==void 0?E:e.MIN_KEY,(g=v.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},h={get:p=>[s,new oi(p.key)],getMany:p=>[s,new oi().addKeys(p.keys)],count:c,query:c,openCursor:c};return Nr(h).forEach(p=>{u[p]=function(v){const{subscr:E}=ot;if(E){const g=_=>{const N=`idb://${t}/${n}/${_}`;return E[N]||(E[N]=new oi)},w=g(""),x=g(":dels"),[y,b]=h[p](v);if(g(y.name||"").add(b),!y.isPrimaryKey){if(p!=="count"){const _=p==="query"&&l&&v.values&&a.query({...v,values:!1});return a[p].apply(this,arguments).then(N=>{if(p==="query"){if(l&&v.values)return _.then(({result:T})=>(w.addKeys(T),N));const k=v.values?N.result.map(o):N.result;v.values?w.addKeys(k):x.addKeys(k)}else if(p==="openCursor"){const k=N,T=v.values;return k&&Object.create(k,{key:{get:()=>(x.addKey(k.primaryKey),k.key)},primaryKey:{get(){const A=k.primaryKey;return x.addKey(A),A}},value:{get:()=>(T&&w.addKey(k.primaryKey),k.value)}})}return N})}x.add(r)}}return a[p].apply(this,arguments)}}),u}}}};class $s{constructor(t,r){this._middlewares={},this.verno=0;const n=$s.dependencies;this._options=r={addons:$s.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:a}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:er,dbReadyPromise:null,cancelOpen:er,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;i.dbReadyPromise=new tt(o=>{i.dbReadyResolve=o}),i.openCanceller=new tt((o,l)=>{i.cancelOpen=l}),this._state=i,this.name=t,this.on=Ru(this,"populate","blocked","versionchange","close",{ready:[U1,er]}),this.on.ready.subscribe=a_(this.on.ready.subscribe,o=>(l,u)=>{$s.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||tt.resolve().then(l),u&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&o(l);else{o(l);const h=this;u||o(function p(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(p)})}})}),this.Collection=(s=this,au(kD.prototype,function(o,l){this.db=s;let u=S_,c=null;if(l)try{u=l()}catch(E){c=E}const h=o._ctx,p=h.table,v=p.hook.reading.fire;this._ctx={table:p,index:h.index,isPrimKey:!h.index||p.schema.primKey.keyPath&&h.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:v!==fc?v:null}})),this.Table=function(o){return au(CD.prototype,function(l,u,c){this.db=o,this._tx=c,this.name=l,this.schema=u,this.hook=o._allTables[l]?o._allTables[l].hook:Ru(null,{creating:[xD,er],reading:[gD,fc],updating:[yD,er],deleting:[vD,er]})})}(this),this.Transaction=function(o){return au(ID.prototype,function(l,u,c,h,p){this.db=o,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=Ru(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new tt((v,E)=>{this._resolve=v,this._reject=E}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},v=>{var E=this.active;return this.active=!1,this.on.error.fire(v),this.parent?this.parent._reject(v):E&&this.idbtrans&&this.idbtrans.abort(),Rr(v)})})}(this),this.Version=function(o){return au(BD.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return au(N_.prototype,function(l,u,c){this.db=o,this._ctx={table:l,index:u===":id"?null:u,or:c};const h=o._deps.indexedDB;if(!h)throw new mt.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(p,v)=>h.cmp(v,p),this._max=(p,v)=>h.cmp(p,v)>0?p:v,this._min=(p,v)=>h.cmp(p,v)<0?p:v,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=mc(r.IDBKeyRange),this._createTransaction=(o,l,u,c)=>new this.Transaction(o,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=o=>{this.on("blocked").fire(o),Iu.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(WD),this.use($D),this.use(VD),this.use(GD),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new mt.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new mt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(a=>a._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(MD),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||ot.letThrough||this._vip)?t():new tt((r,n)=>{if(this._state.openComplete)return n(new mt.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new mt.DatabaseClosed);this.open().catch(er)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:a}){a&&this.unuse({stack:t,name:a});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:r,level:n??10,name:a}),i.sort((s,o)=>s.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(a=>n?a.create!==n:!!r&&a.name!==r)),this}open(){return zD(this)}_close(){const t=this._state,r=Iu.indexOf(this);if(r>=0&&Iu.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new tt(n=>{t.dbReadyResolve=n}),t.openCanceller=new tt((n,a)=>{t.cancelOpen=a})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new mt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new tt((n,a)=>{const i=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=cr(()=>{(function({indexedDB:o,IDBKeyRange:l},u){!G1(o)&&u!==Zd&&$1(o,l).delete(u).catch(er)})(this._deps,this.name),n()}),s.onerror=Ha(a),s.onblocked=this._fireOnBlocked};if(t)throw new mt.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Nr(this._allTables).map(t=>this._allTables[t])}transaction(){const t=qD.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let a=ot.trans;a&&a.db===this&&t.indexOf("!")===-1||(a=null);const i=t.indexOf("?")!==-1;let s,o;t=t.replace("!","").replace("?","");try{if(o=r.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),t=="r"||t===lp)s=lp;else{if(t!="rw"&&t!=up)throw new mt.InvalidArgument("Invalid transaction mode: "+t);s=up}if(a){if(a.mode===lp&&s===up){if(!i)throw new mt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&o.forEach(u=>{if(a&&a.storeNames.indexOf(u)===-1){if(!i)throw new mt.SubTransaction("Table "+u+" not included in parent transaction.");a=null}}),i&&a&&!a.active&&(a=null)}}catch(u){return a?a._promise(null,(c,h)=>{h(u)}):Rr(u)}const l=O_.bind(null,this,s,o,a,n);return a?a._promise(s,l,"lock"):ot.trans?Pl(ot.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!Qn(this._allTables,t))throw new mt.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const YD=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class XD{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[YD](){return this}}function P_(e,t){return Nr(t).forEach(r=>{ud(e[r]||(e[r]=new oi),t[r])}),e}function I_(e){let t,r=!1;const n=new XD(a=>{const i=M1(e);let s=!1,o={},l={};const u={get closed(){return s},unsubscribe:()=>{s=!0,ss.storagemutated.unsubscribe(v)}};a.start&&a.start(u);let c=!1,h=!1;function p(){return Nr(l).some(g=>o[g]&&HD(o[g],l[g]))}const v=g=>{P_(o,g),p()&&E()},E=()=>{if(c||s)return;o={};const g={},w=function(x){i&&Fl();const y=()=>as(e,{subscr:x,trans:null}),b=ot.trans?Pl(ot.transless,y):y();return i&&b.then(_i,_i),b}(g);h||(ss(pc,v),h=!0),c=!0,Promise.resolve(w).then(x=>{r=!0,t=x,c=!1,s||(p()?E():(o={},l=g,a.next&&a.next(x)))},x=>{c=!1,r=!1,a.error&&a.error(x),u.unsubscribe()})};return E(),u});return n.hasValue=()=>r,n.getValue=()=>t,n}let Eg;try{Eg={indexedDB:sr.indexedDB||sr.mozIndexedDB||sr.webkitIndexedDB||sr.msIndexedDB,IDBKeyRange:sr.IDBKeyRange||sr.webkitIDBKeyRange}}catch{Eg={indexedDB:null,IDBKeyRange:null}}const As=$s;function D0(e){let t=fi;try{fi=!0,ss.storagemutated.fire(e)}finally{fi=t}}bl(As,{...E0,delete:e=>new As(e,{addons:[]}).delete(),exists:e=>new As(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return G1(t)?Promise.resolve(t.databases()).then(n=>n.map(a=>a.name).filter(a=>a!==Zd)):$1(t,r).toCollection().primaryKeys()}(As.dependencies).then(e)}catch{return Rr(new mt.MissingAPI)}},defineClass:()=>function(e){Tn(this,e)},ignoreTransaction:e=>ot.trans?Pl(ot.transless,e):e(),vip:yg,async:function(e){return function(){try{var t=wg(e.apply(this,arguments));return t&&typeof t.then=="function"?t:tt.resolve(t)}catch(r){return Rr(r)}}},spawn:function(e,t,r){try{var n=wg(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:tt.resolve(n)}catch(a){return Rr(a)}},currentTransaction:{get:()=>ot.trans||null},waitFor:function(e,t){const r=tt.resolve(typeof e=="function"?As.ignoreTransaction(e):e).timeout(t||6e4);return ot.trans?ot.trans.waitFor(r):r},Promise:tt,debug:{get:()=>ei,set:e=>{c_(e,e==="dexie"?()=>!0:T_)}},derive:al,extend:Tn,props:bl,override:a_,Events:Ru,on:ss,liveQuery:I_,extendObservabilitySet:P_,getByKeyPath:pi,setByKeyPath:Ra,delByKeyPath:function(e,t){typeof t=="string"?Ra(e,t,void 0):"length"in t&&[].map.call(t,function(r){Ra(e,r,void 0)})},shallowClone:o_,deepClone:Hc,getObjectDiff:H1,cmp:bn,asap:i_,minKey:fg,addons:[],connections:Iu,errnames:B1,dependencies:Eg,semVer:S2,version:S2.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),As.maxKey=mc(As.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ss(pc,e=>{if(!fi){let t;Kd?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Ui,!0,!0,e)):t=new CustomEvent(Ui,{detail:e}),fi=!0,dispatchEvent(t),fi=!1}}),addEventListener(Ui,({detail:e})=>{fi||D0(e)}));let fi=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Ui);typeof e.unref=="function"&&e.unref(),ss(pc,t=>{fi||e.postMessage(t)}),e.onmessage=t=>{t.data&&D0(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){ss(pc,t=>{try{fi||(typeof localStorage<"u"&&localStorage.setItem(Ui,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Ui,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Ui){const r=JSON.parse(t.newValue);r&&D0(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Ui&&D0(t.changedParts)})}tt.rejectionMapper=function(e,t){if(!e||e instanceof il||e instanceof TypeError||e instanceof SyntaxError||!e.name||!b2[e.name])return e;var r=new b2[e.name](t||e.message,e);return"stack"in e&&hi(r,"stack",{get:function(){return this.inner.stack}}),r},c_(ei,T_);function KD(e,t,r){var n,a;typeof e=="function"?(n=t||[],a=r):(n=[],a=t);var i=Fs.useRef({hasResult:!1,result:a,error:null}),s=Fs.useReducer(function(u){return u+1},0);s[0];var o=s[1],l=Fs.useMemo(function(){var u=typeof e=="function"?e():e;if(!u||typeof u.subscribe!="function")throw e===u?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!i.current.hasResult&&typeof window<"u"&&(typeof u.hasValue!="function"||u.hasValue()))if(typeof u.getValue=="function")i.current.result=u.getValue(),i.current.hasResult=!0;else{var c=u.subscribe(function(h){i.current.result=h,i.current.hasResult=!0});typeof c=="function"?c():c.unsubscribe()}return u},n);if(Fs.useDebugValue(i.current.result),Fs.useEffect(function(){var u=l.subscribe(function(c){var h=i.current;(h.error!==null||h.result!==c)&&(h.error=null,h.result=c,h.hasResult=!0,o())},function(c){var h=i.current;h.error!==c&&(h.error=c,o())});return typeof u=="function"?u:u.unsubscribe.bind(u)},n),i.current.error)throw i.current.error;return i.current.result}function Qr(e,t,r){return KD(function(){return I_(e)},t||[],r)}let Hf;const ZD=new Uint8Array(16);function QD(){if(!Hf&&(Hf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Hf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hf(ZD)}const Vr=[];for(let e=0;e<256;++e)Vr.push((e+256).toString(16).slice(1));function JD(e,t=0){return Vr[e[t+0]]+Vr[e[t+1]]+Vr[e[t+2]]+Vr[e[t+3]]+"-"+Vr[e[t+4]]+Vr[e[t+5]]+"-"+Vr[e[t+6]]+Vr[e[t+7]]+"-"+Vr[e[t+8]]+Vr[e[t+9]]+"-"+Vr[e[t+10]]+Vr[e[t+11]]+Vr[e[t+12]]+Vr[e[t+13]]+Vr[e[t+14]]+Vr[e[t+15]]}const eC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),P2={randomUUID:eC};function R_(e,t,r){if(P2.randomUUID&&!e)return P2.randomUUID();e=e||{};const n=e.random||(e.rng||QD)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,JD(n)}class tC extends $s{constructor(){super("CourseManagementDB");Eo(this,"groups");Eo(this,"participants");Eo(this,"settings");Eo(this,"yearlyArchives");this.version(1).stores({groups:"id, groupNumber, courseStartDate",participants:"id, groupNumber, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}),this.version(2).stores({groups:"id, groupNumber, courseStartDate",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>r.table("participants").toCollection().modify(n=>{n.autoGroup=n.groupNumber,n.manualGroup=null})),this.version(3).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>{const n=new Date().toISOString();return r.table("groups").toCollection().modify(a=>{a.status=a.groupNumber===1?"active":"planned",a.createdAt=n,a.updatedAt=n})}),this.version(4).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>{const n=new Date().toISOString();r.table("participants").toCollection().modify(a=>{a.createdAt=a.createdAt||n,a.updatedAt=a.updatedAt||n,(a.completedComputed||a.completedOverride===!0)&&(a.completedAt=a.completedAt||n)}),r.table("groups").toCollection().modify(a=>{a.isLocked=a.status==="completed"})}),this.version(5).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id",yearlyArchives:"id, year"}),this.version(6).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate, egn",settings:"id",yearlyArchives:"id, year"}).upgrade(r=>r.table("participants").toCollection().modify(n=>{n.egn=n.egn||"",n.birthPlace=n.birthPlace||"",n.citizenship=n.citizenship||""})),this.version(7).stores({groups:"id, courseStartDate, status, groupNumber",participants:"id, courseStartDate, uniqueNumber, companyName, personName, egn",settings:"id",yearlyArchives:"id, year"}).upgrade(async r=>{await r.table("participants").toCollection().modify(n=>{delete n.groupNumber,delete n.autoGroup,delete n.manualGroup}),await r.table("groups").toCollection().modify(n=>{n.status==="planned"&&(n.groupNumber=null)})})}}const Se=new tC;async function rC(){try{if(await Se.settings.count()===0)await Se.settings.add({id:1,lastUniquePrefix:3533,lastUniqueSeq:0,lastResetYear:null});else{const t=await Se.settings.get(1);t&&t.lastUniquePrefix<=3531&&(await Se.settings.update(1,{lastUniquePrefix:3533,lastUniqueSeq:0}),console.log(" Updated unique number prefix to 3533 for 2026"))}}catch(e){console.error("Failed to initialize settings:",e)}}rC().catch(e=>{console.error("CRITICAL DB INIT FAILURE:",e)});function j_(e){const t=new Date(e),r=t.getDay();if(r===1)return t;const n=r===0?1:8-r;return t.setDate(t.getDate()+n),t}function cd(e){const t=new Date(e),r=j_(t),n=new Date(r);return n.setDate(n.getDate()+7),{courseStartDate:r.toISOString().split("T")[0],courseEndDate:n.toISOString().split("T")[0]}}const nC=Object.freeze(Object.defineProperty({__proto__:null,computeCourseDates:cd,nextMonday:j_},Symbol.toStringTag,{value:"Module"}));function Wi(e,t){return`${e.toString().padStart(4,"0")}-${t}`}function to(e){const t=e.match(/^(\d{4})-(\d+)$/);return t?{prefix:parseInt(t[1],10),seq:parseInt(t[2],10)}:null}async function Xc(e=!1){const t=await Se.participants.toArray();let r=null;for(const n of t){if(!n.uniqueNumber)continue;const a=to(n.uniqueNumber);a&&(r?(a.prefix>r.prefix||a.prefix===r.prefix&&a.seq>r.seq)&&(r=a):r=a)}if(!e){const n=await Se.settings.get(1);if(n){const a={prefix:n.lastUniquePrefix,seq:n.lastUniqueSeq};r?(a.prefix>r.prefix||a.prefix===r.prefix&&a.seq>r.seq)&&(r=a):r=a}}return r}async function xc(){const e=await Se.settings.get(1);if(!e)throw new Error("Settings not initialized");let t=e.lastUniquePrefix,r=e.lastUniqueSeq;const n=await Xc();n&&(n.prefix>t?(t=n.prefix,r=n.seq):n.prefix===t&&n.seq>r&&(r=n.seq));const a=t+1,i=r+1;return Wi(a,i)}async function aC(e){const t=await Se.groups.get(e);if(!t)return;if(t.status!=="active"){console.warn(`Attempted to assign numbers to non-active group ${e}`);return}const n=(await Se.participants.where("courseStartDate").equals(t.courseStartDate).toArray()).filter(u=>!u.uniqueNumber);if(n.length===0)return;n.sort((u,c)=>{const h=new Date(u.createdAt||0).getTime(),p=new Date(c.createdAt||0).getTime();return h!==p?h-p:(u.id||"").localeCompare(c.id||"")});const a=await Se.settings.get(1);if(!a)throw new Error("Settings not initialized");let i=a.lastUniquePrefix,s=a.lastUniqueSeq;const o=await Xc();o&&(o.prefix>i?(i=o.prefix,s=o.seq):o.prefix===i&&o.seq>s&&(s=o.seq));const l=[];for(const u of n){i++,s++;const c=Wi(i,s);l.push({id:u.id,uniqueNumber:c})}for(const u of l)await Se.participants.update(u.id,{uniqueNumber:u.uniqueNumber});await Se.settings.update(1,{lastUniquePrefix:i,lastUniqueSeq:s})}async function M_(){const e=await Se.settings.get(1);if(!e)return;const t=e.lastUniquePrefix+1;await Se.settings.update(1,{lastUniquePrefix:t,lastUniqueSeq:0,lastResetYear:new Date().getFullYear()})}async function iC(e){const t=to(e);if(!t)return;const{prefix:r}=t,n=await Se.participants.filter(s=>!!s.uniqueNumber).toArray(),a=[];for(const s of n){const o=to(s.uniqueNumber);if(o&&o.prefix>r){const l=o.prefix-1,u=o.seq-1,c=Wi(l,u);a.push({id:s.id,newNum:c,newPrefix:l,newSeq:u})}}for(const s of a)await Se.participants.update(s.id,{uniqueNumber:s.newNum});const i=await Xc();i&&await Se.settings.update(1,{lastUniquePrefix:i.prefix,lastUniqueSeq:i.seq})}async function vc(e,t){const n=await Se.participants.where("uniqueNumber").equals(e).toArray();return t?n.length===0||n.length===1&&n[0].id===t:n.length===0}async function _g(){const t=(await Se.participants.toArray()).filter(n=>n.uniqueNumber).map(n=>to(n.uniqueNumber)).filter(n=>n!==null).sort((n,a)=>n.prefix!==a.prefix?n.prefix-a.prefix:n.seq-a.seq);if(console.log("[checkForGaps] Numbers in DB:",t.map(n=>Wi(n.prefix,n.seq))),t.length===0)return null;for(let n=0;n<t.length-1;n++){const a=t[n];if(t[n+1].prefix!==a.prefix+1){const s=Wi(a.prefix+1,a.seq+1);return console.log("[checkForGaps] Gap found between numbers:",s),s}}const r=await Se.settings.get(1);if(console.log("[checkForGaps] Settings:",r?`${r.lastUniquePrefix}-${r.lastUniqueSeq}`:"none"),r&&t.length>0){const n=t[t.length-1];if(console.log("[checkForGaps] Last in DB:",Wi(n.prefix,n.seq)),r.lastUniquePrefix>n.prefix){const a=Wi(n.prefix+1,n.seq+1);return console.log("[checkForGaps] Gap found after last number:",a),a}}return console.log("[checkForGaps] No gaps found"),null}function L_(e){return/^\d{4}-\d+$/.test(e)}async function sC(e){const t=await Se.participants.where("courseStartDate").equals(e).toArray();for(const n of t)n.uniqueNumber&&await Se.participants.update(n.id,{uniqueNumber:""});const r=await Xc(!0);r&&await Se.settings.update(1,{lastUniquePrefix:r.prefix,lastUniqueSeq:r.seq})}const Gs=Object.freeze(Object.defineProperty({__proto__:null,assignUniqueNumbersForGroupActivation:aC,checkForGaps:_g,clearUniqueNumbersForGroup:sC,formatUniqueNumber:Wi,generateNextUniqueNumber:xc,getGlobalMaxUniqueNumber:Xc,isUniqueNumberAvailable:vc,isValidUniqueNumberFormat:L_,parseUniqueNumber:to,realignUniqueNumbers:iC,resetYearlySequence:M_},Symbol.toStringTag,{value:"Module"}));async function da(){return Se.groups.where("status").equals("active").first()}async function B_(e){const t=await Se.groups.where("courseStartDate").equals(e).first();if(!t)return;const{assignUniqueNumbersForGroupActivation:r}=await Pn(async()=>{const{assignUniqueNumbersForGroupActivation:n}=await Promise.resolve().then(()=>Gs);return{assignUniqueNumbersForGroupActivation:n}},void 0);await r(t.id)}async function U_(){return Se.groups.where("status").equals("planned").sortBy("courseStartDate")}async function yc(e){const{computeCourseDates:t}=await Pn(async()=>{const{computeCourseDates:l}=await Promise.resolve().then(()=>nC);return{computeCourseDates:l}},void 0),{isMedicalValidForCourse:r}=await Pn(async()=>{const{isMedicalValidForCourse:l}=await Promise.resolve().then(()=>F5);return{isMedicalValidForCourse:l}},void 0),{courseStartDate:n}=t(e),a=await Se.groups.toArray(),i=a.find(l=>l.status==="active"),s=a.filter(l=>l.status==="planned").sort((l,u)=>l.courseStartDate.localeCompare(u.courseStartDate));if(i&&n<=i.courseStartDate&&r(e,i.courseStartDate))return{group:i,shouldCreate:!1};const o=a.find(l=>l.courseStartDate===n);if(o&&o.status==="completed"){const l=[];i&&l.push(i),l.push(...s),l.sort((c,h)=>c.courseStartDate.localeCompare(h.courseStartDate));const u=l.find(c=>c.courseStartDate<n?!1:r(e,c.courseStartDate));return u?{group:u,shouldCreate:!1}:{group:o,shouldCreate:!1}}return o?{group:o,shouldCreate:!1}:i&&n<i.courseStartDate?{group:{id:"stub_past",status:"completed",courseStartDate:n,courseEndDate:"",groupNumber:-1,createdAt:"",updatedAt:"",isLocked:!0},shouldCreate:!1}:{group:null,shouldCreate:!0,createsForDate:n}}async function fd(e,t="planned"){const r=await Se.groups.where("courseStartDate").equals(e).first();if(r)return r.status!==t&&t==="active"&&console.warn(`Group for ${e} already exists with status ${r.status}. Returning existing.`),r;let n=null;t==="active"&&(n=null);const a=new Date(e);a.setDate(a.getDate()+7);const i=new Date().toISOString(),s={id:R_(),groupNumber:n,courseStartDate:e,courseEndDate:a.toISOString().split("T")[0],status:t,createdAt:i,updatedAt:i,isLocked:!1};return await Se.groups.add(s),s}async function z_(){const e=await da();if(!e)throw new Error("No active group to close");const t=new Date().toISOString();let r=e.groupNumber;if(r==null){const n=await Se.groups.where("status").equals("completed").toArray(),a=new Set(n.map(s=>s.groupNumber).filter(s=>s!=null&&s>0));let i=1;for(;a.has(i);)i++;r=i,console.log(`Assigning Group Number ${r} to closed group (Gap filling/Next sequential)`)}await Se.groups.update(e.id,{status:"completed",groupNumber:r,updatedAt:t,closedAt:t,isLocked:!0})}async function C0(){const e=await Se.participants.toArray(),t=await Se.groups.toArray(),r=t.find(w=>w.status==="active");if(r&&(r.groupNumber===null||r.groupNumber===void 0)){const w=new Set(t.map(y=>y.groupNumber).filter(y=>y!=null&&y>0));let x=1;for(;w.has(x);)x++;await Se.groups.update(r.id,{groupNumber:x,updatedAt:new Date().toISOString()}),console.log(` Assigned Group Number ${x} to active group`)}const n=t.filter(w=>w.status==="active");for(const w of n)await B_(w.courseStartDate);for(const w of t){const x=new Date(w.courseStartDate);if(x.getDay()!==1){console.warn(`Found invalid group start date ${w.courseStartDate} (Day: ${x.getDay()}). Fixing to Monday.`);const y=x.getDay(),b=y===0?1:8-y,_=new Date(x);_.setDate(x.getDate()+b);const N=_.toISOString().split("T")[0];await Se.groups.update(w.id,{courseStartDate:N,courseEndDate:new Date(_.getTime()+7*24*60*60*1e3).toISOString().split("T")[0]});const k=e.filter(T=>T.courseStartDate===w.courseStartDate);for(const T of k)await Se.participants.update(T.id,{courseStartDate:N,courseEndDate:new Date(_.getTime()+7*24*60*60*1e3).toISOString().split("T")[0]})}}const a=new Set;e.forEach(w=>a.add(w.courseStartDate));let i;if(r)i=new Date(r.courseStartDate);else{const w=new Date,x=w.getDay(),y=x===0?1:x===1?0:8-x;i=new Date(w),i.setHours(12,0,0,0),i.setDate(w.getDate()+y)}const s=new Date(i);s.setDate(s.getDate()+7);const o=new Date(i);o.setDate(o.getDate()+14),a.add(s.toISOString().split("T")[0]),a.add(o.toISOString().split("T")[0]);const l=new Set(t.map(w=>w.courseStartDate));for(const w of a)l.has(w)||(console.log(`Creating missing planned group for ${w}`),await fd(w,"planned"));const u=await Se.groups.toArray(),c=new Map;e.forEach(w=>{c.set(w.courseStartDate,(c.get(w.courseStartDate)||0)+1)});const h=new Map;u.forEach(w=>{const x=h.get(w.courseStartDate)||[];x.push(w),h.set(w.courseStartDate,x)});for(const[w,x]of h)if(x.length>1){console.warn(`Found ${x.length} duplicate groups for ${w}. Merging and cleaning up...`);const y=x.sort((N,k)=>{const T=P=>P.status==="completed"?3:P.status==="active"?2:1,A=T(N),S=T(k);return A!==S?S-A:0}),b=y[0],_=y.slice(1);for(const N of _)console.warn(`Merging participants from duplicate group ${N.id} to ${b.id}`),await Se.groups.delete(N.id)}const p=await Se.groups.toArray(),v=p.find(w=>w.status==="active");if(v){const w=p.filter(x=>x.status==="planned"&&x.courseStartDate<v.courseStartDate&&(c.get(x.courseStartDate)||0)===0);for(const x of w)console.log(`Removing old empty planned group before active: ${x.courseStartDate}`),await Se.groups.delete(x.id)}const g=(await Se.groups.toArray()).filter(w=>w.status==="planned");if(g.length>2){const w=g.filter(y=>(c.get(y.courseStartDate)||0)===0);let x=g.length;w.sort((y,b)=>b.courseStartDate.localeCompare(y.courseStartDate));for(const y of w){if(x<=2)break;console.log(`Pruning excess empty planned group: ${y.courseStartDate}`),await Se.groups.delete(y.id),x--}}}function Yo(e){return e?e.status==="completed"&&e.isLocked:!1}async function q_(){return Se.groups.where("status").equals("completed").reverse().sortBy("groupNumber")}async function W_(e){const t=await Se.groups.get(e);if(!t)throw new Error("Group not found");if(t.status==="active")return{success:!0};const r=await da();return r&&r.id!==e?{success:!1,needsConfirm:!0,currentActive:r}:await Qd(e)}async function Qd(e,t=!1){const r=await Se.groups.get(e);if(!r)throw new Error("Group not found");const n=new Date().toISOString();if(t){const s=await da();if(s){await Se.groups.update(s.id,{status:"planned",updatedAt:n,activatedAt:void 0,groupNumber:null});const{clearUniqueNumbersForGroup:o}=await Pn(async()=>{const{clearUniqueNumbersForGroup:l}=await Promise.resolve().then(()=>Gs);return{clearUniqueNumbersForGroup:l}},void 0);await o(s.courseStartDate)}}let a=r.groupNumber;if(r.status==="planned"&&a===null){const s=await Se.groups.toArray(),o=new Set(s.map(u=>u.groupNumber).filter(u=>u!=null&&u>0));let l=1;for(;o.has(l);)l++;a=l,console.log(`Assigning Group Number ${a} to newly activated group`)}await Se.groups.update(e,{groupNumber:a,status:"active",activatedAt:n,updatedAt:n,isLocked:!1});const{assignUniqueNumbersForGroupActivation:i}=await Pn(async()=>{const{assignUniqueNumbersForGroupActivation:s}=await Promise.resolve().then(()=>Gs);return{assignUniqueNumbersForGroupActivation:s}},void 0);return await i(e),{success:!0}}async function $_(){const e=await da();if(!e)throw new Error("No active group to set as planned");const t=new Date().toISOString();await Se.groups.update(e.id,{status:"planned",updatedAt:t,activatedAt:void 0});const{clearUniqueNumbersForGroup:r}=await Pn(async()=>{const{clearUniqueNumbersForGroup:n}=await Promise.resolve().then(()=>Gs);return{clearUniqueNumbersForGroup:n}},void 0);await r(e.courseStartDate)}async function G_(e){const t=await Se.groups.get(e);if(!t)throw new Error("Group not found");if(t.status!=="completed")throw new Error("Only archived groups can be reopened");const r=await da();return r?{success:!1,needsConfirm:!0,currentActive:r}:await Qd(e)}async function H_(){const e=await Se.groups.where("status").equals("active").toArray();if(e.length<=1)return;console.warn(` Found ${e.length} active groups! Fixing...`);const t=e.sort((i,s)=>new Date(s.updatedAt).getTime()-new Date(i.updatedAt).getTime()),r=t[0],n=t.slice(1),a=new Date().toISOString();for(const i of n)await Se.groups.update(i.id,{status:"planned",updatedAt:a,activatedAt:void 0}),console.warn(` Moved Group ${i.groupNumber} from active to planned`);console.log(` Kept Group ${r.groupNumber} as active`)}const Y1=Object.freeze(Object.defineProperty({__proto__:null,activateGroupDirectly:Qd,closeActiveGroup:z_,createGroup:fd,ensureSingleActiveGroup:H_,generateUniqueNumbersForGroup:B_,getActiveGroup:da,getCompletedGroups:q_,getPlannedGroups:U_,getSuggestedGroup:yc,isGroupReadOnly:Yo,makeGroupActive:W_,reopenArchivedGroup:G_,setActiveToPlanned:$_,syncGroups:C0},Symbol.toStringTag,{value:"Module"})),V_=6048e5,oC=864e5,Y_=6e4,X_=36e5,I2=Symbol.for("constructDateFrom");function La(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&I2 in e?e[I2](t):e instanceof Date?new e.constructor(t):new Date(t)}function $r(e,t){return La(t||e,e)}function lC(e,t,r){const n=$r(e,r==null?void 0:r.in);if(isNaN(t))return La(e,NaN);const a=n.getDate(),i=La(e,n.getTime());i.setMonth(n.getMonth()+t+1,0);const s=i.getDate();return a>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}let uC={};function Jd(){return uC}function wc(e,t){var o,l,u,c;const r=Jd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((c=(u=r.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,a=$r(e,t==null?void 0:t.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function dd(e,t){return wc(e,{...t,weekStartsOn:1})}function K_(e,t){const r=$r(e,t==null?void 0:t.in),n=r.getFullYear(),a=La(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=dd(a),s=La(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=dd(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function R2(e){const t=$r(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function cC(e,...t){const r=La.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function j2(e,t){const r=$r(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function fC(e,t,r){const[n,a]=cC(r==null?void 0:r.in,e,t),i=j2(n),s=j2(a),o=+i-R2(i),l=+s-R2(s);return Math.round((o-l)/oC)}function dC(e,t){const r=K_(e,t),n=La(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),dd(n)}function hC(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function pC(e){return!(!hC(e)&&typeof e!="number"||isNaN(+$r(e)))}function mC(e,t){const r=$r(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const gC={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xC=(e,t,r)=>{let n;const a=gC[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function pp(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const vC={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yC={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wC={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bC={date:pp({formats:vC,defaultWidth:"full"}),time:pp({formats:yC,defaultWidth:"full"}),dateTime:pp({formats:wC,defaultWidth:"full"})},EC={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},_C=(e,t,r,n)=>EC[e];function iu(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;a=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const TC={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},SC={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AC={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},NC={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},DC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},CC={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kC=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},OC={ordinalNumber:kC,era:iu({values:TC,defaultWidth:"wide"}),quarter:iu({values:SC,defaultWidth:"wide",argumentCallback:e=>e-1}),month:iu({values:AC,defaultWidth:"wide"}),day:iu({values:NC,defaultWidth:"wide"}),dayPeriod:iu({values:DC,defaultWidth:"wide",formattingValues:CC,defaultFormattingWidth:"wide"})};function su(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?PC(o,h=>h.test(s)):FC(o,h=>h.test(s));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const c=t.slice(s.length);return{value:u,rest:c}}}function FC(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function PC(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function IC(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const RC=/^(\d+)(th|st|nd|rd)?/i,jC=/\d+/i,MC={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LC={any:[/^b/i,/^(a|c)/i]},BC={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},UC={any:[/1/i,/2/i,/3/i,/4/i]},zC={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},qC={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},WC={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$C={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},GC={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HC={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},VC={ordinalNumber:IC({matchPattern:RC,parsePattern:jC,valueCallback:e=>parseInt(e,10)}),era:su({matchPatterns:MC,defaultMatchWidth:"wide",parsePatterns:LC,defaultParseWidth:"any"}),quarter:su({matchPatterns:BC,defaultMatchWidth:"wide",parsePatterns:UC,defaultParseWidth:"any",valueCallback:e=>e+1}),month:su({matchPatterns:zC,defaultMatchWidth:"wide",parsePatterns:qC,defaultParseWidth:"any"}),day:su({matchPatterns:WC,defaultMatchWidth:"wide",parsePatterns:$C,defaultParseWidth:"any"}),dayPeriod:su({matchPatterns:GC,defaultMatchWidth:"any",parsePatterns:HC,defaultParseWidth:"any"})},YC={code:"en-US",formatDistance:xC,formatLong:bC,formatRelative:_C,localize:OC,match:VC,options:{weekStartsOn:0,firstWeekContainsDate:1}};function XC(e,t){const r=$r(e,t==null?void 0:t.in);return fC(r,mC(r))+1}function KC(e,t){const r=$r(e,t==null?void 0:t.in),n=+dd(r)-+dC(r);return Math.round(n/V_)+1}function Z_(e,t){var c,h,p,v;const r=$r(e,t==null?void 0:t.in),n=r.getFullYear(),a=Jd(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(p=a.locale)==null?void 0:p.options)==null?void 0:v.firstWeekContainsDate)??1,s=La((t==null?void 0:t.in)||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const o=wc(s,t),l=La((t==null?void 0:t.in)||e,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const u=wc(l,t);return+r>=+o?n+1:+r>=+u?n:n-1}function ZC(e,t){var o,l,u,c;const r=Jd(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(u=r.locale)==null?void 0:u.options)==null?void 0:c.firstWeekContainsDate)??1,a=Z_(e,t),i=La((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),wc(i,t)}function QC(e,t){const r=$r(e,t==null?void 0:t.in),n=+wc(r,t)-+ZC(r,t);return Math.round(n/V_)+1}function Gt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ki={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Gt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Gt(r+1,2)},d(e,t){return Gt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Gt(e.getHours()%12||12,t.length)},H(e,t){return Gt(e.getHours(),t.length)},m(e,t){return Gt(e.getMinutes(),t.length)},s(e,t){return Gt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Gt(a,t.length)}},Ao={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},M2={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return ki.y(e,t)},Y:function(e,t,r,n){const a=Z_(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return Gt(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Gt(i,t.length)},R:function(e,t){const r=K_(e);return Gt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Gt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Gt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Gt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ki.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Gt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=QC(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Gt(a,t.length)},I:function(e,t,r){const n=KC(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Gt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ki.d(e,t)},D:function(e,t,r){const n=XC(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Gt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Gt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Gt(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Gt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Ao.noon:n===0?a=Ao.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Ao.evening:n>=12?a=Ao.afternoon:n>=4?a=Ao.morning:a=Ao.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ki.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ki.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Gt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Gt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ki.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ki.s(e,t)},S:function(e,t){return ki.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return B2(n);case"XXXX":case"XX":return Os(n);case"XXXXX":case"XXX":default:return Os(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return B2(n);case"xxxx":case"xx":return Os(n);case"xxxxx":case"xxx":default:return Os(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+L2(n,":");case"OOOO":default:return"GMT"+Os(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+L2(n,":");case"zzzz":default:return"GMT"+Os(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Gt(n,t.length)},T:function(e,t,r){return Gt(+e,t.length)}};function L2(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+Gt(i,2)}function B2(e,t){return e%60===0?(e>0?"-":"+")+Gt(Math.abs(e)/60,2):Os(e,t)}function Os(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Gt(Math.trunc(n/60),2),i=Gt(n%60,2);return r+a+t+i}const U2=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Q_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},JC=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return U2(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",U2(n,t)).replace("{{time}}",Q_(a,t))},e5={p:Q_,P:JC},t5=/^D+$/,r5=/^Y+$/,n5=["D","DD","YY","YYYY"];function a5(e){return t5.test(e)}function i5(e){return r5.test(e)}function s5(e,t,r){const n=o5(e,t,r);if(console.warn(n),n5.includes(e))throw new RangeError(n)}function o5(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const l5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,u5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,c5=/^'([^]*?)'?$/,f5=/''/g,d5=/[a-zA-Z]/;function h5(e,t,r){var c,h,p,v;const n=Jd(),a=n.locale??YC,i=n.firstWeekContainsDate??((h=(c=n.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??1,s=n.weekStartsOn??((v=(p=n.locale)==null?void 0:p.options)==null?void 0:v.weekStartsOn)??0,o=$r(e,r==null?void 0:r.in);if(!pC(o))throw new RangeError("Invalid time value");let l=t.match(u5).map(E=>{const g=E[0];if(g==="p"||g==="P"){const w=e5[g];return w(E,a.formatLong)}return E}).join("").match(l5).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const g=E[0];if(g==="'")return{isToken:!1,value:p5(E)};if(M2[g])return{isToken:!0,value:E};if(g.match(d5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:E}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const u={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return l.map(E=>{if(!E.isToken)return E.value;const g=E.value;(i5(g)||a5(g))&&s5(g,t,String(e));const w=M2[g[0]];return w(o,g,a.localize,u)}).join("")}function p5(e){const t=e.match(c5);return t?t[1].replace(f5,"'"):e}function m5(e,t){return+$r(e)<+$r(t)}function g5(e,t){return+$r(e)==+$r(t)}function hd(e,t){const r=()=>La(t==null?void 0:t.in,NaN),a=w5(e);let i;if(a.date){const u=b5(a.date,2);i=E5(u.restDateString,u.year)}if(!i||isNaN(+i))return r();const s=+i;let o=0,l;if(a.time&&(o=_5(a.time),isNaN(o)))return r();if(a.timezone){if(l=T5(a.timezone),isNaN(l))return r()}else{const u=new Date(s+o),c=$r(0,t==null?void 0:t.in);return c.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),c.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),c}return $r(s+o+l,t==null?void 0:t.in)}const Vf={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},x5=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,v5=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,y5=/^([+-])(\d{2})(?::?(\d{2}))?$/;function w5(e){const t={},r=e.split(Vf.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Vf.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Vf.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=Vf.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function b5(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function E5(e,t){if(t===null)return new Date(NaN);const r=e.match(x5);if(!r)return new Date(NaN);const n=!!r[4],a=ou(r[1]),i=ou(r[2])-1,s=ou(r[3]),o=ou(r[4]),l=ou(r[5])-1;if(n)return C5(t,o,l)?S5(t,o,l):new Date(NaN);{const u=new Date(0);return!N5(t,i,s)||!D5(t,a)?new Date(NaN):(u.setUTCFullYear(t,i,Math.max(a,s)),u)}}function ou(e){return e?parseInt(e):1}function _5(e){const t=e.match(v5);if(!t)return NaN;const r=mp(t[1]),n=mp(t[2]),a=mp(t[3]);return k5(r,n,a)?r*X_+n*Y_+a*1e3:NaN}function mp(e){return e&&parseFloat(e.replace(",","."))||0}function T5(e){if(e==="Z")return 0;const t=e.match(y5);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return O5(n,a)?r*(n*X_+a*Y_):NaN}function S5(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const A5=[31,null,31,30,31,30,31,31,30,31,30,31];function J_(e){return e%400===0||e%4===0&&e%100!==0}function N5(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(A5[t]||(J_(e)?29:28))}function D5(e,t){return t>=1&&t<=(J_(e)?366:365)}function C5(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function k5(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function O5(e,t){return t>=0&&t<=59}function eT(e,t,r){return lC(e,-6,r)}function tT(e){const r=eT(new Date);return hd(e)>=r}function ol(e,t){const r=hd(e),n=hd(t);if(!m5(r,n)&&!g5(r,n))return!1;const a=eT(n);return r>=a}function at(e){try{const t=hd(e);return h5(t,"dd.MM.yyyy")}catch{return e}}const Mu="       6     .",F5=Object.freeze(Object.defineProperty({__proto__:null,MEDICAL_EXPIRED_MESSAGE:Mu,formatDateBG:at,isMedicalDateValid:tT,isMedicalValidForCourse:ol},Symbol.toStringTag,{value:"Module"}));function eh(){return{participants:Qr(()=>Se.participants.orderBy("courseStartDate").toArray()),addParticipant:async s=>{const{courseStartDate:o}=cd(s.medicalDate);if(!ol(s.medicalDate,o))throw new Error(Mu);const{group:l,shouldCreate:u,createsForDate:c}=await yc(s.medicalDate),h=l?l.courseStartDate:c||o,p=(()=>{const y=new Date(h);return y.setDate(y.getDate()+7),y.toISOString().split("T")[0]})();if(!ol(s.medicalDate,h))throw new Error(Mu);if((await Se.groups.where("courseStartDate").equals(h).toArray()).some(y=>y.status==="completed"))throw new Error("         (  ).");if((l==null?void 0:l.status)==="completed")throw new Error("        .");if(u){const b=await da()?"planned":"active";await fd(h,b)}let E;if(s.uniqueNumber){if(!await vc(s.uniqueNumber))throw new Error("Unique number already exists");E=s.uniqueNumber}else(l==null?void 0:l.status)==="active"?E=await xc():E="";const g=!1,w=new Date().toISOString(),x={id:R_(),companyName:s.companyName,personName:s.personName,egn:s.egn||"",birthPlace:s.birthPlace||"",citizenship:s.citizenship||"",medicalDate:s.medicalDate,courseStartDate:h,courseEndDate:p,uniqueNumber:E,sent:!1,documents:!1,handedOver:!1,paid:!1,completedOverride:null,completedComputed:g,createdAt:w,updatedAt:w};return await Se.participants.add(x),await C0(),x},updateParticipant:async(s,o)=>{const l=await Se.participants.get(s);if(!l)throw new Error("Participant not found");const u=await Se.groups.where("courseStartDate").equals(l.courseStartDate).first();if(Yo(u))throw new Error("       .      Tools.");const c={};let h=null;if(o.companyName!==void 0&&(c.companyName=o.companyName),o.personName!==void 0&&(c.personName=o.personName),o.egn!==void 0&&(c.egn=o.egn),o.birthPlace!==void 0&&(c.birthPlace=o.birthPlace),o.citizenship!==void 0&&(c.citizenship=o.citizenship),o.medicalDate&&o.medicalDate!==l.medicalDate){const{group:b,shouldCreate:_,createsForDate:N}=await yc(o.medicalDate),{courseStartDate:k}=cd(o.medicalDate),T=b?b.courseStartDate:N||k,A=(()=>{const U=new Date(T);return U.setDate(U.getDate()+7),U.toISOString().split("T")[0]})();if(!ol(o.medicalDate,T))throw new Error(Mu);if((b==null?void 0:b.status)==="completed")throw new Error("      (  ).");if(_){const re=await da()?"planned":"active";await fd(T,re)}c.medicalDate=o.medicalDate,c.courseStartDate=T,c.courseEndDate=A;const S=await Se.groups.where("courseStartDate").equals(l.courseStartDate).first(),P=(S==null?void 0:S.status)||"planned",F=(b==null?void 0:b.status)||"planned";if(F==="active"&&P!=="active"){const{checkForGaps:U}=await Pn(async()=>{const{checkForGaps:le}=await Promise.resolve().then(()=>Gs);return{checkForGaps:le}},void 0),re=await U();re?c.uniqueNumber=re:c.uniqueNumber=await xc()}else if(P==="active"&&F==="planned"){const U=l.uniqueNumber;c.uniqueNumber="",U&&(h=U)}}if(o.uniqueNumber&&o.uniqueNumber!==l.uniqueNumber){if(!await vc(o.uniqueNumber,s))throw new Error("Unique number already exists");c.uniqueNumber=o.uniqueNumber}o.sent!==void 0&&(c.sent=o.sent),o.documents!==void 0&&(c.documents=o.documents),o.handedOver!==void 0&&(c.handedOver=o.handedOver),o.paid!==void 0&&(c.paid=o.paid);const p=c.sent!==void 0?c.sent:l.sent,v=c.documents!==void 0?c.documents:l.documents,E=c.handedOver!==void 0?c.handedOver:l.handedOver,g=c.paid!==void 0?c.paid:l.paid,w=p&&v&&E&&g;c.completedComputed=w,c.updatedAt=new Date().toISOString();const x=l.completedOverride!==null?l.completedOverride:l.completedComputed,y=c.completedOverride!==void 0&&c.completedOverride!==null?c.completedOverride:c.completedOverride===null?w:l.completedOverride!==null?l.completedOverride:w;if(!x&&y&&(c.completedAt=new Date().toISOString()),await Se.participants.update(s,c),h){const{realignUniqueNumbers:b}=await Pn(async()=>{const{realignUniqueNumbers:_}=await Promise.resolve().then(()=>Gs);return{realignUniqueNumbers:_}},void 0);await b(h)}await C0()},deleteParticipant:async s=>{const o=await Se.participants.get(s);if(await Se.participants.delete(s),o&&o.uniqueNumber){const{realignUniqueNumbers:l}=await Pn(async()=>{const{realignUniqueNumbers:u}=await Promise.resolve().then(()=>Gs);return{realignUniqueNumbers:u}},void 0);await l(o.uniqueNumber)}await C0()},resetCompletedOverride:async s=>{await Se.participants.update(s,{completedOverride:null})},getParticipant:async s=>Se.participants.get(s)}}function P5(){return{groups:Qr(()=>Se.groups.orderBy("groupNumber").toArray()),getGroup:async n=>Se.groups.where("groupNumber").equals(n).first(),getGroupsWithCounts:async()=>{const n=await Se.groups.orderBy("groupNumber").toArray();return await Promise.all(n.map(async i=>{const s=i.groupNumber!==null?await Se.participants.where("groupNumber").equals(i.groupNumber).count():0;return{...i,participantCount:s}}))}}}const ia={active:"groups-collapsed-active",planned:"groups-collapsed-planned",completed:"groups-collapsed-completed"};function I5(){const[e,t]=_e.useState(()=>{const o=localStorage.getItem(ia.active),l=localStorage.getItem(ia.planned),u=localStorage.getItem(ia.completed);return l==="true"||o==="true"?(localStorage.setItem(ia.active,"false"),localStorage.setItem(ia.planned,"false"),localStorage.setItem(ia.completed,"true"),{active:!1,planned:!1,completed:!0}):{active:o==="true",planned:l==="true",completed:u===null?!0:u==="true"}});return _e.useEffect(()=>{localStorage.setItem(ia.active,String(e.active)),localStorage.setItem(ia.planned,String(e.planned)),localStorage.setItem(ia.completed,String(e.completed))},[e]),{collapsedSections:e,toggleSection:o=>{t(l=>({...l,[o]:!l[o]}))},expandSection:o=>{t(l=>({...l,[o]:!1}))},expandAll:()=>{t({active:!1,planned:!1,completed:!1})},resetToDefaults:()=>{t({active:!1,planned:!1,completed:!0}),localStorage.setItem(ia.active,"false"),localStorage.setItem(ia.planned,"false"),localStorage.setItem(ia.completed,"true")},setCollapsedState:o=>{t(o)}}}const R5=(e,t,r)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==r?". Note that variables only represent file names one level deep.":""))))})},rT=_e.createContext(void 0),j5=({children:e})=>{const[t,r]=_e.useState(()=>{const o=localStorage.getItem("app-language");return o==="bg"||o==="en"?o:"en"}),[n,a]=_e.useState({});_e.useEffect(()=>{(async()=>{const l=await R5(Object.assign({"../locales/bg.ts":()=>Pn(()=>import("./bg-Bti4Nn9N.js"),[]),"../locales/en.ts":()=>Pn(()=>import("./en-DGiFwhMi.js"),[])}),`../locales/${t}.ts`,3);a(l.default)})()},[t]);const i=o=>{r(o),localStorage.setItem("app-language",o)},s=(o,l)=>{let u=n[o]||o;return l&&Object.entries(l).forEach(([c,h])=>{u=u.replace(`{${c}}`,h)}),u};return f.jsx(rT.Provider,{value:{language:t,setLanguage:i,t:s},children:e})},Tr=()=>{const e=_e.useContext(rT);if(!e)throw new Error("useLanguage must be used within LanguageProvider");return e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M5=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),L5=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),z2=e=>{const t=L5(e);return t.charAt(0).toUpperCase()+t.slice(1)},nT=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),B5=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var U5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z5=_e.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...o},l)=>_e.createElement("svg",{ref:l,...U5,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:nT("lucide",a),...!i&&!B5(o)&&{"aria-hidden":"true"},...o},[...s.map(([u,c])=>_e.createElement(u,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=(e,t)=>{const r=_e.forwardRef(({className:n,...a},i)=>_e.createElement(z5,{ref:i,iconNode:t,className:nT(`lucide-${M5(z2(e))}`,`lucide-${e}`,n),...a}));return r.displayName=z2(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Tg=Wt("activity",q5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W5=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],X1=Wt("archive",W5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],Sg=Wt("calendar-clock",$5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G5=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],yu=Wt("calendar",G5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H5=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],q2=Wt("chevron-down",H5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],W2=Wt("chevron-right",V5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],$2=Wt("circle-alert",Y5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ro=Wt("circle-check-big",X5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Z5=Wt("circle-x",K5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q5=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],aT=Wt("clock",Q5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],ek=Wt("delete",J5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],G2=Wt("download",tk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],nk=Wt("eye-off",rk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ag=Wt("eye",ak);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],sk=Wt("file-spreadsheet",ik);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lk=Wt("file-text",ok);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],H2=Wt("graduation-cap",uk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],iT=Wt("hash",ck);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],K1=Wt("info",fk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],V2=Wt("layers",dk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],th=Wt("lock",hk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],mk=Wt("map-pin",pk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],xk=Wt("package",gk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yk=Wt("rotate-ccw",vk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Z1=Wt("settings",wk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ek=Wt("shield-check",bk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],El=Wt("triangle-alert",_k);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],sT=Wt("upload",Tk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ak=Wt("user",Sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],_l=Wt("users",Nk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Q1=Wt("x",Dk),ts=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="Confirm",cancelText:s="Cancel",variant:o="info"})=>{if(_e.useEffect(()=>{const h=p=>{p.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e,t]),_e.useEffect(()=>{if(e){const h=setTimeout(()=>{t()},5e3);return()=>clearTimeout(h)}},[e,t]),!e)return null;const l=()=>{switch(o){case"danger":return f.jsx(El,{className:"w-6 h-6 text-red-600"});case"warning":return f.jsx(El,{className:"w-6 h-6 text-amber-600"});case"success":return f.jsx(ro,{className:"w-6 h-6 text-emerald-600"});default:return f.jsx(K1,{className:"w-6 h-6 text-blue-600"})}},u=()=>{switch(o){case"danger":return"bg-red-50 text-red-900 border-red-100";case"warning":return"bg-amber-50 text-amber-900 border-amber-100";case"success":return"bg-emerald-50 text-emerald-900 border-emerald-100";default:return"bg-blue-50 text-blue-900 border-blue-100"}},c=()=>{switch(o){case"danger":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"warning":return"bg-amber-600 hover:bg-amber-700 focus:ring-amber-500";case"success":return"bg-emerald-600 hover:bg-emerald-700 focus:ring-emerald-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 transition-opacity",onClick:t}),f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden animate-scale-up transform transition-all",children:[f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:`p-3 rounded-full flex-shrink-0 ${u()} bg-opacity-50`,children:l()}),f.jsxs("div",{className:"flex-1 pt-1",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2 leading-none",children:n}),f.jsx("p",{className:"text-slate-600 leading-relaxed text-sm",children:a})]})]})}),f.jsxs("div",{className:"p-4 bg-slate-50 flex gap-3 justify-end border-t border-slate-100",children:[f.jsx("button",{onClick:t,className:"px-5 py-2.5 bg-white text-slate-700 border border-slate-200 rounded-lg hover:bg-slate-50 hover:text-slate-900 font-medium transition-all duration-200 shadow-sm",children:s}),f.jsx("button",{onClick:()=>{r(),t()},className:`px-5 py-2.5 text-white rounded-lg font-medium shadow-md transition-all duration-200 transform hover:-translate-y-0.5 ${c()}`,children:i})]})]})})]})},Ck={Egida:"bg-violet-50 text-violet-700 ring-1 ring-violet-200/50","D-Max":"bg-orange-50 text-orange-700 ring-1 ring-orange-200/50",Multiforce:"bg-cyan-50 text-cyan-700 ring-1 ring-cyan-200/50"},kk="bg-slate-50 text-slate-600 ring-1 ring-slate-200/50",Lu=({companyName:e,className:t=""})=>{const r=Ck[e]||kk;return f.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-xs rounded-full 
        font-medium tracking-normal transition-all duration-150 
        hover:ring-2 hover:shadow-sm ${r} ${t}`,"aria-label":`Company: ${e||"Unknown"}`,children:e||" "})};function Ok(){return{bulkSetFlag:async(r,n,a)=>{const i={success:0,failed:0,errors:[]},s=new Date().toISOString();for(const o of r)try{const l=await Se.participants.get(o);if(!l){i.failed++,i.errors.push(`Participant ${o} not found`);continue}const u=await Se.groups.where("courseStartDate").equals(l.courseStartDate).first();if(u&&u.status==="completed"&&u.isLocked){i.failed++,i.errors.push(`Participant ${l.personName} belongs to locked group (${u.courseStartDate})`);continue}const c={[n]:a,updatedAt:s},h=n==="sent"?a:l.sent,p=n==="documents"?a:l.documents,v=n==="handedOver"?a:l.handedOver,E=n==="paid"?a:l.paid,g=h&&p&&v&&E;c.completedComputed=g;const w=l.completedOverride!==null?l.completedOverride:l.completedComputed,x=l.completedOverride!==null?l.completedOverride:g;!w&&x&&(c.completedAt=s),await Se.participants.update(o,c),i.success++}catch(l){i.failed++,i.errors.push(`Failed to update ${o}: ${l.message}`)}return i},bulkSetCompleted:async r=>{const n={success:0,failed:0,errors:[]},a=new Date().toISOString();for(const i of r)try{const s=await Se.participants.get(i);if(!s){n.failed++,n.errors.push(`Participant ${i} not found`);continue}const o=await Se.groups.where("courseStartDate").equals(s.courseStartDate).first();if(o&&o.status==="completed"&&o.isLocked){n.failed++,n.errors.push(`Participant ${s.personName} belongs to locked group (${o.courseStartDate})`);continue}if(!s.sent||!s.documents||!s.handedOver||!s.paid){n.failed++,n.errors.push(`Participant ${s.personName} does not have all 4 flags set`);continue}const l={completedOverride:!0,updatedAt:a,completedAt:a};await Se.participants.update(i,l),n.success++}catch(s){n.failed++,n.errors.push(`Failed to update ${i}: ${s.message}`)}return n}}}const oT=({selectedCount:e,selectedIds:t,onClearSelection:r,onActionComplete:n})=>{const{t:a}=Tr(),{bulkSetFlag:i}=Ok(),[s,o]=_e.useState(!1),[l,u]=_e.useState(!1),[c,h]=_e.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),p=async(E,g)=>{o(!0);try{const w=await i(t,E,g);w.failed>0?alert(`${a("bulk.completed")}: ${w.success}
${a("bulk.failed")}: ${w.failed}
${w.errors.join(`
`)}`):alert(`${a("bulk.success")}: ${w.success} ${a("bulk.updated")}`),n()}catch(w){alert(`${a("bulk.error")}: ${w.message}`)}finally{o(!1)}},v=()=>{h({isOpen:!0,title:a("bulk.confirmPaidTitle"),message:a("bulk.confirmPaidMessage"),onConfirm:async()=>{h({...c,isOpen:!1}),await p("paid",!0)}})};return e===0?null:f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"hidden md:block sticky top-0 bg-blue-600 text-white shadow-lg z-20 mb-4 rounded-lg",children:f.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:r,className:"p-1 hover:bg-blue-700 rounded transition-colors","aria-label":"Clear selection",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),f.jsxs("span",{className:"font-semibold",children:[e," ",a("bulk.selected")]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>p("sent",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setSent")}),f.jsx("button",{onClick:()=>p("documents",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setDocuments")}),f.jsx("button",{onClick:()=>p("handedOver",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setHanded")}),f.jsx("button",{onClick:v,disabled:s,className:"px-3 py-1.5 bg-amber-100 text-amber-800 rounded text-sm font-medium hover:bg-amber-200 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setPaid")}),f.jsx("div",{className:"w-px h-6 bg-blue-400"}),f.jsx("button",{onClick:()=>p("sent",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearSent")}),f.jsx("button",{onClick:()=>p("documents",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearDocuments")}),f.jsx("button",{onClick:()=>p("handedOver",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearHanded")}),f.jsx("button",{onClick:()=>p("paid",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearPaid")})]})]})}),f.jsxs("div",{className:"md:hidden fixed bottom-16 left-0 right-0 bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-2xl z-20 rounded-t-2xl",style:{boxShadow:"0 -10px 25px -5px rgba(0, 0, 0, 0.3), 0 -8px 10px -6px rgba(0, 0, 0, 0.1)"},children:[f.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:r,className:"p-1.5 hover:bg-white/20 rounded-full transition-all active:scale-95","aria-label":"Clear selection",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})}),f.jsxs("div",{className:"flex items-baseline gap-1.5",children:[f.jsx("span",{className:"text-xl font-bold",children:e}),f.jsx("span",{className:"text-sm font-medium opacity-90",children:a("bulk.selected")})]})]}),f.jsxs("button",{onClick:()=>u(!l),className:"px-4 py-2.5 bg-white text-blue-700 rounded-full font-semibold text-sm hover:bg-blue-50 active:scale-95 transition-all shadow-md flex items-center gap-1.5",disabled:s,children:[a("bulk.actions"),f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),l&&f.jsxs("div",{className:"fixed inset-0 z-50 flex items-end pointer-events-auto",children:[f.jsx("div",{className:"absolute inset-0 bg-black/40 pointer-events-auto",onClick:()=>u(!1)}),f.jsxs("div",{className:"relative w-full bg-white rounded-t-3xl shadow-2xl max-h-[80vh] overflow-hidden animate-slide-up pointer-events-auto z-10",children:[f.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-3 flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-base font-bold text-slate-900",children:a("bulk.actionTitle")}),f.jsxs("p",{className:"text-xs text-slate-600 mt-0",children:[a("bulk.forSelected"),": ",f.jsx("span",{className:"font-semibold",children:e})]})]}),f.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors active:scale-95","aria-label":"Close",children:f.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"overflow-y-auto",children:[f.jsxs("div",{className:"px-6 pt-3 pb-1",children:[f.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:a("bulk.set")}),f.jsxs("div",{className:"space-y-0.5",children:[f.jsxs("button",{onClick:()=>{p("sent",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setSent")})]}),f.jsxs("button",{onClick:()=>{p("documents",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setDocuments")})]}),f.jsxs("button",{onClick:()=>{p("handedOver",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setHanded")})]}),f.jsxs("button",{onClick:()=>{v(),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-amber-50 active:bg-amber-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-amber-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setPaid")})]})]})]}),f.jsx("div",{className:"my-2 mx-6 border-t border-slate-200"}),f.jsxs("div",{className:"px-6 pb-20",children:[f.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:a("bulk.clear")}),f.jsxs("div",{className:"space-y-0.5",children:[f.jsxs("button",{onClick:()=>{p("sent",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearSent")})]}),f.jsxs("button",{onClick:()=>{p("documents",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearDocuments")})]}),f.jsxs("button",{onClick:()=>{p("handedOver",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearHanded")})]}),f.jsxs("button",{onClick:()=>{p("paid",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearPaid")})]})]})]})]})]})]})]}),f.jsx(ts,{isOpen:c.isOpen,onClose:()=>h({...c,isOpen:!1}),onConfirm:c.onConfirm,title:c.title,message:c.message,confirmText:a("common.confirm"),cancelText:a("common.cancel")})]})};function ll({title:e,count:t,groupNumbers:r,dateRange:n,participantCount:a,isCollapsed:i,onToggle:s,children:o,variant:l="active",showCount:u=!0}){const{t:c}=Tr(),p={active:{bg:"bg-blue-50",border:"border-blue-200",accent:"border-l-blue-400",text:"text-blue-900",countBg:"bg-blue-100",countText:"text-blue-700",icon:f.jsx(Tg,{className:"w-5 h-5 text-blue-600",strokeWidth:2})},planned:{bg:"bg-amber-50",border:"border-amber-200",accent:"border-l-amber-400",text:"text-amber-900",countBg:"bg-amber-100",countText:"text-amber-700",icon:f.jsx(Sg,{className:"w-5 h-5 text-amber-600",strokeWidth:2})},completed:{bg:"bg-slate-50",border:"border-slate-200",accent:"border-l-slate-400",text:"text-slate-700",countBg:"bg-slate-100",countText:"text-slate-600",icon:f.jsx(X1,{className:"w-5 h-5 text-slate-600",strokeWidth:2})}}[l];return f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:`rounded-lg border ${p.border} ${p.bg} border-l-4 ${p.accent} overflow-hidden shadow-sm transition-shadow duration-150`,children:[f.jsxs("button",{onClick:s,className:`w-full flex items-center justify-between px-4 py-3.5 transition-all duration-150 hover:brightness-95 active:scale-[0.99] ${p.text}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"flex-shrink-0",children:p.icon}),f.jsx("span",{className:"font-bold text-base",children:e}),u&&r&&r.length>0&&f.jsx("span",{className:`px-2.5 py-0.5 ${p.countBg} ${p.countText} rounded-full text-xs font-semibold`,children:r.length===1?` ${r[0]}`:` ${r.join(", ")}`}),n&&f.jsx("span",{className:"text-sm font-medium opacity-75",children:n}),u&&!r&&l==="planned"&&f.jsx("span",{className:`px-2.5 py-0.5 ${p.countBg} ${p.countText} rounded-full text-xs font-semibold`,children:t})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[a!==void 0&&f.jsxs("span",{className:`px-2.5 py-1 ${p.countBg} ${p.countText} rounded-full text-xs font-bold`,children:[a," ",c(a===1?"group.participant_one":"group.participant_other")]}),f.jsx("svg",{className:`w-5 h-5 transition-transform duration-200 ease-out ${i?"":"rotate-180"}`,style:{transformOrigin:"center"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),f.jsx("div",{className:`grid transition-all duration-150 ease-in-out ${i?"grid-rows-[0fr] opacity-0":"grid-rows-[1fr] opacity-100"}`,style:{transitionProperty:"grid-template-rows, opacity",willChange:i?"auto":"grid-template-rows, opacity"},children:f.jsx("div",{className:"overflow-hidden",children:f.jsx("div",{className:`px-1.5 sm:px-2 pb-2 transition-transform duration-150 ease-out ${i?"translate-y-[-8px]":"translate-y-0"}`,style:{willChange:i?"auto":"transform"},children:o})})})]}),f.jsx("style",{children:`
        @media (prefers-reduced-motion: reduce) {
          .grid, button, svg {
            transition: none !important;
          }
        }
        
        @media (max-width: 768px) {
          .grid {
            transition-duration: 120ms !important;
          }
        }
      `})]})}const lT=({groupNumber:e,courseStartDate:t,courseEndDate:r,participants:n,renderParticipantRow:a,mode:i="table",defaultExpanded:s=!1})=>{const{t:o}=Tr(),[l,u]=_e.useState(s),[c,h]=_e.useState({key:"uniqueNumber",direction:"desc"}),p=E=>{let g="asc";c.key===E&&c.direction==="asc"&&(g="desc"),h({key:E,direction:g})},v=Fs.useMemo(()=>c.key?[...n].sort((E,g)=>{if(c.key==="uniqueNumber"){const w=E.uniqueNumber||"",x=g.uniqueNumber||"";return c.direction==="asc"?w.localeCompare(x):x.localeCompare(w)}return 0}):n,[n,c]);return f.jsxs("div",{className:"border border-slate-300 rounded-lg mb-2 bg-white shadow-sm transition-shadow duration-150",children:[f.jsxs("button",{onClick:()=>u(!l),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-slate-50 transition-all duration-150 rounded-lg active:scale-[0.99]",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("svg",{className:`w-5 h-5 text-slate-600 transition-transform duration-200 ease-out ${l?"rotate-90":""}`,style:{transformOrigin:"center"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-semibold text-slate-900",children:[o("group.group")," ",e]}),f.jsxs("div",{className:"text-sm text-slate-600",children:[at(t)," - ",at(r)]})]})]}),f.jsxs("div",{className:"text-sm text-slate-600 font-medium",children:[n.length," ",n.length===1?o("group.participant_one"):o("group.participant_other")]})]}),f.jsx("div",{className:`grid transition-all ease-in-out border-t border-slate-200 ${l?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,style:{transitionDuration:"180ms",transitionProperty:"grid-template-rows, opacity",willChange:l?"grid-template-rows, opacity":"auto"},children:f.jsx("div",{className:"overflow-hidden",children:f.jsx("div",{className:`transition-transform duration-180 ease-out ${l?"translate-y-0":"translate-y-[-8px]"}`,style:{willChange:l?"transform":"auto"},children:i==="table"?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.companyName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.personName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none",onClick:()=>p("uniqueNumber"),title:"Sort by Number",children:f.jsxs("div",{className:"flex items-center gap-1",children:[o("participant.uniqueNumber"),c.key==="uniqueNumber"&&f.jsx("span",{className:"text-slate-500",children:c.direction==="asc"?"":""})]})}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.sent")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.documents")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.handedOver")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.paid")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("filters.status")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:v.map(a)})]})}):f.jsx("div",{className:"p-3 space-y-2",children:v.map(a)})})})}),f.jsx("style",{children:`
        @media (prefers-reduced-motion: reduce) {
          .grid, button, svg {
            transition: none !important;
          }
        }
      `})]})};var uT={exports:{}},Kc={},$i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Kc.encode=function(e){for(var t="",r,n,a,i,s,o,l,u=0;u<e.length;)r=e.charCodeAt(u++),n=e.charCodeAt(u++),a=e.charCodeAt(u++),i=r>>2,s=(r&3)<<4|n>>4,o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t=t+$i.charAt(i)+$i.charAt(s)+$i.charAt(o)+$i.charAt(l);return t};Kc.decode=function(e){var t="",r,n,a,i,s,o,l,u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=$i.indexOf(e.charAt(u++)),s=$i.indexOf(e.charAt(u++)),o=$i.indexOf(e.charAt(u++)),l=$i.indexOf(e.charAt(u++)),r=i<<2|s>>4,n=(s&15)<<4|o>>2,a=(o&3)<<6|l,t+=String.fromCharCode(r),o!==64&&(t+=String.fromCharCode(n)),l!==64&&(t+=String.fromCharCode(a));return t};var fn={},Yf;fn.base64=!0;fn.array=!0;fn.string=!0;fn.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";fn.nodebuffer=typeof Buffer<"u";fn.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")Yf=fn.blob=!1;else{var Y2=new ArrayBuffer(0);try{Yf=fn.blob=new Blob([Y2],{type:"application/zip"}).size===0}catch{try{var Fk=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,X2=new Fk;X2.append(Y2),Yf=fn.blob=X2.getBlob("application/zip").size===0}catch{Yf=fn.blob=!1}}}var xa={},Xf={},Ns={},Kf={exports:{}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */var K2;function Pk(){return K2||(K2=1,function(e,t){(function(r,n){n(t)})(OA,function(r){function n(d){for(var D=d.length;--D>=0;)d[D]=0}var a=256,i=286,s=30,o=15,l=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),u=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=new Array(576);n(p);var v=new Array(60);n(v);var E=new Array(512);n(E);var g=new Array(256);n(g);var w=new Array(29);n(w);var x,y,b,_=new Array(s);function N(d,D,m,W,G){this.static_tree=d,this.extra_bits=D,this.extra_base=m,this.elems=W,this.max_length=G,this.has_stree=d&&d.length}function k(d,D){this.dyn_tree=d,this.max_code=0,this.stat_desc=D}n(_);var T=function(d){return d<256?E[d]:E[256+(d>>>7)]},A=function(d,D){d.pending_buf[d.pending++]=255&D,d.pending_buf[d.pending++]=D>>>8&255},S=function(d,D,m){d.bi_valid>16-m?(d.bi_buf|=D<<d.bi_valid&65535,A(d,d.bi_buf),d.bi_buf=D>>16-d.bi_valid,d.bi_valid+=m-16):(d.bi_buf|=D<<d.bi_valid&65535,d.bi_valid+=m)},P=function(d,D,m){S(d,m[2*D],m[2*D+1])},F=function(d,D){var m=0;do m|=1&d,d>>>=1,m<<=1;while(--D>0);return m>>>1},U=function(d,D,m){var W,G,Z=new Array(16),De=0;for(W=1;W<=o;W++)De=De+m[W-1]<<1,Z[W]=De;for(G=0;G<=D;G++){var ne=d[2*G+1];ne!==0&&(d[2*G]=F(Z[ne]++,ne))}},re=function(d){var D;for(D=0;D<i;D++)d.dyn_ltree[2*D]=0;for(D=0;D<s;D++)d.dyn_dtree[2*D]=0;for(D=0;D<19;D++)d.bl_tree[2*D]=0;d.dyn_ltree[512]=1,d.opt_len=d.static_len=0,d.sym_next=d.matches=0},le=function(d){d.bi_valid>8?A(d,d.bi_buf):d.bi_valid>0&&(d.pending_buf[d.pending++]=d.bi_buf),d.bi_buf=0,d.bi_valid=0},pe=function(d,D,m,W){var G=2*D,Z=2*m;return d[G]<d[Z]||d[G]===d[Z]&&W[D]<=W[m]},me=function(d,D,m){for(var W=d.heap[m],G=m<<1;G<=d.heap_len&&(G<d.heap_len&&pe(D,d.heap[G+1],d.heap[G],d.depth)&&G++,!pe(D,W,d.heap[G],d.depth));)d.heap[m]=d.heap[G],m=G,G<<=1;d.heap[m]=W},Ee=function(d,D,m){var W,G,Z,De,ne=0;if(d.sym_next!==0)do W=255&d.pending_buf[d.sym_buf+ne++],W+=(255&d.pending_buf[d.sym_buf+ne++])<<8,G=d.pending_buf[d.sym_buf+ne++],W===0?P(d,G,D):(Z=g[G],P(d,Z+a+1,D),(De=l[Z])!==0&&(G-=w[Z],S(d,G,De)),W--,Z=T(W),P(d,Z,m),(De=u[Z])!==0&&(W-=_[Z],S(d,W,De)));while(ne<d.sym_next);P(d,256,D)},fe=function(d,D){var m,W,G,Z=D.dyn_tree,De=D.stat_desc.static_tree,ne=D.stat_desc.has_stree,Be=D.stat_desc.elems,ie=-1;for(d.heap_len=0,d.heap_max=573,m=0;m<Be;m++)Z[2*m]!==0?(d.heap[++d.heap_len]=ie=m,d.depth[m]=0):Z[2*m+1]=0;for(;d.heap_len<2;)Z[2*(G=d.heap[++d.heap_len]=ie<2?++ie:0)]=1,d.depth[G]=0,d.opt_len--,ne&&(d.static_len-=De[2*G+1]);for(D.max_code=ie,m=d.heap_len>>1;m>=1;m--)me(d,Z,m);G=Be;do m=d.heap[1],d.heap[1]=d.heap[d.heap_len--],me(d,Z,1),W=d.heap[1],d.heap[--d.heap_max]=m,d.heap[--d.heap_max]=W,Z[2*G]=Z[2*m]+Z[2*W],d.depth[G]=(d.depth[m]>=d.depth[W]?d.depth[m]:d.depth[W])+1,Z[2*m+1]=Z[2*W+1]=G,d.heap[1]=G++,me(d,Z,1);while(d.heap_len>=2);d.heap[--d.heap_max]=d.heap[1],function(ce,Ct){var Je,Oe,Ve,At,yt,Ot,He=Ct.dyn_tree,We=Ct.max_code,ct=Ct.stat_desc.static_tree,Jt=Ct.stat_desc.has_stree,st=Ct.stat_desc.extra_bits,jt=Ct.stat_desc.extra_base,Rt=Ct.stat_desc.max_length,pt=0;for(At=0;At<=o;At++)ce.bl_count[At]=0;for(He[2*ce.heap[ce.heap_max]+1]=0,Je=ce.heap_max+1;Je<573;Je++)(At=He[2*He[2*(Oe=ce.heap[Je])+1]+1]+1)>Rt&&(At=Rt,pt++),He[2*Oe+1]=At,Oe>We||(ce.bl_count[At]++,yt=0,Oe>=jt&&(yt=st[Oe-jt]),Ot=He[2*Oe],ce.opt_len+=Ot*(At+yt),Jt&&(ce.static_len+=Ot*(ct[2*Oe+1]+yt)));if(pt!==0){do{for(At=Rt-1;ce.bl_count[At]===0;)At--;ce.bl_count[At]--,ce.bl_count[At+1]+=2,ce.bl_count[Rt]--,pt-=2}while(pt>0);for(At=Rt;At!==0;At--)for(Oe=ce.bl_count[At];Oe!==0;)(Ve=ce.heap[--Je])>We||(He[2*Ve+1]!==At&&(ce.opt_len+=(At-He[2*Ve+1])*He[2*Ve],He[2*Ve+1]=At),Oe--)}}(d,D),U(Z,ie,d.bl_count)},de=function(d,D,m){var W,G,Z=-1,De=D[1],ne=0,Be=7,ie=4;for(De===0&&(Be=138,ie=3),D[2*(m+1)+1]=65535,W=0;W<=m;W++)G=De,De=D[2*(W+1)+1],++ne<Be&&G===De||(ne<ie?d.bl_tree[2*G]+=ne:G!==0?(G!==Z&&d.bl_tree[2*G]++,d.bl_tree[32]++):ne<=10?d.bl_tree[34]++:d.bl_tree[36]++,ne=0,Z=G,De===0?(Be=138,ie=3):G===De?(Be=6,ie=3):(Be=7,ie=4))},Ce=function(d,D,m){var W,G,Z=-1,De=D[1],ne=0,Be=7,ie=4;for(De===0&&(Be=138,ie=3),W=0;W<=m;W++)if(G=De,De=D[2*(W+1)+1],!(++ne<Be&&G===De)){if(ne<ie)do P(d,G,d.bl_tree);while(--ne!=0);else G!==0?(G!==Z&&(P(d,G,d.bl_tree),ne--),P(d,16,d.bl_tree),S(d,ne-3,2)):ne<=10?(P(d,17,d.bl_tree),S(d,ne-3,3)):(P(d,18,d.bl_tree),S(d,ne-11,7));ne=0,Z=G,De===0?(Be=138,ie=3):G===De?(Be=6,ie=3):(Be=7,ie=4)}},Ye=!1,V=function(d,D,m,W){S(d,0+(W?1:0),3),le(d),A(d,m),A(d,~m),m&&d.pending_buf.set(d.window.subarray(D,D+m),d.pending),d.pending+=m},se=function(d,D,m,W){var G,Z,De=0;d.level>0?(d.strm.data_type===2&&(d.strm.data_type=function(ne){var Be,ie=4093624447;for(Be=0;Be<=31;Be++,ie>>>=1)if(1&ie&&ne.dyn_ltree[2*Be]!==0)return 0;if(ne.dyn_ltree[18]!==0||ne.dyn_ltree[20]!==0||ne.dyn_ltree[26]!==0)return 1;for(Be=32;Be<a;Be++)if(ne.dyn_ltree[2*Be]!==0)return 1;return 0}(d)),fe(d,d.l_desc),fe(d,d.d_desc),De=function(ne){var Be;for(de(ne,ne.dyn_ltree,ne.l_desc.max_code),de(ne,ne.dyn_dtree,ne.d_desc.max_code),fe(ne,ne.bl_desc),Be=18;Be>=3&&ne.bl_tree[2*h[Be]+1]===0;Be--);return ne.opt_len+=3*(Be+1)+5+5+4,Be}(d),G=d.opt_len+3+7>>>3,(Z=d.static_len+3+7>>>3)<=G&&(G=Z)):G=Z=m+5,m+4<=G&&D!==-1?V(d,D,m,W):d.strategy===4||Z===G?(S(d,2+(W?1:0),3),Ee(d,p,v)):(S(d,4+(W?1:0),3),function(ne,Be,ie,ce){var Ct;for(S(ne,Be-257,5),S(ne,ie-1,5),S(ne,ce-4,4),Ct=0;Ct<ce;Ct++)S(ne,ne.bl_tree[2*h[Ct]+1],3);Ce(ne,ne.dyn_ltree,Be-1),Ce(ne,ne.dyn_dtree,ie-1)}(d,d.l_desc.max_code+1,d.d_desc.max_code+1,De+1),Ee(d,d.dyn_ltree,d.dyn_dtree)),re(d),W&&le(d)},ee={_tr_init:function(d){Ye||(function(){var D,m,W,G,Z,De=new Array(16);for(W=0,G=0;G<28;G++)for(w[G]=W,D=0;D<1<<l[G];D++)g[W++]=G;for(g[W-1]=G,Z=0,G=0;G<16;G++)for(_[G]=Z,D=0;D<1<<u[G];D++)E[Z++]=G;for(Z>>=7;G<s;G++)for(_[G]=Z<<7,D=0;D<1<<u[G]-7;D++)E[256+Z++]=G;for(m=0;m<=o;m++)De[m]=0;for(D=0;D<=143;)p[2*D+1]=8,D++,De[8]++;for(;D<=255;)p[2*D+1]=9,D++,De[9]++;for(;D<=279;)p[2*D+1]=7,D++,De[7]++;for(;D<=287;)p[2*D+1]=8,D++,De[8]++;for(U(p,287,De),D=0;D<s;D++)v[2*D+1]=5,v[2*D]=F(D,5);x=new N(p,l,257,i,o),y=new N(v,u,0,s,o),b=new N(new Array(0),c,0,19,7)}(),Ye=!0),d.l_desc=new k(d.dyn_ltree,x),d.d_desc=new k(d.dyn_dtree,y),d.bl_desc=new k(d.bl_tree,b),d.bi_buf=0,d.bi_valid=0,re(d)},_tr_stored_block:V,_tr_flush_block:se,_tr_tally:function(d,D,m){return d.pending_buf[d.sym_buf+d.sym_next++]=D,d.pending_buf[d.sym_buf+d.sym_next++]=D>>8,d.pending_buf[d.sym_buf+d.sym_next++]=m,D===0?d.dyn_ltree[2*m]++:(d.matches++,D--,d.dyn_ltree[2*(g[m]+a+1)]++,d.dyn_dtree[2*T(D)]++),d.sym_next===d.sym_end},_tr_align:function(d){S(d,2,3),P(d,256,p),function(D){D.bi_valid===16?(A(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):D.bi_valid>=8&&(D.pending_buf[D.pending++]=255&D.bi_buf,D.bi_buf>>=8,D.bi_valid-=8)}(d)}},C=function(d,D,m,W){for(var G=65535&d|0,Z=d>>>16&65535|0,De=0;m!==0;){m-=De=m>2e3?2e3:m;do Z=Z+(G=G+D[W++]|0)|0;while(--De);G%=65521,Z%=65521}return G|Z<<16|0},R=new Uint32Array(function(){for(var d,D=[],m=0;m<256;m++){d=m;for(var W=0;W<8;W++)d=1&d?3988292384^d>>>1:d>>>1;D[m]=d}return D}()),X=function(d,D,m,W){var G=R,Z=W+m;d^=-1;for(var De=W;De<Z;De++)d=d>>>8^G[255&(d^D[De])];return-1^d},te={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},K={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},M=ee._tr_init,Q=ee._tr_stored_block,be=ee._tr_flush_block,Te=ee._tr_tally,J=ee._tr_align,I=K.Z_NO_FLUSH,j=K.Z_PARTIAL_FLUSH,Y=K.Z_FULL_FLUSH,oe=K.Z_FINISH,Ze=K.Z_BLOCK,Ge=K.Z_OK,xt=K.Z_STREAM_END,rt=K.Z_STREAM_ERROR,zt=K.Z_DATA_ERROR,ft=K.Z_BUF_ERROR,ht=K.Z_DEFAULT_COMPRESSION,kt=K.Z_FILTERED,Tt=K.Z_HUFFMAN_ONLY,Dt=K.Z_RLE,ke=K.Z_FIXED,Re=K.Z_DEFAULT_STRATEGY,$e=K.Z_UNKNOWN,dt=K.Z_DEFLATED,xe=258,ve=262,ae=42,ue=113,Me=666,je=function(d,D){return d.msg=te[D],D},et=function(d){return 2*d-(d>4?9:0)},it=function(d){for(var D=d.length;--D>=0;)d[D]=0},St=function(d){var D,m,W,G=d.w_size;W=D=d.hash_size;do m=d.head[--W],d.head[W]=m>=G?m-G:0;while(--D);W=D=G;do m=d.prev[--W],d.prev[W]=m>=G?m-G:0;while(--D)},It=function(d,D,m){return(D<<d.hash_shift^m)&d.hash_mask},Ke=function(d){var D=d.state,m=D.pending;m>d.avail_out&&(m=d.avail_out),m!==0&&(d.output.set(D.pending_buf.subarray(D.pending_out,D.pending_out+m),d.next_out),d.next_out+=m,D.pending_out+=m,d.total_out+=m,d.avail_out-=m,D.pending-=m,D.pending===0&&(D.pending_out=0))},wt=function(d,D){be(d,d.block_start>=0?d.block_start:-1,d.strstart-d.block_start,D),d.block_start=d.strstart,Ke(d.strm)},lt=function(d,D){d.pending_buf[d.pending++]=D},kr=function(d,D){d.pending_buf[d.pending++]=D>>>8&255,d.pending_buf[d.pending++]=255&D},Nn=function(d,D,m,W){var G=d.avail_in;return G>W&&(G=W),G===0?0:(d.avail_in-=G,D.set(d.input.subarray(d.next_in,d.next_in+G),m),d.state.wrap===1?d.adler=C(d.adler,D,G,m):d.state.wrap===2&&(d.adler=X(d.adler,D,G,m)),d.next_in+=G,d.total_in+=G,G)},ra=function(d,D){var m,W,G=d.max_chain_length,Z=d.strstart,De=d.prev_length,ne=d.nice_match,Be=d.strstart>d.w_size-ve?d.strstart-(d.w_size-ve):0,ie=d.window,ce=d.w_mask,Ct=d.prev,Je=d.strstart+xe,Oe=ie[Z+De-1],Ve=ie[Z+De];d.prev_length>=d.good_match&&(G>>=2),ne>d.lookahead&&(ne=d.lookahead);do if(ie[(m=D)+De]===Ve&&ie[m+De-1]===Oe&&ie[m]===ie[Z]&&ie[++m]===ie[Z+1]){Z+=2,m++;do;while(ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&ie[++Z]===ie[++m]&&Z<Je);if(W=xe-(Je-Z),Z=Je-xe,W>De){if(d.match_start=D,De=W,W>=ne)break;Oe=ie[Z+De-1],Ve=ie[Z+De]}}while((D=Ct[D&ce])>Be&&--G!=0);return De<=d.lookahead?De:d.lookahead},gn=function(d){var D,m,W,G=d.w_size;do{if(m=d.window_size-d.lookahead-d.strstart,d.strstart>=G+(G-ve)&&(d.window.set(d.window.subarray(G,G+G-m),0),d.match_start-=G,d.strstart-=G,d.block_start-=G,d.insert>d.strstart&&(d.insert=d.strstart),St(d),m+=G),d.strm.avail_in===0)break;if(D=Nn(d.strm,d.window,d.strstart+d.lookahead,m),d.lookahead+=D,d.lookahead+d.insert>=3)for(W=d.strstart-d.insert,d.ins_h=d.window[W],d.ins_h=It(d,d.ins_h,d.window[W+1]);d.insert&&(d.ins_h=It(d,d.ins_h,d.window[W+3-1]),d.prev[W&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=W,W++,d.insert--,!(d.lookahead+d.insert<3)););}while(d.lookahead<ve&&d.strm.avail_in!==0)},Ua=function(d,D){var m,W,G,Z=d.pending_buf_size-5>d.w_size?d.w_size:d.pending_buf_size-5,De=0,ne=d.strm.avail_in;do{if(m=65535,G=d.bi_valid+42>>3,d.strm.avail_out<G||(G=d.strm.avail_out-G,m>(W=d.strstart-d.block_start)+d.strm.avail_in&&(m=W+d.strm.avail_in),m>G&&(m=G),m<Z&&(m===0&&D!==oe||D===I||m!==W+d.strm.avail_in)))break;De=D===oe&&m===W+d.strm.avail_in?1:0,Q(d,0,0,De),d.pending_buf[d.pending-4]=m,d.pending_buf[d.pending-3]=m>>8,d.pending_buf[d.pending-2]=~m,d.pending_buf[d.pending-1]=~m>>8,Ke(d.strm),W&&(W>m&&(W=m),d.strm.output.set(d.window.subarray(d.block_start,d.block_start+W),d.strm.next_out),d.strm.next_out+=W,d.strm.avail_out-=W,d.strm.total_out+=W,d.block_start+=W,m-=W),m&&(Nn(d.strm,d.strm.output,d.strm.next_out,m),d.strm.next_out+=m,d.strm.avail_out-=m,d.strm.total_out+=m)}while(De===0);return(ne-=d.strm.avail_in)&&(ne>=d.w_size?(d.matches=2,d.window.set(d.strm.input.subarray(d.strm.next_in-d.w_size,d.strm.next_in),0),d.strstart=d.w_size,d.insert=d.strstart):(d.window_size-d.strstart<=ne&&(d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,d.insert>d.strstart&&(d.insert=d.strstart)),d.window.set(d.strm.input.subarray(d.strm.next_in-ne,d.strm.next_in),d.strstart),d.strstart+=ne,d.insert+=ne>d.w_size-d.insert?d.w_size-d.insert:ne),d.block_start=d.strstart),d.high_water<d.strstart&&(d.high_water=d.strstart),De?4:D!==I&&D!==oe&&d.strm.avail_in===0&&d.strstart===d.block_start?2:(G=d.window_size-d.strstart,d.strm.avail_in>G&&d.block_start>=d.w_size&&(d.block_start-=d.w_size,d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,G+=d.w_size,d.insert>d.strstart&&(d.insert=d.strstart)),G>d.strm.avail_in&&(G=d.strm.avail_in),G&&(Nn(d.strm,d.window,d.strstart,G),d.strstart+=G,d.insert+=G>d.w_size-d.insert?d.w_size-d.insert:G),d.high_water<d.strstart&&(d.high_water=d.strstart),G=d.bi_valid+42>>3,Z=(G=d.pending_buf_size-G>65535?65535:d.pending_buf_size-G)>d.w_size?d.w_size:G,((W=d.strstart-d.block_start)>=Z||(W||D===oe)&&D!==I&&d.strm.avail_in===0&&W<=G)&&(m=W>G?G:W,De=D===oe&&d.strm.avail_in===0&&m===W?1:0,Q(d,d.block_start,m,De),d.block_start+=m,Ke(d.strm)),De?3:1)},na=function(d,D){for(var m,W;;){if(d.lookahead<ve){if(gn(d),d.lookahead<ve&&D===I)return 1;if(d.lookahead===0)break}if(m=0,d.lookahead>=3&&(d.ins_h=It(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),m!==0&&d.strstart-m<=d.w_size-ve&&(d.match_length=ra(d,m)),d.match_length>=3)if(W=Te(d,d.strstart-d.match_start,d.match_length-3),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=3){d.match_length--;do d.strstart++,d.ins_h=It(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart;while(--d.match_length!=0);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=It(d,d.ins_h,d.window[d.strstart+1]);else W=Te(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(W&&(wt(d,!1),d.strm.avail_out===0))return 1}return d.insert=d.strstart<2?d.strstart:2,D===oe?(wt(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(wt(d,!1),d.strm.avail_out===0)?1:2},Gr=function(d,D){for(var m,W,G;;){if(d.lookahead<ve){if(gn(d),d.lookahead<ve&&D===I)return 1;if(d.lookahead===0)break}if(m=0,d.lookahead>=3&&(d.ins_h=It(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=2,m!==0&&d.prev_length<d.max_lazy_match&&d.strstart-m<=d.w_size-ve&&(d.match_length=ra(d,m),d.match_length<=5&&(d.strategy===kt||d.match_length===3&&d.strstart-d.match_start>4096)&&(d.match_length=2)),d.prev_length>=3&&d.match_length<=d.prev_length){G=d.strstart+d.lookahead-3,W=Te(d,d.strstart-1-d.prev_match,d.prev_length-3),d.lookahead-=d.prev_length-1,d.prev_length-=2;do++d.strstart<=G&&(d.ins_h=It(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart);while(--d.prev_length!=0);if(d.match_available=0,d.match_length=2,d.strstart++,W&&(wt(d,!1),d.strm.avail_out===0))return 1}else if(d.match_available){if((W=Te(d,0,d.window[d.strstart-1]))&&wt(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return 1}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(W=Te(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<2?d.strstart:2,D===oe?(wt(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(wt(d,!1),d.strm.avail_out===0)?1:2};function Hr(d,D,m,W,G){this.good_length=d,this.max_lazy=D,this.nice_length=m,this.max_chain=W,this.func=G}var aa=[new Hr(0,0,0,0,Ua),new Hr(4,4,8,4,na),new Hr(4,5,16,8,na),new Hr(4,6,32,32,na),new Hr(4,4,16,16,Gr),new Hr(8,16,32,32,Gr),new Hr(8,16,128,128,Gr),new Hr(8,32,128,256,Gr),new Hr(32,128,258,1024,Gr),new Hr(32,258,258,4096,Gr)];function $l(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),it(this.dyn_ltree),it(this.dyn_dtree),it(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),it(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),it(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var O=function(d){if(!d)return 1;var D=d.state;return!D||D.strm!==d||D.status!==ae&&D.status!==57&&D.status!==69&&D.status!==73&&D.status!==91&&D.status!==103&&D.status!==ue&&D.status!==Me?1:0},z=function(d){if(O(d))return je(d,rt);d.total_in=d.total_out=0,d.data_type=$e;var D=d.state;return D.pending=0,D.pending_out=0,D.wrap<0&&(D.wrap=-D.wrap),D.status=D.wrap===2?57:D.wrap?ae:ue,d.adler=D.wrap===2?0:1,D.last_flush=-2,M(D),Ge},L=function(d){var D,m=z(d);return m===Ge&&((D=d.state).window_size=2*D.w_size,it(D.head),D.max_lazy_match=aa[D.level].max_lazy,D.good_match=aa[D.level].good_length,D.nice_match=aa[D.level].nice_length,D.max_chain_length=aa[D.level].max_chain,D.strstart=0,D.block_start=0,D.lookahead=0,D.insert=0,D.match_length=D.prev_length=2,D.match_available=0,D.ins_h=0),m},B=function(d,D,m,W,G,Z){if(!d)return rt;var De=1;if(D===ht&&(D=6),W<0?(De=0,W=-W):W>15&&(De=2,W-=16),G<1||G>9||m!==dt||W<8||W>15||D<0||D>9||Z<0||Z>ke||W===8&&De!==1)return je(d,rt);W===8&&(W=9);var ne=new $l;return d.state=ne,ne.strm=d,ne.status=ae,ne.wrap=De,ne.gzhead=null,ne.w_bits=W,ne.w_size=1<<ne.w_bits,ne.w_mask=ne.w_size-1,ne.hash_bits=G+7,ne.hash_size=1<<ne.hash_bits,ne.hash_mask=ne.hash_size-1,ne.hash_shift=~~((ne.hash_bits+3-1)/3),ne.window=new Uint8Array(2*ne.w_size),ne.head=new Uint16Array(ne.hash_size),ne.prev=new Uint16Array(ne.w_size),ne.lit_bufsize=1<<G+6,ne.pending_buf_size=4*ne.lit_bufsize,ne.pending_buf=new Uint8Array(ne.pending_buf_size),ne.sym_buf=ne.lit_bufsize,ne.sym_end=3*(ne.lit_bufsize-1),ne.level=D,ne.strategy=Z,ne.method=m,L(d)},q={deflateInit:function(d,D){return B(d,D,dt,15,8,Re)},deflateInit2:B,deflateReset:L,deflateResetKeep:z,deflateSetHeader:function(d,D){return O(d)||d.state.wrap!==2?rt:(d.state.gzhead=D,Ge)},deflate:function(d,D){if(O(d)||D>Ze||D<0)return d?je(d,rt):rt;var m=d.state;if(!d.output||d.avail_in!==0&&!d.input||m.status===Me&&D!==oe)return je(d,d.avail_out===0?ft:rt);var W=m.last_flush;if(m.last_flush=D,m.pending!==0){if(Ke(d),d.avail_out===0)return m.last_flush=-1,Ge}else if(d.avail_in===0&&et(D)<=et(W)&&D!==oe)return je(d,ft);if(m.status===Me&&d.avail_in!==0)return je(d,ft);if(m.status===ae&&m.wrap===0&&(m.status=ue),m.status===ae){var G=dt+(m.w_bits-8<<4)<<8;if(G|=(m.strategy>=Tt||m.level<2?0:m.level<6?1:m.level===6?2:3)<<6,m.strstart!==0&&(G|=32),kr(m,G+=31-G%31),m.strstart!==0&&(kr(m,d.adler>>>16),kr(m,65535&d.adler)),d.adler=1,m.status=ue,Ke(d),m.pending!==0)return m.last_flush=-1,Ge}if(m.status===57){if(d.adler=0,lt(m,31),lt(m,139),lt(m,8),m.gzhead)lt(m,(m.gzhead.text?1:0)+(m.gzhead.hcrc?2:0)+(m.gzhead.extra?4:0)+(m.gzhead.name?8:0)+(m.gzhead.comment?16:0)),lt(m,255&m.gzhead.time),lt(m,m.gzhead.time>>8&255),lt(m,m.gzhead.time>>16&255),lt(m,m.gzhead.time>>24&255),lt(m,m.level===9?2:m.strategy>=Tt||m.level<2?4:0),lt(m,255&m.gzhead.os),m.gzhead.extra&&m.gzhead.extra.length&&(lt(m,255&m.gzhead.extra.length),lt(m,m.gzhead.extra.length>>8&255)),m.gzhead.hcrc&&(d.adler=X(d.adler,m.pending_buf,m.pending,0)),m.gzindex=0,m.status=69;else if(lt(m,0),lt(m,0),lt(m,0),lt(m,0),lt(m,0),lt(m,m.level===9?2:m.strategy>=Tt||m.level<2?4:0),lt(m,3),m.status=ue,Ke(d),m.pending!==0)return m.last_flush=-1,Ge}if(m.status===69){if(m.gzhead.extra){for(var Z=m.pending,De=(65535&m.gzhead.extra.length)-m.gzindex;m.pending+De>m.pending_buf_size;){var ne=m.pending_buf_size-m.pending;if(m.pending_buf.set(m.gzhead.extra.subarray(m.gzindex,m.gzindex+ne),m.pending),m.pending=m.pending_buf_size,m.gzhead.hcrc&&m.pending>Z&&(d.adler=X(d.adler,m.pending_buf,m.pending-Z,Z)),m.gzindex+=ne,Ke(d),m.pending!==0)return m.last_flush=-1,Ge;Z=0,De-=ne}var Be=new Uint8Array(m.gzhead.extra);m.pending_buf.set(Be.subarray(m.gzindex,m.gzindex+De),m.pending),m.pending+=De,m.gzhead.hcrc&&m.pending>Z&&(d.adler=X(d.adler,m.pending_buf,m.pending-Z,Z)),m.gzindex=0}m.status=73}if(m.status===73){if(m.gzhead.name){var ie,ce=m.pending;do{if(m.pending===m.pending_buf_size){if(m.gzhead.hcrc&&m.pending>ce&&(d.adler=X(d.adler,m.pending_buf,m.pending-ce,ce)),Ke(d),m.pending!==0)return m.last_flush=-1,Ge;ce=0}ie=m.gzindex<m.gzhead.name.length?255&m.gzhead.name.charCodeAt(m.gzindex++):0,lt(m,ie)}while(ie!==0);m.gzhead.hcrc&&m.pending>ce&&(d.adler=X(d.adler,m.pending_buf,m.pending-ce,ce)),m.gzindex=0}m.status=91}if(m.status===91){if(m.gzhead.comment){var Ct,Je=m.pending;do{if(m.pending===m.pending_buf_size){if(m.gzhead.hcrc&&m.pending>Je&&(d.adler=X(d.adler,m.pending_buf,m.pending-Je,Je)),Ke(d),m.pending!==0)return m.last_flush=-1,Ge;Je=0}Ct=m.gzindex<m.gzhead.comment.length?255&m.gzhead.comment.charCodeAt(m.gzindex++):0,lt(m,Ct)}while(Ct!==0);m.gzhead.hcrc&&m.pending>Je&&(d.adler=X(d.adler,m.pending_buf,m.pending-Je,Je))}m.status=103}if(m.status===103){if(m.gzhead.hcrc){if(m.pending+2>m.pending_buf_size&&(Ke(d),m.pending!==0))return m.last_flush=-1,Ge;lt(m,255&d.adler),lt(m,d.adler>>8&255),d.adler=0}if(m.status=ue,Ke(d),m.pending!==0)return m.last_flush=-1,Ge}if(d.avail_in!==0||m.lookahead!==0||D!==I&&m.status!==Me){var Oe=m.level===0?Ua(m,D):m.strategy===Tt?function(Ve,At){for(var yt;;){if(Ve.lookahead===0&&(gn(Ve),Ve.lookahead===0)){if(At===I)return 1;break}if(Ve.match_length=0,yt=Te(Ve,0,Ve.window[Ve.strstart]),Ve.lookahead--,Ve.strstart++,yt&&(wt(Ve,!1),Ve.strm.avail_out===0))return 1}return Ve.insert=0,At===oe?(wt(Ve,!0),Ve.strm.avail_out===0?3:4):Ve.sym_next&&(wt(Ve,!1),Ve.strm.avail_out===0)?1:2}(m,D):m.strategy===Dt?function(Ve,At){for(var yt,Ot,He,We,ct=Ve.window;;){if(Ve.lookahead<=xe){if(gn(Ve),Ve.lookahead<=xe&&At===I)return 1;if(Ve.lookahead===0)break}if(Ve.match_length=0,Ve.lookahead>=3&&Ve.strstart>0&&(Ot=ct[He=Ve.strstart-1])===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]){We=Ve.strstart+xe;do;while(Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&Ot===ct[++He]&&He<We);Ve.match_length=xe-(We-He),Ve.match_length>Ve.lookahead&&(Ve.match_length=Ve.lookahead)}if(Ve.match_length>=3?(yt=Te(Ve,1,Ve.match_length-3),Ve.lookahead-=Ve.match_length,Ve.strstart+=Ve.match_length,Ve.match_length=0):(yt=Te(Ve,0,Ve.window[Ve.strstart]),Ve.lookahead--,Ve.strstart++),yt&&(wt(Ve,!1),Ve.strm.avail_out===0))return 1}return Ve.insert=0,At===oe?(wt(Ve,!0),Ve.strm.avail_out===0?3:4):Ve.sym_next&&(wt(Ve,!1),Ve.strm.avail_out===0)?1:2}(m,D):aa[m.level].func(m,D);if(Oe!==3&&Oe!==4||(m.status=Me),Oe===1||Oe===3)return d.avail_out===0&&(m.last_flush=-1),Ge;if(Oe===2&&(D===j?J(m):D!==Ze&&(Q(m,0,0,!1),D===Y&&(it(m.head),m.lookahead===0&&(m.strstart=0,m.block_start=0,m.insert=0))),Ke(d),d.avail_out===0))return m.last_flush=-1,Ge}return D!==oe?Ge:m.wrap<=0?xt:(m.wrap===2?(lt(m,255&d.adler),lt(m,d.adler>>8&255),lt(m,d.adler>>16&255),lt(m,d.adler>>24&255),lt(m,255&d.total_in),lt(m,d.total_in>>8&255),lt(m,d.total_in>>16&255),lt(m,d.total_in>>24&255)):(kr(m,d.adler>>>16),kr(m,65535&d.adler)),Ke(d),m.wrap>0&&(m.wrap=-m.wrap),m.pending!==0?Ge:xt)},deflateEnd:function(d){if(O(d))return rt;var D=d.state.status;return d.state=null,D===ue?je(d,zt):Ge},deflateSetDictionary:function(d,D){var m=D.length;if(O(d))return rt;var W=d.state,G=W.wrap;if(G===2||G===1&&W.status!==ae||W.lookahead)return rt;if(G===1&&(d.adler=C(d.adler,D,m,0)),W.wrap=0,m>=W.w_size){G===0&&(it(W.head),W.strstart=0,W.block_start=0,W.insert=0);var Z=new Uint8Array(W.w_size);Z.set(D.subarray(m-W.w_size,m),0),D=Z,m=W.w_size}var De=d.avail_in,ne=d.next_in,Be=d.input;for(d.avail_in=m,d.next_in=0,d.input=D,gn(W);W.lookahead>=3;){var ie=W.strstart,ce=W.lookahead-2;do W.ins_h=It(W,W.ins_h,W.window[ie+3-1]),W.prev[ie&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=ie,ie++;while(--ce);W.strstart=ie,W.lookahead=2,gn(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=2,W.match_available=0,d.next_in=ne,d.input=Be,d.avail_in=De,W.wrap=G,Ge},deflateInfo:"pako deflate (from Nodeca project)"};function H(d){return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},H(d)}var ge=function(d,D){return Object.prototype.hasOwnProperty.call(d,D)},Ne=function(d){for(var D=Array.prototype.slice.call(arguments,1);D.length;){var m=D.shift();if(m){if(H(m)!=="object")throw new TypeError(m+"must be non-object");for(var W in m)ge(m,W)&&(d[W]=m[W])}}return d},he=function(d){for(var D=0,m=0,W=d.length;m<W;m++)D+=d[m].length;for(var G=new Uint8Array(D),Z=0,De=0,ne=d.length;Z<ne;Z++){var Be=d[Z];G.set(Be,De),De+=Be.length}return G},ye=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ye=!1}for(var we=new Uint8Array(256),Pe=0;Pe<256;Pe++)we[Pe]=Pe>=252?6:Pe>=248?5:Pe>=240?4:Pe>=224?3:Pe>=192?2:1;we[254]=we[254]=1;var qe=function(d){if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(d);var D,m,W,G,Z,De=d.length,ne=0;for(G=0;G<De;G++)(64512&(m=d.charCodeAt(G)))==55296&&G+1<De&&(64512&(W=d.charCodeAt(G+1)))==56320&&(m=65536+(m-55296<<10)+(W-56320),G++),ne+=m<128?1:m<2048?2:m<65536?3:4;for(D=new Uint8Array(ne),Z=0,G=0;Z<ne;G++)(64512&(m=d.charCodeAt(G)))==55296&&G+1<De&&(64512&(W=d.charCodeAt(G+1)))==56320&&(m=65536+(m-55296<<10)+(W-56320),G++),m<128?D[Z++]=m:m<2048?(D[Z++]=192|m>>>6,D[Z++]=128|63&m):m<65536?(D[Z++]=224|m>>>12,D[Z++]=128|m>>>6&63,D[Z++]=128|63&m):(D[Z++]=240|m>>>18,D[Z++]=128|m>>>12&63,D[Z++]=128|m>>>6&63,D[Z++]=128|63&m);return D},Qe=function(d,D){var m,W,G=D||d.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(d.subarray(0,D));var Z=new Array(2*G);for(W=0,m=0;m<G;){var De=d[m++];if(De<128)Z[W++]=De;else{var ne=we[De];if(ne>4)Z[W++]=65533,m+=ne-1;else{for(De&=ne===2?31:ne===3?15:7;ne>1&&m<G;)De=De<<6|63&d[m++],ne--;ne>1?Z[W++]=65533:De<65536?Z[W++]=De:(De-=65536,Z[W++]=55296|De>>10&1023,Z[W++]=56320|1023&De)}}}return function(Be,ie){if(ie<65534&&Be.subarray&&ye)return String.fromCharCode.apply(null,Be.length===ie?Be:Be.subarray(0,ie));for(var ce="",Ct=0;Ct<ie;Ct++)ce+=String.fromCharCode(Be[Ct]);return ce}(Z,W)},Le=function(d,D){(D=D||d.length)>d.length&&(D=d.length);for(var m=D-1;m>=0&&(192&d[m])==128;)m--;return m<0||m===0?D:m+we[d[m]]>D?m:D},Xe=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},vt=Object.prototype.toString,nr=K.Z_NO_FLUSH,ar=K.Z_SYNC_FLUSH,Lr=K.Z_FULL_FLUSH,bs=K.Z_FINISH,za=K.Z_OK,Es=K.Z_STREAM_END,ti=K.Z_DEFAULT_COMPRESSION,Gl=K.Z_DEFAULT_STRATEGY,wa=K.Z_DEFLATED;function Hl(d){this.options=Ne({level:ti,method:wa,chunkSize:16384,windowBits:15,memLevel:8,strategy:Gl},d||{});var D=this.options;D.raw&&D.windowBits>0?D.windowBits=-D.windowBits:D.gzip&&D.windowBits>0&&D.windowBits<16&&(D.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xe,this.strm.avail_out=0;var m=q.deflateInit2(this.strm,D.level,D.method,D.windowBits,D.memLevel,D.strategy);if(m!==za)throw new Error(te[m]);if(D.header&&q.deflateSetHeader(this.strm,D.header),D.dictionary){var W;if(W=typeof D.dictionary=="string"?qe(D.dictionary):vt.call(D.dictionary)==="[object ArrayBuffer]"?new Uint8Array(D.dictionary):D.dictionary,(m=q.deflateSetDictionary(this.strm,W))!==za)throw new Error(te[m]);this._dict_set=!0}}function Ah(d,D){var m=new Hl(D);if(m.push(d,!0),m.err)throw m.msg||te[m.err];return m.result}Hl.prototype.push=function(d,D){var m,W,G=this.strm,Z=this.options.chunkSize;if(this.ended)return!1;for(W=D===~~D?D:D===!0?bs:nr,typeof d=="string"?G.input=qe(d):vt.call(d)==="[object ArrayBuffer]"?G.input=new Uint8Array(d):G.input=d,G.next_in=0,G.avail_in=G.input.length;;)if(G.avail_out===0&&(G.output=new Uint8Array(Z),G.next_out=0,G.avail_out=Z),(W===ar||W===Lr)&&G.avail_out<=6)this.onData(G.output.subarray(0,G.next_out)),G.avail_out=0;else{if((m=q.deflate(G,W))===Es)return G.next_out>0&&this.onData(G.output.subarray(0,G.next_out)),m=q.deflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===za;if(G.avail_out!==0){if(W>0&&G.next_out>0)this.onData(G.output.subarray(0,G.next_out)),G.avail_out=0;else if(G.avail_in===0)break}else this.onData(G.output)}return!0},Hl.prototype.onData=function(d){this.chunks.push(d)},Hl.prototype.onEnd=function(d){d===za&&(this.result=he(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};var ff={Deflate:Hl,deflate:Ah,deflateRaw:function(d,D){return(D=D||{}).raw=!0,Ah(d,D)},gzip:function(d,D){return(D=D||{}).gzip=!0,Ah(d,D)}},df=16209,dA=function(d,D){var m,W,G,Z,De,ne,Be,ie,ce,Ct,Je,Oe,Ve,At,yt,Ot,He,We,ct,Jt,st,jt,Rt,pt,bt=d.state;m=d.next_in,Rt=d.input,W=m+(d.avail_in-5),G=d.next_out,pt=d.output,Z=G-(D-d.avail_out),De=G+(d.avail_out-257),ne=bt.dmax,Be=bt.wsize,ie=bt.whave,ce=bt.wnext,Ct=bt.window,Je=bt.hold,Oe=bt.bits,Ve=bt.lencode,At=bt.distcode,yt=(1<<bt.lenbits)-1,Ot=(1<<bt.distbits)-1;e:do{Oe<15&&(Je+=Rt[m++]<<Oe,Oe+=8,Je+=Rt[m++]<<Oe,Oe+=8),He=Ve[Je&yt];t:for(;;){if(Je>>>=We=He>>>24,Oe-=We,(We=He>>>16&255)===0)pt[G++]=65535&He;else{if(!(16&We)){if(!(64&We)){He=Ve[(65535&He)+(Je&(1<<We)-1)];continue t}if(32&We){bt.mode=16191;break e}d.msg="invalid literal/length code",bt.mode=df;break e}ct=65535&He,(We&=15)&&(Oe<We&&(Je+=Rt[m++]<<Oe,Oe+=8),ct+=Je&(1<<We)-1,Je>>>=We,Oe-=We),Oe<15&&(Je+=Rt[m++]<<Oe,Oe+=8,Je+=Rt[m++]<<Oe,Oe+=8),He=At[Je&Ot];r:for(;;){if(Je>>>=We=He>>>24,Oe-=We,!(16&(We=He>>>16&255))){if(!(64&We)){He=At[(65535&He)+(Je&(1<<We)-1)];continue r}d.msg="invalid distance code",bt.mode=df;break e}if(Jt=65535&He,Oe<(We&=15)&&(Je+=Rt[m++]<<Oe,(Oe+=8)<We&&(Je+=Rt[m++]<<Oe,Oe+=8)),(Jt+=Je&(1<<We)-1)>ne){d.msg="invalid distance too far back",bt.mode=df;break e}if(Je>>>=We,Oe-=We,Jt>(We=G-Z)){if((We=Jt-We)>ie&&bt.sane){d.msg="invalid distance too far back",bt.mode=df;break e}if(st=0,jt=Ct,ce===0){if(st+=Be-We,We<ct){ct-=We;do pt[G++]=Ct[st++];while(--We);st=G-Jt,jt=pt}}else if(ce<We){if(st+=Be+ce-We,(We-=ce)<ct){ct-=We;do pt[G++]=Ct[st++];while(--We);if(st=0,ce<ct){ct-=We=ce;do pt[G++]=Ct[st++];while(--We);st=G-Jt,jt=pt}}}else if(st+=ce-We,We<ct){ct-=We;do pt[G++]=Ct[st++];while(--We);st=G-Jt,jt=pt}for(;ct>2;)pt[G++]=jt[st++],pt[G++]=jt[st++],pt[G++]=jt[st++],ct-=3;ct&&(pt[G++]=jt[st++],ct>1&&(pt[G++]=jt[st++]))}else{st=G-Jt;do pt[G++]=pt[st++],pt[G++]=pt[st++],pt[G++]=pt[st++],ct-=3;while(ct>2);ct&&(pt[G++]=pt[st++],ct>1&&(pt[G++]=pt[st++]))}break}}break}}while(m<W&&G<De);m-=ct=Oe>>3,Je&=(1<<(Oe-=ct<<3))-1,d.next_in=m,d.next_out=G,d.avail_in=m<W?W-m+5:5-(m-W),d.avail_out=G<De?De-G+257:257-(G-De),bt.hold=Je,bt.bits=Oe},hf=15,hA=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),pA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mA=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),gA=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Vl=function(d,D,m,W,G,Z,De,ne){var Be,ie,ce,Ct,Je,Oe,Ve,At,yt,Ot=ne.bits,He=0,We=0,ct=0,Jt=0,st=0,jt=0,Rt=0,pt=0,bt=0,Zt=0,Ss=null,Di=new Uint16Array(16),wf=new Uint16Array(16),bf=null;for(He=0;He<=hf;He++)Di[He]=0;for(We=0;We<W;We++)Di[D[m+We]]++;for(st=Ot,Jt=hf;Jt>=1&&Di[Jt]===0;Jt--);if(st>Jt&&(st=Jt),Jt===0)return G[Z++]=20971520,G[Z++]=20971520,ne.bits=1,0;for(ct=1;ct<Jt&&Di[ct]===0;ct++);for(st<ct&&(st=ct),pt=1,He=1;He<=hf;He++)if(pt<<=1,(pt-=Di[He])<0)return-1;if(pt>0&&(d===0||Jt!==1))return-1;for(wf[1]=0,He=1;He<hf;He++)wf[He+1]=wf[He]+Di[He];for(We=0;We<W;We++)D[m+We]!==0&&(De[wf[D[m+We]]++]=We);if(d===0?(Ss=bf=De,Oe=20):d===1?(Ss=hA,bf=pA,Oe=257):(Ss=mA,bf=gA,Oe=0),Zt=0,We=0,He=ct,Je=Z,jt=st,Rt=0,ce=-1,Ct=(bt=1<<st)-1,d===1&&bt>852||d===2&&bt>592)return 1;for(;;){Ve=He-Rt,De[We]+1<Oe?(At=0,yt=De[We]):De[We]>=Oe?(At=bf[De[We]-Oe],yt=Ss[De[We]-Oe]):(At=96,yt=0),Be=1<<He-Rt,ct=ie=1<<jt;do G[Je+(Zt>>Rt)+(ie-=Be)]=Ve<<24|At<<16|yt|0;while(ie!==0);for(Be=1<<He-1;Zt&Be;)Be>>=1;if(Be!==0?(Zt&=Be-1,Zt+=Be):Zt=0,We++,--Di[He]==0){if(He===Jt)break;He=D[m+De[We]]}if(He>st&&(Zt&Ct)!==ce){for(Rt===0&&(Rt=st),Je+=ct,pt=1<<(jt=He-Rt);jt+Rt<Jt&&!((pt-=Di[jt+Rt])<=0);)jt++,pt<<=1;if(bt+=1<<jt,d===1&&bt>852||d===2&&bt>592)return 1;G[ce=Zt&Ct]=st<<24|jt<<16|Je-Z|0}}return Zt!==0&&(G[Je+Zt]=He-Rt<<24|64<<16|0),ne.bits=st,0},Wx=K.Z_FINISH,xA=K.Z_BLOCK,pf=K.Z_TREES,_s=K.Z_OK,vA=K.Z_STREAM_END,yA=K.Z_NEED_DICT,ba=K.Z_STREAM_ERROR,$x=K.Z_DATA_ERROR,Gx=K.Z_MEM_ERROR,wA=K.Z_BUF_ERROR,Hx=K.Z_DEFLATED,mf=16180,gf=16190,ri=16191,Nh=16192,Dh=16194,xf=16199,vf=16200,Ch=16206,ur=16209,Vx=function(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)};function bA(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var kh,Oh,Ts=function(d){if(!d)return 1;var D=d.state;return!D||D.strm!==d||D.mode<mf||D.mode>16211?1:0},Yx=function(d){if(Ts(d))return ba;var D=d.state;return d.total_in=d.total_out=D.total=0,d.msg="",D.wrap&&(d.adler=1&D.wrap),D.mode=mf,D.last=0,D.havedict=0,D.flags=-1,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new Int32Array(852),D.distcode=D.distdyn=new Int32Array(592),D.sane=1,D.back=-1,_s},Xx=function(d){if(Ts(d))return ba;var D=d.state;return D.wsize=0,D.whave=0,D.wnext=0,Yx(d)},Kx=function(d,D){var m;if(Ts(d))return ba;var W=d.state;return D<0?(m=0,D=-D):(m=5+(D>>4),D<48&&(D&=15)),D&&(D<8||D>15)?ba:(W.window!==null&&W.wbits!==D&&(W.window=null),W.wrap=m,W.wbits=D,Xx(d))},Zx=function(d,D){if(!d)return ba;var m=new bA;d.state=m,m.strm=d,m.window=null,m.mode=mf;var W=Kx(d,D);return W!==_s&&(d.state=null),W},Qx=!0,EA=function(d){if(Qx){kh=new Int32Array(512),Oh=new Int32Array(32);for(var D=0;D<144;)d.lens[D++]=8;for(;D<256;)d.lens[D++]=9;for(;D<280;)d.lens[D++]=7;for(;D<288;)d.lens[D++]=8;for(Vl(1,d.lens,0,288,kh,0,d.work,{bits:9}),D=0;D<32;)d.lens[D++]=5;Vl(2,d.lens,0,32,Oh,0,d.work,{bits:5}),Qx=!1}d.lencode=kh,d.lenbits=9,d.distcode=Oh,d.distbits=5},Jx=function(d,D,m,W){var G,Z=d.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new Uint8Array(Z.wsize)),W>=Z.wsize?(Z.window.set(D.subarray(m-Z.wsize,m),0),Z.wnext=0,Z.whave=Z.wsize):((G=Z.wsize-Z.wnext)>W&&(G=W),Z.window.set(D.subarray(m-W,m-W+G),Z.wnext),(W-=G)?(Z.window.set(D.subarray(m-W,m),0),Z.wnext=W,Z.whave=Z.wsize):(Z.wnext+=G,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=G))),0},ni={inflateReset:Xx,inflateReset2:Kx,inflateResetKeep:Yx,inflateInit:function(d){return Zx(d,15)},inflateInit2:Zx,inflate:function(d,D){var m,W,G,Z,De,ne,Be,ie,ce,Ct,Je,Oe,Ve,At,yt,Ot,He,We,ct,Jt,st,jt,Rt,pt,bt=0,Zt=new Uint8Array(4),Ss=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ts(d)||!d.output||!d.input&&d.avail_in!==0)return ba;(m=d.state).mode===ri&&(m.mode=Nh),De=d.next_out,G=d.output,Be=d.avail_out,Z=d.next_in,W=d.input,ne=d.avail_in,ie=m.hold,ce=m.bits,Ct=ne,Je=Be,jt=_s;e:for(;;)switch(m.mode){case mf:if(m.wrap===0){m.mode=Nh;break}for(;ce<16;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(2&m.wrap&&ie===35615){m.wbits===0&&(m.wbits=15),m.check=0,Zt[0]=255&ie,Zt[1]=ie>>>8&255,m.check=X(m.check,Zt,2,0),ie=0,ce=0,m.mode=16181;break}if(m.head&&(m.head.done=!1),!(1&m.wrap)||(((255&ie)<<8)+(ie>>8))%31){d.msg="incorrect header check",m.mode=ur;break}if((15&ie)!==Hx){d.msg="unknown compression method",m.mode=ur;break}if(ce-=4,st=8+(15&(ie>>>=4)),m.wbits===0&&(m.wbits=st),st>15||st>m.wbits){d.msg="invalid window size",m.mode=ur;break}m.dmax=1<<m.wbits,m.flags=0,d.adler=m.check=1,m.mode=512&ie?16189:ri,ie=0,ce=0;break;case 16181:for(;ce<16;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(m.flags=ie,(255&m.flags)!==Hx){d.msg="unknown compression method",m.mode=ur;break}if(57344&m.flags){d.msg="unknown header flags set",m.mode=ur;break}m.head&&(m.head.text=ie>>8&1),512&m.flags&&4&m.wrap&&(Zt[0]=255&ie,Zt[1]=ie>>>8&255,m.check=X(m.check,Zt,2,0)),ie=0,ce=0,m.mode=16182;case 16182:for(;ce<32;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.head&&(m.head.time=ie),512&m.flags&&4&m.wrap&&(Zt[0]=255&ie,Zt[1]=ie>>>8&255,Zt[2]=ie>>>16&255,Zt[3]=ie>>>24&255,m.check=X(m.check,Zt,4,0)),ie=0,ce=0,m.mode=16183;case 16183:for(;ce<16;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.head&&(m.head.xflags=255&ie,m.head.os=ie>>8),512&m.flags&&4&m.wrap&&(Zt[0]=255&ie,Zt[1]=ie>>>8&255,m.check=X(m.check,Zt,2,0)),ie=0,ce=0,m.mode=16184;case 16184:if(1024&m.flags){for(;ce<16;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.length=ie,m.head&&(m.head.extra_len=ie),512&m.flags&&4&m.wrap&&(Zt[0]=255&ie,Zt[1]=ie>>>8&255,m.check=X(m.check,Zt,2,0)),ie=0,ce=0}else m.head&&(m.head.extra=null);m.mode=16185;case 16185:if(1024&m.flags&&((Oe=m.length)>ne&&(Oe=ne),Oe&&(m.head&&(st=m.head.extra_len-m.length,m.head.extra||(m.head.extra=new Uint8Array(m.head.extra_len)),m.head.extra.set(W.subarray(Z,Z+Oe),st)),512&m.flags&&4&m.wrap&&(m.check=X(m.check,W,Oe,Z)),ne-=Oe,Z+=Oe,m.length-=Oe),m.length))break e;m.length=0,m.mode=16186;case 16186:if(2048&m.flags){if(ne===0)break e;Oe=0;do st=W[Z+Oe++],m.head&&st&&m.length<65536&&(m.head.name+=String.fromCharCode(st));while(st&&Oe<ne);if(512&m.flags&&4&m.wrap&&(m.check=X(m.check,W,Oe,Z)),ne-=Oe,Z+=Oe,st)break e}else m.head&&(m.head.name=null);m.length=0,m.mode=16187;case 16187:if(4096&m.flags){if(ne===0)break e;Oe=0;do st=W[Z+Oe++],m.head&&st&&m.length<65536&&(m.head.comment+=String.fromCharCode(st));while(st&&Oe<ne);if(512&m.flags&&4&m.wrap&&(m.check=X(m.check,W,Oe,Z)),ne-=Oe,Z+=Oe,st)break e}else m.head&&(m.head.comment=null);m.mode=16188;case 16188:if(512&m.flags){for(;ce<16;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(4&m.wrap&&ie!==(65535&m.check)){d.msg="header crc mismatch",m.mode=ur;break}ie=0,ce=0}m.head&&(m.head.hcrc=m.flags>>9&1,m.head.done=!0),d.adler=m.check=0,m.mode=ri;break;case 16189:for(;ce<32;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}d.adler=m.check=Vx(ie),ie=0,ce=0,m.mode=gf;case gf:if(m.havedict===0)return d.next_out=De,d.avail_out=Be,d.next_in=Z,d.avail_in=ne,m.hold=ie,m.bits=ce,yA;d.adler=m.check=1,m.mode=ri;case ri:if(D===xA||D===pf)break e;case Nh:if(m.last){ie>>>=7&ce,ce-=7&ce,m.mode=Ch;break}for(;ce<3;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}switch(m.last=1&ie,ce-=1,3&(ie>>>=1)){case 0:m.mode=16193;break;case 1:if(EA(m),m.mode=xf,D===pf){ie>>>=2,ce-=2;break e}break;case 2:m.mode=16196;break;case 3:d.msg="invalid block type",m.mode=ur}ie>>>=2,ce-=2;break;case 16193:for(ie>>>=7&ce,ce-=7&ce;ce<32;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if((65535&ie)!=(ie>>>16^65535)){d.msg="invalid stored block lengths",m.mode=ur;break}if(m.length=65535&ie,ie=0,ce=0,m.mode=Dh,D===pf)break e;case Dh:m.mode=16195;case 16195:if(Oe=m.length){if(Oe>ne&&(Oe=ne),Oe>Be&&(Oe=Be),Oe===0)break e;G.set(W.subarray(Z,Z+Oe),De),ne-=Oe,Z+=Oe,Be-=Oe,De+=Oe,m.length-=Oe;break}m.mode=ri;break;case 16196:for(;ce<14;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(m.nlen=257+(31&ie),ie>>>=5,ce-=5,m.ndist=1+(31&ie),ie>>>=5,ce-=5,m.ncode=4+(15&ie),ie>>>=4,ce-=4,m.nlen>286||m.ndist>30){d.msg="too many length or distance symbols",m.mode=ur;break}m.have=0,m.mode=16197;case 16197:for(;m.have<m.ncode;){for(;ce<3;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.lens[Ss[m.have++]]=7&ie,ie>>>=3,ce-=3}for(;m.have<19;)m.lens[Ss[m.have++]]=0;if(m.lencode=m.lendyn,m.lenbits=7,Rt={bits:m.lenbits},jt=Vl(0,m.lens,0,19,m.lencode,0,m.work,Rt),m.lenbits=Rt.bits,jt){d.msg="invalid code lengths set",m.mode=ur;break}m.have=0,m.mode=16198;case 16198:for(;m.have<m.nlen+m.ndist;){for(;Ot=(bt=m.lencode[ie&(1<<m.lenbits)-1])>>>16&255,He=65535&bt,!((yt=bt>>>24)<=ce);){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(He<16)ie>>>=yt,ce-=yt,m.lens[m.have++]=He;else{if(He===16){for(pt=yt+2;ce<pt;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(ie>>>=yt,ce-=yt,m.have===0){d.msg="invalid bit length repeat",m.mode=ur;break}st=m.lens[m.have-1],Oe=3+(3&ie),ie>>>=2,ce-=2}else if(He===17){for(pt=yt+3;ce<pt;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}ce-=yt,st=0,Oe=3+(7&(ie>>>=yt)),ie>>>=3,ce-=3}else{for(pt=yt+7;ce<pt;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}ce-=yt,st=0,Oe=11+(127&(ie>>>=yt)),ie>>>=7,ce-=7}if(m.have+Oe>m.nlen+m.ndist){d.msg="invalid bit length repeat",m.mode=ur;break}for(;Oe--;)m.lens[m.have++]=st}}if(m.mode===ur)break;if(m.lens[256]===0){d.msg="invalid code -- missing end-of-block",m.mode=ur;break}if(m.lenbits=9,Rt={bits:m.lenbits},jt=Vl(1,m.lens,0,m.nlen,m.lencode,0,m.work,Rt),m.lenbits=Rt.bits,jt){d.msg="invalid literal/lengths set",m.mode=ur;break}if(m.distbits=6,m.distcode=m.distdyn,Rt={bits:m.distbits},jt=Vl(2,m.lens,m.nlen,m.ndist,m.distcode,0,m.work,Rt),m.distbits=Rt.bits,jt){d.msg="invalid distances set",m.mode=ur;break}if(m.mode=xf,D===pf)break e;case xf:m.mode=vf;case vf:if(ne>=6&&Be>=258){d.next_out=De,d.avail_out=Be,d.next_in=Z,d.avail_in=ne,m.hold=ie,m.bits=ce,dA(d,Je),De=d.next_out,G=d.output,Be=d.avail_out,Z=d.next_in,W=d.input,ne=d.avail_in,ie=m.hold,ce=m.bits,m.mode===ri&&(m.back=-1);break}for(m.back=0;Ot=(bt=m.lencode[ie&(1<<m.lenbits)-1])>>>16&255,He=65535&bt,!((yt=bt>>>24)<=ce);){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(Ot&&!(240&Ot)){for(We=yt,ct=Ot,Jt=He;Ot=(bt=m.lencode[Jt+((ie&(1<<We+ct)-1)>>We)])>>>16&255,He=65535&bt,!(We+(yt=bt>>>24)<=ce);){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}ie>>>=We,ce-=We,m.back+=We}if(ie>>>=yt,ce-=yt,m.back+=yt,m.length=He,Ot===0){m.mode=16205;break}if(32&Ot){m.back=-1,m.mode=ri;break}if(64&Ot){d.msg="invalid literal/length code",m.mode=ur;break}m.extra=15&Ot,m.mode=16201;case 16201:if(m.extra){for(pt=m.extra;ce<pt;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.length+=ie&(1<<m.extra)-1,ie>>>=m.extra,ce-=m.extra,m.back+=m.extra}m.was=m.length,m.mode=16202;case 16202:for(;Ot=(bt=m.distcode[ie&(1<<m.distbits)-1])>>>16&255,He=65535&bt,!((yt=bt>>>24)<=ce);){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(!(240&Ot)){for(We=yt,ct=Ot,Jt=He;Ot=(bt=m.distcode[Jt+((ie&(1<<We+ct)-1)>>We)])>>>16&255,He=65535&bt,!(We+(yt=bt>>>24)<=ce);){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}ie>>>=We,ce-=We,m.back+=We}if(ie>>>=yt,ce-=yt,m.back+=yt,64&Ot){d.msg="invalid distance code",m.mode=ur;break}m.offset=He,m.extra=15&Ot,m.mode=16203;case 16203:if(m.extra){for(pt=m.extra;ce<pt;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}m.offset+=ie&(1<<m.extra)-1,ie>>>=m.extra,ce-=m.extra,m.back+=m.extra}if(m.offset>m.dmax){d.msg="invalid distance too far back",m.mode=ur;break}m.mode=16204;case 16204:if(Be===0)break e;if(Oe=Je-Be,m.offset>Oe){if((Oe=m.offset-Oe)>m.whave&&m.sane){d.msg="invalid distance too far back",m.mode=ur;break}Oe>m.wnext?(Oe-=m.wnext,Ve=m.wsize-Oe):Ve=m.wnext-Oe,Oe>m.length&&(Oe=m.length),At=m.window}else At=G,Ve=De-m.offset,Oe=m.length;Oe>Be&&(Oe=Be),Be-=Oe,m.length-=Oe;do G[De++]=At[Ve++];while(--Oe);m.length===0&&(m.mode=vf);break;case 16205:if(Be===0)break e;G[De++]=m.length,Be--,m.mode=vf;break;case Ch:if(m.wrap){for(;ce<32;){if(ne===0)break e;ne--,ie|=W[Z++]<<ce,ce+=8}if(Je-=Be,d.total_out+=Je,m.total+=Je,4&m.wrap&&Je&&(d.adler=m.check=m.flags?X(m.check,G,Je,De-Je):C(m.check,G,Je,De-Je)),Je=Be,4&m.wrap&&(m.flags?ie:Vx(ie))!==m.check){d.msg="incorrect data check",m.mode=ur;break}ie=0,ce=0}m.mode=16207;case 16207:if(m.wrap&&m.flags){for(;ce<32;){if(ne===0)break e;ne--,ie+=W[Z++]<<ce,ce+=8}if(4&m.wrap&&ie!==(4294967295&m.total)){d.msg="incorrect length check",m.mode=ur;break}ie=0,ce=0}m.mode=16208;case 16208:jt=vA;break e;case ur:jt=$x;break e;case 16210:return Gx;default:return ba}return d.next_out=De,d.avail_out=Be,d.next_in=Z,d.avail_in=ne,m.hold=ie,m.bits=ce,(m.wsize||Je!==d.avail_out&&m.mode<ur&&(m.mode<Ch||D!==Wx))&&Jx(d,d.output,d.next_out,Je-d.avail_out),Ct-=d.avail_in,Je-=d.avail_out,d.total_in+=Ct,d.total_out+=Je,m.total+=Je,4&m.wrap&&Je&&(d.adler=m.check=m.flags?X(m.check,G,Je,d.next_out-Je):C(m.check,G,Je,d.next_out-Je)),d.data_type=m.bits+(m.last?64:0)+(m.mode===ri?128:0)+(m.mode===xf||m.mode===Dh?256:0),(Ct===0&&Je===0||D===Wx)&&jt===_s&&(jt=wA),jt},inflateEnd:function(d){if(Ts(d))return ba;var D=d.state;return D.window&&(D.window=null),d.state=null,_s},inflateGetHeader:function(d,D){if(Ts(d))return ba;var m=d.state;return 2&m.wrap?(m.head=D,D.done=!1,_s):ba},inflateSetDictionary:function(d,D){var m,W=D.length;return Ts(d)||(m=d.state).wrap!==0&&m.mode!==gf?ba:m.mode===gf&&C(1,D,W,0)!==m.check?$x:Jx(d,D,W,W)?(m.mode=16210,Gx):(m.havedict=1,_s)},inflateInfo:"pako inflate (from Nodeca project)"},_A=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},ev=Object.prototype.toString,TA=K.Z_NO_FLUSH,SA=K.Z_FINISH,Yl=K.Z_OK,Fh=K.Z_STREAM_END,Ph=K.Z_NEED_DICT,AA=K.Z_STREAM_ERROR,tv=K.Z_DATA_ERROR,NA=K.Z_MEM_ERROR;function Xl(d){this.options=Ne({chunkSize:65536,windowBits:15,to:""},d||{});var D=this.options;D.raw&&D.windowBits>=0&&D.windowBits<16&&(D.windowBits=-D.windowBits,D.windowBits===0&&(D.windowBits=-15)),!(D.windowBits>=0&&D.windowBits<16)||d&&d.windowBits||(D.windowBits+=32),D.windowBits>15&&D.windowBits<48&&!(15&D.windowBits)&&(D.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Xe,this.strm.avail_out=0;var m=ni.inflateInit2(this.strm,D.windowBits);if(m!==Yl)throw new Error(te[m]);if(this.header=new _A,ni.inflateGetHeader(this.strm,this.header),D.dictionary&&(typeof D.dictionary=="string"?D.dictionary=qe(D.dictionary):ev.call(D.dictionary)==="[object ArrayBuffer]"&&(D.dictionary=new Uint8Array(D.dictionary)),D.raw&&(m=ni.inflateSetDictionary(this.strm,D.dictionary))!==Yl))throw new Error(te[m])}function Ih(d,D){var m=new Xl(D);if(m.push(d),m.err)throw m.msg||te[m.err];return m.result}Xl.prototype.push=function(d,D){var m,W,G,Z=this.strm,De=this.options.chunkSize,ne=this.options.dictionary;if(this.ended)return!1;for(W=D===~~D?D:D===!0?SA:TA,ev.call(d)==="[object ArrayBuffer]"?Z.input=new Uint8Array(d):Z.input=d,Z.next_in=0,Z.avail_in=Z.input.length;;){for(Z.avail_out===0&&(Z.output=new Uint8Array(De),Z.next_out=0,Z.avail_out=De),(m=ni.inflate(Z,W))===Ph&&ne&&((m=ni.inflateSetDictionary(Z,ne))===Yl?m=ni.inflate(Z,W):m===tv&&(m=Ph));Z.avail_in>0&&m===Fh&&Z.state.wrap>0&&d[Z.next_in]!==0;)ni.inflateReset(Z),m=ni.inflate(Z,W);switch(m){case AA:case tv:case Ph:case NA:return this.onEnd(m),this.ended=!0,!1}if(G=Z.avail_out,Z.next_out&&(Z.avail_out===0||m===Fh))if(this.options.to==="string"){var Be=Le(Z.output,Z.next_out),ie=Z.next_out-Be,ce=Qe(Z.output,Be);Z.next_out=ie,Z.avail_out=De-ie,ie&&Z.output.set(Z.output.subarray(Be,Be+ie),0),this.onData(ce)}else this.onData(Z.output.length===Z.next_out?Z.output:Z.output.subarray(0,Z.next_out));if(m!==Yl||G!==0){if(m===Fh)return m=ni.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,!0;if(Z.avail_in===0)break}}return!0},Xl.prototype.onData=function(d){this.chunks.push(d)},Xl.prototype.onEnd=function(d){d===Yl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=he(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};var yf={Inflate:Xl,inflate:Ih,inflateRaw:function(d,D){return(D=D||{}).raw=!0,Ih(d,D)},ungzip:Ih},rv=ff.Deflate,nv=ff.deflate,av=ff.deflateRaw,iv=ff.gzip,sv=yf.Inflate,ov=yf.inflate,lv=yf.inflateRaw,uv=yf.ungzip,cv=K,DA={Deflate:rv,deflate:nv,deflateRaw:av,gzip:iv,Inflate:sv,inflate:ov,inflateRaw:lv,ungzip:uv,constants:cv};r.Deflate=rv,r.Inflate=sv,r.constants=cv,r.default=DA,r.deflate=nv,r.deflateRaw=av,r.gzip=iv,r.inflate=ov,r.inflateRaw=lv,r.ungzip=uv,Object.defineProperty(r,"__esModule",{value:!0})})}(Kf,Kf.exports)),Kf.exports}var Z2;function Ik(){if(Z2)return Ns;Z2=1;var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",t=Pk();return Ns.uncompressInputType=e?"uint8array":"array",Ns.compressInputType=e?"uint8array":"array",Ns.magic="\b\0",Ns.compress=function(r,n){return t.deflateRaw(r,{level:n.level||-1})},Ns.uncompress=function(r){return t.inflateRaw(r)},Ns}var Q2;function J1(){return Q2||(Q2=1,Xf.STORE={magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},Xf.DEFLATE=Ik()),Xf}var ex={exports:{}};ex.exports=function(e,t){return typeof e=="number"?Buffer.alloc(e):Buffer.from(e,t)};ex.exports.test=function(e){return Buffer.isBuffer(e)};var tx=ex.exports;(function(e){function t(c){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},t(c)}var r=fn,n=J1(),a=tx;e.string2binary=function(c){for(var h="",p=0;p<c.length;p++)h+=String.fromCharCode(c.charCodeAt(p)&255);return h},e.arrayBuffer2Blob=function(c,h){e.checkSupport("blob"),h=h||"application/zip";try{return new Blob([c],{type:h})}catch{try{var p=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,v=new p;return v.append(c),v.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}};function i(c){return c}function s(c,h){for(var p=0;p<c.length;++p)h[p]=c.charCodeAt(p)&255;return h}function o(c){var h=65536,p=[],v=c.length,E=e.getTypeOf(c),g=0,w=!0;try{switch(E){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0));break}}catch{w=!1}if(!w){for(var x="",y=0;y<c.length;y++)x+=String.fromCharCode(c[y]);return x}for(;g<v&&h>1;)try{E==="array"||E==="nodebuffer"?p.push(String.fromCharCode.apply(null,c.slice(g,Math.min(g+h,v)))):p.push(String.fromCharCode.apply(null,c.subarray(g,Math.min(g+h,v)))),g+=h}catch{h=Math.floor(h/2)}return p.join("")}e.applyFromCharCode=o;function l(c,h){for(var p=0;p<c.length;p++)h[p]=c[p];return h}var u={};u.string={string:i,array:function(h){return s(h,new Array(h.length))},arraybuffer:function(h){return u.string.uint8array(h).buffer},uint8array:function(h){return s(h,new Uint8Array(h.length))},nodebuffer:function(h){return s(h,a(h.length))}},u.array={string:o,array:i,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a(h)}},u.arraybuffer={string:function(h){return o(new Uint8Array(h))},array:function(h){return l(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:i,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a(new Uint8Array(h))}},u.uint8array={string:o,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:i,nodebuffer:function(h){return a(h)}},u.nodebuffer={string:o,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return u.nodebuffer.uint8array(h).buffer},uint8array:function(h){return l(h,new Uint8Array(h.length))},nodebuffer:i},e.transformTo=function(c,h){if(h||(h=""),!c)return h;e.checkSupport(c);var p=e.getTypeOf(h),v=u[p][c](h);return v},e.getTypeOf=function(c){if(c!=null){if(typeof c=="string")return"string";var h=Object.prototype.toString.call(c);if(h==="[object Array]")return"array";if(r.nodebuffer&&a.test(c))return"nodebuffer";if(r.uint8array&&h==="[object Uint8Array]")return"uint8array";if(r.arraybuffer&&h==="[object ArrayBuffer]")return"arraybuffer";if(h==="[object Promise]")throw new Error("Cannot read data from a promise, you probably are running new PizZip(data) with a promise");if(t(c)==="object"&&typeof c.file=="function")throw new Error("Cannot read data from a pizzip instance, you probably are running new PizZip(zip) with a zipinstance");if(h==="[object Date]")throw new Error("Cannot read data from a Date, you probably are running new PizZip(data) with a date");if(t(c)==="object"&&c.crc32==null)throw new Error("Unsupported data given to new PizZip(data) (object given)")}},e.checkSupport=function(c){var h=r[c.toLowerCase()];if(!h)throw new Error(c+" is not supported by this browser")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(c){var h="",p,v;for(v=0;v<(c||"").length;v++)p=c.charCodeAt(v),h+="\\x"+(p<16?"0":"")+p.toString(16).toUpperCase();return h},e.findCompression=function(c){for(var h in n)if(n.hasOwnProperty(h)&&n[h].magic===c)return n[h];return null},e.isRegExp=function(c){return Object.prototype.toString.call(c)==="[object RegExp]"},e.extend=function(){var c={},h,p;for(h=0;h<arguments.length;h++)for(p in arguments[h])arguments[h].hasOwnProperty(p)&&typeof c[p]>"u"&&(c[p]=arguments[h][p]);return c}})(xa);var Rk=xa,jk=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],Mk=function(t,r){if(typeof t>"u"||!t.length)return 0;var n=Rk.getTypeOf(t)!=="string";typeof r>"u"&&(r=0);var a=0,i=0,s=0;r^=-1;for(var o=0,l=t.length;o<l;o++)s=n?t[o]:t.charCodeAt(o),i=(r^s)&255,a=jk[i],r=r>>>8^a;return r^-1},xs={};xs.LOCAL_FILE_HEADER="PK";xs.CENTRAL_FILE_HEADER="PK";xs.CENTRAL_DIRECTORY_END="PK";xs.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";xs.ZIP64_CENTRAL_DIRECTORY_END="PK";xs.DATA_DESCRIPTOR="PK\x07\b";var va={};va.base64=!1;va.binary=!1;va.dir=!1;va.createFolders=!1;va.date=null;va.compression=null;va.compressionOptions=null;va.comment=null;va.unixPermissions=null;va.dosPermissions=null;function cT(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}cT.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};var fT=cT,rh={},Ng=xa,Bu=fn,Lk=tx,bc=new Array(256);for(var Oi=0;Oi<256;Oi++)bc[Oi]=Oi>=252?6:Oi>=248?5:Oi>=240?4:Oi>=224?3:Oi>=192?2:1;bc[254]=bc[254]=1;function Bk(e){var t,r,n,a,i,s=0,o=e.length;for(a=0;a<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(Bu.uint8array?t=new Uint8Array(s):t=new Array(s),i=0,a=0;i<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t}function Uk(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+bc[e[r]]>t?r:t}function J2(e){var t,r,n,a,i=e.length,s=new Array(i*2);for(r=0,t=0;t<i;){if(n=e[t++],n<128){s[r++]=n;continue}if(a=bc[n],a>4){s[r++]=65533,t+=a-1;continue}for(n&=a===2?31:a===3?15:7;a>1&&t<i;)n=n<<6|e[t++]&63,a--;if(a>1){s[r++]=65533;continue}n<65536?s[r++]=n:(n-=65536,s[r++]=55296|n>>10&1023,s[r++]=56320|n&1023)}return s.length!==r&&(s.subarray?s=s.subarray(0,r):s.length=r),Ng.applyFromCharCode(s)}rh.utf8encode=function(t){return Bu.nodebuffer?Lk(t,"utf-8"):Bk(t)};rh.utf8decode=function(t){if(Bu.nodebuffer)return Ng.transformTo("nodebuffer",t).toString("utf-8");t=Ng.transformTo(Bu.uint8array?"uint8array":"array",t);for(var r=[],n=t.length,a=65536,i=0;i<n;){var s=Uk(t,Math.min(i+a,n));Bu.uint8array?r.push(J2(t.subarray(i,s))):r.push(J2(t.slice(i,s))),i=s}return r.join("")};var zk=xa;function dT(){this.data=[]}dT.prototype={append:function(t){t=zk.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}};var qk=dT,Wk=xa;function hT(e){this.data=new Uint8Array(e),this.index=0}hT.prototype={append:function(t){t.length!==0&&(t=Wk.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}};var $k=hT;function Gk(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Hk(e))||t){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(u){throw u},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var u=r.next();return s=u.done,u},e:function(u){o=!0,i=u},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw i}}}}function Hk(e,t){if(e){if(typeof e=="string")return ey(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ey(e,t):void 0}}function ey(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Vk=fn,tr=xa,rx=Mk,Dg=xs,Yk=va,pT=Kc,Cg=J1(),pd=fT,Xk=tx,ul=rh,Kk=qk,Zk=$k;function mT(e){if(e._data instanceof pd&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,tr.getTypeOf(e._data)==="uint8array")){var t=e._data;e._data=new Uint8Array(t.length),t.length!==0&&e._data.set(t,0)}return e._data}function kg(e){var t=mT(e),r=tr.getTypeOf(t);return r==="string"?!e.options.binary&&Vk.nodebuffer?Xk(t,"utf-8"):e.asBinary():t}var Og={load:function(){throw new Error("Load method is not defined. Is the file pizzip-load.js included ?")},filter:function(t){var r=[],n,a,i,s;for(n in this.files)this.files.hasOwnProperty(n)&&(i=this.files[n],s=new nx(i.name,i._data,tr.extend(i.options)),a=n.slice(this.root.length,n.length),n.slice(0,this.root.length)===this.root&&t(a,s)&&r.push(s));return r},file:function(t,r,n){if(arguments.length===1){if(tr.isRegExp(t)){var a=t;return this.filter(function(i,s){return!s.dir&&a.test(i)})}return this.filter(function(i,s){return!s.dir&&i===t})[0]||null}return t=this.root+t,gT.call(this,t,r,n),this},folder:function(t){if(!t)return this;if(tr.isRegExp(t))return this.filter(function(i,s){return s.dir&&t.test(i)});var r=this.root+t,n=vT.call(this,r),a=this.shallowClone();return a.root=n.name,a},remove:function(t){t=this.root+t;var r=this.files[t];if(r||(t.slice(-1)!=="/"&&(t+="/"),r=this.files[t]),r&&!r.dir)delete this.files[t];else for(var n=this.filter(function(i,s){return s.name.slice(0,t.length)===t}),a=0;a<n.length;a++)delete this.files[n[a].name];return this},generate:function(t){t=tr.extend(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:ul.utf8encode}),tr.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var r=[],n=tr.transformTo("string",t.encodeFileName(t.comment||this.comment||"")),a=0,i=0,s,o,l=[];t.fileOrder instanceof Array&&(l=t.fileOrder);for(var u in this.files)l.indexOf(u)===-1&&l.push(u);typeof t.fileOrder=="function"&&(l=t.fileOrder(this.files));var c=Gk(l),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;if(this.files.hasOwnProperty(p)){var v=this.files[p],E=v.options.compression||t.compression.toUpperCase(),g=Cg[E];if(!g)throw new Error(E+" is not a valid compression method !");var w=v.options.compressionOptions||t.compressionOptions||{},x=e6.call(this,v,g,w),y=n6.call(this,p,v,x,a,t.platform,t.encodeFileName);a+=y.fileRecord.length+x.compressedSize,i+=y.dirRecord.length,r.push(y)}}}catch(k){c.e(k)}finally{c.f()}var b="";b=Dg.CENTRAL_DIRECTORY_END+"\0\0\0\0"+xr(r.length,2)+xr(r.length,2)+xr(i,4)+xr(a,4)+xr(n.length,2)+n;var _=t.type.toLowerCase();for(_==="uint8array"||_==="arraybuffer"||_==="blob"||_==="nodebuffer"?s=new Zk(a+i+b.length):s=new Kk(a+i+b.length),o=0;o<r.length;o++)s.append(r[o].fileRecord),s.append(r[o].compressedObject.compressedContent);for(o=0;o<r.length;o++)s.append(r[o].dirRecord);s.append(b);var N=s.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return tr.transformTo(t.type.toLowerCase(),N);case"blob":return tr.arrayBuffer2Blob(tr.transformTo("arraybuffer",N),t.mimeType);case"base64":return t.base64?pT.encode(N):N;default:return N}},crc32:function(t,r){return rx(t,r)},utf8encode:function(t){return tr.transformTo("string",ul.utf8encode(t))},utf8decode:function(t){return ul.utf8decode(t)}};function ty(e){var t=mT(this);return t===null||typeof t>"u"?"":(this.options.base64&&(t=pT.decode(t)),e&&this.options.binary?t=Og.utf8decode(t):t=tr.transformTo("string",t),!e&&!this.options.binary&&(t=tr.transformTo("string",Og.utf8encode(t))),t)}function nx(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}}nx.prototype={asText:function(){return ty.call(this,!0)},asBinary:function(){return ty.call(this,!1)},asNodeBuffer:function(){var t=kg(this);return tr.transformTo("nodebuffer",t)},asUint8Array:function(){var t=kg(this);return tr.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};function xr(e,t){var r="",n;for(n=0;n<t;n++)r+=String.fromCharCode(e&255),e>>>=8;return r}function Qk(e){return e=e||{},e.base64===!0&&(e.binary===null||e.binary===void 0)&&(e.binary=!0),e=tr.extend(e,Yk),e.date=e.date||new Date,e.compression!==null&&(e.compression=e.compression.toUpperCase()),e}function gT(e,t,r){var n=tr.getTypeOf(t),a;if(r=Qk(r),typeof r.unixPermissions=="string"&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&r.unixPermissions&16384&&(r.dir=!0),r.dosPermissions&&r.dosPermissions&16&&(r.dir=!0),r.dir&&(e=xT(e)),r.createFolders&&(a=Jk(e))&&vT.call(this,a,!0),r.dir||t===null||typeof t>"u")r.base64=!1,r.binary=!1,t=null,n=null;else if(n==="string")r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(t=tr.string2binary(t));else{if(r.base64=!1,r.binary=!0,!n&&!(t instanceof pd))throw new Error("The data of '"+e+"' is in an unsupported format !");n==="arraybuffer"&&(t=tr.transformTo("uint8array",t))}var i=new nx(e,t,r);return this.files[e]=i,i}function Jk(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""}function xT(e){return e.slice(-1)!=="/"&&(e+="/"),e}function vT(e,t){return t=typeof t<"u"?t:!1,e=xT(e),this.files[e]||gT.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}function e6(e,t,r){var n=new pd,a;return e._data instanceof pd?(n.uncompressedSize=e._data.uncompressedSize,n.crc32=e._data.crc32,n.uncompressedSize===0||e.dir?(t=Cg.STORE,n.compressedContent="",n.crc32=0):e._data.compressionMethod===t.magic?n.compressedContent=e._data.getCompressedContent():(a=e._data.getContent(),n.compressedContent=t.compress(tr.transformTo(t.compressInputType,a),r))):(a=kg(e),(!a||a.length===0||e.dir)&&(t=Cg.STORE,a=""),n.uncompressedSize=a.length,n.crc32=rx(a),n.compressedContent=t.compress(tr.transformTo(t.compressInputType,a),r)),n.compressedSize=n.compressedContent.length,n.compressionMethod=t.magic,n}function t6(e,t){var r=e;return e||(r=t?16893:33204),(r&65535)<<16}function r6(e){return(e||0)&63}function n6(e,t,r,n,a,i){var s=i!==ul.utf8encode,o=tr.transformTo("string",i(t.name)),l=tr.transformTo("string",ul.utf8encode(t.name)),u=t.comment||"",c=tr.transformTo("string",i(u)),h=tr.transformTo("string",ul.utf8encode(u)),p=l.length!==t.name.length,v=h.length!==u.length,E=t.options,g,w,x="",y="",b="",_,N;t._initialMetadata.dir!==t.dir?_=t.dir:_=E.dir,t._initialMetadata.date!==t.date?N=t.date:N=E.date;var k=0,T=0;_&&(k|=16),a==="UNIX"?(T=798,k|=t6(t.unixPermissions,_)):(T=20,k|=r6(t.dosPermissions)),g=N.getHours(),g<<=6,g|=N.getMinutes(),g<<=5,g|=N.getSeconds()/2,w=N.getFullYear()-1980,w<<=4,w|=N.getMonth()+1,w<<=5,w|=N.getDate(),p&&(y=xr(1,1)+xr(rx(o),4)+l,x+="up"+xr(y.length,2)+y),v&&(b=xr(1,1)+xr(this.crc32(c),4)+h,x+="uc"+xr(b.length,2)+b);var A="";A+=`
\0`,A+=!s&&(p||v)?"\0\b":"\0\0",A+=r.compressionMethod,A+=xr(g,2),A+=xr(w,2),A+=xr(r.crc32,4),A+=xr(r.compressedSize,4),A+=xr(r.uncompressedSize,4),A+=xr(o.length,2),A+=xr(x.length,2);var S=Dg.LOCAL_FILE_HEADER+A+o+x,P=Dg.CENTRAL_FILE_HEADER+xr(T,2)+A+xr(c.length,2)+"\0\0\0\0"+xr(k,4)+xr(n,4)+o+x+c;return{fileRecord:S,dirRecord:P,compressedObject:r}}var yT=Og,a6=xa;function wT(){this.data=null,this.length=0,this.index=0,this.zero=0}wT.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var r=0,n;for(this.checkOffset(t),n=this.index+t-1;n>=this.index;n--)r=(r<<8)+this.byteAt(n);return this.index+=t,r},readString:function(t){return a6.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1)}};var bT=wT,i6=bT,s6=xa;function Zc(e,t){this.data=e,t||(this.data=s6.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}Zc.prototype=new i6;Zc.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};Zc.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};Zc.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var ET=Zc,o6=bT;function Qc(e){if(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0;for(var t=0;t<this.data.length;t++)e[t]&=e[t]}}Qc.prototype=new o6;Qc.prototype.byteAt=function(e){return this.data[this.zero+e]};Qc.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),i=this.length-4;i>=0;--i)if(this.data[i]===t&&this.data[i+1]===r&&this.data[i+2]===n&&this.data[i+3]===a)return i-this.zero;return-1};Qc.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var _T=Qc,l6=_T;function ax(e){e&&(this.data=e,this.length=this.data.length,this.index=0,this.zero=0)}ax.prototype=new l6;ax.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var TT=ax,u6=TT;function ix(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0}ix.prototype=new u6;ix.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var c6=ix,gp=ET,_a=xa,f6=fT,Ds=yT,d6=fn,h6=0,p6=3;function ST(e,t){this.options=e,this.loadOptions=t}ST.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(t,r,n){return function(){var a=t.index;t.setIndex(r);var i=t.readData(n);return t.setIndex(a),i}},prepareContent:function(t,r,n,a,i){return function(){var s=_a.transformTo(a.uncompressInputType,this.getCompressedContent()),o=a.uncompress(s);if(o.length!==i)throw new Error("Bug : uncompressed data size mismatch");return o}},readLocalPart:function(t){t.skip(22),this.fileNameLength=t.readInt(2);var r=t.readInt(2);if(this.fileName=t.readData(this.fileNameLength),t.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");var n=_a.findCompression(this.compressionMethod);if(n===null)throw new Error("Corrupted zip : compression "+_a.pretty(this.compressionMethod)+" unknown (inner file : "+_a.transformTo("string",this.fileName)+")");if(this.decompressed=new f6,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,n),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,n,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=_a.transformTo("string",this.decompressed.getContent()),Ds.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readData(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),t===h6&&(this.dosPermissions=this.externalFileAttributes&63),t===p6&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=new gp(this.extraFields[1].value);this.uncompressedSize===_a.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===_a.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===_a.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===_a.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var r=t.index,n,a,i;for(this.extraFields=this.extraFields||{};t.index<r+this.extraFieldsLength;)n=t.readInt(2),a=t.readInt(2),i=t.readString(a),this.extraFields[n]={id:n,length:a,value:i}},handleUTF8:function(){var t=d6.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Ds.utf8decode(this.fileName),this.fileCommentStr=Ds.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var n=_a.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var a=this.findExtraFieldUnicodeComment();if(a!==null)this.fileCommentStr=a;else{var i=_a.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var r=new gp(t.value);return r.readInt(1)!==1||Ds.crc32(this.fileName)!==r.readInt(4)?null:Ds.utf8decode(r.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var r=new gp(t.value);return r.readInt(1)!==1||Ds.crc32(this.fileComment)!==r.readInt(4)?null:Ds.utf8decode(r.readString(t.length-5))}return null}};var m6=ST,g6=ET,x6=c6,v6=TT,y6=_T,qn=xa,Ta=xs,w6=m6,Zf=fn;function AT(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}AT.prototype={checkSignature:function(t){var r=this.reader.readString(4);if(r!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+qn.pretty(r)+", expected "+qn.pretty(t)+")")},isSignature:function(t,r){var n=this.reader.index;this.reader.setIndex(t);var a=this.reader.readString(4),i=a===r;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),r=Zf.uint8array?"uint8array":"array",n=qn.transformTo(r,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t=this.zip64EndOfCentralSize-44,r=0,n,a,i;r<t;)n=this.reader.readInt(2),a=this.reader.readInt(4),i=this.reader.readString(a),this.zip64ExtensibleData[n]={id:n,length:a,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,r;for(t=0;t<this.files.length;t++)r=this.files[t],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(Ta.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===Ta.CENTRAL_FILE_HEADER;)t=new w6({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(Ta.CENTRAL_DIRECTORY_END);if(t<0){var r=!this.isSignature(0,Ta.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ?"):new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(t);var n=t;if(this.checkSignature(Ta.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===qn.MAX_VALUE_16BITS||this.diskWithCentralDirStart===qn.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===qn.MAX_VALUE_16BITS||this.centralDirRecords===qn.MAX_VALUE_16BITS||this.centralDirSize===qn.MAX_VALUE_32BITS||this.centralDirOffset===qn.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(Ta.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(Ta.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Ta.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Ta.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Ta.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);var i=n-a;if(i>0)this.isSignature(n,Ta.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){var r=qn.getTypeOf(t);if(qn.checkSupport(r),r==="string"&&!Zf.uint8array)this.reader=new g6(t,this.loadOptions.optimizedBinaryString);else if(r==="nodebuffer")this.reader=new x6(t);else if(Zf.uint8array)this.reader=new v6(qn.transformTo("uint8array",t));else if(Zf.array)this.reader=new y6(qn.transformTo("array",t));else throw new Error("Unexpected error: unsupported type '"+r+"'")},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var b6=AT,E6=Kc,_6=rh,T6=xa,S6=b6,A6=function(e,t){var r,n;t=T6.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:_6.utf8decode}),t.base64&&(e=E6.decode(e));var a=new S6(e,t),i=a.files;for(r=0;r<i.length;r++)n=i[r],this.file(n.fileNameStr,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:t.createFolders});return a.zipComment.length&&(this.comment=a.zipComment),this},Ln={},Rn=xa;Ln.string2binary=function(e){return Rn.string2binary(e)};Ln.string2Uint8Array=function(e){return Rn.transformTo("uint8array",e)};Ln.uint8Array2String=function(e){return Rn.transformTo("string",e)};Ln.string2Blob=function(e){var t=Rn.transformTo("arraybuffer",e);return Rn.arrayBuffer2Blob(t)};Ln.arrayBuffer2Blob=function(e){return Rn.arrayBuffer2Blob(e)};Ln.transformTo=function(e,t){return Rn.transformTo(e,t)};Ln.getTypeOf=function(e){return Rn.getTypeOf(e)};Ln.checkSupport=function(e){return Rn.checkSupport(e)};Ln.MAX_VALUE_16BITS=Rn.MAX_VALUE_16BITS;Ln.MAX_VALUE_32BITS=Rn.MAX_VALUE_32BITS;Ln.pretty=function(e){return Rn.pretty(e)};Ln.findCompression=function(e){return Rn.findCompression(e)};Ln.isRegExp=function(e){return Rn.isRegExp(e)};(function(e){var t=Kc;function r(n,a){if(!(this instanceof r))return new r(n,a);this.files={},this.comment=null,this.root="",n&&this.load(n,a),this.clone=function(){var i=this,s=new r;return Object.keys(this.files).forEach(function(o){s.file(o,i.files[o].asUint8Array())}),s},this.shallowClone=function(){var i=new r;for(var s in this)typeof this[s]!="function"&&(i[s]=this[s]);return i}}r.prototype=yT,r.prototype.load=A6,r.support=fn,r.defaults=va,r.utils=Ln,r.base64={encode:function(a){return t.encode(a)},decode:function(a){return t.decode(a)}},r.compressions=J1(),e.exports=r,e.exports.default=r})(uT);var N6=uT.exports;const D6=zg(N6);var NT={exports:{}},Lt={},br={};function C6(e,t,r){if(r===void 0&&(r=Array.prototype),e&&typeof r.find=="function")return r.find.call(e,t);for(var n=0;n<e.length;n++)if(ho(e,n)){var a=e[n];if(t.call(void 0,a,n,e))return a}}function Il(e,t){return t===void 0&&(t=Object),t&&typeof t.getOwnPropertyDescriptors=="function"&&(e=t.create(null,t.getOwnPropertyDescriptors(e))),t&&typeof t.freeze=="function"?t.freeze(e):e}function ho(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function k6(e,t){if(e===null||typeof e!="object")throw new TypeError("target is not an object");for(var r in t)ho(t,r)&&(e[r]=t[r]);return e}var DT=Il({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function O6(e){return ho(DT,e.toLowerCase())}var CT=Il({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function F6(e){return ho(CT,e.toLowerCase())}var Ec=Il({script:!1,style:!1,textarea:!0,title:!0});function P6(e){var t=e.toLowerCase();return ho(Ec,t)&&!Ec[t]}function I6(e){var t=e.toLowerCase();return ho(Ec,t)&&Ec[t]}function kT(e){return e===_c.HTML}function R6(e){return kT(e)||e===_c.XML_XHTML_APPLICATION}var _c=Il({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),j6=Object.keys(_c).map(function(e){return _c[e]});function M6(e){return j6.indexOf(e)>-1}var L6=Il({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});br.assign=k6;br.find=C6;br.freeze=Il;br.HTML_BOOLEAN_ATTRIBUTES=DT;br.HTML_RAW_TEXT_ELEMENTS=Ec;br.HTML_VOID_ELEMENTS=CT;br.hasDefaultHTMLNamespace=R6;br.hasOwn=ho;br.isHTMLBooleanAttribute=O6;br.isHTMLRawTextElement=P6;br.isHTMLEscapableRawTextElement=I6;br.isHTMLMimeType=kT;br.isHTMLVoidElement=F6;br.isValidMimeType=M6;br.MIME_TYPE=_c;br.NAMESPACE=L6;var vs={},B6=br;function OT(e,t){e.prototype=Object.create(Error.prototype,{constructor:{value:e},name:{value:e.name,enumerable:!0,writable:t}})}var Tc=B6.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),FT=Object.keys(Tc);function PT(e){return typeof e=="number"&&e>=1&&e<=25}function U6(e){return typeof e=="string"&&e.substring(e.length-Tc.Error.length)===Tc.Error}function Jc(e,t){PT(e)?(this.name=FT[e],this.message=t||""):(this.message=e,this.name=U6(t)?t:Tc.Error),Error.captureStackTrace&&Error.captureStackTrace(this,Jc)}OT(Jc,!0);Object.defineProperties(Jc.prototype,{code:{enumerable:!0,get:function(){var e=FT.indexOf(this.name);return PT(e)?e:0}}});var IT={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},xp=Object.entries(IT);for(var Qf=0;Qf<xp.length;Qf++){var z6=xp[Qf][0];Jc[z6]=xp[Qf][1]}function sx(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,sx)}OT(sx);vs.DOMException=Jc;vs.DOMExceptionName=Tc;vs.ExceptionCode=IT;vs.ParseError=sx;var Er={},_t={};function RT(e){try{typeof e!="function"&&(e=RegExp);var t=new e("","u").exec("");return!!t&&t[0].length===2}catch{}return!1}var ef=RT();function no(e){if(e.source[0]!=="[")throw new Error(e+" can not be used with chars");return e.source.slice(1,e.source.lastIndexOf("]"))}function Tl(e,t){if(e.source[0]!=="[")throw new Error("/"+e.source+"/ can not be used with chars_without");if(!t||typeof t!="string")throw new Error(JSON.stringify(t)+" is not a valid search");if(e.source.indexOf(t)===-1)throw new Error('"'+t+'" is not is /'+e.source+"/");if(t==="-"&&e.source.indexOf(t)!==1)throw new Error('"'+t+'" is not at the first postion of /'+e.source+"/");return new RegExp(e.source.replace(t,""),ef?"u":"")}function Ft(e){var t=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(r){var n=typeof r=="string";if(n&&t===void 0&&r==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return n?r:r.source}).join(""),ef?"mu":"m")}function gt(e){if(arguments.length===0)throw new Error("no parameters provided");return Ft.apply(gt,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var q6="",ao=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;ef&&(ao=Ft("[",no(ao),"\\u{10000}-\\u{10FFFF}","]"));var ox=/[\x20\x09\x0D\x0A]/,W6=no(ox),Xt=Ft(ox,"+"),hr=Ft(ox,"*"),Sc=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;ef&&(Sc=Ft("[",no(Sc),"\\u{10000}-\\u{10FFFF}","]"));var $6=no(Sc),lx=Ft("[",$6,no(/[-.0-9\xB7]/),no(/[\u0300-\u036F\u203F-\u2040]/),"]"),ga=Ft(Sc,lx,"*"),ry=Ft(lx,"+"),G6=Ft("&",ga,";"),H6=gt(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),Ac=gt(G6,"|",H6),Nc=Ft("%",ga,";"),ux=gt(Ft('"',gt(/[^%&"]/,"|",Nc,"|",Ac),"*",'"'),"|",Ft("'",gt(/[^%&']/,"|",Nc,"|",Ac),"*","'")),V6=gt('"',gt(/[^<&"]/,"|",Ac),"*",'"',"|","'",gt(/[^<&']/,"|",Ac),"*","'"),Y6=Tl(Sc,":"),X6=Tl(lx,":"),ny=Ft(Y6,X6,"*"),tf=Ft(ny,gt(":",ny),"?"),K6=Ft("^",tf,"$"),Z6=Ft("(",tf,")"),Dc=gt(/"[^"]*"|'[^']*'/),Q6=Ft(/^<\?/,"(",ga,")",gt(Xt,"(",ao,"*?)"),"?",/\?>/),ay=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,nh=gt('"',ay,'*"',"|","'",Tl(ay,"'"),"*'"),jT="<!--",MT="-->",J6=Ft(jT,gt(Tl(ao,"-"),"|",Ft("-",Tl(ao,"-"))),"*",MT),iy="#PCDATA",e8=gt(Ft(/\(/,hr,iy,gt(hr,/\|/,hr,tf),"*",hr,/\)\*/),"|",Ft(/\(/,hr,iy,hr,/\)/)),t8=/[?*+]?/,r8=Ft(/\([^>]+\)/,t8),n8=gt("EMPTY","|","ANY","|",e8,"|",r8),a8="<!ELEMENT",i8=Ft(a8,Xt,gt(tf,"|",Nc),Xt,gt(n8,"|",Nc),hr,">"),s8=Ft("NOTATION",Xt,/\(/,hr,ga,gt(hr,/\|/,hr,ga),"*",hr,/\)/),o8=Ft(/\(/,hr,ry,gt(hr,/\|/,hr,ry),"*",hr,/\)/),l8=gt(s8,"|",o8),u8=gt(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",l8),c8=gt(/#REQUIRED|#IMPLIED/,"|",gt(gt("#FIXED",Xt),"?",V6)),f8=gt(Xt,ga,Xt,u8,Xt,c8),d8="<!ATTLIST",h8=Ft(d8,Xt,ga,f8,"*",hr,">"),Fg="about:legacy-compat",p8=gt('"'+Fg+'"',"|","'"+Fg+"'"),cx="SYSTEM",ah="PUBLIC",ih=gt(gt(cx,Xt,Dc),"|",gt(ah,Xt,nh,Xt,Dc)),m8=Ft("^",gt(gt(cx,Xt,"(?<SystemLiteralOnly>",Dc,")"),"|",gt(ah,Xt,"(?<PubidLiteral>",nh,")",Xt,"(?<SystemLiteral>",Dc,")"))),g8=gt(Xt,"NDATA",Xt,ga),x8=gt(ux,"|",gt(ih,g8,"?")),LT="<!ENTITY",v8=Ft(LT,Xt,ga,Xt,x8,hr,">"),y8=gt(ux,"|",ih),w8=Ft(LT,Xt,"%",Xt,ga,Xt,y8,hr,">"),b8=gt(v8,"|",w8),E8=Ft(ah,Xt,nh),_8=Ft("<!NOTATION",Xt,ga,Xt,gt(ih,"|",E8),hr,">"),fx=Ft(hr,"=",hr),sy=/1[.]\d+/,T8=Ft(Xt,"version",fx,gt("'",sy,"'","|",'"',sy,'"')),oy=/[A-Za-z][-A-Za-z0-9._]*/,S8=gt(Xt,"encoding",fx,gt('"',oy,'"',"|","'",oy,"'")),A8=gt(Xt,"standalone",fx,gt("'",gt("yes","|","no"),"'","|",'"',gt("yes","|","no"),'"')),N8=Ft(/^<\?xml/,T8,S8,"?",A8,"?",hr,/\?>/),D8="<!DOCTYPE",C8="<![CDATA[",k8="]]>",O8=/<!\[CDATA\[/,F8=/\]\]>/,P8=Ft(ao,"*?",F8),I8=Ft(O8,P8);_t.chars=no;_t.chars_without=Tl;_t.detectUnicodeSupport=RT;_t.reg=Ft;_t.regg=gt;_t.ABOUT_LEGACY_COMPAT=Fg;_t.ABOUT_LEGACY_COMPAT_SystemLiteral=p8;_t.AttlistDecl=h8;_t.CDATA_START=C8;_t.CDATA_END=k8;_t.CDSect=I8;_t.Char=ao;_t.Comment=J6;_t.COMMENT_START=jT;_t.COMMENT_END=MT;_t.DOCTYPE_DECL_START=D8;_t.elementdecl=i8;_t.EntityDecl=b8;_t.EntityValue=ux;_t.ExternalID=ih;_t.ExternalID_match=m8;_t.Name=ga;_t.NotationDecl=_8;_t.Reference=Ac;_t.PEReference=Nc;_t.PI=Q6;_t.PUBLIC=ah;_t.PubidLiteral=nh;_t.QName=tf;_t.QName_exact=K6;_t.QName_group=Z6;_t.S=Xt;_t.SChar_s=W6;_t.S_OPT=hr;_t.SYSTEM=cx;_t.SystemLiteral=Dc;_t.UNICODE_REPLACEMENT_CHARACTER=q6;_t.UNICODE_SUPPORT=ef;_t.XMLDecl=N8;var ha=br,Za=ha.find,R8=ha.hasDefaultHTMLNamespace,Sl=ha.hasOwn,j8=ha.isHTMLMimeType,M8=ha.isHTMLRawTextElement,L8=ha.isHTMLVoidElement,wu=ha.MIME_TYPE,Qa=ha.NAMESPACE,xn=Symbol(),BT=vs,ut=BT.DOMException,B8=BT.DOMExceptionName,Va=_t;function Bn(e){if(e!==xn)throw new TypeError("Illegal constructor")}function U8(e){return e!==""}function z8(e){return e?e.split(/[\t\n\f\r ]+/).filter(U8):[]}function q8(e,t){return Sl(e,t)||(e[t]=!0),e}function ly(e){if(!e)return[];var t=z8(e);return Object.keys(t.reduce(q8,{}))}function W8(e){return function(t){return e&&e.indexOf(t)!==-1}}function UT(e){if(!Va.QName_exact.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+e+'"')}function Pg(e,t){UT(t),e=e||null;var r=null,n=t;if(t.indexOf(":")>=0){var a=t.split(":");r=a[0],n=a[1]}if(r!==null&&e===null)throw new ut(ut.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(r==="xml"&&e!==ha.NAMESPACE.XML)throw new ut(ut.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((r==="xmlns"||t==="xmlns")&&e!==ha.NAMESPACE.XMLNS)throw new ut(ut.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(e===ha.NAMESPACE.XMLNS&&r!=="xmlns"&&t!=="xmlns")throw new ut(ut.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[e,r,n]}function Rl(e,t){for(var r in e)Sl(e,r)&&(t[r]=e[r])}function Un(e,t){var r=e.prototype;if(!(r instanceof t)){let a=function(){};var n=a;a.prototype=t.prototype,a=new a,Rl(r,a),e.prototype=r=a}r.constructor!=e&&(typeof e!="function"&&console.error("unknown Class:"+e),r.constructor=e)}var zn={},Oa=zn.ELEMENT_NODE=1,Al=zn.ATTRIBUTE_NODE=2,md=zn.TEXT_NODE=3,zT=zn.CDATA_SECTION_NODE=4,qT=zn.ENTITY_REFERENCE_NODE=5,$8=zn.ENTITY_NODE=6,WT=zn.PROCESSING_INSTRUCTION_NODE=7,$T=zn.COMMENT_NODE=8,Cc=zn.DOCUMENT_NODE=9,GT=zn.DOCUMENT_TYPE_NODE=10,os=zn.DOCUMENT_FRAGMENT_NODE=11,G8=zn.NOTATION_NODE=12,gr=ha.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function HT(e,t){if(t.length<e.length)return HT(t,e);var r=null;for(var n in e){if(e[n]!==t[n])return r;r=e[n]}return r}function uy(e){return e.guid||(e.guid=Math.random()),e.guid}function Fr(){}Fr.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e){for(var t=[],r=0;r<this.length;r++)Xo(this[r],t,e);return t.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};Fr.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function Hs(e,t){this._node=e,this._refresh=t,sh(this)}function sh(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(aS(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)Sl(e,n)&&delete e[n];Rl(r,e),e._inc=t}}Hs.prototype.item=function(e){return sh(this),this[e]||null};Un(Hs,Fr);function Nl(){}function VT(e,t){for(var r=0;r<e.length;){if(e[r]===t)return r;r++}}function H8(e,t,r,n){if(n?t[VT(t,n)]=r:(t[t.length]=r,t.length++),e){r.ownerElement=e;var a=e.ownerDocument;a&&(n&&KT(a,e,n),V8(a,e,r))}}function cy(e,t,r){var n=VT(t,r);if(n>=0){for(var a=t.length-1;n<=a;)t[n]=t[++n];if(t.length=a,e){var i=e.ownerDocument;i&&KT(i,e,r),r.ownerElement=null}}}Nl.prototype={length:0,item:Fr.prototype.item,getNamedItem:function(e){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());for(var t=0;t<this.length;){var r=this[t];if(r.nodeName===e)return r;t++}return null},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!==this._ownerElement)throw new ut(ut.INUSE_ATTRIBUTE_ERR);var r=this.getNamedItemNS(e.namespaceURI,e.localName);return r===e?e:(H8(this._ownerElement,this,e,r),r)},setNamedItemNS:function(e){return this.setNamedItem(e)},removeNamedItem:function(e){var t=this.getNamedItem(e);if(!t)throw new ut(ut.NOT_FOUND_ERR,e);return cy(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);if(!r)throw new ut(ut.NOT_FOUND_ERR,e?e+" : "+t:t);return cy(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){e||(e=null);for(var r=0;r<this.length;){var n=this[r];if(n.localName===t&&n.namespaceURI===e)return n;r++}return null}};Nl.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function YT(){}YT.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=wu.XML_APPLICATION;e===Qa.HTML?n=wu.XML_XHTML_APPLICATION:e===Qa.SVG&&(n=wu.XML_SVG_IMAGE);var a=new ls(xn,{contentType:n});if(a.implementation=this,a.childNodes=new Fr,a.doctype=r||null,r&&a.appendChild(r),t){var i=a.createElementNS(e,t);a.appendChild(i)}return a},createDocumentType:function(e,t,r,n){UT(e);var a=new uh(xn);return a.name=e,a.nodeName=e,a.publicId=t||"",a.systemId=r||"",a.internalSubset=n||"",a.childNodes=new Fr,a},createHTMLDocument:function(e){var t=new ls(xn,{contentType:wu.HTML});if(t.implementation=this,t.childNodes=new Fr,e!==!1){t.doctype=this.createDocumentType("html"),t.doctype.ownerDocument=t,t.appendChild(t.doctype);var r=t.createElement("html");t.appendChild(r);var n=t.createElement("head");if(r.appendChild(n),typeof e=="string"){var a=t.createElement("title");a.appendChild(t.createTextNode(e)),n.appendChild(a)}r.appendChild(t.createElement("body"))}return t}};function Mt(e){Bn(e)}Mt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var e=this.getRootNode();return e&&e.nodeType===e.DOCUMENT_NODE},contains:function(e){if(!e)return!1;var t=e;do{if(this===t)return!0;t=e.parentNode}while(t);return!1},getRootNode:function(e){var t=this;do{if(!t.parentNode)return t;t=t.parentNode}while(t)},isEqualNode:function(e){if(!e||this.nodeType!==e.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==e.name||this.publicId!==e.publicId||this.systemId!==e.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==e.namespaceURI||this.prefix!==e.prefix||this.localName!==e.localName||this.attributes.length!==e.attributes.length)return!1;for(var t=0;t<this.attributes.length;t++){var r=this.attributes.item(t);if(!r.isEqualNode(e.getAttributeNodeNS(r.namespaceURI,r.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==e.namespaceURI||this.localName!==e.localName||this.value!==e.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==e.target||this.data!==e.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==e.data)return!1;break}if(this.childNodes.length!==e.childNodes.length)return!1;for(var t=0;t<this.childNodes.length;t++)if(!this.childNodes[t].isEqualNode(e.childNodes[t]))return!1;return!0},isSameNode:function(e){return this===e},insertBefore:function(e,t){return gd(this,e,t)},replaceChild:function(e,t){gd(this,e,t,eS),t&&this.removeChild(t)},removeChild:function(e){return QT(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return Ig(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==md&&e.nodeType==md?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r){for(var n in r)if(Sl(r,n)&&r[n]===e)return n}t=t.nodeType==Al?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&Sl(r,e))return r[e];t=t.nodeType==Al?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null},compareDocumentPosition:function(e){if(this===e)return 0;var t=e,r=this,n=null,a=null;if(t instanceof io&&(n=t,t=n.ownerElement),r instanceof io&&(a=r,r=a.ownerElement,n&&t&&r===t))for(var i=0,s;s=r.attributes[i];i++){if(s===n)return gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+gr.DOCUMENT_POSITION_PRECEDING;if(s===a)return gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+gr.DOCUMENT_POSITION_FOLLOWING}if(!t||!r||r.ownerDocument!==t.ownerDocument)return gr.DOCUMENT_POSITION_DISCONNECTED+gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(uy(r.ownerDocument)>uy(t.ownerDocument)?gr.DOCUMENT_POSITION_FOLLOWING:gr.DOCUMENT_POSITION_PRECEDING);if(a&&t===r)return gr.DOCUMENT_POSITION_CONTAINS+gr.DOCUMENT_POSITION_PRECEDING;if(n&&t===r)return gr.DOCUMENT_POSITION_CONTAINED_BY+gr.DOCUMENT_POSITION_FOLLOWING;for(var o=[],l=t.parentNode;l;){if(!a&&l===r)return gr.DOCUMENT_POSITION_CONTAINED_BY+gr.DOCUMENT_POSITION_FOLLOWING;o.push(l),l=l.parentNode}o.reverse();for(var u=[],c=r.parentNode;c;){if(!n&&c===t)return gr.DOCUMENT_POSITION_CONTAINS+gr.DOCUMENT_POSITION_PRECEDING;u.push(c),c=c.parentNode}u.reverse();var h=HT(o,u);for(var p in h.childNodes){var v=h.childNodes[p];if(v===r)return gr.DOCUMENT_POSITION_FOLLOWING;if(v===t)return gr.DOCUMENT_POSITION_PRECEDING;if(u.indexOf(v)>=0)return gr.DOCUMENT_POSITION_FOLLOWING;if(o.indexOf(v)>=0)return gr.DOCUMENT_POSITION_PRECEDING}return 0}};function XT(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}Rl(zn,Mt);Rl(zn,Mt.prototype);Rl(gr,Mt);Rl(gr,Mt.prototype);function Uu(e,t){if(t(e))return!0;if(e=e.firstChild)do if(Uu(e,t))return!0;while(e=e.nextSibling)}function ls(e,t){Bn(e);var r=t||{};this.ownerDocument=this,this.contentType=r.contentType||wu.XML_APPLICATION,this.type=j8(this.contentType)?"html":"xml"}function V8(e,t,r){e&&e._inc++;var n=r.namespaceURI;n===Qa.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}function KT(e,t,r,n){e&&e._inc++;var a=r.namespaceURI;a===Qa.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function ZT(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r&&!r.nextSibling)n[n.length++]=r;else{for(var a=t.firstChild,i=0;a;)n[i++]=a,a=a.nextSibling;n.length=i,delete n[n.length]}}}function QT(e,t){if(e!==t.parentNode)throw new ut(ut.NOT_FOUND_ERR,"child's parent is not parent");var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,ZT(e.ownerDocument,e),t.parentNode=null,t.previousSibling=null,t.nextSibling=null,t}function Y8(e){return e&&(e.nodeType===Mt.DOCUMENT_NODE||e.nodeType===Mt.DOCUMENT_FRAGMENT_NODE||e.nodeType===Mt.ELEMENT_NODE)}function X8(e){return e&&(e.nodeType===Mt.CDATA_SECTION_NODE||e.nodeType===Mt.COMMENT_NODE||e.nodeType===Mt.DOCUMENT_FRAGMENT_NODE||e.nodeType===Mt.DOCUMENT_TYPE_NODE||e.nodeType===Mt.ELEMENT_NODE||e.nodeType===Mt.PROCESSING_INSTRUCTION_NODE||e.nodeType===Mt.TEXT_NODE)}function us(e){return e&&e.nodeType===Mt.DOCUMENT_TYPE_NODE}function mi(e){return e&&e.nodeType===Mt.ELEMENT_NODE}function JT(e){return e&&e.nodeType===Mt.TEXT_NODE}function fy(e,t){var r=e.childNodes||[];if(Za(r,mi)||us(t))return!1;var n=Za(r,us);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function dy(e,t){var r=e.childNodes||[];function n(i){return mi(i)&&i!==t}if(Za(r,n))return!1;var a=Za(r,us);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function K8(e,t,r){if(!Y8(e))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new ut(ut.NOT_FOUND_ERR,"child not in parent");if(!X8(t)||us(t)&&e.nodeType!==Mt.DOCUMENT_NODE)throw new ut(ut.HIERARCHY_REQUEST_ERR,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function Z8(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===Mt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(mi);if(i.length>1||Za(a,JT))throw new ut(ut.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(i.length===1&&!fy(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(mi(t)&&!fy(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(us(t)){if(Za(n,us))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=Za(n,mi);if(r&&n.indexOf(s)<n.indexOf(r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!r&&s)throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function eS(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===Mt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(mi);if(i.length>1||Za(a,JT))throw new ut(ut.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(i.length===1&&!dy(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(mi(t)&&!dy(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(us(t)){let l=function(u){return us(u)&&u!==r};var o=l;if(Za(n,l))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=Za(n,mi);if(r&&n.indexOf(s)<n.indexOf(r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function gd(e,t,r,n){K8(e,t,r),e.nodeType===Mt.DOCUMENT_NODE&&(n||Z8)(e,t,r);var a=t.parentNode;if(a&&a.removeChild(t),t.nodeType===os){var i=t.firstChild;if(i==null)return t;var s=t.lastChild}else i=s=t;var o=r?r.previousSibling:e.lastChild;i.previousSibling=o,s.nextSibling=r,o?o.nextSibling=i:e.firstChild=i,r==null?e.lastChild=s:r.previousSibling=s;do i.parentNode=e;while(i!==s&&(i=i.nextSibling));return ZT(e.ownerDocument||e,e,t),t.nodeType==os&&(t.firstChild=t.lastChild=null),t}ls.prototype={implementation:null,nodeName:"#document",nodeType:Cc,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType===os){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return gd(this,e,t),e.ownerDocument=this,this.documentElement===null&&e.nodeType===Oa&&(this.documentElement=e),e},removeChild:function(e){var t=QT(this,e);return t===this.documentElement&&(this.documentElement=null),t},replaceChild:function(e,t){gd(this,e,t,eS),e.ownerDocument=this,t&&this.removeChild(t),mi(e)&&(this.documentElement=e)},importNode:function(e,t){return nS(this,e,t)},getElementById:function(e){var t=null;return Uu(this.documentElement,function(r){if(r.nodeType==Oa&&r.getAttribute("id")==e)return t=r,!0}),t},createElement:function(e){var t=new cs(xn);t.ownerDocument=this,this.type==="html"&&(e=e.toLowerCase()),R8(this.contentType)&&(t.namespaceURI=Qa.HTML),t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new Fr;var r=t.attributes=new Nl;return r._ownerElement=t,t},createDocumentFragment:function(){var e=new nf(xn);return e.ownerDocument=this,e.childNodes=new Fr,e},createTextNode:function(e){var t=new rf(xn);return t.ownerDocument=this,t.childNodes=new Fr,t.appendData(e),t},createComment:function(e){var t=new oh(xn);return t.ownerDocument=this,t.childNodes=new Fr,t.appendData(e),t},createCDATASection:function(e){var t=new lh(xn);return t.ownerDocument=this,t.childNodes=new Fr,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new fh(xn);return r.ownerDocument=this,r.childNodes=new Fr,r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){if(!Va.QName_exact.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'invalid character in name "'+e+'"');return this.type==="html"&&(e=e.toLowerCase()),this._createAttribute(e)},_createAttribute:function(e){var t=new io(xn);return t.ownerDocument=this,t.childNodes=new Fr,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){if(!Va.Name.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'not a valid xml name "'+e+'"');if(this.type==="html")throw new ut("document is an html document",B8.NotSupportedError);var t=new ch(xn);return t.ownerDocument=this,t.childNodes=new Fr,t.nodeName=e,t},createElementNS:function(e,t){var r=Pg(e,t),n=new cs(xn),a=n.attributes=new Nl;return n.childNodes=new Fr,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],a._ownerElement=n,n},createAttributeNS:function(e,t){var r=Pg(e,t),n=new io(xn);return n.ownerDocument=this,n.childNodes=new Fr,n.nodeName=t,n.name=t,n.specified=!0,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],n}};Un(ls,Mt);function cs(e){Bn(e),this._nsMap=Object.create(null)}cs.prototype={nodeType:Oa,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===Qa.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(e){return!!this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t?t.value:null},getAttributeNode:function(e){return this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase()),this.attributes.getNamedItem(e)},setAttribute:function(e,t){this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());var r=this.getAttributeNode(e);r?r.value=r.nodeValue=""+t:(r=this.ownerDocument._createAttribute(e),r.value=r.nodeValue=""+t,this.setAttributeNode(r))},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r?r.value:null},setAttributeNS:function(e,t,r){var n=Pg(e,t),a=n[2],i=this.getAttributeNodeNS(e,a);i?i.value=i.nodeValue=""+r:(i=this.ownerDocument.createAttributeNS(e,t),i.value=i.nodeValue=""+r,this.setAttributeNode(i))},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByClassName:function(e){var t=ly(e);return new Hs(this,function(r){var n=[];return t.length>0&&Uu(r,function(a){if(a!==r&&a.nodeType===Oa){var i=a.getAttribute("class");if(i){var s=e===i;if(!s){var o=ly(i);s=t.every(W8(o))}s&&n.push(a)}}}),n})},getElementsByTagName:function(e){var t=(this.nodeType===Cc?this:this.ownerDocument).type==="html",r=e.toLowerCase();return new Hs(this,function(n){var a=[];return Uu(n,function(i){if(!(i===n||i.nodeType!==Oa))if(e==="*")a.push(i);else{var s=i.getQualifiedName(),o=t&&i.namespaceURI===Qa.HTML?r:e;s===o&&a.push(i)}}),a})},getElementsByTagNameNS:function(e,t){return new Hs(this,function(r){var n=[];return Uu(r,function(a){a!==r&&a.nodeType===Oa&&(e==="*"||a.namespaceURI===e)&&(t==="*"||a.localName==t)&&n.push(a)}),n})}};ls.prototype.getElementsByClassName=cs.prototype.getElementsByClassName;ls.prototype.getElementsByTagName=cs.prototype.getElementsByTagName;ls.prototype.getElementsByTagNameNS=cs.prototype.getElementsByTagNameNS;Un(cs,Mt);function io(e){Bn(e),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}io.prototype.nodeType=Al;Un(io,Mt);function jl(e){Bn(e)}jl.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){var n=this.data.substring(0,e),a=this.data.substring(e+t);r=n+r+a,this.nodeValue=this.data=r,this.length=r.length}};Un(jl,Mt);function rf(e){Bn(e)}rf.prototype={nodeName:"#text",nodeType:md,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};Un(rf,jl);function oh(e){Bn(e)}oh.prototype={nodeName:"#comment",nodeType:$T};Un(oh,jl);function lh(e){Bn(e)}lh.prototype={nodeName:"#cdata-section",nodeType:zT};Un(lh,rf);function uh(e){Bn(e)}uh.prototype.nodeType=GT;Un(uh,Mt);function dx(e){Bn(e)}dx.prototype.nodeType=G8;Un(dx,Mt);function hx(e){Bn(e)}hx.prototype.nodeType=$8;Un(hx,Mt);function ch(e){Bn(e)}ch.prototype.nodeType=qT;Un(ch,Mt);function nf(e){Bn(e)}nf.prototype.nodeName="#document-fragment";nf.prototype.nodeType=os;Un(nf,Mt);function fh(e){Bn(e)}fh.prototype.nodeType=WT;Un(fh,jl);function tS(){}tS.prototype.serializeToString=function(e,t){return rS.call(e,t)};Mt.prototype.toString=rS;function rS(e){var t=[],r=this.nodeType===Cc&&this.documentElement||this,n=r.prefix,a=r.namespaceURI;if(a&&n==null){var n=r.lookupPrefix(a);if(n==null)var i=[{namespace:a,prefix:null}]}return Xo(this,t,e,i),t.join("")}function hy(e,t,r){var n=e.prefix||"",a=e.namespaceURI;if(!a||n==="xml"&&a===Qa.XML||a===Qa.XMLNS)return!1;for(var i=r.length;i--;){var s=r[i];if(s.prefix===n)return s.namespace!==a}return!0}function vp(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,XT),'"')}function Xo(e,t,r,n){n||(n=[]);var a=e.nodeType===Cc?e:e.ownerDocument,i=a.type==="html";if(r)if(e=r(e),e){if(typeof e=="string"){t.push(e);return}}else return;switch(e.nodeType){case Oa:var s=e.attributes,o=s.length,b=e.firstChild,l=e.tagName,u=l;if(!i&&!e.prefix&&e.namespaceURI){for(var c,h=0;h<s.length;h++)if(s.item(h).name==="xmlns"){c=s.item(h).value;break}if(!c)for(var p=n.length-1;p>=0;p--){var v=n[p];if(v.prefix===""&&v.namespace===e.namespaceURI){c=v.namespace;break}}if(c!==e.namespaceURI)for(var p=n.length-1;p>=0;p--){var v=n[p];if(v.namespace===e.namespaceURI){v.prefix&&(u=v.prefix+":"+l);break}}}t.push("<",u);for(var E=0;E<o;E++){var g=s.item(E);g.prefix=="xmlns"?n.push({prefix:g.localName,namespace:g.value}):g.nodeName=="xmlns"&&n.push({prefix:"",namespace:g.value})}for(var E=0;E<o;E++){var g=s.item(E);if(hy(g,i,n)){var w=g.prefix||"",x=g.namespaceURI;vp(t,w?"xmlns:"+w:"xmlns",x),n.push({prefix:w,namespace:x})}Xo(g,t,r,n)}if(l===u&&hy(e,i,n)){var w=e.prefix||"",x=e.namespaceURI;vp(t,w?"xmlns:"+w:"xmlns",x),n.push({prefix:w,namespace:x})}var y=!b;if(y&&(i||e.namespaceURI===Qa.HTML)&&(y=L8(l)),y)t.push("/>");else{if(t.push(">"),i&&M8(l))for(;b;)b.data?t.push(b.data):Xo(b,t,r,n.slice()),b=b.nextSibling;else for(;b;)Xo(b,t,r,n.slice()),b=b.nextSibling;t.push("</",u,">")}return;case Cc:case os:for(var b=e.firstChild;b;)Xo(b,t,r,n.slice()),b=b.nextSibling;return;case Al:return vp(t,e.name,e.value);case md:return t.push(e.data.replace(/[<&>]/g,XT));case zT:return t.push(Va.CDATA_START,e.data,Va.CDATA_END);case $T:return t.push(Va.COMMENT_START,e.data,Va.COMMENT_END);case GT:var _=e.publicId,N=e.systemId;t.push(Va.DOCTYPE_DECL_START," ",e.name),_?(t.push(" ",Va.PUBLIC," ",_),N&&N!=="."&&t.push(" ",N)):N&&N!=="."&&t.push(" ",Va.SYSTEM," ",N),e.internalSubset&&t.push(" [",e.internalSubset,"]"),t.push(">");return;case WT:return t.push("<?",e.target," ",e.data,"?>");case qT:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function nS(e,t,r){var n;switch(t.nodeType){case Oa:n=t.cloneNode(!1),n.ownerDocument=e;case os:break;case Al:r=!0;break}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var a=t.firstChild;a;)n.appendChild(nS(e,a,r)),a=a.nextSibling;return n}function Ig(e,t,r){var n=new t.constructor(xn);for(var a in t)if(Sl(t,a)){var i=t[a];typeof i!="object"&&i!=n[a]&&(n[a]=i)}switch(t.childNodes&&(n.childNodes=new Fr),n.ownerDocument=e,n.nodeType){case Oa:var s=t.attributes,o=n.attributes=new Nl,l=s.length;o._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(Ig(e,s.item(u),!0));break;case Al:r=!0}if(r)for(var c=t.firstChild;c;)n.appendChild(Ig(e,c,r)),c=c.nextSibling;return n}function aS(e,t,r){e[t]=r}try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case Oa:case os:var r=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}};var KB=e;Object.defineProperty(Hs.prototype,"length",{get:function(){return sh(this),this.$$length}}),Object.defineProperty(Mt.prototype,"textContent",{get:function(){return e(this)},set:function(t){switch(this.nodeType){case Oa:case os:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),aS=function(t,r,n){t["$$"+r]=n}}}catch{}Er._updateLiveList=sh;Er.Attr=io;Er.CDATASection=lh;Er.CharacterData=jl;Er.Comment=oh;Er.Document=ls;Er.DocumentFragment=nf;Er.DocumentType=uh;Er.DOMImplementation=YT;Er.Element=cs;Er.Entity=hx;Er.EntityReference=ch;Er.LiveNodeList=Hs;Er.NamedNodeMap=Nl;Er.Node=Mt;Er.NodeList=Fr;Er.Notation=dx;Er.Text=rf;Er.ProcessingInstruction=fh;Er.XMLSerializer=tS;var Ml={},iS={};(function(e){var t=br.freeze;e.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),e.entityMap=e.HTML_ENTITIES})(iS);var dh={},Ll=br,Et=_t,sS=vs,Q8=Ll.isHTMLEscapableRawTextElement,J8=Ll.isHTMLMimeType,eO=Ll.isHTMLRawTextElement,kc=Ll.hasOwn,py=Ll.NAMESPACE,my=sS.ParseError,tO=sS.DOMException,lu=0,Fi=1,No=2,uu=3,Do=4,Co=5,cu=6,Jf=7;function oS(){}oS.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),lS(t,t=Object.create(null)),rO(e,t,r,n,this.errorHandler),n.endDocument()}};var px=/&#?\w+;?/g;function rO(e,t,r,n,a){var i=J8(n.mimeType);e.indexOf(Et.UNICODE_REPLACEMENT_CHARACTER)>=0&&a.warning("Unicode replacement character detected, source encoding issues?");function s(de){if(de>65535){de-=65536;var Ce=55296+(de>>10),Ye=56320+(de&1023);return String.fromCharCode(Ce,Ye)}else return String.fromCharCode(de)}function o(de){var Ce=de[de.length-1]===";"?de:de+";";if(!i&&Ce!==de)return a.error("EntityRef: expecting ;"),de;var Ye=Et.Reference.exec(Ce);if(!Ye||Ye[0].length!==Ce.length)return a.error("entity not matching Reference production: "+de),de;var V=Ce.slice(1,-1);return kc(r,V)?r[V]:V.charAt(0)==="#"?s(parseInt(V.substring(1).replace("x","0x"))):(a.error("entity not found:"+de),de)}function l(de){if(de>w){var Ce=e.substring(w,de).replace(px,o);p&&v(w),n.characters(Ce,0,de-w),w=de}}var u=0,c=0,h=/\r\n?|\n|$/g,p=n.locator;function v(de,Ce){for(;de>=c&&(Ce=h.exec(e));)u=c,c=Ce.index+Ce[0].length,p.lineNumber++;p.columnNumber=de-u+1}for(var E=[{currentNSMap:t}],g=[],w=0;;){try{var x=e.indexOf("<",w);if(x<0){if(!i&&g.length>0)return a.fatalError("unclosed xml tag(s): "+g.join(", "));if(!e.substring(w).match(/^\s*$/)){var y=n.doc,b=y.createTextNode(e.substring(w));if(y.documentElement)return a.error("Extra content at the end of the document");y.appendChild(b),n.currentElement=b}return}if(x>w){var _=e.substring(w,x);!i&&g.length===0&&(_=_.replace(new RegExp(Et.S_OPT.source,"g"),""),_&&a.error("Unexpected content outside root element: '"+_+"'")),l(x)}switch(e.charAt(x+1)){case"/":var le=e.indexOf(">",x+2),N=e.substring(x+2,le>0?le:void 0);if(!N)return a.fatalError("end tag name missing");var k=le>0&&Et.reg("^",Et.QName_group,Et.S_OPT,"$").exec(N);if(!k)return a.fatalError('end tag name contains invalid characters: "'+N+'"');if(!n.currentElement&&!n.doc.documentElement)return;var T=g[g.length-1]||n.currentElement.tagName||n.doc.documentElement.tagName||"";if(T!==k[1]){var A=k[1].toLowerCase();if(!i||T.toLowerCase()!==A)return a.fatalError('Opening and ending tag mismatch: "'+T+'" != "'+N+'"')}var S=E.pop();g.pop();var P=S.localNSMap;if(n.endElement(S.uri,S.localName,T),P)for(var F in P)kc(P,F)&&n.endPrefixMapping(F);le++;break;case"?":p&&v(x),le=sO(e,x,n,a);break;case"!":p&&v(x),le=cS(e,x,n,a,i);break;default:p&&v(x);var U=new fS,re=E[E.length-1].currentNSMap,le=nO(e,x,U,re,o,a,i),pe=U.length;if(U.closed||(i&&Ll.isHTMLVoidElement(U.tagName)?U.closed=!0:g.push(U.tagName)),p&&pe){for(var me=gy(p,{}),Ee=0;Ee<pe;Ee++){var fe=U[Ee];v(fe.offset),fe.locator=gy(p,{})}n.locator=me,xy(U,n,re)&&E.push(U),n.locator=p}else xy(U,n,re)&&E.push(U);i&&!U.closed?le=aO(e,le,U.tagName,o,n):le++}}catch(de){if(de instanceof my)throw de;if(de instanceof tO)throw new my(de.name+": "+de.message,n.locator,de);a.error("element parse error: "+de),le=-1}le>w?w=le:l(Math.max(x,w)+1)}}function gy(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function nO(e,t,r,n,a,i,s){function o(v,E,g){if(kc(r.attributeNames,v))return i.fatalError("Attribute "+v+" redefined");if(!s&&E.indexOf("<")>=0)return i.fatalError("Unescaped '<' not allowed in attributes values");r.addValue(v,E.replace(/[\t\n\r]/g," ").replace(px,a),g)}for(var l,u,c=++t,h=lu;;){var p=e.charAt(c);switch(p){case"=":if(h===Fi)l=e.slice(t,c),h=uu;else if(h===No)h=uu;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(h===uu||h===Fi)if(h===Fi&&(i.warning('attribute value must after "="'),l=e.slice(t,c)),t=c+1,c=e.indexOf(p,t),c>0)u=e.slice(t,c),o(l,u,t-1),h=Co;else throw new Error("attribute value no end '"+p+"' match");else if(h==Do)u=e.slice(t,c),o(l,u,t),i.warning('attribute "'+l+'" missed start quot('+p+")!!"),t=c+1,h=Co;else throw new Error('attribute value must after "="');break;case"/":switch(h){case lu:r.setTagName(e.slice(t,c));case Co:case cu:case Jf:h=Jf,r.closed=!0;case Do:case Fi:break;case No:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),h==lu&&r.setTagName(e.slice(t,c)),c;case">":switch(h){case lu:r.setTagName(e.slice(t,c));case Co:case cu:case Jf:break;case Do:case Fi:u=e.slice(t,c),u.slice(-1)==="/"&&(r.closed=!0,u=u.slice(0,-1));case No:h===No&&(u=l),h==Do?(i.warning('attribute "'+u+'" missed quot(")!'),o(l,u,t)):(s||i.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),o(u,u,t));break;case uu:if(!s)return i.fatalError(`AttValue: ' or " expected`)}return c;case"":p=" ";default:if(p<=" ")switch(h){case lu:r.setTagName(e.slice(t,c)),h=cu;break;case Fi:l=e.slice(t,c),h=No;break;case Do:var u=e.slice(t,c);i.warning('attribute "'+u+'" missed quot(")!!'),o(l,u,t);case Co:h=cu;break}else switch(h){case No:s||i.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),o(l,l,t),t=c,h=Fi;break;case Co:i.warning('attribute space is required"'+l+'"!!');case cu:h=Fi,t=c;break;case uu:h=Do,t=c;break;case Jf:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function xy(e,t,r){for(var n=e.tagName,a=null,h=e.length;h--;){var i=e[h],s=i.qName,o=i.value,p=s.indexOf(":");if(p>0)var l=i.prefix=s.slice(0,p),u=s.slice(p+1),c=l==="xmlns"&&u;else u=s,l=null,c=s==="xmlns"&&"";i.localName=u,c!==!1&&(a==null&&(a=Object.create(null),lS(r,r=Object.create(null))),r[c]=a[c]=o,i.uri=py.XMLNS,t.startPrefixMapping(c,o))}for(var h=e.length;h--;)i=e[h],i.prefix&&(i.prefix==="xml"&&(i.uri=py.XML),i.prefix!=="xmlns"&&(i.uri=r[i.prefix]));var p=n.indexOf(":");p>0?(l=e.prefix=n.slice(0,p),u=e.localName=n.slice(p+1)):(l=null,u=e.localName=n);var v=e.uri=r[l||""];if(t.startElement(v,u,n,e),e.closed){if(t.endElement(v,u,n),a)for(l in a)kc(a,l)&&t.endPrefixMapping(l)}else return e.currentNSMap=r,e.localNSMap=a,!0}function aO(e,t,r,n,a){var i=Q8(r);if(i||eO(r)){var s=e.indexOf("</"+r+">",t),o=e.substring(t+1,s);return i&&(o=o.replace(px,n)),a.characters(o,0,o.length),s}return t+1}function lS(e,t){for(var r in e)kc(e,r)&&(t[r]=e[r])}function uS(e,t){var r=t;function n(c){return c=c||0,e.charAt(r+c)}function a(c){c=c||1,r+=c}function i(){for(var c=0;r<e.length;){var h=n();if(h!==" "&&h!==`
`&&h!=="	"&&h!=="\r")return c;c++,a()}return-1}function s(){return e.substring(r)}function o(c){return e.substring(r,r+c.length)===c}function l(c){return e.substring(r,r+c.length).toUpperCase()===c.toUpperCase()}function u(c){var h=Et.reg("^",c),p=h.exec(s());return p?(a(p[0].length),p[0]):null}return{char:n,getIndex:function(){return r},getMatch:u,getSource:function(){return e},skip:a,skipBlanks:i,substringFromIndex:s,substringStartsWith:o,substringStartsWithCaseInsensitive:l}}function iO(e,t){function r(o,l){var u=Et.PI.exec(o.substringFromIndex());return u?u[1].toLowerCase()==="xml"?l.fatalError("xml declaration is only allowed at the start of the document, but found at position "+o.getIndex()):(o.skip(u[0].length),u[0]):l.fatalError("processing instruction is not well-formed at position "+o.getIndex())}var n=e.getSource();if(e.char()==="["){e.skip(1);for(var a=e.getIndex();e.getIndex()<n.length;){if(e.skipBlanks(),e.char()==="]"){var i=n.substring(a,e.getIndex());return e.skip(1),i}var s=null;if(e.char()==="<"&&e.char(1)==="!")switch(e.char(2)){case"E":e.char(3)==="L"?s=e.getMatch(Et.elementdecl):e.char(3)==="N"&&(s=e.getMatch(Et.EntityDecl));break;case"A":s=e.getMatch(Et.AttlistDecl);break;case"N":s=e.getMatch(Et.NotationDecl);break;case"-":s=e.getMatch(Et.Comment);break}else if(e.char()==="<"&&e.char(1)==="?")s=r(e,t);else if(e.char()==="%")s=e.getMatch(Et.PEReference);else return t.fatalError("Error detected in Markup declaration");if(!s)return t.fatalError("Error in internal subset at position "+e.getIndex())}return t.fatalError("doctype internal subset is not well-formed, missing ]")}}function cS(e,t,r,n,a){var i=uS(e,t);switch(a?i.char(2).toUpperCase():i.char(2)){case"-":var s=i.getMatch(Et.Comment);return s?(r.comment(s,Et.COMMENT_START.length,s.length-Et.COMMENT_START.length-Et.COMMENT_END.length),i.getIndex()):n.fatalError("comment is not well-formed at position "+i.getIndex());case"[":var o=i.getMatch(Et.CDSect);return o?!a&&!r.currentElement?n.fatalError("CDATA outside of element"):(r.startCDATA(),r.characters(o,Et.CDATA_START.length,o.length-Et.CDATA_START.length-Et.CDATA_END.length),r.endCDATA(),i.getIndex()):n.fatalError("Invalid CDATA starting at position "+t);case"D":{if(r.doc&&r.doc.documentElement)return n.fatalError("Doctype not allowed inside or after documentElement at position "+i.getIndex());if(a?!i.substringStartsWithCaseInsensitive(Et.DOCTYPE_DECL_START):!i.substringStartsWith(Et.DOCTYPE_DECL_START))return n.fatalError("Expected "+Et.DOCTYPE_DECL_START+" at position "+i.getIndex());if(i.skip(Et.DOCTYPE_DECL_START.length),i.skipBlanks()<1)return n.fatalError("Expected whitespace after "+Et.DOCTYPE_DECL_START+" at position "+i.getIndex());var l={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(l.name=i.getMatch(Et.Name),!l.name)return n.fatalError("doctype name missing or contains unexpected characters at position "+i.getIndex());if(a&&l.name.toLowerCase()!=="html"&&n.warning("Unexpected DOCTYPE in HTML document at position "+i.getIndex()),i.skipBlanks(),i.substringStartsWith(Et.PUBLIC)||i.substringStartsWith(Et.SYSTEM)){var u=Et.ExternalID_match.exec(i.substringFromIndex());if(!u)return n.fatalError("doctype external id is not well-formed at position "+i.getIndex());u.groups.SystemLiteralOnly!==void 0?l.systemId=u.groups.SystemLiteralOnly:(l.systemId=u.groups.SystemLiteral,l.publicId=u.groups.PubidLiteral),i.skip(u[0].length)}else if(a&&i.substringStartsWithCaseInsensitive(Et.SYSTEM)){if(i.skip(Et.SYSTEM.length),i.skipBlanks()<1)return n.fatalError("Expected whitespace after "+Et.SYSTEM+" at position "+i.getIndex());if(l.systemId=i.getMatch(Et.ABOUT_LEGACY_COMPAT_SystemLiteral),!l.systemId)return n.fatalError("Expected "+Et.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+Et.SYSTEM+" at position "+i.getIndex())}return a&&l.systemId&&!Et.ABOUT_LEGACY_COMPAT_SystemLiteral.test(l.systemId)&&n.warning("Unexpected doctype.systemId in HTML document at position "+i.getIndex()),a||(i.skipBlanks(),l.internalSubset=iO(i,n)),i.skipBlanks(),i.char()!==">"?n.fatalError("doctype not terminated with > at position "+i.getIndex()):(i.skip(1),r.startDTD(l.name,l.publicId,l.systemId,l.internalSubset),r.endDTD(),i.getIndex())}default:return n.fatalError('Not well-formed XML starting with "<!" at position '+t)}}function sO(e,t,r,n){var a=e.substring(t).match(Et.PI);if(!a)return n.fatalError("Invalid processing instruction starting at position "+t);if(a[1].toLowerCase()==="xml"){if(t>0)return n.fatalError("processing instruction at position "+t+" is an xml declaration which is only at the start of the document");if(!Et.XMLDecl.test(e.substring(t)))return n.fatalError("xml declaration is not well-formed")}return r.processingInstruction(a[1],a[2]),t+a[0].length}function fS(){this.attributeNames=Object.create(null)}fS.prototype={setTagName:function(e){if(!Et.QName_exact.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!Et.QName_exact.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};dh.XMLReader=oS;dh.parseUtils=uS;dh.parseDoctypeCommentOrCData=cS;var po=br,oO=Er,lO=vs,vy=iS,uO=dh,cO=oO.DOMImplementation,fO=po.hasDefaultHTMLNamespace,dO=po.isHTMLMimeType,hO=po.isValidMimeType,dS=po.MIME_TYPE,yp=po.NAMESPACE,yy=lO.ParseError,pO=uO.XMLReader;function hS(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function pS(e){if(e=e||{},e.locator===void 0&&(e.locator=!0),this.assign=e.assign||po.assign,this.domHandler=e.domHandler||hh,this.onError=e.onError||e.errorHandler,e.errorHandler&&typeof e.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");e.errorHandler&&e.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=e.normalizeLineEndings||hS,this.locator=!!e.locator,this.xmlns=this.assign(Object.create(null),e.xmlns)}pS.prototype.parseFromString=function(e,t){if(!hO(t))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+t+'" is not valid.');var r=this.assign(Object.create(null),this.xmlns),n=vy.XML_ENTITIES,a=r[""]||null;fO(t)?(n=vy.HTML_ENTITIES,a=yp.HTML):t===dS.XML_SVG_IMAGE&&(a=yp.SVG),r[""]=a,r.xml=r.xml||yp.XML;var i=new this.domHandler({mimeType:t,defaultNamespace:a,onError:this.onError}),s=this.locator?{}:void 0;this.locator&&i.setDocumentLocator(s);var o=new pO;o.errorHandler=i,o.domBuilder=i;var l=!po.isHTMLMimeType(t);return l&&typeof e!="string"&&o.errorHandler.fatalError("source is not a string"),o.parse(this.normalizeLineEndings(String(e)),r,n),i.doc.documentElement||o.errorHandler.fatalError("missing root element"),i.doc};function hh(e){var t=e||{};this.mimeType=t.mimeType||dS.XML_APPLICATION,this.defaultNamespace=t.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=t.onError}function ko(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}hh.prototype={startDocument:function(){var e=new cO;this.doc=dO(this.mimeType)?e.createHTMLDocument(!1):e.createDocument(this.defaultNamespace,"")},startElement:function(e,t,r,n){var a=this.doc,i=a.createElementNS(e,r||t),s=n.length;e0(this,i),this.currentElement=i,this.locator&&ko(this.locator,i);for(var o=0;o<s;o++){var e=n.getURI(o),l=n.getValue(o),r=n.getQName(o),u=a.createAttributeNS(e,r);this.locator&&ko(n.getLocator(o),u),u.value=u.nodeValue=l,i.setAttributeNode(u)}},endElement:function(e,t,r){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&ko(this.locator,r),e0(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=wy.apply(this,arguments),e){if(this.cdata)var n=this.doc.createCDATASection(e);else var n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&ko(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){e&&(e.lineNumber=0),this.locator=e},comment:function(e,t,r){e=wy.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&ko(this.locator,n),e0(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r,n){var a=this.doc.implementation;if(a&&a.createDocumentType){var i=a.createDocumentType(e,t,r,n);this.locator&&ko(this.locator,i),e0(this,i),this.doc.doctype=i}},reportError:function(e,t){if(typeof this.onError=="function")try{this.onError(e,t,this)}catch(r){throw new yy("Reporting "+e+' "'+t+'" caused '+r,this.locator)}else console.error("[xmldom "+e+"]	"+t,mO(this.locator))},warning:function(e){this.reportError("warning",e)},error:function(e){this.reportError("error",e)},fatalError:function(e){throw this.reportError("fatalError",e),new yy(e,this.locator)}};function mO(e){if(e)return`
@#[line:`+e.lineNumber+",col:"+e.columnNumber+"]"}function wy(e,t,r){return typeof e=="string"?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){hh.prototype[e]=function(){return null}});function e0(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}function gO(e){if(e==="error")throw"onErrorStopParsing"}function xO(){throw"onWarningStopParsing"}Ml.__DOMHandler=hh;Ml.DOMParser=pS;Ml.normalizeLineEndings=hS;Ml.onErrorStopParsing=gO;Ml.onWarningStopParsing=xO;var Bl=br;Lt.assign=Bl.assign;Lt.hasDefaultHTMLNamespace=Bl.hasDefaultHTMLNamespace;Lt.isHTMLMimeType=Bl.isHTMLMimeType;Lt.isValidMimeType=Bl.isValidMimeType;Lt.MIME_TYPE=Bl.MIME_TYPE;Lt.NAMESPACE=Bl.NAMESPACE;var ph=vs;Lt.DOMException=ph.DOMException;Lt.DOMExceptionName=ph.DOMExceptionName;Lt.ExceptionCode=ph.ExceptionCode;Lt.ParseError=ph.ParseError;var jr=Er;Lt.Attr=jr.Attr;Lt.CDATASection=jr.CDATASection;Lt.CharacterData=jr.CharacterData;Lt.Comment=jr.Comment;Lt.Document=jr.Document;Lt.DocumentFragment=jr.DocumentFragment;Lt.DocumentType=jr.DocumentType;Lt.DOMImplementation=jr.DOMImplementation;Lt.Element=jr.Element;Lt.Entity=jr.Entity;Lt.EntityReference=jr.EntityReference;Lt.LiveNodeList=jr.LiveNodeList;Lt.NamedNodeMap=jr.NamedNodeMap;Lt.Node=jr.Node;Lt.NodeList=jr.NodeList;Lt.Notation=jr.Notation;Lt.ProcessingInstruction=jr.ProcessingInstruction;Lt.Text=jr.Text;Lt.XMLSerializer=jr.XMLSerializer;var mh=Ml;Lt.DOMParser=mh.DOMParser;Lt.normalizeLineEndings=mh.normalizeLineEndings;Lt.onErrorStopParsing=mh.onErrorStopParsing;Lt.onWarningStopParsing=mh.onWarningStopParsing;function vO(e){return e[e.length-1]}function yO(e){return e[0]}var mx={last:vO,first:yO};function Oc(e){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(e)}function by(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?by(Object(r),!0).forEach(function(n){bO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):by(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bO(e,t,r){return(t=EO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EO(e){var t=_O(e,"string");return Oc(t)=="symbol"?t:t+""}function _O(e,t){if(Oc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Oc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mS=mx,k0=mS.last,Ls=mS.first;function mo(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}mo.prototype=Error.prototype;function mn(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}mn.prototype=new mo;function Fc(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}Fc.prototype=new mo;function gh(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}gh.prototype=new mo;function ys(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}ys.prototype=new mo;function gx(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}gx.prototype=new mo;function TO(e,t){var r=new gx(e);throw r.properties=wO({id:"api_version_error"},t),r}function SO(e){var t=new mn("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t}function AO(e){var t=new mn("Unopened tag");return t.properties={xtag:k0(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t}function NO(e){var t=new mn("Duplicate open tag, expected one open tag");return t.properties={xtag:Ls(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t}function DO(e){var t=new mn("Duplicate close tag, expected one close tag");return t.properties={xtag:Ls(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t}function CO(e){var t=new mn("Unclosed tag");return t.properties={xtag:Ls(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t}function kO(e){var t=new mn('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t}function OO(e){var t=e.tag,r=e.value,n=e.offset,a=new Fc("There are some XML corrupt characters");return a.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:n,explanation:"There are some corrupt characters for the field ".concat(t)},a}function FO(e){var t=e.tag,r=e.value,n=e.offset,a=new Fc("Non string values are not allowed for rawXML tags");return a.properties={id:"invalid_raw_xml_value",xtag:t,value:r,offset:n,explanation:"The value of the raw tag : '".concat(t,"' is not a string")},a}function PO(e){var t=e.part,r=t.value,n=t.offset,a=e.id,i=a===void 0?"raw_tag_outerxml_invalid":a,s=e.message,o=s===void 0?"Raw tag not in paragraph":s,l=e.part,u=e.explanation,c=u===void 0?'The tag "'.concat(r,'" is not inside a paragraph'):u;typeof c=="function"&&(c=c(l));var h=new mn(o);throw h.properties={id:i,explanation:c,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},h}function IO(e){var t=new mn("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t}function RO(e){var t=e.location,r=e.offset,n=e.square,a=t==="start"?"unclosed":"unopened",i=t==="start"?"Unclosed":"Unopened",s=new mn("".concat(i," loop")),o=e.value;return s.properties={id:"".concat(a,"_loop"),explanation:'The loop with tag "'.concat(o,'" is ').concat(a),xtag:o,offset:r},n&&(s.properties.square=n),s}function jO(e,t){var r=new mn("Unbalanced loop tag"),n=t[0].part.value,a=t[1].part.value,i=e[0].part.value,s=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(a,"}{#").concat(i,"}{/").concat(s,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r}function MO(e){var t=e.tags,r=new mn("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(t[0].value,'" is closed by the tag "').concat(t[1].value,'"'),openingtag:Ls(t).value,offset:[Ls(t).offset,k0(t).offset],closingtag:k0(t).value},Ls(t).square&&(r.properties.square=[Ls(t).square,k0(t).square]),r}function LO(e){var t=e.tag,r=e.rootError,n=e.offset,a=new gh("Scope parser compilation failed");return a.properties={id:"scopeparser_compilation_failed",offset:n,xtag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},a}function BO(e){var t=e.tag,r=e.scope,n=e.error,a=e.offset,i=new gh("Scope parser execution failed");return i.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:a,xtag:t,rootError:n},i}function UO(e){var t=e.tag,r=e.offset,n=new mn('The position of the loop tags "'.concat(t,'" would produce invalid XML'));return n.properties={xtag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n}function zO(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');e.module&&(r+=' "'.concat(e.module,'"'));var n=new mn(r);throw n.properties={part:e,index:t,id:"unimplemented_tag_type"},n}function qO(){var e=new ys("Malformed xml");throw e.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},e}function WO(){var e=new ys("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e}function $O(){var e=new ys("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e}function GO(){var e=new ys("You should not call .render twice on the same docxtemplater instance");throw e.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},e}function HO(e){var t=Object.keys(e.files).slice(0,10),r="";t.length===0?r="Empty zip file":r="Zip file contains : ".concat(t.join(","));var n=new ys("The filetype for this file could not be identified, is this file corrupted ? ".concat(r));throw n.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(r)},n}function VO(e,t){var r=new mn("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r}function YO(e){var t=new ys('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t}var Ba={XTError:mo,XTTemplateError:mn,XTInternalError:ys,XTScopeParserError:gh,XTAPIVersionError:gx,RenderingError:Fc,XTRenderingError:Fc,getClosingTagNotMatchOpeningTag:MO,getLoopPositionProducesInvalidXMLError:UO,getScopeCompilationError:LO,getScopeParserExecutionError:BO,getUnclosedTagException:CO,getUnopenedTagException:AO,getUnmatchedLoopException:RO,getDuplicateCloseTagException:DO,getDuplicateOpenTagException:NO,getCorruptCharactersException:OO,getInvalidRawXMLValueException:FO,getUnbalancedLoopException:jO,throwApiVersionError:TO,throwFileTypeNotHandled:YO,throwFileTypeNotIdentified:HO,throwMalformedXml:qO,throwMultiError:SO,throwExpandNotFound:PO,throwRawTagShouldBeOnlyTextInParagraph:IO,throwUnimplementedTagType:zO,throwXmlTagNotFound:kO,throwXmlInvalid:VO,throwResolveBeforeCompile:WO,throwRenderInvalidTemplate:$O,throwRenderTwice:GO};function XO(e,t){return JO(e)||QO(e,t)||ZO(e,t)||KO()}function KO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZO(e,t){if(e){if(typeof e=="string")return Ey(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ey(e,t):void 0}}function Ey(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function QO(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function JO(e){if(Array.isArray(e))return e}var gS=Lt,eF=gS.DOMParser,tF=gS.XMLSerializer,rF=Ba,xS=rF.throwXmlTagNotFound,vS=mx,nF=vS.last,aF=vS.first;function iF(e){return/^[ \n\r\t]+$/.test(e)}function sF(e){return{get:function(r){return e==="."?r:r&&r[e]}}}function oF(e){for(var t=0;t<e.length;t++){var r=e[t];r.message&&console.warn("Warning : "+r.message)}}var wp={};function lF(e,t,r){var n;if(wp[t]?n=wp[t]:(n=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),wp[t]=n),n.test(e))return e.replace(n,"$1".concat(r,"$3"));var a=e.lastIndexOf("/>");return a===-1&&(a=e.lastIndexOf(">")),e.substr(0,a)+" ".concat(t,'="').concat(r,'"')+e.substr(a)}function uF(e,t){var r=e.indexOf(" ".concat(t,'="'));if(r===-1)return null;var n=e.substr(r).search(/["']/)+r,a=e.substr(n+1).search(/["']/)+n;return e.substr(n+1,a-n)}function cF(e,t){return e.indexOf(t,e.length-t.length)!==-1}function fF(e,t){return e.substring(0,t.length)===t}function dF(e){for(var t=[],r={},n=[],a=0,i=e.length;a<i;++a)r[e[a]]?t.push(e[a]):(r[e[a]]=!0,n.push(e[a]));return t}function hF(e){for(var t={},r=[],n=0,a=e.length;n<a;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r}function pF(e,t){for(var r=[[]],n=0;n<e.length;n++){var a=e[n],i=r[r.length-1],s=t(a);s==="start"?r.push([a]):s==="end"?(i.push(a),r.push([])):i.push(a)}for(var o=[],l=0;l<r.length;l++){var u=r[l];u.length>0&&o.push(u)}return o}function mF(){return{errorLogging:"json",stripInvalidXMLChars:!1,paragraphLoop:!1,nullGetter:function(t){return t.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:sF,warnFn:oF,linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}}function gF(e){return new tF().serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")}function xF(e){return e.charCodeAt(0)===65279&&(e=e.substr(1)),new eF().parseFromString(e,"text/xml")}var yS=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],Pc=yS.map(function(e){var t=XO(e,2),r=t[0],n=t[1];return{rstart:new RegExp(n,"g"),rend:new RegExp(r,"g"),start:n,end:r}});function vF(e){for(var t=Pc.length-1;t>=0;t--){var r=Pc[t];e=e.replace(r.rstart,r.end)}return e}function yF(e){var t;(t=e)!==null&&t!==void 0&&t.toString?e=e.toString():e="";for(var r,n=0,a=Pc.length;n<a;n++)r=Pc[n],e=e.replace(r.rend,r.start);return e}function wF(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;a++){var i=n[a];t.push(i)}return t}function bF(e,t){if(!t)return e;for(var r=0,n=t.length;r<n;r++)e.push(t[r]);return e}var EF=new RegExp("","g");function _F(e){return e.replace(EF," ")}function TF(e,t){for(var r=[],n;(n=e.exec(t))!=null;)r.push({array:n,offset:n.index});return r}function xx(e,t){return e==="</"+t+">"}function vx(e,t){return e.indexOf("<"+t)===0&&[">"," ","/"].indexOf(e[t.length+1])!==-1}function SF(e,t,r){var n=wS(e,t,r);if(n!==null)return n;xS({position:"right",element:t,parsed:e,index:r})}function wS(e,t,r){typeof t=="string"&&(t=[t]);for(var n=1,a=r,i=e.length;a<i;a++)for(var s=e[a],o=0,l=t;o<l.length;o++){var u=l[o];if(xx(s.value,u)&&n--,vx(s.value,u)&&n++,n===0)return a}return null}function AF(e,t,r){var n=bS(e,t,r);if(n!==null)return n;xS({position:"left",element:t,parsed:e,index:r})}function bS(e,t,r){typeof t=="string"&&(t=[t]);for(var n=1,a=r;a>=0;a--)for(var i=e[a],s=0,o=t;s<o.length;s++){var l=o[s];if(vx(i.value,l)&&n--,xx(i.value,l)&&n++,n===0)return a}return null}function NF(e,t){var r=t.type,n=t.tag,a=t.position;return r==="tag"&&n===e&&(a==="start"||a==="selfclosing")}function DF(e,t){var r=t.type,n=t.tag,a=t.position;return r==="tag"&&n===e&&a==="end"}function CF(e){var t=e.type,r=e.tag,n=e.position;return["w:p","a:p","text:p"].indexOf(r)!==-1&&t==="tag"&&n==="start"}function kF(e){var t=e.type,r=e.tag,n=e.position;return["w:p","a:p","text:p"].indexOf(r)!==-1&&t==="tag"&&n==="end"}function OF(e){var t=e.type,r=e.position,n=e.text;return n&&t==="tag"&&r==="start"}function FF(e){var t=e.type,r=e.position,n=e.text;return n&&t==="tag"&&r==="end"}function PF(e){var t=e.type,r=e.position;return t==="placeholder"||t==="content"&&r==="insidetag"}function IF(e,t){var r=e.module,n=e.type;return t instanceof Array||(t=[t]),n==="placeholder"&&t.indexOf(r)!==-1}var Rg=/[\x00-\x08\x0B\x0C\x0E-\x1F]/g;function RF(e){return Rg.lastIndex=0,Rg.test(e)}function jF(e){return typeof e!="string"&&(e=String(e)),e.replace(Rg,"")}function MF(e){var t={};for(var r in e){var n=e[r];t[n]||(t[n]=[]),t[n].push(r)}return t}function LF(e,t){return e.map(function(r,n){return{item:r,index:n}}).sort(function(r,n){return t(r.item,n.item)||r.index-n.index}).map(function(r){var n=r.item;return n})}var Mr={endsWith:cF,startsWith:fF,isContent:PF,isParagraphStart:CF,isParagraphEnd:kF,isTagStart:NF,isTagEnd:DF,isTextStart:OF,isTextEnd:FF,isStarting:vx,isEnding:xx,isModule:IF,uniq:hF,getDuplicates:dF,chunkBy:pF,last:nF,first:aF,xml2str:gF,str2xml:xF,getRightOrNull:wS,getRight:SF,getLeftOrNull:bS,getLeft:AF,pregMatchAll:TF,convertSpaces:_F,charMapRegexes:Pc,hasCorruptCharacters:RF,removeCorruptCharacters:jF,getDefaults:mF,wordToUtf8:vF,utf8ToWord:yF,concatArrays:wF,pushArray:bF,invertMap:MF,charMap:yS,getSingleAttribute:uF,setSingleAttribute:lF,isWhiteSpace:iF,stableSort:LF};function BF(e,t){return WF(e)||qF(e,t)||zF(e,t)||UF()}function UF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zF(e,t){if(e){if(typeof e=="string")return _y(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_y(e,t):void 0}}function _y(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function qF(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function WF(e){if(Array.isArray(e))return e}function Kr(e){"@babel/helpers - typeof";return Kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(e)}function $F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VF(n.key),n)}}function HF(e,t,r){return r&&GF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VF(e){var t=YF(e,"string");return Kr(t)=="symbol"?t:t+""}function YF(e,t){if(Kr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kr(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var XF=function(){function e(){$F(this,e)}return HF(e,null,[{key:"createSchema",value:function(r){var n={validate:r,optional:function(){return e.createSchema(function(i){return i===void 0?{success:!0,value:i}:r(i)})},nullable:function(){return e.createSchema(function(i){return i==null?{success:!0,value:i}:r(i)})}};return n}},{key:"string",value:function(){return e.createSchema(function(r){return typeof r!="string"?{success:!1,error:"Expected string, received ".concat(Kr(r))}:{success:!0,value:r}})}},{key:"date",value:function(){return e.createSchema(function(r){return r instanceof Date?{success:!0,value:r}:{success:!1,error:"Expected date, received ".concat(Kr(r))}})}},{key:"boolean",value:function(){return e.createSchema(function(r){return typeof r!="boolean"?{success:!1,error:"Expected boolean, received ".concat(Kr(r))}:{success:!0,value:r}})}},{key:"number",value:function(){return e.createSchema(function(r){return typeof r!="number"?{success:!1,error:"Expected number, received ".concat(Kr(r))}:{success:!0,value:r}})}},{key:"function",value:function(){return e.createSchema(function(r){return typeof r!="function"?{success:!1,error:"Expected function, received ".concat(Kr(r))}:{success:!0,value:r}})}},{key:"array",value:function(r){return e.createSchema(function(n){if(!Array.isArray(n))return{success:!1,error:"Expected array, received ".concat(Kr(n))};for(var a=0;a<n.length;a++){var i=r.validate(n[a]);if(!i.success)return{success:!1,error:"".concat(i.error," at index ").concat(a)}}return{success:!0,value:n}})}},{key:"any",value:function(){return e.createSchema(function(r){return{success:!0,value:r}})}},{key:"isRegex",value:function(){return e.createSchema(function(r){return r instanceof RegExp?{success:!0,value:r}:{success:!1,error:"Expected RegExp, received ".concat(Kr(r))}})}},{key:"union",value:function(r){return e.createSchema(function(n){for(var a=0;a<r.length;a++){var i=r[a],s=i.validate(n);if(s.success)return s}return{success:!1,error:"Value ".concat(n," does not match any schema in union")}})}},{key:"object",value:function(r){var n=e.createSchema(function(a){if(a==null)return{success:!1,error:"Expected object, received ".concat(a)};if(Kr(a)!=="object")return{success:!1,error:"Expected object, received ".concat(Kr(a))};for(var i=0,s=Object.entries(r);i<s.length;i++){var o=BF(s[i],2),l=o[0],u=o[1],c=u.validate(a[l]);if(!c.success)return{success:!1,error:"".concat(c.error," at ").concat(l)}}return{success:!0,value:a}});return n.strict=function(){return e.createSchema(function(a){var i=n.validate(a);if(!i.success)return i;var s=Object.keys(a).filter(function(o){return!(o in r)});return s.length>0?{success:!1,error:"Unexpected properties: ".concat(s.join(", "))}:i})},n}},{key:"record",value:function(r){return e.createSchema(function(n){if(n===null)return{success:!1,error:"Expected object, received null"};if(Kr(n)!=="object")return{success:!1,error:"Expected object, received ".concat(Kr(n))};for(var a=0,i=Object.keys(n);a<i.length;a++){var s=i[a];if(typeof s!="string")return{success:!1,error:"Expected string key, received ".concat(Kr(s)," at ").concat(s)};var o=r.validate(n[s]);if(!o.success)return{success:!1,error:"".concat(o.error," at key ").concat(s)}}return{success:!0,value:n}})}}])}(),KF=XF,bp,Ty;function ZF(){if(Ty)return bp;Ty=1;var e=Mr,t=e.str2xml,r="_rels/.rels";function n(a){for(var i=a.files[r],s=i?t(i.asText()):null,o=s?s.getElementsByTagName("Relationship"):[],l={},u=0;u<o.length;u++){var c=o[u];l[c.getAttribute("Target")]=c.getAttribute("Type")}return l}return bp={getRelsTypes:n},bp}var Ep,Sy;function QF(){if(Sy)return Ep;Sy=1;var e=Mr,t=e.str2xml,r="[Content_Types].xml";function n(i,s,o){for(var l={},u=0;u<i.length;u++){var c=i[u],h=c.getAttribute("ContentType"),p=c.getAttribute("PartName").substr(1);l[p]=h}return o.file(/./).map(function(v){for(var E=v.name,g=0;g<s.length;g++){var w=s[g],x=w.getAttribute("ContentType"),y=w.getAttribute("Extension");E.slice(E.length-y.length)===y&&!l[E]&&E!==r&&(l[E]=x)}l[E]||(l[E]="")}),l}function a(i){var s=i.files[r],o=s?t(s.asText()):null,l=o?o.getElementsByTagName("Override"):null,u=o?o.getElementsByTagName("Default"):null;return{overrides:l,defaults:u,contentTypes:s,contentTypeXml:o}}return Ep={collectContentTypes:n,getContentTypes:a},Ep}var _p,Ay;function go(){if(Ay)return _p;Ay=1;var e=Ba,t=e.XTInternalError;function r(){}function n(a){return a}return _p=function(a){var i={on:r,set:r,getFileType:r,optionsTransformer:n,preparse:n,matchers:function(){return[]},parse:r,getTraits:r,postparse:n,errorsTransformer:n,preResolve:r,resolve:r,getRenderedMap:n,render:r,nullGetter:r,postrender:n};if(Object.keys(i).every(function(l){return!a[l]})){var s=new t("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw s.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},s}for(var o in i)a[o]||(a[o]=i[o]);return a},_p}var Tp,Ny;function yx(){if(Ny)return Tp;Ny=1;function e(C){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},e(C)}function t(C){return a(C)||n(C)||o(C)||r()}function r(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(C){if(typeof Symbol<"u"&&C[Symbol.iterator]!=null||C["@@iterator"]!=null)return Array.from(C)}function a(C){if(Array.isArray(C))return l(C)}function i(C,R){return c(C)||u(C,R)||o(C,R)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(C,R){if(C){if(typeof C=="string")return l(C,R);var X={}.toString.call(C).slice(8,-1);return X==="Object"&&C.constructor&&(X=C.constructor.name),X==="Map"||X==="Set"?Array.from(C):X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X)?l(C,R):void 0}}function l(C,R){(R==null||R>C.length)&&(R=C.length);for(var X=0,te=Array(R);X<R;X++)te[X]=C[X];return te}function u(C,R){var X=C==null?null:typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(X!=null){var te,K,M,Q,be=[],Te=!0,J=!1;try{if(M=(X=X.call(C)).next,R!==0)for(;!(Te=(te=M.call(X)).done)&&(be.push(te.value),be.length!==R);Te=!0);}catch(I){J=!0,K=I}finally{try{if(!Te&&X.return!=null&&(Q=X.return(),Object(Q)!==Q))return}finally{if(J)throw K}}return be}}function c(C){if(Array.isArray(C))return C}function h(C,R){var X=Object.keys(C);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(C);R&&(te=te.filter(function(K){return Object.getOwnPropertyDescriptor(C,K).enumerable})),X.push.apply(X,te)}return X}function p(C){for(var R=1;R<arguments.length;R++){var X=arguments[R]!=null?arguments[R]:{};R%2?h(Object(X),!0).forEach(function(te){v(C,te,X[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(X)):h(Object(X)).forEach(function(te){Object.defineProperty(C,te,Object.getOwnPropertyDescriptor(X,te))})}return C}function v(C,R,X){return(R=E(R))in C?Object.defineProperty(C,R,{value:X,enumerable:!0,configurable:!0,writable:!0}):C[R]=X,C}function E(C){var R=g(C,"string");return e(R)=="symbol"?R:R+""}function g(C,R){if(e(C)!="object"||!C)return C;var X=C[Symbol.toPrimitive];if(X!==void 0){var te=X.call(C,R);if(e(te)!="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(C)}var w=Mr,x=w.getRightOrNull,y=w.getRight,b=w.getLeft,_=w.getLeftOrNull,N=w.chunkBy,k=w.isTagStart,T=w.isTagEnd,A=w.isContent,S=w.last,P=w.first,F=Ba,U=F.XTTemplateError,re=F.throwExpandNotFound,le=F.getLoopPositionProducesInvalidXMLError;function pe(C,R){if(C.length===0)return!1;var X=S(C).substr(1);return X.indexOf(R)===0}function me(C){for(var R=[],X=0;X<C.length;X++){var te=C[X],K=te.position,M=te.value,Q=te.tag;Q&&(K==="end"?pe(R,Q)?R.pop():R.push(M):K==="start"&&R.push(M))}return R}function Ee(C,R){for(var X=0;X<R.length;X++){var te=R[X];if(te.indexOf("<".concat(C))===0)return!0}return!1}function fe(C,R,X){for(var te=me(C.slice(R[0].offset,R[1].offset)),K=function(){var Te=X[Q],J=Te.contains,I=Te.expand,j=Te.onlyTextInTag;if(Ee(J,te)){if(j){var Y=_(C,J,R[0].offset),oe=x(C,J,R[1].offset);if(Y===null||oe===null)return 0;var Ze=C.slice(Y,oe),Ge=N(Ze,function($e){return k(J,$e)?"start":T(J,$e)?"end":null}),xt=P(Ge),rt=S(Ge),zt=xt.filter(A),ft=rt.filter(A);if(zt.length!==1||ft.length!==1)return 0}for(var ht=de(te),kt=0,Tt=0;Tt<ht.length;Tt++){var Dt=ht[Tt],ke=Dt.tag,Re=Dt.position;ke===I&&(Re==="start"&&kt++,Re==="end"&&kt--)}return kt!==0?{v:{error:le({tag:P(R).part.value,offset:[P(R).part.offset,S(R).part.offset]})}}:{v:{value:I}}}},M,Q=0;Q<X.length;Q++)if(M=K(),M!==0&&M)return M.v;return Ye(te)?{}:{error:le({tag:P(R).part.value,offset:[P(R).part.offset,S(R).part.offset]})}}function de(C){for(var R=[],X=0;X<C.length;X++){var te=C[X],K=Ce(te),M=/^\s*<\//.test(te)?"end":"start";R.push({tag:K,position:M})}return R}function Ce(C){return C.replace(/^\s*<\/?([a-zA-Z:]+).*/,"$1")}function Ye(C){if(C.length%2===1)return!1;for(var R=0,X=C.length/2;R<X;R++){var te=C[R],K=C[C.length-R-1],M=Ce(te),Q=Ce(K);if(M!==Q)return!1}return!0}function V(C,R,X,te){var K=C.expandTo||te.expandTo;if(K){var M,Q;try{Q=b(X,K,R),M=y(X,K,R)}catch(J){var be=p({part:C,rootError:J,postparsed:X,expandTo:K,index:R},te.error);if(te.onError){var Te=te.onError(be);if(Te==="ignore")return}re(be)}return[Q,M]}}function se(C,R,X,te){var K=i(C,2),M=K[0],Q=K[1],be=X.indexOf(R),Te=X.slice(M,be),J=X.slice(be+1,Q+1),I=te.getInner({postparse:te.postparse,index:be,part:R,leftParts:Te,rightParts:J,left:M,right:Q,postparsed:X});return I.length||(I.expanded=[Te,J],I=[I]),{left:M,right:Q,inner:I}}function ee(C,R){var X=[];C.errors&&(X=C.errors,C=C.postparsed);for(var te=[],K=0,M=C.length;K<M;K++){var Q=C[K];if(Q.type==="placeholder"&&Q.module===R.moduleName&&!Q.subparsed&&!Q.expanded)try{var be=V(Q,K,C,R);if(!be)continue;var Te=i(be,2),J=Te[0],I=Te[1];te.push({left:J,right:I,part:Q,i:K,leftPart:C[J],rightPart:C[I]})}catch(ft){X.push(ft)}}te.sort(function(ft,ht){return ft.left===ht.left?ht.part.lIndex<ft.part.lIndex?1:-1:ht.left<ft.left?1:-1});for(var j=-1,Y=0,oe=0,Ze=te.length;oe<Ze;oe++){var Ge,xt=te[oe];if(j=Math.max(j,oe>0?te[oe-1].right:0),!(xt.left<j)){var rt=void 0;try{rt=se([xt.left+Y,xt.right+Y],xt.part,C,R)}catch(ft){if(R.onError){var zt=R.onError(p({part:xt.part,rootError:ft,postparsed:C,expandOne:se},R.errors));if(zt==="ignore")continue}if(ft instanceof U)X.push(ft);else throw ft}rt&&(Y+=rt.inner.length-(rt.right+1-rt.left),(Ge=C).splice.apply(Ge,[rt.left,rt.right+1-rt.left].concat(t(rt.inner))))}}return{postparsed:C,errors:X}}return Tp={expandToOne:ee,getExpandToDefault:fe},Tp}var Sp,Dy;function wx(){if(Dy)return Sp;Dy=1;var e="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",t="application/vnd.ms-word.document.macroEnabled.main+xml",r="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",n="application/vnd.ms-word.template.macroEnabledTemplate.main+xml",a="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",i="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",s="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",o="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",l="application/vnd.openxmlformats-officedocument.presentationml.slide+xml",u="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml",c="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml",h="application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml",p="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",v="application/vnd.ms-excel.sheet.macroEnabled.main+xml",E="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",g=[e,t,r,n],w={main:g,docx:[a].concat(g,[o,i,s]),pptx:[l,u,c,h],xlsx:[p,v,E]};return Sp=w,Sp}var Ap,Cy;function ES(){if(Cy)return Ap;Cy=1;var e="application/vnd.openxmlformats-package.core-properties+xml",t="application/vnd.openxmlformats-officedocument.extended-properties+xml",r="application/vnd.openxmlformats-officedocument.custom-properties+xml",n="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",a="application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",i="application/vnd.ms-office.drawingml.diagramDrawing+xml";return Ap={settingsContentType:n,coreContentType:e,appContentType:t,customContentType:r,diagramDataContentType:a,diagramDrawingContentType:i},Ap}var Np,ky;function JF(){if(ky)return Np;ky=1;function e(b){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},e(b)}function t(b,_){if(!(b instanceof _))throw new TypeError("Cannot call a class as a function")}function r(b,_){for(var N=0;N<_.length;N++){var k=_[N];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(b,a(k.key),k)}}function n(b,_,N){return _&&r(b.prototype,_),Object.defineProperty(b,"prototype",{writable:!1}),b}function a(b){var _=i(b,"string");return e(_)=="symbol"?_:_+""}function i(b,_){if(e(b)!="object"||!b)return b;var N=b[Symbol.toPrimitive];if(N!==void 0){var k=N.call(b,_);if(e(k)!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(b)}var s=Mr,o=s.pushArray,l=go(),u=wx(),c=ES(),h=c.settingsContentType,p=c.coreContentType,v=c.appContentType,E=c.customContentType,g=c.diagramDataContentType,w=c.diagramDrawingContentType,x=[h,p,v,E,g,w],y=function(){function b(){t(this,b),this.name="Common"}return n(b,[{key:"getFileType",value:function(N){var k=N.doc,T=k.invertedContentTypes;if(T){for(var A=0;A<x.length;A++){var S=x[A];T[S]&&o(k.targets,T[S])}for(var P=["docx","pptx","xlsx"],F,U=0;U<P.length;U++)for(var re=P[U],le=u[re],pe=0;pe<le.length;pe++){var me=le[pe];if(T[me])for(var Ee=0,fe=T[me];Ee<fe.length;Ee++){var de=fe[Ee];k.relsTypes[de]&&["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(k.relsTypes[de])===-1||(F=re,(u.main.indexOf(me)!==-1||me===u.pptx[0])&&(k.textTarget||(k.textTarget=de)),F!=="xlsx"&&k.targets.push(de))}}return F}}}])}();return Np=function(){return l(new y)},Np}var Dp,Oy;function eP(){if(Oy)return Dp;Oy=1;function e(w){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},e(w)}function t(w,x){if(!(w instanceof x))throw new TypeError("Cannot call a class as a function")}function r(w,x){for(var y=0;y<x.length;y++){var b=x[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(w,a(b.key),b)}}function n(w,x,y){return x&&r(w.prototype,x),Object.defineProperty(w,"prototype",{writable:!1}),w}function a(w){var x=i(w,"string");return e(x)=="symbol"?x:x+""}function i(w,x){if(e(w)!="object"||!w)return w;var y=w[Symbol.toPrimitive];if(y!==void 0){var b=y.call(w,x);if(e(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}var s=Ba,o=s.getScopeParserExecutionError,l=mx,u=l.last,c=Mr,h=c.concatArrays;function p(w,x){for(var y=w.length>>>0,b,_=0;_<y;_++)if(b=w[_],x.call(this,b,_,w))return b}function v(w,x,y){var b=this,_=this.scopeList[y];if(this.root.finishedResolving){for(var N=this.resolved,k=function(){var U=b.scopeLindex[T];N=p(N,function(re){return re.lIndex===U}),N=N.value[b.scopePathItem[T]]},T=this.resolveOffset,A=this.scopePath.length;T<A;T++)k();return p(N,function(F){return x.part.lIndex===F.lIndex}).value}var S,P;!this.cachedParsers||!x.part?P=this.parser(w,{tag:x.part,scopePath:this.scopePath}):this.cachedParsers[x.part.lIndex]?P=this.cachedParsers[x.part.lIndex]:P=this.cachedParsers[x.part.lIndex]=this.parser(w,{tag:x.part,scopePath:this.scopePath});try{S=P.get(_,this.getContext(x,y))}catch(F){throw o({tag:w,scope:_,error:F,offset:x.part.offset})}return S==null&&y>0?v.call(this,w,x,y-1):S}function E(w,x,y){var b=this,_=this.scopeList[y],N;return!this.cachedParsers||!x.part?N=this.parser(w,{tag:x.part,scopePath:this.scopePath}):this.cachedParsers[x.part.lIndex]?N=this.cachedParsers[x.part.lIndex]:N=this.cachedParsers[x.part.lIndex]=this.parser(w,{tag:x.part,scopePath:this.scopePath}),Promise.resolve().then(function(){return N.get(_,b.getContext(x,y))}).catch(function(k){throw o({tag:w,scope:_,error:k,offset:x.part.offset})}).then(function(k){return k==null&&y>0?E.call(b,w,x,y-1):k})}var g=function(){function w(x){t(this,w),this.root=x.root||this,this.resolveOffset=x.resolveOffset||0,this.scopePath=x.scopePath,this.scopePathItem=x.scopePathItem,this.scopePathLength=x.scopePathLength,this.scopeList=x.scopeList,this.scopeType="",this.scopeTypes=x.scopeTypes,this.scopeLindex=x.scopeLindex,this.parser=x.parser,this.resolved=x.resolved,this.cachedParsers=x.cachedParsers}return n(w,[{key:"loopOver",value:function(y,b,_,N){return this.loopOverValue(this.getValue(y,N),b,_)}},{key:"functorIfInverted",value:function(y,b,_,N,k){return y&&b(_,N,k),y}},{key:"isValueFalsy",value:function(y,b){return y==null||!y||b==="[object Array]"&&y.length===0}},{key:"loopOverValue",value:function(y,b,_){this.root.finishedResolving&&(_=!1);var N=Object.prototype.toString.call(y);if(this.isValueFalsy(y,N))return this.scopeType=!1,this.functorIfInverted(_,b,u(this.scopeList),0,1);if(N==="[object Array]"){this.scopeType="array";for(var k=0;k<y.length;k++)this.functorIfInverted(!_,b,y[k],k,y.length);return!0}return N==="[object Object]"?(this.scopeType="object",this.functorIfInverted(!_,b,y,0,1)):this.functorIfInverted(!_,b,u(this.scopeList),0,1)}},{key:"getValue",value:function(y,b){var _=v.call(this,y,b,this.scopeList.length-1);return typeof _=="function"?_(this.scopeList[this.scopeList.length-1],this):_}},{key:"getValueAsync",value:function(y,b){var _=this;return E.call(this,y,b,this.scopeList.length-1).then(function(N){return typeof N=="function"?N(_.scopeList[_.scopeList.length-1],_):N})}},{key:"getContext",value:function(y,b){return{num:b,meta:y,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(y,b,_,N,k){return new w({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:h([this.scopeTypes,[this.scopeType]]),scopeList:h([this.scopeList,[y]]),scopePath:h([this.scopePath,[b]]),scopePathItem:h([this.scopePathItem,[_]]),scopePathLength:h([this.scopePathLength,[k]]),scopeLindex:h([this.scopeLindex,[N.lIndex]])})}}])}();return Dp=function(w){return w.scopePath=[],w.scopePathItem=[],w.scopePathLength=[],w.scopeTypes=[],w.scopeLindex=[],w.scopeList=[w.tags],new g(w)},Dp}var Cp,Fy;function _S(){if(Fy)return Cp;Fy=1;function e(C){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},e(C)}function t(C,R){return s(C)||i(C,R)||n(C,R)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(C,R){if(C){if(typeof C=="string")return a(C,R);var X={}.toString.call(C).slice(8,-1);return X==="Object"&&C.constructor&&(X=C.constructor.name),X==="Map"||X==="Set"?Array.from(C):X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X)?a(C,R):void 0}}function a(C,R){(R==null||R>C.length)&&(R=C.length);for(var X=0,te=Array(R);X<R;X++)te[X]=C[X];return te}function i(C,R){var X=C==null?null:typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(X!=null){var te,K,M,Q,be=[],Te=!0,J=!1;try{if(M=(X=X.call(C)).next,R!==0)for(;!(Te=(te=M.call(X)).done)&&(be.push(te.value),be.length!==R);Te=!0);}catch(I){J=!0,K=I}finally{try{if(!Te&&X.return!=null&&(Q=X.return(),Object(Q)!==Q))return}finally{if(J)throw K}}return be}}function s(C){if(Array.isArray(C))return C}function o(C,R){var X=Object.keys(C);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(C);R&&(te=te.filter(function(K){return Object.getOwnPropertyDescriptor(C,K).enumerable})),X.push.apply(X,te)}return X}function l(C){for(var R=1;R<arguments.length;R++){var X=arguments[R]!=null?arguments[R]:{};R%2?o(Object(X),!0).forEach(function(te){u(C,te,X[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(X)):o(Object(X)).forEach(function(te){Object.defineProperty(C,te,Object.getOwnPropertyDescriptor(X,te))})}return C}function u(C,R,X){return(R=c(R))in C?Object.defineProperty(C,R,{value:X,enumerable:!0,configurable:!0,writable:!0}):C[R]=X,C}function c(C){var R=h(C,"string");return e(R)=="symbol"?R:R+""}function h(C,R){if(e(C)!="object"||!C)return C;var X=C[Symbol.toPrimitive];if(X!==void 0){var te=X.call(C,R);if(e(te)!="object")return te;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(C)}var p=Ba,v=p.getUnclosedTagException,E=p.getUnopenedTagException,g=p.getDuplicateOpenTagException,w=p.getDuplicateCloseTagException,x=p.throwMalformedXml,y=p.throwXmlInvalid,b=p.XTTemplateError,_=Mr,N=_.isTextStart,k=_.isTextEnd,T=_.wordToUtf8,A=_.pushArray,S=0,P=1,F=2,U=3;function re(C,R){return C[0]<=R.offset&&R.offset<C[1]}function le(C,R){return N(C)?(R&&x(),!0):k(C)?(R||x(),!1):R}function pe(C){var R="",X=1,te=C.indexOf(" ");return C[C.length-2]==="/"?(R="selfclosing",te===-1&&(te=C.length-2)):C[1]==="/"?(X=2,R="end",te===-1&&(te=C.length-1)):(R="start",te===-1&&(te=C.length-1)),{tag:C.slice(X,te),position:R}}function me(C,R,X){for(var te=0,K=C.length,M={},Q=0;Q<R.length;Q++){var be=R[Q];M[be]=!0}for(var Te=0;Te<X.length;Te++){var J=X[Te];M[J]=!1}for(var I=[];te<K&&(te=C.indexOf("<",te),te!==-1);){var j=te,Y=C.indexOf("<",te+1);te=C.indexOf(">",te),(te===-1||Y!==-1&&te>Y)&&y(C,j);var oe=C.slice(j,te+1),Ze=pe(oe),Ge=Ze.tag,xt=Ze.position,rt=M[Ge];rt!=null&&I.push({type:"tag",position:xt,text:rt,offset:j,value:oe,tag:Ge})}return I}function Ee(C,R,X){var te=[],K=!1,M={offset:0},Q,be=C.reduce(function(J,I){var j=I.position,Y=I.offset,oe=M.offset,Ze=M.length;if(Q=R.substr(oe,Y-oe),K&&j==="start"){if(oe+Ze===Y&&(Q=R.substr(oe,Y-oe+Ze+4),!X.allowUnclosedTag))return te.push(g({xtag:Q,offset:oe})),M=I,J.push(l(l({},I),{},{error:!0})),J;if(!X.allowUnclosedTag)return te.push(v({xtag:T(Q),offset:oe})),M=I,J.push(l(l({},I),{},{error:!0})),J;J.pop()}return!K&&j==="end"?X.allowUnopenedTag?J:oe+Ze===Y?(Q=R.substr(oe-4,Y-oe+Ze+4),te.push(w({xtag:Q,offset:oe})),M=I,J.push(l(l({},I),{},{error:!0})),J):(te.push(E({xtag:Q,offset:Y})),M=I,J.push(l(l({},I),{},{error:!0})),J):(K=j==="start",M=I,J.push(I),J)},[]);if(K){var Te=M.offset;Q=R.substr(Te,R.length-Te),X.allowUnclosedTag?be.pop():te.push(v({xtag:T(Q),offset:Te}))}return{delimiterWithErrors:be,errors:te}}function fe(C,R){return C===-1&&R===-1?S:C===R?P:C===-1||R===-1?R<C?F:U:C<R?F:U}function de(C){var R=C.split(" ");if(R.length!==2){var X=new b("New Delimiters cannot be parsed");throw X.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},X}var te=t(R,2),K=te[0],M=te[1];if(K.length===0||M.length===0){var Q=new b("New Delimiters cannot be parsed");throw Q.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},Q}return[K,M]}function Ce(C,R,X){var te=[],K=R.start,M=R.end,Q=-1,be=!1;if(K==null&&M==null)return[];for(;;){var Te=C.indexOf(K,Q+1),J=C.indexOf(M,Q+1),I=null,j=void 0,Y=fe(Te,J);switch(Y===P&&(Y=be?U:F),Y){case S:return te;case U:be=!1,Q=J,I="end",j=M.length;break;case F:be=!0,Q=Te,I="start",j=K.length;break}if(X.changeDelimiterPrefix&&Y===F&&C[Q+K.length]===X.changeDelimiterPrefix){te.push({offset:Te,position:"start",length:K.length,changedelimiter:!0});var oe=C.indexOf(X.changeDelimiterPrefix,Q+K.length+1),Ze=C.indexOf(M,oe+1);te.push({offset:Ze,position:"end",length:M.length,changedelimiter:!0});var Ge=C.substr(Q+K.length+1,oe-Q-K.length-1),xt=de(Ge),rt=t(xt,2);K=rt[0],M=rt[1],Q=Ze;continue}te.push({offset:Q,position:I,length:j})}}function Ye(C,R,X){var te=C.map(function(oe){return oe.value}).join(""),K=Ce(te,R,X),M=0,Q=C.map(function(oe){return M+=oe.value.length,{offset:M-oe.value.length,lIndex:oe.lIndex}}),be=Ee(K,te,X),Te=be.delimiterWithErrors,J=be.errors,I=0,j=0,Y=Q.map(function(oe,Ze){for(var Ge=oe.offset,xt=[Ge,Ge+C[Ze].value.length],rt=C[Ze].value,zt=[];j<Te.length&&re(xt,Te[j]);)zt.push(Te[j]),j++;var ft=[],ht=0;I>0&&(ht=I,I=0);for(var kt=0;kt<zt.length;kt++){var Tt=zt[kt],Dt=rt.substr(ht,Tt.offset-Ge-ht);if(Tt.changedelimiter){Tt.position==="start"?Dt.length>0&&ft.push({type:"content",value:Dt}):ht=Tt.offset-Ge+Tt.length;continue}Dt.length>0&&(ft.push({type:"content",value:Dt}),ht+=Dt.length);var ke={type:"delimiter",position:Tt.position,offset:ht+Ge};ft.push(ke),ht=Tt.offset-Ge+Tt.length}I=ht-rt.length;var Re=rt.substr(ht);return Re.length>0&&ft.push({type:"content",value:Re}),ft},this);return{parsed:Y,errors:J}}function V(C){return C.type==="content"&&C.position==="insidetag"}function se(C){return C.filter(V)}function ee(C,R){for(var X=!1,te=0;te<C.length;te++){var K=C[te];X=le(K,X),K.type==="content"&&(K.position=X?"insidetag":"outsidetag"),R!=="text"&&V(K)&&(K.value=K.value.replace(/>/g,"&gt;"))}}return Cp={parseDelimiters:Ye,parse:function(R,X,te,K){ee(R,K);for(var M=Ye(se(R),X,te),Q=M.parsed,be=M.errors,Te=[],J=0,I=0,j=0;j<R.length;j++){var Y=R[j];if(V(Y)){for(var oe=0,Ze=Q[J];oe<Ze.length;oe++){var Ge=Ze[oe];Ge.type==="content"&&(Ge.position="insidetag"),Ge.lIndex=I++}A(Te,Q[J]),J++}else Y.lIndex=I++,Te.push(Y)}return{errors:be,lexed:Te}},xmlparse:function(R,X){for(var te=me(R,X.text,X.other),K=0,M=[],Q=0;Q<te.length;Q++){var be=te[Q];R.length>K&&be.offset-K>0&&M.push({type:"content",value:R.substr(K,be.offset-K)}),K=be.offset+be.value.length,delete be.offset,M.push(be)}return R.length>K&&M.push({type:"content",value:R.substr(K)}),M}},Cp}var kp,Py;function tP(){if(Py)return kp;Py=1;function e(l){return a(l)||n(l)||r(l)||t()}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(l,u){if(l){if(typeof l=="string")return i(l,u);var c={}.toString.call(l).slice(8,-1);return c==="Object"&&l.constructor&&(c=l.constructor.name),c==="Map"||c==="Set"?Array.from(l):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i(l,u):void 0}}function n(l){if(typeof Symbol<"u"&&l[Symbol.iterator]!=null||l["@@iterator"]!=null)return Array.from(l)}function a(l){if(Array.isArray(l))return i(l)}function i(l,u){(u==null||u>l.length)&&(u=l.length);for(var c=0,h=Array(u);c<u;c++)h[c]=l[c];return h}function s(l){return l.type==="placeholder"}function o(l){var u={},c=[{items:l.filter(s),parents:[],path:[]}];function h(me,Ee,fe){fe.length&&c.push({items:fe,parents:[].concat(e(Ee.parents),[me]),path:me.dataBound!==!1&&!me.attrParsed&&me.value&&!me.attrParsed?[].concat(e(Ee.path),[me.value]):e(Ee.path)})}function p(me,Ee){for(var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee.length,de=me,Ce=0;Ce<fe;Ce++)de=de[Ee[Ce]];return de}function v(me,Ee){for(var fe=Ee.length,de=0;de<Ee.length;de++){var Ce=Ee[de],Ye=typeof Ce.lIndex=="number"?Ce.lIndex:parseInt(Ce.lIndex.split("-")[0],10);Ye>me.lIndex&&fe--}return fe}for(;c.length>0;)for(var E=c.pop(),g=p(u,E.path),w=0,x=E.items;w<x.length;w++){var y,b,_=x[w];if(_.attrParsed){for(var N in _.attrParsed)h(_,E,_.attrParsed[N].filter(s));continue}if(_.subparsed){if(_.dataBound!==!1){var k,T;(k=g)[T=_.value]||(k[T]={})}h(_,E,_.subparsed.filter(s));continue}if(_.cellParsed){for(var A=0,S=_.cellPostParsed;A<S.length;A++){var P=S[A];if(P.type==="placeholder"){if(P.module==="pro-xml-templating/xls-module-loop")continue;if(P.subparsed){var F,U;(F=g)[U=P.value]||(F[U]={}),h(P,E,P.subparsed.filter(s))}else{var re,le,pe=v(_,E.parents);g=p(u,E.path,pe),(re=g)[le=P.value]||(re[le]={})}}}continue}_.dataBound!==!1&&((y=g)[b=_.value]||(y[b]={}))}return u}return kp={getTags:o,isPlaceholder:s},kp}var Op,Iy;function rP(){if(Iy)return Op;Iy=1;var e=Mr,t=e.pushArray;function r(a,i){return i instanceof Error?t(Object.getOwnPropertyNames(i),["stack"]).reduce(function(s,o){return s[o]=i[o],o==="stack"&&(s[o]=i[o].toString()),s},{}):i}function n(a,i){if(console.log(JSON.stringify({error:a},r,i==="json"?2:null)),a.properties&&a.properties.errors instanceof Array){var s=a.properties.errors.map(function(o){return o.properties.explanation}).join(`
`);console.log("errorMessages",s)}}return Op=n,Op}var Fp,Ry;function TS(){if(Ry)return Fp;Ry=1;var e=Mr,t=e.pregMatchAll;return Fp=function(n,a){var i={content:n},s=a.join("|"),o=new RegExp("(?:(<(?:".concat(s,")[^>]*>)([^<>]*)</(?:").concat(s,")>)|(<(?:").concat(s,")[^>]*/>)"),"g");return i.matches=t(o,i.content),i},Fp}var Pp,jy;function nP(){if(jy)return Pp;jy=1;function e(s){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},e(s)}var t=new RegExp("","g");function r(s){return s.replace(t," ")}function n(s,o){var l=e(s);if(l==="string")return r(o.substr(0,s.length))===s;if(s instanceof RegExp)return s.test(r(o));if(l==="function")return!!s(o)}function a(s,o){var l=e(s);if(l==="string")return r(o).substr(s.length);if(s instanceof RegExp)return r(o).match(s)[1];if(l==="function")return s(o)}function i(s,o){var l=e(s);if(l==="string")return[o,r(o).substr(s.length)];if(s instanceof RegExp)return r(o).match(s);if(l==="function")return[o,s(o)]}return Pp={match:n,getValue:a,getValues:i},Pp}var Ip,My;function aP(){if(My)return Ip;My=1;function e(T){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},e(T)}function t(T,A){var S=Object.keys(T);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(T);A&&(P=P.filter(function(F){return Object.getOwnPropertyDescriptor(T,F).enumerable})),S.push.apply(S,P)}return S}function r(T){for(var A=1;A<arguments.length;A++){var S=arguments[A]!=null?arguments[A]:{};A%2?t(Object(S),!0).forEach(function(P){n(T,P,S[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(S)):t(Object(S)).forEach(function(P){Object.defineProperty(T,P,Object.getOwnPropertyDescriptor(S,P))})}return T}function n(T,A,S){return(A=a(A))in T?Object.defineProperty(T,A,{value:S,enumerable:!0,configurable:!0,writable:!0}):T[A]=S,T}function a(T){var A=i(T,"string");return e(A)=="symbol"?A:A+""}function i(T,A){if(e(T)!="object"||!T)return T;var S=T[Symbol.toPrimitive];if(S!==void 0){var P=S.call(T,A);if(e(P)!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(T)}function s(T,A){return h(T)||c(T,A)||l(T,A)||o()}function o(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l(T,A){if(T){if(typeof T=="string")return u(T,A);var S={}.toString.call(T).slice(8,-1);return S==="Object"&&T.constructor&&(S=T.constructor.name),S==="Map"||S==="Set"?Array.from(T):S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S)?u(T,A):void 0}}function u(T,A){(A==null||A>T.length)&&(A=T.length);for(var S=0,P=Array(A);S<A;S++)P[S]=T[S];return P}function c(T,A){var S=T==null?null:typeof Symbol<"u"&&T[Symbol.iterator]||T["@@iterator"];if(S!=null){var P,F,U,re,le=[],pe=!0,me=!1;try{if(U=(S=S.call(T)).next,A!==0)for(;!(pe=(P=U.call(S)).done)&&(le.push(P.value),le.length!==A);pe=!0);}catch(Ee){me=!0,F=Ee}finally{try{if(!pe&&S.return!=null&&(re=S.return(),Object(re)!==re))return}finally{if(me)throw F}}return le}}function h(T){if(Array.isArray(T))return T}var p=Mr,v=p.wordToUtf8,E=p.pushArray,g=nP(),w=g.match,x=g.getValue,y=g.getValues;function b(T,A){for(var S=[],P=0;P<T.length;P++){var F=T[P];if(F.matchers){var U=F.matchers(A);if(!(U instanceof Array))throw new Error("module matcher returns a non array");E(S,U)}}return S}function _(T,A,S){for(var P=[],F=0;F<T.length;F++){var U=T[F],re=s(U,2),le=re[0],pe=re[1],me=U[2]||{};if(S.match(le,A)){var Ee=S.getValues(le,A);if(typeof me=="function"&&(me=me(Ee)),!me.value){var fe=s(Ee,2);me.value=fe[1]}P.push(r({type:"placeholder",prefix:le,module:pe,onMatch:me.onMatch,priority:me.priority},me))}}return P}function N(T,A){var S=A.modules,P=A.startOffset,F=A.lIndex,U;A.offset=P,A.match=w,A.getValue=x,A.getValues=y;var re=b(S,A),le=_(re,T,A);if(le.length>0){for(var pe=null,me=0;me<le.length;me++){var Ee=le[me];Ee.priority||(Ee.priority=-Ee.value.length),(!pe||Ee.priority>pe.priority)&&(pe=Ee)}return pe.offset=P,delete pe.priority,pe.endLindex=F,pe.lIndex=F,pe.raw=T,pe.onMatch&&pe.onMatch(pe),delete pe.onMatch,delete pe.prefix,pe}for(var fe=0;fe<S.length;fe++){var de=S[fe];if(U=de.parse(T,A),U)return U.offset=P,U.endLindex=F,U.lIndex=F,U.raw=T,U}return{type:"placeholder",value:T,offset:P,endLindex:F,lIndex:F}}var k={preparse:function(A,S,P){function F(U,re){for(var le=0;le<S.length;le++){var pe=S[le];U=pe.preparse(U,re)||U}return U}return F(A,P)},parse:function(A,S,P){var F=!1,U="",re,le=[],pe=P.fileTypeConfig.droppedTagsInsidePlaceholder||[];return A.reduce(function(me,Ee){return Ee.type==="delimiter"?(F=Ee.position==="start",Ee.position==="end"&&(P.parse=function(fe){return N(fe,r(r(r({},P),Ee),{},{startOffset:re,modules:S}))},me.push(P.parse(v(U))),E(me,le),le=[]),Ee.position==="start"&&(le=[],re=Ee.offset),U="",me):F?Ee.type!=="content"||Ee.position!=="insidetag"?(pe.indexOf(Ee.tag)!==-1||le.push(Ee),me):(U+=Ee.value,me):(me.push(Ee),me)},[])},postparse:function(A,S,P){function F(le,pe,me){for(var Ee=[],fe=0;fe<S.length;fe++){var de=S[fe];Ee.push(de.getTraits(le,pe,me))}return Ee}var U=[];function re(le,pe){for(var me=le,Ee=0;Ee<S.length;Ee++){var fe=S[Ee],de=fe.postparse(me,r(r({},pe),{},{postparse:function(Ye,V){return re(Ye,r(r({},pe),V))},getTraits:F}));if(de!=null){if(de.errors){E(U,de.errors),me=de.postparsed;continue}me=de}}return me}return{postparsed:re(A,P),errors:U}}};return Ip=k,Ip}var Rp,Ly;function SS(){if(Ly)return Rp;Ly=1;function e(t,r){if(t.lIndex==null)return null;var n=r.scopeManager.scopePathItem;t.parentPart&&(n=n.slice(0,n.length-1));var a=r.filePath+"@"+t.lIndex.toString()+"-"+n.join("-");return a}return Rp=e,Rp}var jp,By;function iP(){if(By)return jp;By=1;var e=Ba,t=e.throwUnimplementedTagType,r=e.XTScopeParserError,n=Mr,a=n.pushArray,i=SS();function s(l,u){for(var c=0,h=u.modules;c<h.length;c++){var p=h[c],v=p.render(l,u);if(v)return v}return!1}function o(l){var u=l.baseNullGetter,c=l.compiled,h=l.scopeManager;l.nullGetter=function(N,k){return u(N,k||h)};for(var p=[],v=[],E=0,g=c.length;E<g;E++){var w=c[E];l.index=E,l.resolvedId=i(w,l);var x=void 0;try{x=s(w,l)}catch(N){if(N instanceof r){p.push(N),v.push(w);continue}throw N}if(x){x.errors&&a(p,x.errors),v.push(x);continue}if(w.type==="content"||w.type==="tag"){v.push(w);continue}t(w,E)}for(var y=[],b=0;b<v.length;b++){var _=v[b].value;_ instanceof Array?a(y,_):_&&y.push(_)}return{errors:p,parts:y}}return jp=o,jp}var Mp,Uy;function sP(){if(Uy)return Mp;Uy=1;function e(r){var n,a,i,s,o=0,l=r.length;for(i=0;i<l;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<l&&(a=r.charCodeAt(i+1),(a&64512)===56320&&(n=65536+(n-55296<<10)+(a-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;var u=new Uint8Array(o);for(s=0,i=0;s<o;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<l&&(a=r.charCodeAt(i+1),(a&64512)===56320&&(n=65536+(n-55296<<10)+(a-56320),i++)),n<128?u[s++]=n:n<2048?(u[s++]=192|n>>>6,u[s++]=128|n&63):n<65536?(u[s++]=224|n>>>12,u[s++]=128|n>>>6&63,u[s++]=128|n&63):(u[s++]=240|n>>>18,u[s++]=128|n>>>12&63,u[s++]=128|n>>>6&63,u[s++]=128|n&63);return u}function t(r,n){for(var a=0,i=n.modules;a<i.length;a++){var s=i[a];r=s.postrender(r,n)}for(var o=0,l=n.joinUncorrupt(r,n),u="",c=0,h=65536,p=[],v=0,E=l.length;v<E;v++){var g=l[v];if(g.length+c>h){var w=e(u);o+=w.length,p.push(w),u=""}u+=g,c+=g.length,delete l[v]}var x=e(u);o+=x.length,p.push(x);for(var y=new Uint8Array(o),b=0,_=0;_<p.length;_++){for(var N=p[_],k=0;k<N.length;++k)y[k+b]=N[k];b+=N.length}return y}return Mp=t,Mp}var Lp,zy;function oP(){if(zy)return Lp;zy=1;function e(E){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},e(E)}function t(E,g){var w=Object.keys(E);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(E);g&&(x=x.filter(function(y){return Object.getOwnPropertyDescriptor(E,y).enumerable})),w.push.apply(w,x)}return w}function r(E){for(var g=1;g<arguments.length;g++){var w=arguments[g]!=null?arguments[g]:{};g%2?t(Object(w),!0).forEach(function(x){n(E,x,w[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(w)):t(Object(w)).forEach(function(x){Object.defineProperty(E,x,Object.getOwnPropertyDescriptor(w,x))})}return E}function n(E,g,w){return(g=a(g))in E?Object.defineProperty(E,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):E[g]=w,E}function a(E){var g=i(E,"string");return e(g)=="symbol"?g:g+""}function i(E,g){if(e(E)!="object"||!E)return E;var w=E[Symbol.toPrimitive];if(w!==void 0){var x=w.call(E,g);if(e(x)!="object")return x;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(E)}var s=Mr,o=s.pushArray,l=SS();function u(E,g){for(var w=0,x=g.modules;w<x.length;w++){var y=x[w],b=y.resolve(E,g);if(b)return b}return!1}function c(E,g,w,x){var y=u(E,r(r({},x),{},{resolvedId:l(E,x)}));if(y)return y.then(function(b){g.push({tag:E.value,lIndex:E.lIndex,value:b})}).catch(function(b){b instanceof Array?o(w,b):w.push(b)});if(E.type==="placeholder")return x.scopeManager.getValueAsync(E.value,{part:E}).then(function(b){return b??x.nullGetter(E)}).then(function(b){g.push({tag:E.value,lIndex:E.lIndex,value:b})}).catch(function(b){b instanceof Array?o(w,b):w.push(b)})}function h(E){var g=[],w=[],x=E.baseNullGetter,y=E.scopeManager;E.nullGetter=function(_,N){return x(_,N||y)},E.resolved=g;var b=p(E,w,g);return b?b.then(function(){return v(E,w,g)}):v(E,w,g)}function p(E,g,w){for(var x=null,y=function(){var k=_[b];if(["content","tag"].indexOf(k.type)!==-1)return 1;k.resolveFirst&&(x??(x=Promise.resolve(null)),x=x.then(function(){return c(k,w,g,E)}))},b=0,_=E.compiled;b<_.length;b++)y();return x}function v(E,g,w){for(var x=[],y=0,b=E.compiled;y<b.length;y++){var _=b[y];["content","tag"].indexOf(_.type)===-1&&(_.resolveFirst||x.push(c(_,w,g,E)))}return Promise.all(x).then(function(){return{errors:g,resolved:w}})}return Lp=h,Lp}var Bp,qy;function lP(){if(qy)return Bp;qy=1;var e=Mr,t=e.startsWith,r=e.endsWith,n=e.isStarting,a=e.isEnding,i=e.isWhiteSpace,s=wx();function o(u){for(var c="",h=0,p=u.length;h<p;h++){var v=u[h];i(v)||t(v,"<w:bookmarkEnd")||(r(c,"</w:tbl>")&&!t(v,"<w:p")&&!t(v,"<w:tbl")&&!t(v,"<w:sectPr")&&!t(v,"</w:ftr>")&&!t(v,"</w:hdr>")&&(v="<w:p/>".concat(v)),c=v,u[h]=v)}return u}function l(u,c){var h=c.fileTypeConfig.tagShouldContain||[],p="",v=-1;s.docx.indexOf(c.contentType)!==-1&&(u=o(u));for(var E=-1,g=0,w=h.length;g<w;g++)for(var x=h[g],y=x.tag,b=x.shouldContain,_=x.value,N=x.drop,k=x.dropParent,T=0,A=u.length;T<A;T++){var S=u[T];if(v===g){if(a(S,y))if(v=-1,k){for(var P=-1,F=E;F>0;F--)if(n(u[F],k)){P=F;break}for(var U=P;U<=u.length;U++){if(a(u[U],k)){u[U]="";break}u[U]=""}}else{for(var re=E;re<=T;re++)u[re]="";N||(u[T]=p+_+S)}p+=S;for(var le=0,pe=b.length;le<pe;le++){var me=b[le];if(n(S,me)){v=-1;break}}}v===-1&&n(S,y)&&S.substr(1).indexOf("<")===-1&&(S[S.length-2]==="/"?u[T]="":(E=T,v=g,p=S))}return u}return Bp=l,Bp}var Up,Wy;function uP(){if(Wy)return Up;Wy=1;function e(y){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},e(y)}function t(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function r(y,b){for(var _=0;_<b.length;_++){var N=b[_];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(y,a(N.key),N)}}function n(y,b,_){return b&&r(y.prototype,b),Object.defineProperty(y,"prototype",{writable:!1}),y}function a(y){var b=i(y,"string");return e(b)=="symbol"?b:b+""}function i(y,b){if(e(y)!="object"||!y)return y;var _=y[Symbol.toPrimitive];if(_!==void 0){var N=_.call(y,b);if(e(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(y)}var s=Mr,o=s.pushArray,l=s.wordToUtf8,u=s.convertSpaces,c=TS(),h=_S(),p=aP(),v=iP(),E=sP(),g=oP(),w=lP();function x(y,b){var _=c(y,b),N=_.matches.map(function(k){return k.array[2]});return l(u(N.join("")))}return Up=function(){function y(b,_){t(this,y),this.cachedParsers={},this.content=b;for(var N in _)this[N]=_[N];this.setModules({inspect:{filePath:_.filePath}})}return n(y,[{key:"resolveTags",value:function(_){var N=this;this.tags=_;var k=this.getOptions(),T=this.filePath;k.scopeManager=this.scopeManager,k.resolve=g;var A=[];return Promise.all(this.modules.map(function(S){return Promise.resolve(S.preResolve(k)).catch(function(P){A.push(P)})})).then(function(){if(A.length!==0)throw A;return g(k).then(function(S){var P=S.resolved,F=S.errors;if(F=F.map(function(U){var re;return U instanceof Error||(U=new Error(U)),(re=U).properties||(re.properties={}),U.properties.file=T,U}),F.length!==0)throw F;return Promise.all(P).then(function(U){return k.scopeManager.root.finishedResolving=!0,k.scopeManager.resolved=U,N.setModules({inspect:{resolved:U,filePath:T}}),U})}).catch(function(S){throw N.errorChecker(S),S})})}},{key:"getFullText",value:function(){return x(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(_){for(var N=0,k=this.modules;N<k.length;N++){var T=k[N];T.set(_)}}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=h.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var _=h.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),N=_.lexed,k=_.errors;o(this.allErrors,k),this.lexed=N,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var T=this.getOptions();this.lexed=p.preparse(this.lexed,this.modules,T)}},{key:"parse",value:function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=_.noPostParse;this.setModules({inspect:{filePath:this.filePath}});var k=this.getOptions();return this.parsed=p.parse(this.lexed,this.modules,k),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}}),N?this:this.postparse()}},{key:"postparse",value:function(){var _=this.getOptions(),N=p.postparse(this.parsed,this.modules,_),k=N.postparsed,T=N.errors;return this.postparsed=k,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),o(this.allErrors,T),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(_){for(var N=0,k=_;N<k.length;N++){var T=k[N];T.properties||(T.properties={}),T.properties.file=this.filePath}for(var A=0,S=this.modules;A<S.length;A++){var P=S[A];_=P.errorsTransformer(_)}}},{key:"baseNullGetter",value:function(_,N){for(var k=null,T=0,A=this.modules;T<A.length;T++){var S=A[T];k==null&&(k=S.nullGetter(_,N,this))}return k??this.nullGetter(_,N)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function(_){this.filePath=_;var N=this.getOptions();N.resolved=this.scopeManager.resolved,N.scopeManager=this.scopeManager,N.render=v,N.joinUncorrupt=w;var k=v(N),T=k.errors,A=k.parts;return T.length>0?(this.allErrors=T,this.errorChecker(T),this):(this.content=E(A,N),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}])}(),Up}var zp,$y;function cP(){if($y)return zp;$y=1;function e(J){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},e(J)}function t(J,I){var j=Object.keys(J);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(J);I&&(Y=Y.filter(function(oe){return Object.getOwnPropertyDescriptor(J,oe).enumerable})),j.push.apply(j,Y)}return j}function r(J){for(var I=1;I<arguments.length;I++){var j=arguments[I]!=null?arguments[I]:{};I%2?t(Object(j),!0).forEach(function(Y){n(J,Y,j[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(j)):t(Object(j)).forEach(function(Y){Object.defineProperty(J,Y,Object.getOwnPropertyDescriptor(j,Y))})}return J}function n(J,I,j){return(I=v(I))in J?Object.defineProperty(J,I,{value:j,enumerable:!0,configurable:!0,writable:!0}):J[I]=j,J}function a(J,I){return u(J)||l(J,I)||s(J,I)||i()}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s(J,I){if(J){if(typeof J=="string")return o(J,I);var j={}.toString.call(J).slice(8,-1);return j==="Object"&&J.constructor&&(j=J.constructor.name),j==="Map"||j==="Set"?Array.from(J):j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j)?o(J,I):void 0}}function o(J,I){(I==null||I>J.length)&&(I=J.length);for(var j=0,Y=Array(I);j<I;j++)Y[j]=J[j];return Y}function l(J,I){var j=J==null?null:typeof Symbol<"u"&&J[Symbol.iterator]||J["@@iterator"];if(j!=null){var Y,oe,Ze,Ge,xt=[],rt=!0,zt=!1;try{if(Ze=(j=j.call(J)).next,I!==0)for(;!(rt=(Y=Ze.call(j)).done)&&(xt.push(Y.value),xt.length!==I);rt=!0);}catch(ft){zt=!0,oe=ft}finally{try{if(!rt&&j.return!=null&&(Ge=j.return(),Object(Ge)!==Ge))return}finally{if(zt)throw oe}}return xt}}function u(J){if(Array.isArray(J))return J}function c(J,I){if(!(J instanceof I))throw new TypeError("Cannot call a class as a function")}function h(J,I){for(var j=0;j<I.length;j++){var Y=I[j];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(J,v(Y.key),Y)}}function p(J,I,j){return I&&h(J.prototype,I),Object.defineProperty(J,"prototype",{writable:!1}),J}function v(J){var I=E(J,"string");return e(I)=="symbol"?I:I+""}function E(J,I){if(e(J)!="object"||!J)return J;var j=J[Symbol.toPrimitive];if(j!==void 0){var Y=j.call(J,I);if(e(Y)!="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(J)}var g=Mr,w=g.chunkBy,x=g.last,y=g.isParagraphStart,b=g.isModule,_=g.pushArray,N=g.isParagraphEnd,k=g.isContent,T=g.startsWith,A=g.isTagEnd,S=g.isTagStart,P=g.getSingleAttribute,F=g.setSingleAttribute,U=wx(),re=go(),le="loop";function pe(J){for(var I=0;I<J.length;I++){var j=J[I];if(k(j))return!0}return!1}function me(J){for(var I=0;I<J.length;I++){var j=J[I];if(j.type!=="content")return j}return null}function Ee(J){var I=me(J.subparsed);return I!=null&&I.tag!=="w:t"}function fe(J){return J.hasPageBreak&&Ee(J)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function de(J){return J.length&&y(J[0])&&N(x(J))}function Ce(J){return pe(J)?0:J.length}function Ye(J){var I=J.parts.length-1;J.parts[I]==="</w:p>"?J.parts.splice(I,0,'<w:r><w:br w:type="page"/></w:r>'):J.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function V(J){J.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function se(J){for(var I=0;I<J.length;I++){var j=J[I];if(S("w:type",j)&&j.value.indexOf("continuous")!==-1)return!0}return!1}function ee(J){for(var I=0;I<J.length;I++){var j=J[I];if(S("w:type",j)&&j.value.indexOf('w:val="nextPage"')!==-1)return!0}return!1}function C(J,I){J.unshift("<w:p><w:pPr>".concat(I.map(function(j){var Y=j.value;return Y}).join(""),"</w:pPr></w:p>"))}function R(J){for(var I=!1,j=!1,Y=0;Y<J.length;Y++){var oe=J[Y];!I&&T(oe,"<w:sectPr")&&(j=!0),j&&(T(oe,"<w:type")&&(I=!0),!I&&T(oe,"</w:sectPr")&&(J.splice(Y,0,'<w:type w:val="continuous"/>'),Y++))}return J}function X(J){for(var I=0,j=0;j<J.length;j++)!T(J[j],"<w:headerReference")&&!T(J[j],"<w:footerReference")&&(J[I]=J[j],I++);return J.length=I,J}function te(J){for(var I=0;I<J.length;I++){var j=J[I];if(j.tag==="w:br"&&j.value.indexOf('w:type="page"')!==-1)return!0}return!1}function K(J){for(var I=0;I<J.length;I++){var j=J[I];if(j.tag==="w:drawing")return!0}return!1}function M(J){for(var I=[],j=null,Y=0;Y<J.length;Y++){var oe=J[Y];S("w:sectPr",oe)&&(j=[],I.push(j)),j!==null&&j.push(oe),A("w:sectPr",oe)&&(j=null)}return I}function Q(J){for(var I=!1,j=0,Y=0;Y<J.length;Y++){var oe=J[Y];S("w:sectPr",oe)&&(I=!0),I&&(oe.tag==="w:headerReference"||oe.tag==="w:footerReference")&&(j++,I=!1),A("w:sectPr",oe)&&(I=!1)}return j}function be(J){for(var I=[],j=!1,Y=J.length-1;Y>=0;Y--){var oe=J[Y];if(A("w:sectPr",oe)&&(j=!0),S("w:sectPr",oe)&&(I.unshift(oe.value),j=!1),j&&I.unshift(oe.value),y(oe)){if(I.length>0)return I.join("");break}}return""}var Te=function(){function J(){c(this,J),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}return p(J,[{key:"optionsTransformer",value:function(j,Y){return this.docxtemplater=Y,j}},{key:"preparse",value:function(j,Y){var oe=Y.contentType;U.main.indexOf(oe)!==-1&&(this.sects=M(j))}},{key:"matchers",value:function(){var j=le;return[[this.prefix.start,j,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,j,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,j,{location:"end"}],[this.prefix.dash,j,function(Y){var oe=a(Y,3),Ze=oe[1],Ge=oe[2];return{location:"start",inverted:!1,expandTo:Ze,value:Ge}}]]}},{key:"getTraits",value:function(j,Y){if(j==="expandPair"){for(var oe=[],Ze=0,Ge=Y.length;Ze<Ge;Ze++){var xt=Y[Ze];b(xt,le)&&xt.subparsed==null&&oe.push({part:xt,offset:Ze})}return oe}}},{key:"postparse",value:function(j,Y){var oe=Y.basePart;if(oe&&this.docxtemplater.fileType==="docx"&&j.length>0){oe.sectPrCount=Q(j),this.totalSectPr+=oe.sectPrCount;for(var Ze=this.sects,Ge=0,xt=Ze.length;Ge<xt;Ge++){var rt=Ze[Ge];if(oe.lIndex<rt[0].lIndex){Ge+1<Ze.length&&se(Ze[Ge+1])&&(oe.addContinuousType=!0);break}if(j[0].lIndex<rt[0].lIndex&&rt[0].lIndex<oe.lIndex){ee(Ze[Ge])&&(oe.addNextPage={index:Ge});break}}oe.lastParagrapSectPr=be(j)}if(!oe||oe.expandTo!=="auto"||oe.module!==le||!de(j))return j;oe.paragraphLoop=!0;var zt=0,ft=w(j,function(ke){return y(ke)&&(zt++,zt===1)?"start":N(ke)&&(zt--,zt===0)?"end":null}),ht=ft[0],kt=x(ft),Tt=Ce(ht),Dt=Ce(kt);return oe.hasPageBreakBeginning=te(ht),oe.hasPageBreak=te(kt),K(ht)&&(Tt=0),K(kt)&&(Dt=0),j.slice(Tt,j.length-Dt)}},{key:"resolve",value:function(j,Y){var oe=this;if(!b(j,le))return null;var Ze=Y.scopeManager,Ge=Ze.getValueAsync(j.value,{part:j}),xt=[],rt;oe.resolveSerially&&(rt=Promise.resolve(null));function zt(ht,kt,Tt){var Dt=Ze.createSubScopeManager(ht,j.value,kt,j,Tt);oe.resolveSerially?(rt=rt.then(function(){return Y.resolve(r(r({},Y),{},{compiled:j.subparsed,tags:{},scopeManager:Dt}))}),xt.push(rt)):xt.push(Y.resolve(r(r({},Y),{},{compiled:j.subparsed,tags:{},scopeManager:Dt})))}var ft=[];return Ge.then(function(ht){return ht??(ht=Y.nullGetter(j)),ht instanceof Promise?ht.then(function(kt){return kt instanceof Array?Promise.all(kt):kt}):ht instanceof Array?Promise.all(ht):ht}).then(function(ht){return Ze.loopOverValue(ht,zt,j.inverted),Promise.all(xt).then(function(kt){return kt.map(function(Tt){var Dt=Tt.resolved,ke=Tt.errors;return _(ft,ke),Dt})}).then(function(kt){if(ft.length>0)throw ft;return kt})})}},{key:"render",value:function(j,Y){var oe=this;if(j.tag==="p:xfrm"&&(oe.inXfrm=j.position==="start"),j.tag==="a:ext"&&oe.inXfrm)return oe.lastExt=j,j;if(!b(j,le))return null;var Ze=[],Ge=[],xt=0,rt=j.subparsed[0],zt=0;(rt==null?void 0:rt.tag)==="a:tr"&&(zt=+P(rt.value,"h")),xt-=zt;var ft=0,ht=Ee(j);function kt(Re,$e,dt){xt+=zt;for(var xe=Y.scopeManager.createSubScopeManager(Re,j.value,$e,j,dt),ve=0,ae=j.subparsed;ve<ae.length;ve++){var ue=ae[ve];if(S("a16:rowId",ue)){var Me=+P(ue.value,"val")+ft;ft=1,ue.value=F(ue.value,"val",Me)}}var je=Y.render(r(r({},Y),{},{compiled:j.subparsed,tags:{},scopeManager:xe}));j.hasPageBreak&&$e===dt-1&&ht&&Ye(je);var et=xe.scopePathItem.some(function(Ke){return Ke!==0});et?(j.sectPrCount===1&&(je.parts=X(je.parts)),j.addContinuousType&&(je.parts=R(je.parts))):j.addNextPage&&C(je.parts,oe.sects[j.addNextPage.index]),j.addNextPage&&Ye(je),j.hasPageBreakBeginning&&ht&&V(je);for(var it=0,St=je.parts;it<St.length;it++){var It=St[it];Ze.push(It)}_(Ge,je.errors)}var Tt=Y.scopeManager.getValue(j.value,{part:j});Tt??(Tt=Y.nullGetter(j));var Dt=Y.scopeManager.loopOverValue(Tt,kt,j.inverted);if(Dt===!1)return j.lastParagrapSectPr?j.paragraphLoop?{value:"<w:p><w:pPr>".concat(j.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(j.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:fe(j)||"",errors:Ge};if(xt!==0){var ke=+P(oe.lastExt.value,"cy");oe.lastExt.value=F(oe.lastExt.value,"cy",ke+xt)}return{value:Y.joinUncorrupt(Ze,r(r({},Y),{},{basePart:j})),errors:Ge}}}])}();return zp=function(){return re(new Te)},zp}var qp,Gy;function fP(){if(Gy)return qp;Gy=1;function e(N){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},e(N)}function t(N,k){if(!(N instanceof k))throw new TypeError("Cannot call a class as a function")}function r(N,k){for(var T=0;T<k.length;T++){var A=k[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(N,a(A.key),A)}}function n(N,k,T){return k&&r(N.prototype,k),Object.defineProperty(N,"prototype",{writable:!1}),N}function a(N){var k=i(N,"string");return e(k)=="symbol"?k:k+""}function i(N,k){if(e(N)!="object"||!N)return N;var T=N[Symbol.toPrimitive];if(T!==void 0){var A=T.call(N,k);if(e(A)!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}var s=go(),o=Mr,l=o.isTextStart,u=o.isTextEnd,c=o.endsWith,h=o.startsWith,p=o.pushArray,v='<w:t xml:space="preserve">',E=v.length,g="</w:t>",w=g.length;function x(N){return l(N)&&N.tag==="w:t"}function y(N,k){var T=N[k].value;return N[k+1].value==="</w:t>"||T.indexOf('xml:space="preserve"')!==-1?T:T.substr(0,T.length-1)+' xml:space="preserve">'}function b(N,k){return N&&N.basePart&&k.length>1}var _=function(){function N(){t(this,N),this.name="SpacePreserveModule"}return n(N,[{key:"postparse",value:function(T,A){var S=[],P=!1,F=0,U=0;function re(pe,me){return pe.type==="placeholder"&&me.length>1}var le=T.reduce(function(pe,me){return x(me)&&(P=!0,U=S.length),P?(S.push(me),b(A,S)&&(F=A.basePart.endLindex,S[0].value=y(S,0)),re(me,S)&&(S[U].value=y(S,U),F=me.endLindex),u(me)&&me.lIndex>F&&(F!==0&&(S[U].value=y(S,U)),p(pe,S),S=[],P=!1,F=0,U=0),pe):(pe.push(me),pe)},[]);return p(le,S),le}},{key:"postrender",value:function(T){for(var A="",S=0,P=0,F=T.length;P<F;P++){var U=T[P];U!==""&&(c(A,v)&&h(U,g)&&(T[S]=A.substr(0,A.length-E)+"<w:t/>",U=U.substr(w)),A=U,S=P,T[P]=U)}return T}}])}();return qp=function(){return s(new _)},qp}var Wp,Hy;function dP(){if(Hy)return Wp;Hy=1;function e(w){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},e(w)}function t(w,x){if(!(w instanceof x))throw new TypeError("Cannot call a class as a function")}function r(w,x){for(var y=0;y<x.length;y++){var b=x[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(w,a(b.key),b)}}function n(w,x,y){return x&&r(w.prototype,x),Object.defineProperty(w,"prototype",{writable:!1}),w}function a(w){var x=i(w,"string");return e(x)=="symbol"?x:x+""}function i(w,x){if(e(w)!="object"||!w)return w;var y=w[Symbol.toPrimitive];if(y!==void 0){var b=y.call(w,x);if(e(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}var s=yx(),o=Mr,l=o.isContent,u=Ba,c=u.throwRawTagShouldBeOnlyTextInParagraph,h=u.getInvalidRawXMLValueException,p=go(),v="rawxml";function E(w){for(var x=w.part,y=w.left,b=w.right,_=w.postparsed,N=w.index,k=_.slice(y+1,b),T=0,A=k.length;T<A;T++)if(T!==N-y-1){var S=k[T];l(S)&&c({paragraphParts:k,part:x})}return x}var g=function(){function w(){t(this,w),this.name="RawXmlModule",this.prefix="@"}return n(w,[{key:"optionsTransformer",value:function(y,b){return this.fileTypeConfig=b.fileTypeConfig,y}},{key:"matchers",value:function(){return[[this.prefix,v]]}},{key:"postparse",value:function(y){return s.expandToOne(y,{moduleName:v,getInner:E,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(_){return'The tag "'.concat(_.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(y,b){if(y.module!==v)return null;var _,N=[];try{_=b.scopeManager.getValue(y.value,{part:y}),_??(_=b.nullGetter(y))}catch(k){return N.push(k),{errors:N}}return _=_||"",typeof _=="string"?{value:_}:{errors:[h({tag:y.value,value:_,offset:y.offset})]}}}])}();return Wp=function(){return p(new g)},Wp}var $p,Vy;function hP(){if(Vy)return $p;Vy=1;function e(t,r){for(var n=-1,a=0,i=t.length;a<i;a++)r[a]>=t[a].length||(n===-1||t[a][r[a]].offset<t[n][r[n]].offset)&&(n=a);return n}return $p=function(t){for(var r=0,n=0,a=t;n<a.length;n++){var i=a[n];r+=i.length}t=t.filter(function(c){return c.length>0});for(var s=new Array(r),o=t.map(function(){return 0}),l=0;l<r;l++){var u=e(t,o);s[l]=t[u][o[u]],o[u]++}return s},$p}var Gp,Yy;function pP(){if(Yy)return Gp;Yy=1;function e(A){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},e(A)}function t(A,S){if(!(A instanceof S))throw new TypeError("Cannot call a class as a function")}function r(A,S){for(var P=0;P<S.length;P++){var F=S[P];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(A,a(F.key),F)}}function n(A,S,P){return S&&r(A.prototype,S),Object.defineProperty(A,"prototype",{writable:!1}),A}function a(A){var S=i(A,"string");return e(S)=="symbol"?S:S+""}function i(A,S){if(e(A)!="object"||!A)return A;var P=A[Symbol.toPrimitive];if(P!==void 0){var F=P.call(A,S);if(e(F)!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(A)}var s="expandPair",o=hP(),l=Mr,u=l.getLeft,c=l.getRight,h=l.pushArray,p=go(),v=yx(),E=v.getExpandToDefault,g=Ba,w=g.getUnmatchedLoopException,x=g.getClosingTagNotMatchOpeningTag,y=g.getUnbalancedLoopException;function b(A){switch(A.location){case"start":return 1;case"end":return-1}}function _(A,S){return A!=null&&S!=null&&(A.part.location==="start"&&S.part.location==="end"&&A.part.value===S.part.value||S.part.value==="")}function N(A){for(var S=0,P=[];S<A.length;){var F=A[S].part;if(F.location==="end"){if(S===0)return A.splice(0,1),P.push(w(F)),{traits:A,errors:P};var U=S,re=S-1,le=1;if(_(A[re],A[U]))return A.splice(U,1),A.splice(re,1),{errors:P,traits:A};for(;le<50;){var pe=A[re-le],me=A[U+le];if(_(pe,A[U]))return A.splice(U,1),A.splice(re-le,1),{errors:P,traits:A};if(_(A[re],me))return A.splice(U+le,1),A.splice(re,1),{errors:P,traits:A};le++}return P.push(x({tags:[A[re].part,A[U].part]})),A.splice(U,1),A.splice(re,1),{traits:A,errors:P}}S++}for(var Ee=0;Ee<A.length;Ee++){var fe=A[Ee].part;P.push(w(fe))}return{traits:[],errors:P}}function k(A){var S={},P=[],F=[],U=[];for(h(U,A);U.length>0;){var re=N(U);h(P,re.errors),U=re.traits}if(P.length>0)return{pairs:F,errors:P};for(var le=0,pe=0;pe<A.length;pe++){var me=A[pe],Ee=me.part,fe=b(Ee);if(le+=fe,fe===1)S[le]=me;else{var de=S[le+1];le===0&&F.push([de,me])}le=le>=0?le:0}return{pairs:F,errors:P}}var T=function(){function A(){t(this,A),this.name="ExpandPairTrait"}return n(A,[{key:"optionsTransformer",value:function(P,F){return F.options.paragraphLoop&&h(F.fileTypeConfig.expandTags,F.fileTypeConfig.onParagraphLoop),this.expandTags=F.fileTypeConfig.expandTags,P}},{key:"postparse",value:function(P,F){var U=this,re=F.getTraits,le=F.postparse,pe=F.fileType,me=re(s,P,F);me=me.map(function(R){return R||[]}),me=o(me);var Ee=k(me),fe=Ee.pairs,de=Ee.errors,Ce=0,Ye=null,V=fe.map(function(R){var X=R[0].part.expandTo;if(X==="auto"&&pe!=="text"){var te=E(P,R,U.expandTags);te.error&&de.push(te.error),X=te.value}if(!X||pe==="text"){var K=R[0].offset,M=R[1].offset;return K<Ce&&!U.docxtemplater.options.syntax.allowUnbalancedLoops&&de.push(y(R,Ye)),Ye=R,Ce=M,[K,M]}var Q,be;try{Q=u(P,X,R[0].offset)}catch(Te){de.push(Te)}try{be=c(P,X,R[1].offset)}catch(Te){de.push(Te)}return Q<Ce&&!U.docxtemplater.options.syntax.allowUnbalancedLoops&&de.push(y(R,Ye)),Ce=be,Ye=R,[Q,be]});if(de.length>0)return{postparsed:P,errors:de};var se=0,ee,C=P.reduce(function(R,X,te){var K=se<fe.length&&V[se][0]<=te&&te<=V[se][1],M=fe[se],Q=V[se];if(!K)return R.push(X),R;if(Q[0]===te&&(ee=[]),M[0].offset!==te&&M[1].offset!==te&&ee.push(X),Q[1]===te){var be=P[M[0].offset];be.subparsed=le(ee,{basePart:be}),be.endLindex=M[1].part.lIndex,delete be.location,delete be.expandTo,R.push(be),se++;for(var Te=V[se];Te&&Te[0]<te;)se++,Te=V[se]}return R},[]);return{postparsed:C,errors:de}}}])}();return Gp=function(){return p(new T)},Gp}var Hp,Xy;function mP(){if(Xy)return Hp;Xy=1;function e(k){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},e(k)}function t(k,T){if(!(k instanceof T))throw new TypeError("Cannot call a class as a function")}function r(k,T){for(var A=0;A<T.length;A++){var S=T[A];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(k,a(S.key),S)}}function n(k,T,A){return T&&r(k.prototype,T),Object.defineProperty(k,"prototype",{writable:!1}),k}function a(k){var T=i(k,"string");return e(T)=="symbol"?T:T+""}function i(k,T){if(e(k)!="object"||!k)return k;var A=k[Symbol.toPrimitive];if(A!==void 0){var S=A.call(k,T);if(e(S)!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(k)}var s=go(),o=Ba,l=o.getScopeCompilationError,u=o.getCorruptCharactersException,c=Mr,h=c.utf8ToWord,p=c.hasCorruptCharacters,v=c.removeCorruptCharacters,E=ES(),g=E.settingsContentType,w=E.coreContentType,x=E.appContentType,y=E.customContentType,b=[g,w,x,y],_={docx:"w",pptx:"a"},N=function(){function k(){t(this,k),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return n(k,[{key:"set",value:function(A){A.compiled&&(this.compiled=A.compiled),A.data!=null&&(this.data=A.data)}},{key:"optionsTransformer",value:function(A,S){return this.docxtemplater=S,this.brTag=S.fileType==="docx"?"<w:r><w:br/></w:r>":"<a:br/>",this.prefix=_[S.fileType],this.runStartTag="".concat(this.prefix,":r"),this.runPropsStartTag="".concat(this.prefix,":rPr"),A}},{key:"postparse",value:function(A,S){for(var P=[],F=0;F<A.length;F++){var U=A[F];if(U.type==="placeholder"){var re=U.value;try{S.cachedParsers[U.lIndex]=this.docxtemplater.parser(re,{tag:U})}catch(le){P.push(l({tag:re,rootError:le,offset:U.offset}))}}}return{postparsed:A,errors:P}}},{key:"getRenderedMap",value:function(A){for(var S in this.compiled)A[S]={from:S,data:this.data};return A}},{key:"render",value:function(A,S){var P=S.contentType,F=S.scopeManager,U=S.linebreaks,re=S.nullGetter,le=S.fileType,pe=S.stripInvalidXMLChars;if(b.indexOf(P)!==-1&&(U=!1),U&&this.recordRuns(A),!(A.type!=="placeholder"||A.module)){var me;try{me=F.getValue(A.value,{part:A})}catch(Ee){return{errors:[Ee]}}if(me??(me=re(A)),typeof me=="string"){if(pe)me=v(me);else if(["docx","pptx","xlsx"].indexOf(le)!==-1&&p(me))return{errors:[u({tag:A.value,value:me,offset:A.offset})]}}return le==="text"?{value:me}:{value:U&&typeof me=="string"?this.renderLineBreaks(me):h(me)}}}},{key:"recordRuns",value:function(A){A.tag===this.runStartTag?this.recordedRun="":A.tag===this.runPropsStartTag?(A.position==="start"&&(this.recordRun=!0,this.recordedRun+=A.value),(A.position==="end"||A.position==="selfclosing")&&(this.recordedRun+=A.value,this.recordRun=!1)):this.recordRun&&(this.recordedRun+=A.value)}},{key:"renderLineBreaks",value:function(A){for(var S=[],P=A.split(`
`),F=0,U=P.length;F<U;F++)S.push(h(P[F])),F<P.length-1&&S.push("</".concat(this.prefix,":t></").concat(this.prefix,":r>").concat(this.brTag,"<").concat(this.prefix,":r>").concat(this.recordedRun,"<").concat(this.prefix,":t").concat(this.docxtemplater.fileType==="docx"?' xml:space="preserve"':"",">"));return S}}])}();return Hp=function(){return s(new N)},Hp}var Vp,Ky;function gP(){if(Ky)return Vp;Ky=1;var e=cP(),t=fP(),r=dP(),n=pP(),a=mP();function i(){return{getTemplatedFiles:function(){return[]},templatedNs:["http://schemas.microsoft.com/office/2006/coverPageProps"],textPath:function(l){return l.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","PublishDate","Abstract","CompanyAddress","CompanyPhone","CompanyFax","CompanyEmail","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:ftr","w:hdr","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[e,t,n,r,a],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:!0},{tag:"w:tbl",shouldContain:["w:tr"],drop:!0}]}}function s(){return{getTemplatedFiles:function(){return[]},textPath:function(l){return l.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[e,n,r,a],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}return Vp={docx:i,pptx:s},Vp}(function(e){var t=["modules"];function r(xe,ve){var ae=Object.keys(xe);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(xe);ve&&(ue=ue.filter(function(Me){return Object.getOwnPropertyDescriptor(xe,Me).enumerable})),ae.push.apply(ae,ue)}return ae}function n(xe){for(var ve=1;ve<arguments.length;ve++){var ae=arguments[ve]!=null?arguments[ve]:{};ve%2?r(Object(ae),!0).forEach(function(ue){a(xe,ue,ae[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(xe,Object.getOwnPropertyDescriptors(ae)):r(Object(ae)).forEach(function(ue){Object.defineProperty(xe,ue,Object.getOwnPropertyDescriptor(ae,ue))})}return xe}function a(xe,ve,ae){return(ve=x(ve))in xe?Object.defineProperty(xe,ve,{value:ae,enumerable:!0,configurable:!0,writable:!0}):xe[ve]=ae,xe}function i(xe,ve){return c(xe)||u(xe,ve)||o(xe,ve)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(xe,ve){if(xe){if(typeof xe=="string")return l(xe,ve);var ae={}.toString.call(xe).slice(8,-1);return ae==="Object"&&xe.constructor&&(ae=xe.constructor.name),ae==="Map"||ae==="Set"?Array.from(xe):ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae)?l(xe,ve):void 0}}function l(xe,ve){(ve==null||ve>xe.length)&&(ve=xe.length);for(var ae=0,ue=Array(ve);ae<ve;ae++)ue[ae]=xe[ae];return ue}function u(xe,ve){var ae=xe==null?null:typeof Symbol<"u"&&xe[Symbol.iterator]||xe["@@iterator"];if(ae!=null){var ue,Me,je,et,it=[],St=!0,It=!1;try{if(je=(ae=ae.call(xe)).next,ve===0){if(Object(ae)!==ae)return;St=!1}else for(;!(St=(ue=je.call(ae)).done)&&(it.push(ue.value),it.length!==ve);St=!0);}catch(Ke){It=!0,Me=Ke}finally{try{if(!St&&ae.return!=null&&(et=ae.return(),Object(et)!==et))return}finally{if(It)throw Me}}return it}}function c(xe){if(Array.isArray(xe))return xe}function h(xe){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},h(xe)}function p(xe,ve){if(xe==null)return{};var ae,ue,Me=v(xe,ve);if(Object.getOwnPropertySymbols){var je=Object.getOwnPropertySymbols(xe);for(ue=0;ue<je.length;ue++)ae=je[ue],ve.indexOf(ae)===-1&&{}.propertyIsEnumerable.call(xe,ae)&&(Me[ae]=xe[ae])}return Me}function v(xe,ve){if(xe==null)return{};var ae={};for(var ue in xe)if({}.hasOwnProperty.call(xe,ue)){if(ve.indexOf(ue)!==-1)continue;ae[ue]=xe[ue]}return ae}function E(xe,ve){if(!(xe instanceof ve))throw new TypeError("Cannot call a class as a function")}function g(xe,ve){for(var ae=0;ae<ve.length;ae++){var ue=ve[ae];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(xe,x(ue.key),ue)}}function w(xe,ve,ae){return ve&&g(xe.prototype,ve),Object.defineProperty(xe,"prototype",{writable:!1}),xe}function x(xe){var ve=y(xe,"string");return h(ve)=="symbol"?ve:ve+""}function y(xe,ve){if(h(xe)!="object"||!xe)return xe;var ae=xe[Symbol.toPrimitive];if(ae!==void 0){var ue=ae.call(xe,ve);if(h(ue)!="object")return ue;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(xe)}var b=Mr,_=KF,N=_.object({allowUnopenedTag:_.boolean().optional(),allowUnclosedTag:_.boolean().optional(),allowUnbalancedLoops:_.boolean().optional(),changeDelimiterPrefix:_.string().optional().nullable()}),k=_.object({delimiters:_.object({start:_.string().nullable(),end:_.string().nullable()}).strict().optional(),fileTypeConfig:_.object({}).optional(),paragraphLoop:_.boolean().optional(),parser:_.function().optional(),errorLogging:_.union([_.boolean(),_.string()]).optional(),linebreaks:_.boolean().optional(),nullGetter:_.function().optional(),syntax:N.optional(),stripInvalidXMLChars:_.boolean().optional(),warnFn:_.function().optional()}).strict(),T=ZF(),A=T.getRelsTypes,S=QF(),P=S.collectContentTypes,F=S.getContentTypes,U=go(),re=yx(),le=JF(),pe=eP(),me=_S(),Ee=tP(),fe=Ee.getTags,de=rP(),Ce=Ba,Ye=Ce.throwMultiError,V=Ce.throwResolveBeforeCompile,se=Ce.throwRenderInvalidTemplate,ee=Ce.throwRenderTwice,C=Ce.XTInternalError,R=Ce.XTTemplateError,X=Ce.throwFileTypeNotIdentified,te=Ce.throwFileTypeNotHandled,K=Ce.throwApiVersionError;b.getRelsTypes=A,b.traits=re,b.moduleWrapper=U,b.collectContentTypes=P,b.getContentTypes=F;var M=b.getDefaults,Q=b.str2xml,be=b.xml2str,Te=b.concatArrays,J=b.uniq,I=b.getDuplicates,j=b.stableSort,Y=b.pushArray,oe=b.utf8ToWord,Ze=b.invertMap,Ge="[Content_Types].xml",xt="_rels/.rels",rt=[3,47,2];function zt(xe){var ve=I(xe.map(function(ae){var ue=ae.name;return ue}));if(ve.length>0)throw new C('Detected duplicate module "'.concat(ve[0],'"'))}function ft(xe){for(var ve=0,ae=xe.modules;ve<ae.length;ve++)for(var ue=ae[ve],Me=0,je=ue.xmlContentTypes||[];Me<je.length;Me++)for(var et=je[Me],it=xe.invertedContentTypes[et]||[],St=0;St<it.length;St++){var It=it[St];xe.zip.files[It]&&xe.options.xmlFileNames.push(It)}}function ht(xe){return j(xe,function(ve,ae){return(ae.priority||0)-(ve.priority||0)})}function kt(xe){var ve=[];for(var ae in xe)ve.push(ae);for(var ue=[Ge,xt],Me=["word/","xl/","ppt/"],je=0;je<ve.length;je++)for(var et=ve[je],it=0;it<Me.length;it++){var St=Me[it];et.indexOf("".concat(St))===0&&ue.push(et)}for(var It=0;It<ve.length;It++){var Ke=ve[It];ue.indexOf(Ke)===-1&&ue.push(Ke)}return ue}function Tt(xe,ve){xe.hideDeprecations!==!0&&console.warn(ve)}function Dt(xe,ve){if(xe.hideDeprecations!==!0)return Tt(xe,'Deprecated method ".'.concat(ve,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat(new Error().stack))}function ke(xe){xe.modules=xe.modules.filter(function(ve){if(!ve.supportedFileTypes)return!0;if(!Array.isArray(ve.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var ae=ve.supportedFileTypes.includes(xe.fileType);return ae||ve.on("detached"),ae})}function Re(xe){var ve=xe.compiled;xe.errors=Te(Object.keys(ve).map(function(ae){return ve[ae].allErrors})),xe.errors.length!==0&&(xe.options.errorLogging&&de(xe.errors,xe.options.errorLogging),Ye(xe.errors))}function $e(xe){return typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(xe)}var dt=function(){function xe(ve){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=ae.modules,Me=ue===void 0?[]:ue,je=p(ae,t);if(E(this,xe),this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[le()],this.xmlDocuments={},arguments.length===0)Tt(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat(new Error().stack)),this.hideDeprecations=!0,this.setOptions(je);else{if(this.hideDeprecations=!0,this.setOptions(je),$e(ve))throw new Error("You passed a Buffer to the Docxtemplater constructor. The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!ve||!ve.files||typeof ve.file!="function")throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!Array.isArray(Me))throw new Error("The modules argument of docxtemplater's constructor must be an array");for(var et=0;et<Me.length;et++){var it=Me[et];this.attachModule(it)}this.loadZip(ve),this.compile(),this.v4Constructor=!0}this.hideDeprecations=!1}return w(xe,[{key:"verifyApiVersion",value:function(ae){return ae=ae.split(".").map(function(ue){return parseInt(ue,10)}),ae.length!==3&&K("neededVersion is not a valid version",{neededVersion:ae,explanation:"the neededVersion must be an array of length 3"}),ae[0]!==rt[0]&&K("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:ae,currentModuleApiVersion:rt,explanation:"moduleAPIVersionMismatch : needed=".concat(ae.join("."),", current=").concat(rt.join("."))}),ae[1]>rt[1]&&K("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:ae,currentModuleApiVersion:rt,explanation:"moduleAPIVersionMismatch : needed=".concat(ae.join("."),", current=").concat(rt.join("."))}),ae[1]===rt[1]&&ae[2]>rt[2]&&K("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:ae,currentModuleApiVersion:rt,explanation:"moduleAPIVersionMismatch : needed=".concat(ae.join("."),", current=").concat(rt.join("."))}),!0}},{key:"setModules",value:function(ae){for(var ue=0,Me=this.modules;ue<Me.length;ue++){var je=Me[ue];je.set(ae)}}},{key:"sendEvent",value:function(ae){for(var ue=0,Me=this.modules;ue<Me.length;ue++){var je=Me[ue];je.on(ae)}}},{key:"attachModule",value:function(ae){if(this.v4Constructor)throw new C("attachModule() should not be called manually when using the v4 constructor");Dt(this,"attachModule");var ue=h(ae);if(ue==="function")throw new C("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!ae||ue!=="object")throw new C("Cannot attachModule with a falsy value");if(ae.requiredAPIVersion&&this.verifyApiVersion(ae.requiredAPIVersion),ae.attached===!0)if(typeof ae.clone=="function")ae=ae.clone();else throw new Error('Cannot attach a module that was already attached : "'.concat(ae.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));ae.attached=!0;var Me=U(ae);return this.modules.push(Me),Me.on("attached"),this.fileType&&ke(this),this}},{key:"findModule",value:function(ae){for(var ue=0,Me=this.modules;ue<Me.length;ue++){var je=Me[ue];if(je.name===ae)return je}}},{key:"setOptions",value:function(ae){var ue,Me;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!ae)throw new Error("setOptions should be called with an object as first parameter");var je=k.validate(ae);if(je.success===!1)throw new Error(je.error);Dt(this,"setOptions"),this.options={};var et=M();for(var it in et){var St=et[it];this.options[it]=ae[it]!=null?ae[it]:this[it]||St,this[it]=this.options[it]}return(ue=this.delimiters).start&&(ue.start=oe(this.delimiters.start)),(Me=this.delimiters).end&&(Me.end=oe(this.delimiters.end)),this}},{key:"loadZip",value:function(ae){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(Dt(this,"loadZip"),ae.loadAsync)throw new C("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");ae.xtRendered&&this.options.warnFn([new Error("This zip file appears to be the outcome of a previous docxtemplater generation. This typically indicates that docxtemplater was integrated by reusing the same zip file. It is recommended to create a new Pizzip instance for each docxtemplater generation.")]),this.zip=ae,this.updateFileTypeConfig(),this.modules=Te([this.fileTypeConfig.baseModules.map(function(et){return et()}),this.modules]);for(var ue=0,Me=this.modules;ue<Me.length;ue++){var je=Me[ue];je.zip=this.zip,je.docxtemplater=this,je.fileTypeConfig=this.fileTypeConfig,je.fileType=this.fileType,je.xtOptions=this.options,je.modules=this.modules}return ke(this),this}},{key:"precompileFile",value:function(ae){var ue=this.createTemplateClass(ae);ue.preparse(),this.compiled[ae]=ue}},{key:"compileFile",value:function(ae){this.compiled[ae].parse()}},{key:"getScopeManager",value:function(ae,ue,Me){var je;return(je=this.scopeManagers)[ae]||(je[ae]=pe({tags:Me,parser:this.parser,cachedParsers:ue.cachedParsers})),this.scopeManagers[ae]}},{key:"resolveData",value:function(ae){var ue=this;Dt(this,"resolveData");var Me=[];return Object.keys(this.compiled).length||V(),Promise.resolve(ae).then(function(je){return ue.data=je,ue.setModules({data:ue.data,Lexer:me}),ue.mapper=ue.modules.reduce(function(et,it){return it.getRenderedMap(et)},{}),Promise.all(Object.keys(ue.mapper).map(function(et){var it=ue.mapper[et],St=it.from,It=it.data;return Promise.resolve(It).then(function(Ke){var wt=ue.compiled[St];return wt.filePath=et,wt.scopeManager=ue.getScopeManager(et,wt,Ke),wt.resolveTags(Ke).then(function(lt){return wt.scopeManager.finishedResolving=!0,lt},function(lt){Y(Me,lt)})})})).then(function(et){return Me.length!==0&&(ue.options.errorLogging&&de(Me,ue.options.errorLogging),Ye(Me)),Te(et)})})}},{key:"compile",value:function(){if(Dt(this,"compile"),this.updateFileTypeConfig(),zt(this.modules),this.modules=ht(this.modules),Object.keys(this.compiled).length)return this;for(var ae=this.options,ue=0,Me=this.modules;ue<Me.length;ue++){var je=Me[ue];ae=je.optionsTransformer(ae,this)}this.options=ae,this.options.xmlFileNames=J(this.options.xmlFileNames);for(var et=0,it=this.options.xmlFileNames;et<it.length;et++){var St=it[et],It=this.zip.files[St].asText();this.xmlDocuments[St]=Q(It)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments});for(var Ke=0,wt=this.modules;Ke<wt.length;Ke++){var lt=wt[Ke];lt.xmlDocuments=this.xmlDocuments}this.getTemplatedFiles(),this.sendEvent("before-preparse");for(var kr=0,Nn=this.templatedFiles;kr<Nn.length;kr++){var ra=Nn[kr];this.zip.files[ra]!=null&&this.precompileFile(ra)}this.sendEvent("after-preparse");for(var gn=0,Ua=this.templatedFiles;gn<Ua.length;gn++){var na=Ua[gn];this.zip.files[na]!=null&&this.compiled[na].parse({noPostParse:!0})}this.sendEvent("after-parse");for(var Gr=0,Hr=this.templatedFiles;Gr<Hr.length;Gr++){var aa=Hr[Gr];this.zip.files[aa]!=null&&this.compiled[aa].postparse()}return this.sendEvent("after-postparse"),this.setModules({compiled:this.compiled}),Re(this),this}},{key:"updateFileTypeConfig",value:function(){this.relsTypes=A(this.zip);var ae=F(this.zip),ue=ae.overrides,Me=ae.defaults,je=ae.contentTypes,et=ae.contentTypeXml;et&&(this.filesContentTypes=P(ue,Me,this.zip),this.invertedContentTypes=Ze(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes}));var it;this.zip.files.mimetype&&(it="odt");for(var St=0,It=this.modules;St<It.length;St++){var Ke=It[St];it=Ke.getFileType({zip:this.zip,contentTypes:je,contentTypeXml:et,overrides:ue,defaults:Me,doc:this})||it}if(this.fileType=it,it==="odt"&&te(it),it||X(this.zip),ft(this),ke(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig,!this.fileTypeConfig)if(xe.FileTypeConfig[this.fileType])this.fileTypeConfig=xe.FileTypeConfig[this.fileType]();else{var wt='Filetype "'.concat(this.fileType,'" is not supported'),lt="filetype_not_supported";this.fileType==="xlsx"&&(wt='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule'),lt="xlsx_filetype_needs_xlsx_module");var kr=new R(wt);throw kr.properties={id:lt,explanation:wt},kr}return this}},{key:"renderAsync",value:function(ae){var ue=this;this.hideDeprecations=!0;var Me=this.resolveData(ae);return this.hideDeprecations=!1,this.zip.xtRendered=!0,Me.then(function(){return ue.render()})}},{key:"render",value:function(ae){this.zip.xtRendered=!0,this.rendered&&ee(),this.rendered=!0,Object.keys(this.compiled).length===0&&this.compile(),this.errors.length>0&&se(),arguments.length>0&&(this.data=ae),this.setModules({data:this.data,Lexer:me}),this.mapper||(this.mapper=this.modules.reduce(function($l,O){return O.getRenderedMap($l)},{}));var ue=[];for(var Me in this.mapper){var je=this.mapper[Me],et=je.from,it=je.data,St=this.compiled[et];St.scopeManager=this.getScopeManager(Me,St,it),St.render(Me),ue.push([Me,St.content,St]),delete St.content}for(var It=0;It<ue.length;It++)for(var Ke=ue[It],wt=i(Ke,3),lt=wt[1],kr=wt[2],Nn=0,ra=this.modules;Nn<ra.length;Nn++){var gn=ra[Nn];if(gn.preZip){var Ua=gn.preZip(lt,kr);typeof Ua=="string"&&(Ke[1]=Ua)}}for(var na=0;na<ue.length;na++){var Gr=i(ue[na],2),Hr=Gr[0],aa=Gr[1];this.zip.file(Hr,aa,{createFolders:!0})}return Re(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){for(var ae in this.xmlDocuments){this.zip.remove(ae);var ue=be(this.xmlDocuments[ae]);this.zip.file(ae,ue,{createFolders:!0})}}},{key:"setData",value:function(ae){return Dt(this,"setData"),this.data=ae,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(ae){var ue=this.zip.files[ae].asText();return this.createTemplateClassFromContent(ue,ae)}},{key:"createTemplateClassFromContent",value:function(ae,ue){for(var Me={filePath:ue,contentType:this.filesContentTypes[ue],relsType:this.relsTypes[ue]},je=M(),et=Y(Object.keys(je),["filesContentTypes","fileTypeConfig","fileType","modules"]),it=0;it<et.length;it++){var St=et[it];Me[St]=this[St]}return new xe.XmlTemplater(ae,Me)}},{key:"getFullText",value:function(ae){return this.createTemplateClass(ae||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),Y(this.templatedFiles,this.targets);var ae=this.fileTypeConfig.templatedNs||[];if(ae.length>0){for(var ue in this.filesContentTypes)if(/^customXml\/item\d+\.xml$/.test(ue))for(var Me=0;Me<ae.length;Me++){var je=ae[Me],et=this.zip.file(ue).asText();et.indexOf('xmlns="'.concat(je,'"'))!==-1&&this.templatedFiles.push(ue)}}return this.templatedFiles=J(this.templatedFiles),this.templatedFiles}},{key:"getTags",value:function(){var ae={headers:[],footers:[]};for(var ue in this.compiled){var Me=this.filesContentTypes[ue];Me==="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"&&(ae.document={target:ue,tags:fe(this.compiled[ue].postparsed)}),Me==="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"&&ae.headers.push({target:ue,tags:fe(this.compiled[ue].postparsed)}),Me==="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"&&ae.footers.push({target:ue,tags:fe(this.compiled[ue].postparsed)})}return ae}},{key:"toBuffer",value:function(ae){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:kt},ae),{},{type:"nodebuffer"}))}},{key:"toBlob",value:function(ae){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:kt},ae),{},{type:"blob"}))}},{key:"toBase64",value:function(ae){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:kt},ae),{},{type:"base64"}))}},{key:"toUint8Array",value:function(ae){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:kt},ae),{},{type:"uint8array"}))}},{key:"toArrayBuffer",value:function(ae){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:kt},ae),{},{type:"arraybuffer"}))}}])}();dt.DocUtils=b,dt.Errors=Ba,dt.XmlTemplater=uP(),dt.FileTypeConfig=gP(),dt.XmlMatcher=TS(),e.exports=dt,e.exports.default=dt})(NT);var xP=NT.exports;const vP=zg(xP);async function O0(e,t){if("showSaveFilePicker"in window)try{const a=t.split(".").pop()||"",i={suggestedName:t,types:[]};a==="json"?i.types=[{description:"JSON ",accept:{"application/json":[".json"]}}]:a==="xlsx"?i.types=[{description:"Excel ",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}]:a==="csv"?i.types=[{description:"CSV ",accept:{"text/csv":[".csv"]}}]:a==="docx"&&(i.types=[{description:"Word ",accept:{"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]}}]);const o=await(await window.showSaveFilePicker(i)).createWritable();await o.write(e),await o.close();return}catch(a){if(a.name==="AbortError")return;console.warn("File System Access API failed, using fallback:",a)}const r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}function yP(){return Math.random()<.7?{text:"",value:"6.00"}:{text:". ",value:"5.00"}}function Yp(e){return e.replace(/[/\\:*?"<>|]/g,"").replace(/\s+/g,"_").substring(0,200)}async function AS(e,t,r){try{if(!e.personName||!e.uniqueNumber)throw new Error("Missing required participant fields: personName or uniqueNumber");if(!t)throw new Error("Group information is required for certificate generation");const n=(t.groupNumber||0)*5,i=await fetch("/Certify-app/template.docx");if(!i.ok)throw new Error(`Template not found: ${i.status} ${i.statusText}. Please ensure template.docx exists in /public/ folder.`);const s=await i.arrayBuffer(),o=new D6(s),l=new vP(o,{paragraphLoop:!0,linebreaks:!0,delimiters:{start:"{{",end:"}}"}}),u=yP(),c=r||e.courseEndDate,h=at(c),p=new Date(c).getFullYear().toString(),v={F01:String(e.uniqueNumber||""),F02:h,F03:String(e.personName||""),F04:String(e.egn||""),F05:String(e.birthPlace||""),F06:String(e.citizenship||""),F07:p,F08:String(n),F09:u.text,F10:u.value};l.render(v);const E=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),g=Yp(e.personName),w=Yp(e.uniqueNumber),x=Yp(e.companyName),y=`udostoverenie_${w}_${x}_${g}.docx`;await O0(E,y)}catch(n){throw console.error("Certificate generation failed:",n),n}}const Ko=({label:e,variant:t,icon:r})=>{const n={success:"bg-emerald-50 text-emerald-800 ring-1 ring-emerald-200 border-0",neutral:"bg-slate-100 text-slate-700 ring-1 ring-slate-200 border-0",info:"bg-blue-50 text-blue-800 ring-1 ring-blue-200 border-0"};return f.jsxs("span",{className:`
        inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border
        ${n[t]}
      `,children:[r==="check"&&f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),r==="manual"&&f.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"}),f.jsx("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319z"})]}),e]})},bx=({isOpen:e,onClose:t,title:r,message:n,buttonText:a="OK",variant:i="info"})=>{if(_e.useEffect(()=>{const u=c=>{c.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[e,t]),_e.useEffect(()=>{if(e){const u=setTimeout(()=>{t()},5e3);return()=>clearTimeout(u)}},[e,t]),!e)return null;const s=()=>{switch(i){case"danger":case"error":return f.jsx(Z5,{className:"w-6 h-6 text-red-600"});case"warning":return f.jsx(El,{className:"w-6 h-6 text-amber-600"});case"success":return f.jsx(ro,{className:"w-6 h-6 text-emerald-600"});default:return f.jsx(K1,{className:"w-6 h-6 text-blue-600"})}},o=()=>{switch(i){case"danger":case"error":return"bg-red-50 text-red-900 border-red-100";case"warning":return"bg-amber-50 text-amber-900 border-amber-100";case"success":return"bg-emerald-50 text-emerald-900 border-emerald-100";default:return"bg-blue-50 text-blue-900 border-blue-100"}},l=()=>{switch(i){case"danger":case"error":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"warning":return"bg-amber-600 hover:bg-amber-700 focus:ring-amber-500";case"success":return"bg-emerald-600 hover:bg-emerald-700 focus:ring-emerald-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 transition-opacity",onClick:t}),f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full md:max-w-md lg:max-w-lg overflow-hidden animate-scale-up transform transition-all",children:[f.jsxs("div",{className:"p-6 md:p-8 text-center",children:[f.jsx("div",{className:`mx-auto mb-4 w-12 h-12 rounded-full flex items-center justify-center ${o()}`,children:s()}),f.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:r}),f.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:n})]}),f.jsx("div",{className:"p-4 bg-slate-50 border-t border-slate-100",children:f.jsx("button",{onClick:t,className:`w-full px-5 py-2.5 text-white rounded-lg font-medium shadow-md transition-all duration-200 transform hover:-translate-y-0.5 ${l()}`,children:a})})]})})]})},wP=({participants:e,onEdit:t,onDelete:r,collapsedSections:n,toggleSection:a,hasActiveFilters:i,onFilterChange:s,groupRefreshKey:o=0})=>{var J;const{updateParticipant:l}=eh(),{t:u}=Tr(),[c,h]=_e.useState("uniqueNumber"),[p,v]=_e.useState("asc"),[E,g]=_e.useState(new Set),[w,x]=_e.useState({isOpen:!1,participant:void 0}),[y,b]=_e.useState(null),[_,N]=_e.useState({isOpen:!1,title:"",message:"",variant:"info"}),k=(I,j)=>{const Y=I.currentTarget.getBoundingClientRect();b({participant:j,x:Y.left,y:Y.top-8})},T=()=>{b(null)},A=Qr(()=>Se.groups.toArray(),[o]),S=_e.useMemo(()=>A?new Map(A.map(I=>[I.courseStartDate,I])):new Map,[A]),P=_e.useMemo(()=>[...e].sort((j,Y)=>{let oe=0;return c==="courseStartDate"||c==="groupNumber"?oe=j.courseStartDate.localeCompare(Y.courseStartDate):c==="uniqueNumber"&&(oe=j.uniqueNumber.localeCompare(Y.uniqueNumber)),p==="asc"?oe:-oe}),[e,c,p]),F=_e.useMemo(()=>{const I=[],j=[],Y=[];return P.forEach(oe=>{const Ze=S.get(oe.courseStartDate);if(!Ze){j.push(oe);return}Ze.status==="active"?I.push(oe):Ze.status==="planned"?j.push(oe):Ze.status==="completed"&&Y.push(oe)}),{active:I,planned:j,completed:Y}},[P,S]),U=_e.useMemo(()=>A==null?void 0:A.find(I=>I.status==="active"),[A]),re=U!=null&&U.groupNumber?[U.groupNumber]:[],le=U?`${at(U.courseStartDate)} - ${at(U.courseEndDate)}`:void 0,pe=_e.useMemo(()=>{const I=new Map;return A==null||A.forEach(j=>{j.status==="active"&&I.set(j.courseStartDate,{group:j,participants:[]})}),F.active.forEach(j=>{const Y=I.get(j.courseStartDate);if(Y)Y.participants.push(j);else{const oe=S.get(j.courseStartDate)||{id:"virt-active-"+j.courseStartDate,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,status:"active",groupNumber:null,isLocked:!1,createdAt:"",updatedAt:""};I.set(j.courseStartDate,{group:oe,participants:[j]})}}),Array.from(I.values()).sort((j,Y)=>j.group.courseStartDate.localeCompare(Y.group.courseStartDate))},[F.active,A,S]),me=_e.useMemo(()=>{const I=new Map;return A&&A.forEach(j=>{j.status==="planned"&&I.set(j.courseStartDate,{group:j,participants:[]})}),F.planned.forEach(j=>{if(!S.get(j.courseStartDate)&&!I.has(j.courseStartDate)){const oe={id:"virtual-planned-"+j.courseStartDate,groupNumber:null,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""};I.set(j.courseStartDate,{group:oe,participants:[]})}I.has(j.courseStartDate)&&I.get(j.courseStartDate).participants.push(j)}),Array.from(I.entries()).sort(([j],[Y])=>j.localeCompare(Y)).slice(0,2).map(([j,Y])=>({courseStartDate:j,...Y}))},[F.planned,S,A]),Ee=_e.useMemo(()=>{const I=new Map;return F.completed.forEach(j=>{const Y=S.get(j.courseStartDate);Y&&(I.has(j.courseStartDate)||I.set(j.courseStartDate,{group:Y,participants:[]}),I.get(j.courseStartDate).participants.push(j))}),Array.from(I.entries()).sort(([j],[Y])=>Y.localeCompare(j)).map(([j,Y])=>({courseStartDate:j,...Y}))},[F.completed,S]),fe=_e.useMemo(()=>{const I=new Set,j=new Set,Y=new Set;return pe.forEach(oe=>I.add(oe.group.courseStartDate)),A&&A.forEach(oe=>{oe.status==="active"&&I.add(oe.courseStartDate),oe.status==="planned"&&j.add(oe.courseStartDate),oe.status==="completed"&&Y.add(oe.courseStartDate)}),F.active.forEach(oe=>I.add(oe.courseStartDate)),F.planned.forEach(oe=>j.add(oe.courseStartDate)),F.completed.forEach(oe=>Y.add(oe.courseStartDate)),{active:{count:I.size,numbers:[]},planned:{count:j.size,numbers:[]},completed:{count:Y.size,numbers:[]}}},[F,A,pe]);_e.useEffect(()=>{(async()=>{const{syncGroups:j}=await Pn(async()=>{const{syncGroups:Y}=await Promise.resolve().then(()=>Y1);return{syncGroups:Y}},void 0);await j()})()},[]);const de=I=>{c===I?v(j=>j==="asc"?"desc":"asc"):(h(I),v("asc"))},Ce=async(I,j)=>{const Y=S.get(I.courseStartDate);if(Yo(Y)){N({isOpen:!0,title:u("common.info"),message:u("lock.lockedInfo"),variant:"info"});return}try{await l(I.id,{[j]:!I[j]})}catch(oe){console.error("Error updating participant:",oe),N({isOpen:!0,title:u("common.error"),message:"Failed to update participant",variant:"error"})}},Ye=async I=>{const j=S.get(I.courseStartDate);if(Yo(j)){N({isOpen:!0,title:u("common.info"),message:u("lock.lockedInfo"),variant:"info"});return}const Y=I.completedOverride!==null?I.completedOverride:I.completedComputed;try{await l(I.id,{completedOverride:!Y})}catch(oe){console.error("Error updating completed status:",oe),N({isOpen:!0,title:u("common.error"),message:"Failed to update completed status",variant:"error"})}},V=async I=>{const j=S.get(I.courseStartDate);if(Yo(j)){N({isOpen:!0,title:u("common.info"),message:u("lock.lockedInfo"),variant:"info"});return}try{await l(I.id,{completedOverride:null})}catch(Y){console.error("Error resetting completed status:",Y),N({isOpen:!0,title:u("common.error"),message:"Failed to reset completed status",variant:"error"})}},se=I=>I.completedOverride!==null?I.completedOverride:I.completedComputed,ee=I=>I.completedOverride!==null,C=async I=>{try{let j=S.get(I.courseStartDate);j||(j={id:"virtual-cert",groupNumber:null,courseStartDate:I.courseStartDate,courseEndDate:I.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""}),await AS(I,j),N({isOpen:!0,title:u("common.success"),message:u("certificate.generated"),variant:"success"})}catch(j){N({isOpen:!0,title:u("common.error"),message:u("certificate.error")+": "+j.message,variant:"error"})}},R=()=>{w.participant&&r(w.participant.id),x({isOpen:!1,participant:void 0})},X=I=>{const j=S.get(I.courseStartDate),Y=Te(I),oe=["hover:bg-slate-100 transition-colors duration-150",(j==null?void 0:j.status)==="active"?"bg-slate-50":"",(j==null?void 0:j.status)==="completed"?"opacity-90":""].filter(Boolean).join(" ");return f.jsxs("tr",{className:oe,children:[f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:E.has(I.id),onChange:()=>M(I.id),disabled:Y,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed","aria-label":`Select ${I.personName}`})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Lu,{companyName:I.companyName}),Y&&f.jsx("span",{className:"text-xs text-slate-500",title:u("lock.lockedInfo"),children:""})]})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx("div",{className:"max-w-xs truncate cursor-help",onMouseEnter:Ze=>k(Ze,I),onMouseLeave:T,children:I.personName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.medicalDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.courseStartDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.courseEndDate)}),f.jsx("td",{className:"px-3 py-3 text-sm",children:f.jsx("span",{className:"font-mono text-xs bg-slate-100 px-2 py-0.5 rounded inline-block text-slate-700 cursor-help",title:`   
: ${j!=null&&j.groupNumber?j.groupNumber*5:"---"}`,children:I.uniqueNumber||"---"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.sent,onChange:()=>Ce(I,"sent"),disabled:Y,title:"    ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.documents,onChange:()=>Ce(I,"documents"),disabled:Y,title:"   ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.handedOver,onChange:()=>Ce(I,"handedOver"),disabled:Y,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.paid,onChange:()=>Ce(I,"paid"),disabled:Y,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>Ye(I),disabled:Y,className:`px-3 py-1 rounded-md text-xs font-medium transition-colors duration-150 ring-1 disabled:opacity-50 disabled:cursor-not-allowed ${se(I)?"bg-emerald-50 text-emerald-800 ring-emerald-200 hover:bg-emerald-100":"bg-slate-100 text-slate-700 ring-slate-200 hover:bg-slate-200"}`,title:Y?u("lock.lockedInfo"):"Click to toggle",children:se(I)?u("completed.done"):u("completed.pending")}),ee(I)&&!Y&&f.jsx("button",{onClick:()=>V(I),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors duration-150",title:"Reset to auto","aria-label":"Reset completed to automatic",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>t(I),disabled:Y,className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:u(Y?"lock.lockedInfo":"common.edit"),"aria-label":`Edit ${I.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),f.jsx("button",{onClick:()=>C(I),className:"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-lg transition-colors duration-150",title:" ","aria-label":`Generate certificate for ${I.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),f.jsx("button",{onClick:()=>x({isOpen:!0,participant:I}),disabled:Y,className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:u(Y?"lock.lockedInfo":"common.delete"),"aria-label":`Delete ${I.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},I.id)},te=I=>{const j=Te(I);return f.jsxs("tr",{className:"hover:bg-slate-100 transition-colors duration-150",children:[f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:E.has(I.id),onChange:()=>M(I.id),disabled:j,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed","aria-label":`Select ${I.personName}`})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx(Lu,{companyName:I.companyName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx("div",{className:"max-w-xs truncate cursor-help",onMouseEnter:oe=>k(oe,I),onMouseLeave:T,children:I.personName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.medicalDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.courseStartDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:at(I.courseEndDate)}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.documents,onChange:()=>Ce(I,"documents"),disabled:j,title:"   ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:I.paid,onChange:()=>Ce(I,"paid"),disabled:j,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>t(I),disabled:j,className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:u(j?"lock.lockedInfo":"common.edit"),"aria-label":`Edit ${I.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),f.jsx("button",{onClick:()=>x({isOpen:!0,participant:I}),disabled:j,className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:u(j?"lock.lockedInfo":"common.delete"),"aria-label":`Delete ${I.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},I.id)},K=I=>{const j=S.get(I.courseStartDate),Y=se(I);return f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f.jsx(Lu,{companyName:I.companyName})}),f.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f.jsx("div",{className:"cursor-help",onMouseEnter:oe=>k(oe,I),onMouseLeave:T,children:I.personName})}),f.jsx("td",{className:"px-3 py-2 text-sm",children:f.jsx("span",{className:"font-mono text-xs bg-slate-100 px-2 py-0.5 rounded inline-block text-slate-700 cursor-help",title:`   
: ${j!=null&&j.groupNumber?j.groupNumber*5:"---"}`,children:I.uniqueNumber})}),f.jsx("td",{className:"px-3 py-2 text-sm text-slate-600",children:at(I.medicalDate)}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:I.sent,disabled:!0,title:"    ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:I.documents,disabled:!0,title:"   ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:I.handedOver,disabled:!0,title:"  ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:I.paid,disabled:!0,title:"  ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Y&&f.jsx(Ko,{label:u("participant.completedBadge"),variant:"success",icon:"check"}),ee(I)&&f.jsx(Ko,{label:u("participant.manual"),variant:"info",icon:"manual"}),!Y&&!ee(I)&&f.jsx("span",{className:"text-xs text-slate-400 italic",children:u("completed.pending")})]})})]},I.id)},M=I=>{const j=new Set(E);j.has(I)?j.delete(I):j.add(I),g(j)},Q=()=>{g(new Set)},be=()=>{g(new Set)},Te=I=>{const j=S.get(I.courseStartDate);return Yo(j)};return P.length===0?f.jsx("div",{className:"text-center py-12 text-slate-500",children:u("participants.noResults")}):f.jsxs(f.Fragment,{children:[f.jsx(oT,{selectedCount:E.size,selectedIds:Array.from(E),onClearSelection:Q,onActionComplete:be}),f.jsx(bx,{isOpen:_.isOpen,onClose:()=>N(I=>({...I,isOpen:!1})),title:_.title,message:_.message,variant:_.variant}),f.jsxs("div",{className:"space-y-4",children:[(F.active.length>0||!i)&&f.jsx(ll,{title:u("groups.activeSection"),count:fe.active.count,groupNumbers:pe.length<=1?re:[],dateRange:pe.length<=1?le:void 0,participantCount:F.active.length,isCollapsed:n.active,onToggle:()=>a("active"),variant:"active",children:pe.length===0?f.jsx("div",{className:"text-center py-8 text-slate-500 bg-slate-50 border border-dashed border-slate-200 rounded-lg",children:u("participants.noActive")}):f.jsx("div",{className:"space-y-8",children:pe.map(I=>f.jsxs("div",{className:"space-y-3",children:[pe.length>1&&f.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-blue-100",children:[f.jsxs("span",{className:"font-bold text-blue-900",children:[at(I.group.courseStartDate)," - ",at(I.group.courseEndDate)]}),I.group.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:[" ",I.group.groupNumber]})]}),f.jsx("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto relative rounded-lg border border-slate-200",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-100 sticky top-0 z-10 shadow-sm",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 border-b border-slate-200 w-12",children:f.jsx("input",{type:"checkbox",checked:I.participants.length>0&&I.participants.every(j=>E.has(j.id)),onChange:j=>{const Y=new Set(E);j.target.checked?I.participants.filter(oe=>!Te(oe)).forEach(oe=>Y.add(oe.id)):I.participants.forEach(oe=>Y.delete(oe.id)),g(Y)},className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer"})}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.companyName")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.personName")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.courseStart")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.courseEnd")}),f.jsxs("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-200 transition-colors duration-150",onClick:()=>de("uniqueNumber"),children:[u("participant.uniqueNumber")," ",c==="uniqueNumber"&&(p==="asc"?"":"")]}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.sent")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.documents")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.handedOver")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.paid")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("filters.status")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("common.delete")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:I.participants.length>0?I.participants.map(X):f.jsx("tr",{children:f.jsx("td",{colSpan:13,className:"text-center py-8 text-slate-400 italic",children:u("participants.noParticipantsInGroup")})})})]})})]},I.group.courseStartDate))})}),(F.planned.length>0||!i)&&me.length>0&&f.jsx(ll,{title:u("groups.plannedSection"),count:fe.planned.count,groupNumbers:me.map(I=>I.group.groupNumber).filter(I=>I!==null),isCollapsed:n.planned,onToggle:()=>a("planned"),variant:"planned",children:f.jsx("div",{className:"space-y-6",children:me.map(({courseStartDate:I,group:j,participants:Y})=>f.jsxs("div",{className:"bg-white border border-amber-200 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"bg-amber-50 px-4 py-2 border-b border-amber-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[j.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-amber-200 text-amber-900 rounded text-xs font-semibold",children:[" ",j.groupNumber]}),f.jsxs("span",{className:"font-semibold text-amber-900",children:[at(j.courseStartDate)," - ",at(j.courseEndDate)]})]}),f.jsxs("span",{className:"text-sm text-amber-700 font-medium",children:[Y.length," ",Y.length===1?u("group.participant_one"):u("group.participant_other")]})]})}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 border-b border-slate-200 w-12",children:f.jsx("input",{type:"checkbox",checked:Y.length>0&&Y.every(oe=>E.has(oe.id)),onChange:oe=>{const Ze=new Set(E);oe.target.checked?Y.forEach(Ge=>Ze.add(Ge.id)):Y.forEach(Ge=>Ze.delete(Ge.id)),g(Ze)},className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer"})}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.companyName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.personName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.courseStart")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.courseEnd")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.documents")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("participant.paid")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:u("common.delete")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:Y.length>0?Y.map(te):f.jsx("tr",{children:f.jsx("td",{colSpan:10,className:"text-center py-4 text-slate-400 italic",children:u("participants.noParticipantsInGroup")})})})]})})]},I))})}),(F.completed.length>0||!i)&&Ee.length>0&&f.jsx(ll,{title:u("groups.completedSection"),count:fe.completed.count,groupNumbers:fe.completed.numbers,isCollapsed:n.completed,onToggle:()=>a("completed"),variant:"completed",children:f.jsx("div",{className:"space-y-4",children:Ee.map(({courseStartDate:I,group:j,participants:Y})=>f.jsx("div",{children:f.jsx(lT,{groupNumber:j.groupNumber||0,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,participants:Y,renderParticipantRow:K,defaultExpanded:i})},I))})})]}),i&&e.length===0&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center",children:[f.jsx("div",{className:"text-6xl mb-4",children:""}),f.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"  "}),f.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"      "}),f.jsx("button",{onClick:()=>{s({searchTerm:"",courseStartDate:null,category:null,status:"all"})},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:" "})]}),f.jsx(ts,{isOpen:w.isOpen,onClose:()=>x({isOpen:!1,participant:void 0}),onConfirm:R,title:u("modal.deleteTitle"),message:f.jsxs(f.Fragment,{children:[u("modal.deleteMessage").split("{name}")[0],f.jsx("strong",{className:"font-bold text-slate-900",children:((J=w.participant)==null?void 0:J.personName)||""}),u("modal.deleteMessage").split("{name}")[1]]}),confirmText:u("common.delete"),cancelText:u("common.cancel"),variant:"danger"}),y&&f.jsxs("div",{className:"fixed z-50 bg-slate-800 text-white text-xs p-3 rounded shadow-lg pointer-events-none transform -translate-y-full filter drop-shadow-md",style:{left:y.x,top:y.y,minWidth:"220px"},children:[f.jsx("div",{className:"font-bold mb-2 border-b border-slate-600 pb-1 text-slate-100",children:y.participant.personName}),f.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-3 gap-y-1.5",children:[f.jsxs("span",{className:"text-slate-400 text-right",children:[u("participant.egn"),":"]}),f.jsx("span",{className:"font-mono",children:y.participant.egn||"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[u("participant.birthPlace"),":"]}),f.jsx("span",{children:y.participant.birthPlace||"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[u("participant.added"),":"]}),f.jsx("span",{children:y.participant.createdAt?at(y.participant.createdAt):"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[u("participant.modified"),":"]}),f.jsx("span",{children:y.participant.updatedAt?at(y.participant.updatedAt):"-"})]})]})]})},Zy=({onEdit:e,onDetails:t,onGenerate:r,onDelete:n})=>{const[a,i]=_e.useState(!1),s=_e.useRef(null);return _e.useEffect(()=>{const o=u=>{s.current&&!s.current.contains(u.target)&&i(!1)},l=u=>{u.key==="Escape"&&i(!1)};if(a)return document.addEventListener("mousedown",o),document.addEventListener("keydown",l),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",l)}},[a]),f.jsxs("div",{className:"relative",ref:s,children:[f.jsx("button",{onClick:()=>i(!a),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors duration-150 min-h-[44px] min-w-[44px] flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"More options","aria-expanded":a,children:f.jsxs("svg",{className:"w-5 h-5 text-slate-600",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("circle",{cx:"8",cy:"2",r:"1.5"}),f.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),f.jsx("circle",{cx:"8",cy:"14",r:"1.5"})]})}),a&&f.jsxs("div",{className:"absolute right-0 top-12 bg-white rounded-lg shadow-lg border border-slate-200 py-1 min-w-[140px] z-10 animate-scale-up",children:[e&&f.jsxs("button",{onClick:()=>{e(),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-slate-700 hover:bg-slate-100 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),""]}),t&&f.jsxs("button",{onClick:()=>{t(),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-blue-700 hover:bg-blue-50 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),""]}),r&&f.jsxs("button",{onClick:()=>{r(),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-green-700 hover:bg-green-50 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),""]}),n&&f.jsxs("button",{onClick:()=>{n(),i(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),""]})]})]})},bP=({isOpen:e,onClose:t,participant:r})=>{const{t:n}=Tr();return _e.useEffect(()=>{const a=i=>{i.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e,t]),!e||!r?null:f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 transition-opacity",onClick:t}),f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full overflow-hidden animate-scale-up pointer-events-auto",children:[f.jsxs("div",{className:"relative bg-slate-50 px-6 py-4 border-b border-slate-100",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center shrink-0",children:f.jsx(Ak,{className:"w-5 h-5 text-blue-600"})}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 truncate pr-6",children:r.personName}),f.jsx("p",{className:"text-xs text-slate-500 truncate",children:r.companyName})]})]}),f.jsx("button",{onClick:t,className:"absolute right-4 top-4 p-1 rounded-full hover:bg-slate-200 transition-colors text-slate-400 hover:text-slate-600",children:f.jsx(Q1,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[f.jsx(iT,{className:"w-3.5 h-3.5"}),f.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold",children:n("participant.egn")})]}),f.jsx("div",{className:"text-sm font-mono text-slate-900 bg-slate-50 px-2 py-1 rounded",children:r.egn||"---"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[f.jsx(mk,{className:"w-3.5 h-3.5"}),f.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold",children:n("participant.birthPlace")})]}),f.jsx("div",{className:"text-sm font-medium text-slate-900 truncate",children:r.birthPlace||"---"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[f.jsx(aT,{className:"w-3.5 h-3.5"}),f.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold",children:n("participant.added")})]}),f.jsx("div",{className:"text-xs text-slate-900",children:r.createdAt?at(r.createdAt):"---"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[f.jsx(yu,{className:"w-3.5 h-3.5"}),f.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold",children:n("participant.modified")})]}),f.jsx("div",{className:"text-xs text-slate-900",children:r.updatedAt?at(r.updatedAt):"---"})]})]})]}),f.jsx("div",{className:"px-6 py-4 bg-slate-50 flex justify-end",children:f.jsx("button",{onClick:t,className:"px-4 py-2 bg-white text-slate-700 border border-slate-200 rounded-lg hover:bg-slate-100 font-medium text-sm transition-all",children:n("common.close")})})]})})]})},t0=({label:e,isActive:t})=>f.jsxs("div",{className:`
        flex items-center justify-center gap-1 px-1.5 py-1 rounded text-xs font-medium
        transition-all duration-150 min-h-[32px] w-full
        ${t?"bg-emerald-700 border border-emerald-700 text-white":"bg-white border border-slate-300 text-slate-700"}
      `,children:[t&&f.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),f.jsx("span",{className:"text-[10px] whitespace-nowrap",children:e})]}),EP=({participants:e,onEdit:t,onDelete:r,onSelectionChange:n,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:o})=>{var K;const{t:l}=Tr(),{updateParticipant:u}=eh(),[c,h]=_e.useState(new Set),[p,v]=_e.useState(null),[E,g]=_e.useState({isOpen:!1,participant:void 0}),[w,x]=_e.useState({isOpen:!1,participant:void 0}),y=Qr(()=>Se.groups.toArray(),[]),b=_e.useMemo(()=>y?new Map(y.map(M=>[M.courseStartDate,M])):new Map,[y]),_=_e.useMemo(()=>{const M=[],Q=[],be=[];return e.forEach(Te=>{const J=b.get(Te.courseStartDate);if(!J){Q.push(Te);return}J.status==="active"?M.push(Te):J.status==="planned"?Q.push(Te):J.status==="completed"&&be.push(Te)}),{active:M,planned:Q,completed:be}},[e,b]),N=_e.useMemo(()=>{const M=new Map;return y&&y.forEach(Q=>{Q.status==="planned"&&M.set(Q.courseStartDate,{group:Q,participants:[]})}),_.planned.forEach(Q=>{if(!b.get(Q.courseStartDate)&&!M.has(Q.courseStartDate)){const Te={id:"virtual-"+Q.courseStartDate,groupNumber:null,courseStartDate:Q.courseStartDate,courseEndDate:Q.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""};M.set(Q.courseStartDate,{group:Te,participants:[]})}M.has(Q.courseStartDate)&&M.get(Q.courseStartDate).participants.push(Q)}),Array.from(M.entries()).sort(([Q],[be])=>Q.localeCompare(be)).slice(0,2).map(([Q,be])=>({courseStartDate:Q,...be}))},[_.planned,b,y]),k=_e.useMemo(()=>{const M=new Map;return _.completed.forEach(Q=>{const be=b.get(Q.courseStartDate);be&&(M.has(Q.courseStartDate)||M.set(Q.courseStartDate,{group:be,participants:[]}),M.get(Q.courseStartDate).participants.push(Q))}),Array.from(M.entries()).sort(([Q],[be])=>be.localeCompare(Q)).map(([Q,be])=>({courseStartDate:Q,...be}))},[_.completed,b]),T=_e.useMemo(()=>y==null?void 0:y.find(M=>M.status==="active"),[y]),A=T!=null&&T.groupNumber?[T.groupNumber]:[],S=T?`${at(T.courseStartDate)} - ${at(T.courseEndDate)}`:void 0,P=_e.useMemo(()=>{const M=new Map;return y==null||y.forEach(Q=>{Q.status==="active"&&M.set(Q.courseStartDate,{group:Q,participants:[]})}),_.active.forEach(Q=>{const be=M.get(Q.courseStartDate);if(be)be.participants.push(Q);else{const Te=b.get(Q.courseStartDate)||{id:"virt-active-"+Q.courseStartDate,courseStartDate:Q.courseStartDate,courseEndDate:Q.courseEndDate,status:"active",groupNumber:null,isLocked:!1,createdAt:"",updatedAt:""};M.set(Q.courseStartDate,{group:Te,participants:[Q]})}}),Array.from(M.values()).sort((Q,be)=>Q.group.courseStartDate.localeCompare(be.group.courseStartDate))},[_.active,y,b]),F=_e.useMemo(()=>{const M=new Set,Q=new Set,be=new Set;return _.active.forEach(Te=>M.add(Te.courseStartDate)),y&&y.forEach(Te=>{Te.status==="planned"&&Q.add(Te.courseStartDate)}),_.planned.forEach(Te=>Q.add(Te.courseStartDate)),_.completed.forEach(Te=>be.add(Te.courseStartDate)),{active:{count:M.size,periods:Array.from(M).sort()},planned:{count:Math.min(Q.size,2),periods:Array.from(Q).sort()},completed:{count:be.size,periods:Array.from(be).sort()}}},[_,y]),U=_e.useRef(e);_e.useEffect(()=>{U.current!==e&&o&&(_.active.length>0&&a.active&&s("active"),_.planned.length>0&&a.planned&&s("planned"),_.completed.length>0&&a.completed&&s("completed"),U.current=e)},[e,_,a,s,o]),_e.useEffect(()=>{n==null||n(c.size>0)},[c.size,n]);const re=async(M,Q)=>{const be=b.get(M.courseStartDate);if(be&&be.status==="completed"&&be.isLocked){alert(l("lock.lockedInfo"));return}try{await u(M.id,{[Q]:!M[Q]})}catch(Te){console.error("Error updating participant:",Te)}},le=M=>M.completedOverride!==null?M.completedOverride:M.completedComputed,pe=M=>M.completedOverride!==null,me=M=>{const Q=b.get(M.courseStartDate);return Q?Q.status==="completed"&&Q.isLocked:!1},Ee=(M,Q)=>{if(me(Q))return;const be=setTimeout(()=>{h(new Set([M]))},500);v(be)},fe=()=>{p&&(clearTimeout(p),v(null))},de=(M,Q)=>{const be=me(Q);if(c.size>0){if(be)return;const Te=new Set(c);Te.has(M)?Te.delete(M):Te.add(M),h(Te)}},Ce=()=>{h(new Set)},Ye=()=>{h(new Set)},V=M=>{g({isOpen:!0,participant:M})},se=()=>{E.participant&&r(E.participant.id),g({isOpen:!1,participant:void 0})},[ee,C]=_e.useState({isOpen:!1,title:"",message:"",variant:"info"}),R=async M=>{try{let Q=b.get(M.courseStartDate);Q||(Q={id:"virtual",groupNumber:null,courseStartDate:M.courseStartDate,courseEndDate:M.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""}),await AS(M,Q),C({isOpen:!0,title:l("common.success"),message:l("certificate.generated"),variant:"success"})}catch(Q){C({isOpen:!0,title:l("common.error"),message:l("certificate.error")+": "+Q.message,variant:"error"})}},X=(M,Q)=>{var J;const be=c.has(M.id),Te=me(M);return f.jsxs("div",{onClick:()=>de(M.id,M),onTouchStart:()=>Ee(M.id,M),onTouchEnd:fe,onMouseDown:()=>Ee(M.id,M),onMouseUp:fe,onMouseLeave:fe,className:`bg-white rounded-lg shadow-sm p-3 md:p-4 border transition-all duration-150 ${be?"border-blue-500 ring-2 ring-blue-200":"border-slate-200"} ${Te?"opacity-75":"cursor-pointer hover:shadow-md"}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"mb-1",children:f.jsx(Lu,{companyName:M.companyName})}),f.jsxs("div",{className:"flex items-center gap-2",children:[be&&f.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded flex items-center justify-center shrink-0",children:f.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),f.jsx("h3",{className:"font-bold text-lg text-slate-900 leading-tight truncate",children:M.personName}),Te&&f.jsx("span",{className:"text-xs text-slate-500 shrink-0",title:l("lock.lockedInfo"),children:""})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[M.uniqueNumber&&f.jsx("span",{className:"text-xs font-mono bg-slate-100 px-2 py-1 rounded text-slate-700",children:M.uniqueNumber}),f.jsxs("div",{className:"flex gap-1",children:[le(M)?f.jsx(Ko,{label:l("participant.completedBadge"),variant:"success",icon:"check"}):f.jsx("span",{className:"text-[10px] text-slate-400 italic font-medium",children:l("completed.pending")}),pe(M)&&f.jsx(Ko,{label:l("participant.manual"),variant:"info",icon:"manual"})]})]}),!Te&&f.jsx(Zy,{onEdit:()=>t(M),onDetails:()=>x({isOpen:!0,participant:M}),onGenerate:((J=b.get(M.courseStartDate))==null?void 0:J.status)==="active"?()=>R(M):void 0,onDelete:()=>V(M)})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-2 gap-y-2 mb-3",children:[f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsx("span",{className:"text-slate-500 text-[10px] sm:text-[11px] uppercase tracking-wider font-semibold truncate",children:l("participant.medical")}),f.jsx("span",{className:"font-bold text-sm text-slate-900 truncate",children:at(M.medicalDate)})]}),f.jsxs("div",{className:"flex flex-col min-w-0 text-right",children:[f.jsx("span",{className:"text-slate-500 text-[10px] sm:text-[11px] uppercase tracking-wider font-semibold truncate",children:l("participant.period")}),f.jsx("span",{className:"font-bold text-sm text-slate-900 truncate",children:at(M.courseStartDate)})]}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsx("span",{className:"text-slate-500 text-[10px] sm:text-[11px] uppercase tracking-wider font-semibold truncate",children:l("participant.courseStart")}),f.jsx("span",{className:"font-bold text-sm text-slate-900 truncate",children:at(M.courseStartDate)})]}),f.jsxs("div",{className:"flex flex-col min-w-0 text-right",children:[f.jsx("span",{className:"text-slate-500 text-[10px] sm:text-[11px] uppercase tracking-wider font-semibold truncate",children:l("participant.courseEnd")}),f.jsx("span",{className:"font-bold text-sm text-slate-900 truncate",children:at(M.courseEndDate)})]})]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-1.5 sm:gap-1",children:[f.jsx("button",{onClick:I=>{I.stopPropagation(),re(M,"sent")},disabled:Te,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(t0,{label:l("participant.sent"),isActive:M.sent})}),f.jsx("button",{onClick:I=>{I.stopPropagation(),re(M,"documents")},disabled:Te,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(t0,{label:l("participant.documents"),isActive:M.documents})}),f.jsx("button",{onClick:I=>{I.stopPropagation(),re(M,"handedOver")},disabled:Te,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(t0,{label:l("participant.handed"),isActive:M.handedOver})}),f.jsx("button",{onClick:I=>{I.stopPropagation(),re(M,"paid")},disabled:Te,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(t0,{label:l("participant.paid"),isActive:M.paid})})]})]},M.id)},te=M=>f.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[f.jsx("div",{className:"mb-1",children:f.jsx(Lu,{companyName:M.companyName})}),f.jsx("h4",{className:"font-semibold text-slate-900 truncate",children:M.personName})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-1 items-end shrink-0",children:[M.uniqueNumber&&f.jsx("span",{className:"text-xs font-mono bg-slate-100 px-2 py-1 rounded text-slate-700",children:M.uniqueNumber}),f.jsxs("div",{className:"flex gap-1",children:[le(M)?f.jsx(Ko,{label:l("participant.completedBadge"),variant:"success",icon:"check"}):f.jsx("span",{className:"text-[10px] text-slate-400 italic font-medium",children:l("completed.pending")}),pe(M)&&f.jsx(Ko,{label:l("participant.manual"),variant:"info",icon:"manual"})]})]}),f.jsx(Zy,{onDetails:()=>x({isOpen:!0,participant:M})})]})]}),f.jsx("div",{className:"text-sm text-slate-600 mb-2",children:f.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-semibold mb-1",children:[l("participant.medical"),": ",at(M.medicalDate)]})}),f.jsxs("div",{className:"flex flex-nowrap justify-between items-center gap-0.5 mt-auto pt-2 border-t border-slate-50 overflow-hidden",children:[f.jsxs("label",{className:"flex items-center gap-0.5 text-[8px] sm:text-[9px] text-slate-500 whitespace-nowrap",children:[f.jsx("input",{type:"checkbox",checked:M.sent,disabled:!0,className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),l("participant.sent")]}),f.jsxs("label",{className:"flex items-center gap-0.5 text-[8px] sm:text-[9px] text-slate-500 whitespace-nowrap",children:[f.jsx("input",{type:"checkbox",checked:M.documents,disabled:!0,className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),l("participant.documents")]}),f.jsxs("label",{className:"flex items-center gap-0.5 text-[8px] sm:text-[9px] text-slate-500 whitespace-nowrap",children:[f.jsx("input",{type:"checkbox",checked:M.handedOver,disabled:!0,className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),l("participant.handed")]}),f.jsxs("label",{className:"flex items-center gap-0.5 text-[8px] sm:text-[9px] text-slate-500 whitespace-nowrap",children:[f.jsx("input",{type:"checkbox",checked:M.paid,disabled:!0,className:"w-2.5 h-2.5 sm:w-3 sm:h-3 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),l("participant.paid")]})]})]},M.id);return e.length===0?f.jsx("div",{className:"text-center py-12 text-slate-500",children:l("participants.noResults")}):f.jsxs(f.Fragment,{children:[f.jsx(oT,{selectedCount:c.size,selectedIds:Array.from(c),onClearSelection:Ce,onActionComplete:Ye}),f.jsx(bP,{isOpen:w.isOpen,onClose:()=>x({isOpen:!1,participant:void 0}),participant:w.participant}),f.jsx(bx,{isOpen:ee.isOpen,onClose:()=>C(M=>({...M,isOpen:!1})),title:ee.title,message:ee.message,variant:ee.variant==="error"?"danger":ee.variant}),f.jsxs("div",{className:"space-y-4 pb-32",children:[(_.active.length>0||!o)&&f.jsx(ll,{title:l("groups.activeSection"),count:F.active.count,groupNumbers:P.length<=1&&A.length>0?A:[],dateRange:P.length<=1?S:void 0,participantCount:_.active.length,isCollapsed:a.active,onToggle:()=>i("active"),showCount:P.length<=1?Math.max(A.length,0)>0:!0,variant:"active",children:P.length===0?f.jsx("div",{className:"text-center py-8 text-slate-500 bg-slate-50/50 rounded-lg border border-dashed border-slate-200",children:f.jsx("p",{children:l("participants.noActive")})}):f.jsx("div",{className:"space-y-8",children:P.map(M=>f.jsxs("div",{className:"space-y-4",children:[P.length>1&&f.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-blue-100",children:[f.jsxs("span",{className:"font-semibold text-blue-900",children:[at(M.group.courseStartDate)," - ",at(M.group.courseEndDate)]}),M.group.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-bold",children:[" ",M.group.groupNumber]})]}),M.participants.length>0?f.jsx("div",{className:"space-y-4",children:M.participants.map((Q,be)=>X(Q))}):f.jsx("div",{className:"text-center py-4 italic text-slate-400 bg-white/50 rounded border border-dashed border-slate-100",children:l("participants.noParticipantsInGroup")})]},M.group.courseStartDate))})}),(_.planned.length>0||!o)&&f.jsx(ll,{title:l("groups.plannedSection"),count:F.planned.count,groupNumbers:N.map(M=>M.group.groupNumber).filter(M=>M!==null),participantCount:_.planned.length,isCollapsed:a.planned,onToggle:()=>i("planned"),variant:"planned",children:N.length>0?f.jsx("div",{className:"space-y-3",children:N.map(({courseStartDate:M,group:Q,participants:be})=>f.jsxs("div",{className:"bg-white border-2 border-amber-200 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"bg-amber-50 px-3 py-2 border-b border-amber-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[Q.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-amber-200 text-amber-900 rounded text-xs font-semibold",children:[" ",Q.groupNumber]}),f.jsxs("span",{className:"font-semibold text-amber-900",children:[at(Q.courseStartDate)," - ",at(Q.courseEndDate)]})]}),f.jsxs("span",{className:"text-xs text-amber-700 font-medium",children:[be.length," ",be.length===1?l("group.participant_one"):l("group.participant_other")]})]})}),f.jsx("div",{className:"p-2 space-y-2",children:be.map((Te,J)=>X(Te))})]},M))}):f.jsx("div",{className:"text-center py-8 text-slate-500",children:l("participants.noParticipantsInGroup")})}),(_.completed.length>0||!o)&&f.jsx(ll,{title:l("groups.completedSection"),count:F.completed.count,participantCount:_.completed.length,isCollapsed:a.completed,onToggle:()=>i("completed"),variant:"completed",children:k.length>0?f.jsx("div",{className:"space-y-2",children:k.map(({courseStartDate:M,group:Q,participants:be})=>f.jsx(lT,{groupNumber:Q.groupNumber||0,courseStartDate:Q.courseStartDate,courseEndDate:Q.courseEndDate,participants:be,renderParticipantRow:te,mode:"cards",defaultExpanded:o},M))}):f.jsx("div",{className:"text-center py-8 text-slate-500",children:"  "})})]}),o&&e.length===0&&f.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center",children:[f.jsx("div",{className:"text-6xl mb-4",children:""}),f.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"  "}),f.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"   "})]}),f.jsx(ts,{isOpen:E.isOpen,onClose:()=>g({isOpen:!1,participant:void 0}),onConfirm:se,title:l("modal.deleteTitle"),message:l("modal.deleteMessage",{name:((K=E.participant)==null?void 0:K.personName)||""}),confirmText:l("common.delete"),cancelText:l("common.cancel"),variant:"danger"})]})},_P=({isOpen:e,onClose:t,participant:r})=>{const{addParticipant:n,updateParticipant:a}=eh(),{t:i}=Tr(),[s,o]=_e.useState({companyName:"",personName:"",egn:"",birthPlace:"",citizenship:"",medicalDate:"",groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:""}),[l,u]=_e.useState({courseStartDate:"",courseEndDate:""}),[c,h]=_e.useState({}),[p,v]=_e.useState(!1),[E,g]=_e.useState(""),[w,x]=_e.useState(null),[y,b]=_e.useState({isOpen:!1,message:"",onConfirm:()=>{}}),_=Qr(()=>da(),[]),N=Qr(()=>Se.groups.orderBy("groupNumber").toArray(),[]),[k,T]=_e.useState(null);_e.useEffect(()=>{if(!s.medicalDate){T(null);return}yc(s.medicalDate).then(F=>{if(F.group)T(F.group);else if(F.createsForDate){const U=new Date(F.createsForDate),re=new Date(U);re.setDate(U.getDate()+7),T({groupNumber:null,courseStartDate:F.createsForDate,courseEndDate:re.toISOString().split("T")[0],status:"planned"})}else T(null)})},[s.medicalDate]),_e.useEffect(()=>{r?(o({companyName:r.companyName,personName:r.personName,egn:r.egn||"",birthPlace:r.birthPlace||"",citizenship:r.citizenship||"",medicalDate:r.medicalDate,groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:r.uniqueNumber}),u({courseStartDate:r.courseStartDate,courseEndDate:r.courseEndDate}),g("")):(o({companyName:"",personName:"",egn:"",birthPlace:"",citizenship:"",medicalDate:"",groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:""}),u({courseStartDate:"",courseEndDate:""}),e&&Promise.all([xc(),_g()]).then(([F,U])=>{g(F),x(U)}).catch(F=>{console.error("Failed to generate next unique number:",F),g(""),x(null)})),h({})},[r,e]),_e.useEffect(()=>{if(k)u({courseStartDate:k.courseStartDate,courseEndDate:k.courseEndDate}),k.status==="active"?Promise.all([xc(),_g()]).then(([F,U])=>{g(U||F),x(U),r&&o(le=>({...le,uniqueNumber:""}))}).catch(F=>{console.error("Failed to get unique number:",F)}):(g(""),x(null));else if(s.medicalDate)try{const F=cd(s.medicalDate);u(F)}catch(F){console.error("Error computing dates:",F)}},[s.medicalDate,k,r]);const A=async()=>{const F={};if(s.companyName.trim()||(F.companyName=i("modal.companyNameRequired")),s.personName.trim()||(F.personName=i("modal.personNameRequired")),s.egn.trim()?/^\d{10}$/.test(s.egn)||(F.egn=i("modal.egnInvalid")):F.egn=i("modal.egnRequired"),s.birthPlace.trim()||(F.birthPlace=i("modal.birthPlaceRequired")),s.medicalDate?tT(s.medicalDate)||(F.medicalDate=Mu):F.medicalDate=i("modal.medicalDateRequired"),s.uniqueNumber){if(!L_(s.uniqueNumber))F.uniqueNumber="Invalid format. Use NNNN-NNN (e.g., 3532-001)";else if(!await vc(s.uniqueNumber,r==null?void 0:r.id))F.uniqueNumber="This unique number already exists";else if(w&&!r){const re=to(s.uniqueNumber),le=to(w);re&&le&&(re.prefix>le.prefix||re.prefix===le.prefix&&re.seq>le.seq)&&(F.uniqueNumber=`Cannot skip gap! Must fill ${w} first or leave empty for auto-assign`)}}return h(F),Object.keys(F).length===0},S=async F=>{if(F.preventDefault(),!!await A()){if(s.groupAssignmentMode==="manual"&&s.selectedGroupId){const re=parseInt(s.selectedGroupId,10),le=N==null?void 0:N.find(pe=>pe.groupNumber===re);if((le==null?void 0:le.status)==="completed"){h(pe=>({...pe,selectedGroupId:i("modal.completedGroupError")}));return}if(!ol(s.medicalDate,le.courseStartDate)){h(pe=>({...pe,medicalDate:"             6 ."}));return}}else if(!ol(s.medicalDate,l.courseStartDate)){h(re=>({...re,medicalDate:"             6 ."}));return}if(s.groupAssignmentMode==="manual"&&s.selectedGroupId){const re=parseInt(s.selectedGroupId,10),le=await yc(l.courseStartDate);if(le.group&&le.group.groupNumber!==re){const pe=N==null?void 0:N.find(me=>me.groupNumber===re);b({isOpen:!0,message:`:   ${re} (${at(pe.courseStartDate)})      ${le.group.groupNumber} (${at(le.group.courseStartDate)})    .`,onConfirm:()=>{b({isOpen:!1,message:"",onConfirm:()=>{}}),P()}});return}}await P()}},P=async()=>{v(!0);try{const F={companyName:s.companyName.trim(),personName:s.personName.trim(),egn:s.egn.trim(),birthPlace:s.birthPlace.trim(),citizenship:s.citizenship.trim()||"",medicalDate:s.medicalDate,uniqueNumber:s.uniqueNumber.trim()||w||void 0};r?await a(r.id,F):await n(F),t()}catch(F){console.error("Error saving participant:",F),alert(`Failed to save participant: ${F.message}`)}finally{v(!1)}};return e?f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:[f.jsxs("div",{className:"w-full max-w-2xl p-16 cursor-default",onClick:F=>F.stopPropagation(),children:[f.jsx("div",{className:"bg-white rounded-lg w-full max-h-[85vh] overflow-y-auto shadow-xl",children:f.jsxs("div",{className:"p-6",children:[f.jsx("h2",{className:"text-2xl font-bold mb-4",children:i(r?"modal.editParticipant":"modal.addParticipant")}),r&&f.jsx("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg border border-slate-200",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.createdAt&&f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-600",children:[i("timestamp.createdAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-slate-900",children:[at(r.createdAt.split("T")[0])," ",new Date(r.createdAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]}),r.updatedAt&&f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-600",children:[i("timestamp.updatedAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-slate-900",children:[at(r.updatedAt.split("T")[0])," ",new Date(r.updatedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]}),r.completedAt&&f.jsxs("div",{className:"col-span-2",children:[f.jsxs("span",{className:"text-emerald-600",children:[i("timestamp.completedAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-emerald-800",children:[at(r.completedAt.split("T")[0])," ",new Date(r.completedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]})]})}),f.jsxs("form",{onSubmit:S,children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.companyName")," *"]}),f.jsxs("select",{value:s.companyName,onChange:F=>o({...s,companyName:F.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:i("modal.selectCompany")}),f.jsx("option",{value:"Egida",children:"Egida"}),f.jsx("option",{value:"D-Max",children:"D-Max"}),f.jsx("option",{value:"Multiforce",children:"Multiforce"})]}),c.companyName&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.companyName})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.personName")," *"]}),f.jsx("input",{type:"text",value:s.personName,onChange:F=>o({...s,personName:F.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.personName&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.personName})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),f.jsx("input",{type:"text",value:s.egn,onChange:F=>o({...s,egn:F.target.value}),placeholder:"XXXXXXXXXX",maxLength:10,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.egn&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.egn})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),f.jsx("input",{type:"text",value:s.birthPlace,onChange:F=>o({...s,birthPlace:F.target.value}),placeholder:"./. ...",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.birthPlace&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.birthPlace})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),f.jsx("input",{type:"text",value:s.citizenship,onChange:F=>o({...s,citizenship:F.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.medicalDate")," *"]}),f.jsx("input",{type:"date",value:s.medicalDate,onChange:F=>o({...s,medicalDate:F.target.value}),onClick:F=>{var U,re;return(re=(U=F.target).showPicker)==null?void 0:re.call(U)},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer ${c.medicalDate?"border-red-500":"border-slate-300"}`}),c.medicalDate&&f.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:c.medicalDate}),s.medicalDate&&!c.medicalDate&&f.jsxs("p",{className:"text-emerald-600 text-sm mt-1",children:[" ",i("modal.medicalValid"),": ",at(s.medicalDate)]})]}),l.courseStartDate&&f.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-md",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:i("modal.courseDates")}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:i("modal.courseStart")}),f.jsx("div",{className:"text-lg font-semibold text-blue-900",children:at(l.courseStartDate)})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:i("modal.courseEnd")}),f.jsx("div",{className:"text-lg font-semibold text-blue-900",children:at(l.courseEndDate)})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:i("modal.groupAssignment")}),f.jsxs("div",{className:"flex gap-2 mb-3",children:[f.jsx("button",{type:"button",onClick:()=>o({...s,groupAssignmentMode:"auto",selectedGroupId:""}),className:`flex-1 px-3 py-2 rounded-md border ${s.groupAssignmentMode==="auto"?"bg-blue-700 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:i("modal.auto")}),f.jsx("button",{type:"button",onClick:()=>o({...s,groupAssignmentMode:"manual"}),className:`flex-1 px-3 py-2 rounded-md border ${s.groupAssignmentMode==="manual"?"bg-blue-700 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:i("modal.manual")})]}),s.groupAssignmentMode==="auto"&&k&&f.jsx(f.Fragment,{children:k.status==="completed"?f.jsx("div",{className:"bg-red-50 border border-red-200 p-3 rounded-md",children:f.jsxs("p",{className:"text-sm text-red-800 font-medium",children:[" ",i("modal.periodClosed"),f.jsx("br",{}),f.jsxs("span",{className:"text-xs font-normal mt-1 block",children:[i("modal.cannotAddComp",{date:at(k.courseStartDate)}),f.jsx("br",{}),i("modal.selectOtherDate")]})]})}):f.jsx("div",{className:"bg-emerald-50 border border-emerald-200 p-3 rounded-md",children:f.jsxs("p",{className:"text-sm text-emerald-800",children:[" ",i("modal.willBeAssigned")," ",f.jsxs("span",{className:"font-semibold",children:[i("group.number")," ",k.groupNumber||"-"]})," ","(",at(k.courseStartDate)," - ",at(k.courseEndDate),")"," ",f.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-semibold ${k.status==="active"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:k.status==="active"?i("modal.active"):i("modal.planned")})]})})}),s.groupAssignmentMode==="manual"&&f.jsxs("select",{value:s.selectedGroupId,onChange:F=>o({...s,selectedGroupId:F.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:i("modal.selectGroup")}),_&&f.jsxs("option",{value:(_.groupNumber||"").toString(),children:[i("group.number")," ",_.groupNumber||"-"," - ",at(_.courseStartDate)," (",i("modal.active"),")"]}),N==null?void 0:N.filter(F=>F.status==="planned").map(F=>f.jsxs("option",{value:(F.groupNumber||"").toString(),children:[i("group.number")," ",F.groupNumber||"-"," - ",at(F.courseStartDate)," (",i("modal.planned"),")"]},F.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:i("modal.uniqueNumberAuto")}),w&&r&&f.jsx("div",{className:"mb-2 p-2 bg-amber-50 border border-amber-300 rounded-md",children:f.jsxs("p",{className:"text-amber-800 text-sm font-medium",children:["     : ",w]})}),r&&(k==null?void 0:k.status)==="active"&&E&&!w&&f.jsx("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-300 rounded-md",children:f.jsxs("p",{className:"text-blue-800 text-sm font-medium",children:["       : ",f.jsx("span",{className:"font-bold",children:E})]})}),f.jsx("input",{type:"text",value:s.uniqueNumber,onChange:F=>o({...s,uniqueNumber:F.target.value}),placeholder:E?`${i("modal.uniqueNumberNext")}: ${E}`:"e.g., 3534-001",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono"}),c.uniqueNumber&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.uniqueNumber})]})]}),f.jsxs("div",{className:"mt-6 flex gap-3 justify-end pb-2 md:pb-0",children:[f.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-slate-200 rounded-md text-slate-700 hover:bg-slate-50",disabled:p,children:i("common.cancel")}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-700 text-white rounded-md hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:p||s.groupAssignmentMode==="auto"&&(k==null?void 0:k.status)==="completed",children:i(p?"common.saving":r?"modal.update":"common.add")})]})]})]})})," "]})," ",f.jsx(ts,{isOpen:y.isOpen,onClose:()=>b({isOpen:!1,message:"",onConfirm:()=>{}}),onConfirm:y.onConfirm,title:"  ",message:y.message,confirmText:"",cancelText:"",variant:"warning"})]}):null},TP=({isOpen:e,onClose:t,searchText:r,onSearchTextChange:n,selectedGroup:a,onSelectedGroupChange:i,statusFilters:s,onStatusFilterChange:o,dateRange:l,onDateRangeChange:u,groups:c,onResetToDefaults:h,visibleCount:p,totalCount:v})=>{const{t:E}=Tr(),g=x=>{x.key==="Enter"&&t()};_e.useEffect(()=>{const x=y=>{y.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[e,t]);const w=({label:x,value:y,onChange:b})=>f.jsxs("div",{className:"mb-3",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700 mb-1.5 block",children:x}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsx("button",{onClick:()=>b(null),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${y===null?"bg-slate-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:E("filters.all")}),f.jsx("button",{onClick:()=>b(!0),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${y===!0?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:E("filters.yes")}),f.jsx("button",{onClick:()=>b(!1),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${y===!1?"bg-red-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:E("filters.no")})]})]});return e?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 transition-opacity",onClick:t}),f.jsxs("div",{className:`fixed z-50 bg-white shadow-2xl transition-transform
          md:top-0 md:left-0 md:h-dvh md:w-[360px] lg:w-[420px] md:max-w-[480px] md:translate-x-0
          bottom-0 left-0 right-0 max-h-[90vh] rounded-t-3xl md:rounded-none flex flex-col
          ${e?"translate-y-0":"translate-y-full md:translate-y-0 md:-translate-x-full"}
        `,children:[f.jsx("div",{className:"md:hidden flex justify-center pt-3 pb-2",children:f.jsx("div",{className:"w-12 h-1.5 bg-slate-300 rounded-full"})}),f.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-4 border-b border-slate-200 z-10",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900",children:E("filters.title")}),p!==void 0&&v!==void 0&&f.jsxs("span",{className:"text-sm font-medium text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full",children:[p," / ",v]})]}),f.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-lg min-w-[44px] min-h-[44px] transition-colors duration-150",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"p-4 pb-4 flex-1 overflow-y-auto overscroll-contain",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:E("filters.search")}),f.jsx("input",{type:"text",value:r,onChange:x=>n(x.target.value),onKeyDown:g,placeholder:E("filters.searchPlaceholder"),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150"})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:E("filters.group")}),f.jsxs("select",{value:a,onChange:x=>i(x.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150",children:[f.jsx("option",{value:"",children:E("filters.allGroups")}),c.map(x=>f.jsx("option",{value:x.groupNumber.toString(),children:E("filters.groupOption",{number:x.groupNumber.toString(),date:x.courseStartDate})},x.groupNumber))]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:E("filters.dateRange")}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("input",{type:"date",value:l.start,onChange:x=>u({...l,start:x.target.value}),onClick:x=>{var y,b;return(b=(y=x.target).showPicker)==null?void 0:b.call(y)},className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150 cursor-pointer"}),f.jsx("input",{type:"date",value:l.end,onChange:x=>u({...l,end:x.target.value}),onClick:x=>{var y,b;return(b=(y=x.target).showPicker)==null?void 0:b.call(y)},className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150 cursor-pointer"})]})]}),f.jsxs("div",{className:"border-t border-slate-200 pt-4 mt-4",children:[f.jsx("h4",{className:"font-medium text-slate-900 mb-4",children:E("filters.statusFilters")}),f.jsx(w,{label:E("participant.sent"),value:s.sent,onChange:x=>o("sent",x)}),f.jsx(w,{label:E("participant.documents"),value:s.documents,onChange:x=>o("documents",x)}),f.jsx(w,{label:E("participant.handed"),value:s.handedOver,onChange:x=>o("handedOver",x)}),f.jsx(w,{label:E("participant.paid"),value:s.paid,onChange:x=>o("paid",x)}),f.jsx(w,{label:E("participant.completed"),value:s.completed,onChange:x=>o("completed",x)})]}),f.jsxs("div",{className:"mt-6 mb-6 pb-8 flex gap-3",children:[f.jsx("button",{onClick:()=>{n(""),i(""),u({start:"",end:""}),o("sent",null),o("documents",null),o("handedOver",null),o("paid",null),o("completed",null),h()},className:"flex-1 px-4 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 font-medium min-h-[48px] transition-colors duration-150",children:E("filters.clearAll")}),f.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 font-medium min-h-[48px] transition-colors duration-150",children:E("filters.apply")})]})]})]})]}):null},SP=({activeFilters:e,onRemoveFilter:t})=>{var a,i;const{t:r}=Tr(),n=[];return e.searchText&&n.push({label:`${r("filters.search")}: "${e.searchText}"`,type:"search"}),e.selectedGroup&&n.push({label:`${r("filters.group")}: ${e.selectedGroup}`,type:"group"}),(a=e.dateRange)!=null&&a.start&&n.push({label:`${r("filters.from")}: ${at(e.dateRange.start)}`,type:"dateStart"}),(i=e.dateRange)!=null&&i.end&&n.push({label:`${r("filters.to")}: ${at(e.dateRange.end)}`,type:"dateEnd"}),e.statusFilters&&Object.entries(e.statusFilters).forEach(([s,o])=>{if(o!==null){const l=`participant.${s}`;n.push({label:`${r(l)}: ${r(o?"filters.yes":"filters.no")}`,type:"status",value:s})}}),n.length===0?null:f.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.map((s,o)=>f.jsxs("button",{onClick:()=>t(s.type,s.value),className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200 transition-colors duration-150",children:[f.jsx("span",{children:s.label}),f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},o)),f.jsx("button",{onClick:()=>t("all"),className:"px-3 py-1.5 bg-slate-200 text-slate-700 rounded-full text-sm hover:bg-slate-300 transition-colors duration-150",children:"Clear All"})]})},AP=3e5,NP=16,DP="SHA-256",CP=256,xh="app_pin_config";function Qy(e){const t=new Uint8Array(e);let r="";const n=t.byteLength,a=8192;for(let i=0;i<n;i+=a)r+=String.fromCharCode.apply(null,t.subarray(i,i+a));return window.btoa(r)}function kP(e){try{const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}catch{throw new Error("Invalid Base64 string")}}async function NS(e,t){let r;t?r=kP(t):r=window.crypto.getRandomValues(new Uint8Array(NP));const n=new TextEncoder,a=await window.crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),i=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:AP,hash:DP},a,CP);return{hash:Qy(i),salt:Qy(r.buffer)}}async function Jy(e,t){try{const{hash:r}=await NS(e,t.salt);return r===t.hash}catch(r){return console.error("PIN verification failed:",r),!1}}function OP(e){localStorage.setItem(xh,JSON.stringify(e))}function ew(){const e=localStorage.getItem(xh);if(!e)return null;try{return JSON.parse(e)}catch{return null}}function jg(){localStorage.removeItem(xh)}function Bs(){return!!localStorage.getItem(xh)}const DS=({mode:e,onSuccess:t,onCancel:r,onResetData:n})=>{const{t:a}=Tr(),[i,s]=_e.useState(""),[o,l]=_e.useState(""),[u,c]=_e.useState("enter"),[h,p]=_e.useState(null),[v,E]=_e.useState(!1),[g,w]=_e.useState(!1);_e.useEffect(()=>{s(""),l(""),c("enter"),p(null)},[e]);const x=A=>{if(v)return;p(null);const S=u==="enter"?i:o;if(S.length<4){const P=S+A.toString();u==="enter"?s(P):l(P),P.length===4&&b(P)}},y=()=>{v||(p(null),u==="enter"?s(A=>A.slice(0,-1)):l(A=>A.slice(0,-1)))},b=async A=>{E(!0),await new Promise(S=>setTimeout(S,100));try{if(e==="unlock"){const S=ew();if(!S){t();return}await Jy(A,S)?t():(p(a("security.incorrectPin")),s(""))}else if(e==="setup")if(u==="enter"){c("confirm"),E(!1);return}else if(A===i){const{hash:S,salt:P}=await NS(A);OP({version:1,hash:S,salt:P,algo:"PBKDF2-SHA-256",createdAt:new Date().toISOString()}),t()}else p(a("security.pinMismatch")),s(""),l(""),c("enter");else if(e==="disable"){const S=ew();S&&await Jy(A,S)?(jg(),t()):(p(a("security.incorrectPin")),s(""))}}catch(S){console.error(S),p(a("security.error"))}finally{E(!1)}},_=()=>f.jsxs("div",{className:"grid grid-cols-3 gap-4 max-w-[280px] mx-auto mt-8",children:[[1,2,3,4,5,6,7,8,9].map(A=>f.jsx("button",{onClick:()=>x(A),className:"w-16 h-16 rounded-full bg-slate-100 text-slate-700 text-2xl font-bold hover:bg-slate-200 active:bg-slate-300 transition-colors flex items-center justify-center shadow-sm",children:A},A)),f.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:e==="unlock"&&f.jsx("button",{onClick:()=>w(!0),className:"text-xs text-slate-400 font-medium hover:text-red-500 transition-colors",children:a("security.forgot")})}),f.jsx("button",{onClick:()=>x(0),className:"w-16 h-16 rounded-full bg-slate-100 text-slate-700 text-2xl font-bold hover:bg-slate-200 active:bg-slate-300 transition-colors flex items-center justify-center shadow-sm",children:"0"}),f.jsx("button",{onClick:y,className:"w-16 h-16 rounded-full text-slate-500 hover:text-slate-700 hover:bg-slate-100 active:bg-slate-200 transition-colors flex items-center justify-center",children:f.jsx(ek,{className:"w-6 h-6"})})]}),N=A=>f.jsx("div",{className:"flex gap-4 justify-center mb-6",children:[0,1,2,3].map(S=>f.jsx("div",{className:`w-4 h-4 rounded-full border-2 transition-all duration-200 ${S<A.length?"bg-blue-600 border-blue-600":"bg-transparent border-slate-300"} ${h?"border-red-400 bg-red-50":""}`},S))}),k=()=>a(e==="setup"?u==="enter"?"security.setPinTitle":"security.confirmPinTitle":e==="disable"?"security.enterPinToDisable":"security.appLocked"),T=()=>h||a(e==="setup"?u==="enter"?"security.enter4DigitPin":"security.reEnterToConfirm":"security.enterYourPin");return f.jsxs("div",{className:"fixed inset-0 bg-slate-50 z-[100] flex flex-col items-center justify-center p-4 animate-in fade-in duration-300",children:[f.jsxs("div",{className:"w-full max-w-sm text-center",children:[f.jsx("div",{className:"mb-6 flex justify-center",children:f.jsx("div",{className:`p-4 rounded-full ${h?"bg-red-100":"bg-blue-100"}`,children:e==="unlock"?f.jsx(th,{className:`w-8 h-8 ${h?"text-red-600":"text-blue-600"}`}):f.jsx(Ek,{className:"w-8 h-8 text-blue-600"})})}),f.jsx("h2",{className:`text-2xl font-bold mb-2 ${h?"text-red-600":"text-slate-800"}`,children:k()}),f.jsx("p",{className:`text-sm mb-8 font-medium ${h?"text-red-500":"text-slate-500"}`,children:T()}),N(u==="enter"?i:o),_(),r&&f.jsx("button",{onClick:r,className:"mt-8 text-slate-500 hover:text-slate-700 font-medium text-sm",children:a("common.cancel")})]}),g&&f.jsx(ts,{isOpen:g,onClose:()=>w(!1),onConfirm:()=>{n&&(jg(),n()),w(!1)},title:a("security.resetDataTitle"),message:a("security.resetDataMessage"),confirmText:a("security.resetDataConfirm"),variant:"danger"})]})},tw=10*60*1e3,FP=({children:e})=>{const[t,r]=_e.useState(!1),[n,a]=_e.useState(!1),i=_e.useRef(Date.now()),s=_e.useRef(null);_e.useEffect(()=>{Bs()&&r(!0),a(!0)},[]);const o=_e.useCallback(()=>{Bs()&&r(!0)},[]),l=_e.useCallback(()=>{r(!1),i.current=Date.now()},[]);_e.useEffect(()=>{if(t)return;const c=()=>{i.current=Date.now()},h=["mousedown","keydown","touchstart","scroll","mousemove"];let p=null;const v=()=>{p||(c(),p=setTimeout(()=>{p=null},1e3))};h.forEach(g=>window.addEventListener(g,v));const E=()=>{!document.hidden&&Bs()&&Date.now()-i.current>tw&&r(!0)};return document.addEventListener("visibilitychange",E),s.current=setInterval(()=>{if(document.hidden)return;Date.now()-i.current>tw&&Bs()&&r(!0)},5e3),()=>{h.forEach(g=>window.removeEventListener(g,v)),document.removeEventListener("visibilitychange",E),s.current&&clearInterval(s.current),p&&clearTimeout(p)}},[t]),_e.useEffect(()=>{const c=()=>o();return window.addEventListener("app-lock-manual",c),()=>window.removeEventListener("app-lock-manual",c)},[o]);const u=async()=>{try{await Se.delete(),await Se.open(),jg(),window.location.reload()}catch(c){console.error("Failed to reset data",c),alert("Failed to reset data. Please clear browser storage manually.")}};return n?t?f.jsx(DS,{mode:"unlock",onSuccess:l,onResetData:u}):f.jsx(f.Fragment,{children:e}):null},CS=()=>{window.dispatchEvent(new Event("app-lock-manual"))},PP=({activeTab:e,onTabChange:t,onBack:r})=>{const{t:n}=Tr();return f.jsx("header",{className:"bg-blue-700 text-white shadow-sm sticky top-0 z-40",children:f.jsx("div",{className:"container mx-auto px-4 py-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[r&&f.jsx("button",{onClick:r,className:"md:hidden p-2 hover:bg-blue-700 rounded-lg",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),f.jsx("div",{className:"flex-shrink-0 w-14 h-14 md:w-16 md:h-16 bg-white rounded-md flex items-center justify-center overflow-hidden",children:f.jsx("img",{src:"./Logo.svg",alt:"Logo",className:"w-full h-full object-cover scale-[2.4]"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"CERTIFY"}),f.jsx("p",{className:"text-sm md:text-base text-blue-100",children:"    "})]}),f.jsxs("div",{className:"hidden md:flex gap-2",children:[f.jsxs("button",{onClick:()=>t("participants"),className:`px-6 py-2 rounded-lg font-medium transition-colors duration-150 flex items-center gap-2 ${e==="participants"?"bg-white text-blue-800":"bg-blue-700/30 text-white hover:bg-blue-700/50"}`,children:[f.jsx(_l,{className:"w-5 h-5",strokeWidth:2}),n("nav.participants")]}),f.jsxs("button",{onClick:()=>t("tools"),className:`px-6 py-2 rounded-lg font-medium transition-colors duration-150 flex items-center gap-2 ${e==="tools"?"bg-white text-blue-800":"bg-blue-700/30 text-white hover:bg-blue-700/50"}`,children:[f.jsx(Z1,{className:"w-5 h-5",strokeWidth:2}),n("nav.tools")]}),Bs()&&f.jsxs("button",{onClick:()=>CS(),className:"px-4 py-2 ml-2 rounded-lg font-medium bg-indigo-600 text-white hover:bg-indigo-500 border border-indigo-400/50 shadow-sm transition-all duration-150 flex items-center gap-2",title:n("nav.lock"),children:[f.jsx(th,{className:"w-5 h-5",strokeWidth:2}),f.jsx("span",{className:"hidden lg:inline",children:n("nav.lock")})]})]})]})})})},IP=({totalParticipants:e,visibleParticipants:t,totalCourses:r,visibleCourses:n,completedCount:a})=>{const{t:i}=Tr(),[s,o]=_e.useState(!1);return f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"md:hidden",children:[f.jsxs("button",{onClick:()=>o(!s),className:"w-full bg-white rounded-lg px-2 py-2 shadow-sm border border-slate-200 flex items-center justify-between mb-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"text-[11px] font-medium text-slate-500",children:i("participants.showing")}),f.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[t,"/",e]})]}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"text-[11px] font-medium text-slate-500",children:i("participant.completed")}),f.jsx("div",{className:"text-lg font-bold text-emerald-700",children:a})]})]}),f.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform duration-200 ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-1",children:[f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-slate-400",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-900 font-semibold whitespace-nowrap",children:i("participants.total")}),f.jsx("div",{className:"text-[9px] text-transparent font-medium mt-0.5 select-none",children:""})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(_l,{className:"w-3.5 h-3.5 text-slate-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:e})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-blue-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold whitespace-nowrap",children:i("participants.showing")}),f.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-0.5",children:i("participants.showingSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(Ag,{className:"w-3.5 h-3.5 text-blue-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-blue-600",children:t})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-indigo-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-indigo-600 font-semibold whitespace-nowrap",children:i("participants.totalCourses")}),f.jsx("div",{className:"text-[9px] text-transparent font-medium mt-0.5 select-none",children:""})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(V2,{className:"w-3.5 h-3.5 text-indigo-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-indigo-600",children:r})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-cyan-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-cyan-600 font-semibold whitespace-nowrap",children:i("participants.visibleCourses")}),f.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-0.5",children:i("participants.visibleCoursesSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(ro,{className:"w-3.5 h-3.5 text-cyan-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-cyan-600",children:n})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-amber-500 col-span-2",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-amber-600 font-semibold whitespace-nowrap",children:i("participants.completed")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(H2,{className:"w-3.5 h-3.5 text-amber-600",strokeWidth:2})})]}),f.jsxs("div",{className:"flex items-baseline gap-1",children:[f.jsx("div",{className:"text-xl font-semibold tracking-tight text-amber-600",children:a}),f.jsxs("div",{className:"text-xs text-slate-500",children:["/ ",t," (",t>0?Math.round(a/t*100):0,"%)"]})]})]})]})]}),f.jsxs("div",{className:"hidden md:grid grid-cols-5 gap-4 mb-2",children:[f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-slate-400 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-slate-900 font-semibold whitespace-nowrap",children:i("participants.total")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(_l,{className:"w-[18px] h-[18px] text-slate-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-slate-900 mt-auto",children:e})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-blue-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-base uppercase tracking-wide text-blue-600 font-semibold whitespace-nowrap",children:i("participants.showing")}),f.jsx("div",{className:"text-[10px] text-slate-500 font-medium mt-0.5",children:i("participants.showingSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(Ag,{className:"w-[18px] h-[18px] text-blue-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-4xl font-semibold tracking-tight text-blue-600 mt-auto",children:t})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-indigo-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-indigo-600 font-semibold whitespace-nowrap",children:i("participants.totalCourses")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(V2,{className:"w-[18px] h-[18px] text-indigo-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-indigo-600 mt-auto",children:r})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-cyan-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-base uppercase tracking-wide text-cyan-600 font-semibold whitespace-nowrap",children:i("participants.visibleCourses")}),f.jsx("div",{className:"text-[10px] text-slate-500 font-medium mt-0.5",children:i("participants.visibleCoursesSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(ro,{className:"w-[18px] h-[18px] text-cyan-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-4xl font-semibold tracking-tight text-cyan-600 mt-auto",children:n})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-amber-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-amber-600 font-semibold whitespace-nowrap",children:i("participants.completed")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(H2,{className:"w-[18px] h-[18px] text-amber-600",strokeWidth:2})})]}),f.jsxs("div",{className:"flex items-baseline gap-2 mt-auto",children:[f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-amber-600",children:a}),f.jsxs("div",{className:"text-sm text-slate-500",children:["/ ",t," (",t>0?Math.round(a/t*100):0,"%)"]})]})]})]})]})},RP=({activeTab:e,onTabChange:t})=>{const{t:r}=Tr();return f.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-sm z-50",children:f.jsxs("div",{className:"flex",children:[f.jsxs("button",{onClick:()=>t("participants"),className:`flex-1 flex flex-col items-center justify-center py-3 transition-colors duration-150 ${e==="participants"?"text-blue-700":"text-slate-400"}`,children:[f.jsx(_l,{className:"w-6 h-6 mb-1",strokeWidth:2}),f.jsx("span",{className:`text-xs ${e==="participants"?"font-semibold":"font-medium"}`,children:r("nav.participants")})]}),f.jsxs("button",{onClick:()=>t("tools"),className:`flex-1 flex flex-col items-center justify-center py-3 transition-colors duration-150 ${e==="tools"?"text-blue-700":"text-slate-400"}`,children:[f.jsx(Z1,{className:"w-6 h-6 mb-1",strokeWidth:2}),f.jsx("span",{className:`text-xs ${e==="tools"?"font-semibold":"font-medium"}`,children:r("nav.tools")})]})]})})},jP=({onClick:e})=>{const{t}=Tr();return f.jsx("button",{onClick:e,className:"md:hidden fixed bottom-24 right-6 w-14 h-14 bg-emerald-600 hover:bg-emerald-700 active:bg-emerald-800 text-white rounded-full shadow-lg flex items-center justify-center z-40 active:scale-95 transition-all duration-150",style:{minWidth:"56px",minHeight:"56px"},"aria-label":t("participants.add"),children:f.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xd={};xd.version="0.18.5";var kS=1252,MP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],OS=function(e){MP.indexOf(e)!=-1&&(kS=e)};function LP(){OS(1252)}var Ic=function(e){OS(e)};function BP(){Ic(1200),LP()}var r0=function(t){return String.fromCharCode(t)},rw=function(t){return String.fromCharCode(t)},vd,Gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rc(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Gi.charAt(i)+Gi.charAt(s)+Gi.charAt(o)+Gi.charAt(l);return t}function Ti(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Gi.indexOf(e.charAt(u++)),s=Gi.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Gi.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Gi.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var qt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ni=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function so(e){return qt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nw(e){return qt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ka=function(t){return qt?Ni(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function vh(e){if(typeof ArrayBuffer>"u")return ka(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function af(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function UP(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Jr=qt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ni(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function zP(e){for(var t=[],r=0,n=e.length+250,a=so(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=so(65535),n=65530)}return t.push(a.slice(0,r)),Jr(t)}var zu=/\u0000/g,n0=/[\u0001-\u0006]/g;function cl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Fa(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}function Ex(e,t){var r=""+e;return r.length>=t?r:yr(" ",t-r.length)+r}function yd(e,t){var r=""+e;return r.length>=t?r:r+yr(" ",t-r.length)}function qP(e,t){var r=""+Math.round(e);return r.length>=t?r:yr("0",t-r.length)+r}function WP(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}var aw=Math.pow(2,32);function Oo(e,t){if(e>aw||e<-aw)return qP(e,t);var r=Math.round(e);return WP(r,t)}function wd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var iw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $P(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},GP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bd(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,u=0,c=0,h=Math.floor(a);u<t&&(h=Math.floor(a),o=h*s+i,c=h*u+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=u,u=c;if(c>t&&(u>t?(c=l,o=i):(c=u,o=s)),!r)return[0,n*o,c];var p=Math.floor(n*o/c);return[p,n*o-p*c,c]}function a0(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=QP(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var FS=new Date(1899,11,31,0,0,0),HP=FS.getTime(),VP=new Date(1900,2,1,0,0,0);function PS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=VP&&(r+=24*60*60*1e3),(r-(HP+(e.getTimezoneOffset()-FS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function _x(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function YP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function XP(e){var t=e<0?12:11,r=_x(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function KP(e){var t=_x(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ZP(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=XP(e):t===10?r=e.toFixed(10).substr(0,12):r=KP(e),_x(YP(r.toUpperCase()))}function Mg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ZP(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fs(14,PS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function QP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function JP(e,t,r,n){var a="",i=0,s=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return Xp[r.m-1][1];case 5:return Xp[r.m-1][0];default:return Xp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return iw[r.q][0];default:return iw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Fa(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Fa(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Fa(l,u):"";return c}function Hi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var IS=/%/g;function eI(e,t,r){var n=t.replace(IS,""),a=t.length-n.length;return gi(e,n,r*Math.pow(10,2*a))+yr("%",a)}function tI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return gi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function RS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+RS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var jS=/# (\?+)( ?)\/( ?)(\d+)/;function rI(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?yr(" ",e[1].length+1+e[4].length):Ex(s,e[1].length)+e[2]+"/"+e[3]+Fa(o,e[4].length))}function nI(e,t,r){return r+(t===0?"":""+t)+yr(" ",e[1].length+2+e[4].length)}var MS=/^#*0*\.([0#]+)/,LS=/\).*[0#]/,BS=/\(###\) ###\\?-####/;function yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ow(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function aI(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function iI(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function sa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(LS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?sa("n",n,r):"("+sa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tI(e,t,r);if(t.indexOf("%")!==-1)return eI(e,t,r);if(t.indexOf("E")!==-1)return RS(t,r);if(t.charCodeAt(0)===36)return"$"+sa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Oo(l,t.length);if(t.match(/^[#?]+$/))return a=Oo(r,0),a==="0"&&(a=""),a.length>t.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(jS))return rI(i,l,u);if(t.match(/^#+0+$/))return u+Oo(l,t.length-t.indexOf("0"));if(i=t.match(MS))return a=ow(r,i[1].length).replace(/^([^\.]+)$/,"$1."+yn(i[1])).replace(/\.$/,"."+yn(i[1])).replace(/\.(\d*)$/,function(E,g){return"."+g+yr("0",yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+ow(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Hi(Oo(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+sa(e,t,-r):Hi(""+(Math.floor(r)+aI(r,i[1].length)))+"."+Fa(lw(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return sa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(sa(e,t.replace(/[\\-]/g,""),r)),s=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return s<a.length?a.charAt(s++):E==="0"?"0":""}));if(t.match(BS))return a=sa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=bd(l,Math.pow(10,s)-1,!1),a=""+u,c=gi("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=yd(o[2],s),c.length<i[4].length&&(c=yn(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=bd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ex(o[1],s)+i[2]+"/"+i[3]+yd(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Oo(r,0),t.length<=a.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return yn(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=lw(r,i[1].length),r<0?"-"+sa(e,t,-r):Hi(iI(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Fa(0,3-E.length):"")+E})+"."+Fa(s,i[1].length);switch(t){case"###,##0.00":return sa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Hi(Oo(l,0));return v!=="0"?u+v:"";case"###,###.00":return sa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return sa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sI(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return gi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function oI(e,t,r){var n=t.replace(IS,""),a=t.length-n.length;return gi(e,n,r*Math.pow(10,2*a))+yr("%",a)}function US(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+US(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(LS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sI(e,t,r);if(t.indexOf("%")!==-1)return oI(e,t,r);if(t.indexOf("E")!==-1)return US(t,r);if(t.charCodeAt(0)===36)return"$"+Wa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Fa(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(jS))return nI(i,l,u);if(t.match(/^#+0+$/))return u+Fa(l,t.length-t.indexOf("0"));if(i=t.match(MS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+yn(i[1])).replace(/\.$/,"."+yn(i[1])),a=a.replace(/\.(\d*)$/,function(E,g){return"."+g+yr("0",yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Hi(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Hi(""+r)+"."+yr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Wa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(Wa(e,t.replace(/[\\-]/g,""),r)),s=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return s<a.length?a.charAt(s++):E==="0"?"0":""}));if(t.match(BS))return a=Wa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=bd(l,Math.pow(10,s)-1,!1),a=""+u,c=gi("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=yd(o[2],s),c.length<i[4].length&&(c=yn(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=bd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ex(o[1],s)+i[2]+"/"+i[3]+yd(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return yn(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Hi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Fa(0,3-E.length):"")+E})+"."+Fa(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Hi(""+l);return v!=="0"?u+v:"";default:if(t.match(/\.[0#?]*$/))return Wa(e,t.slice(0,t.lastIndexOf(".")),r)+yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function gi(e,t,r){return(r|0)===r?Wa(e,t,r):sa(e,t,r)}function lI(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var zS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qS(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":wd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(zS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uI(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",u,c,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!wd(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var v=e.charAt(++s),E=v==="("||v===")"?v:"t";a[a.length]={t:E,v},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=a0(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=a0(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=a0(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",s+=5,p="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(zS)){if(u==null&&(u=a0(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",qS(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var w=0,x=0,y;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",w<1&&(w=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",_;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=JP(a[s].t.charCodeAt(0),a[s].v,u,x),a[s].t="t";break;case"n":case"?":for(_=s+1;a[_]!=null&&((o=a[_].t)==="?"||o==="D"||(o===" "||o==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[s].v+=a[_].v,a[_]={v:"",t:";"},++_;b+=a[s].v,s=_-1;break;case"G":a[s].t="t",a[s].v=Mg(t,r);break}var N="",k,T;if(b.length>0){b.charCodeAt(0)==40?(k=t<0&&b.charCodeAt(0)===45?-t:t,T=gi("n",b,k)):(k=t<0&&n>1?-t:t,T=gi("n",b,k),k<0&&a[0]&&a[0].t=="t"&&(T=T.substr(1),a[0].v="-"+a[0].v)),_=T.length-1;var A=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){A=s;break}var S=a.length;if(A===a.length&&T.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(_>=a[s].v.length-1?(_-=a[s].v.length,a[s].v=T.substr(_+1,a[s].v.length)):_<0?a[s].v="":(a[s].v=T.substr(0,_+1),_=-1),a[s].t="t",S=s);_>=0&&S<a.length&&(a[S].v=T.substr(0,_+1)+a[S].v)}else if(A!==a.length&&T.indexOf("E")===-1){for(_=T.indexOf(".")-1,s=A;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(c=a[s].v.indexOf(".")>-1&&s===A?a[s].v.indexOf(".")-1:a[s].v.length-1,N=a[s].v.substr(c+1);c>=0;--c)_>=0&&(a[s].v.charAt(c)==="0"||a[s].v.charAt(c)==="#")&&(N=T.charAt(_--)+N);a[s].v=N,a[s].t="t",S=s}for(_>=0&&S<a.length&&(a[S].v=T.substr(0,_+1)+a[S].v),_=T.indexOf(".")+1,s=A;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==A)){for(c=a[s].v.indexOf(".")>-1&&s===A?a[s].v.indexOf(".")+1:0,N=a[s].v.substr(0,c);c<a[s].v.length;++c)_<T.length&&(N+=T.charAt(_++));a[s].v=N,a[s].t="t",S=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(k=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=gi(a[s].t,a[s].v,k),a[s].t="t");var P="";for(s=0;s!==a.length;++s)a[s]!=null&&(P+=a[s].v);return P}var uw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function cI(e,t){var r=lI(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(uw),o=r[1].match(uw);return cw(t,s)?[n,r[0]]:cw(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function fs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:wr)[e],n==null&&(n=r.table&&r.table[sw[e]]||wr[sw[e]]),n==null&&(n=GP[e]||"General");break}if(wd(n,0))return Mg(t,r);t instanceof Date&&(t=PS(t,r.date1904));var a=cI(n,t);if(wd(a[1]))return Mg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uI(a[1],t,r,a[0])}function WS(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(wr[r]==null){t<0&&(t=r);continue}if(wr[r]==e){t=r;break}}t<0&&(t=391)}return wr[t]=e,t}function yh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&WS(e[t],t)}function wh(){wr=$P()}var $S=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fI(e){var t=typeof e=="number"?wr[e]:e;return t=t.replace($S,"(\\d+)"),new RegExp("^"+t+"$")}function dI(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match($S)||[]).forEach(function(h,p){var v=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":s=v;break;case"s":l=v;break;case"m":s>=0?o=v:a=v;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&i==-1?c:u+"T"+c}var hI=function(){var e={};e.version="1.2.0";function t(){for(var T=0,A=new Array(256),S=0;S!=256;++S)T=S,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,A[S]=T;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(T){var A=0,S=0,P=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)F[P]=T[P];for(P=0;P!=256;++P)for(S=T[P],A=256+P;A<4096;A+=256)S=F[A]=S>>>8^T[S&255];var U=[];for(P=1;P!=16;++P)U[P-1]=typeof Int32Array<"u"?F.subarray(P*256,P*256+256):F.slice(P*256,P*256+256);return U}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],u=a[4],c=a[5],h=a[6],p=a[7],v=a[8],E=a[9],g=a[10],w=a[11],x=a[12],y=a[13],b=a[14];function _(T,A){for(var S=A^-1,P=0,F=T.length;P<F;)S=S>>>8^r[(S^T.charCodeAt(P++))&255];return~S}function N(T,A){for(var S=A^-1,P=T.length-15,F=0;F<P;)S=b[T[F++]^S&255]^y[T[F++]^S>>8&255]^x[T[F++]^S>>16&255]^w[T[F++]^S>>>24]^g[T[F++]]^E[T[F++]]^v[T[F++]]^p[T[F++]]^h[T[F++]]^c[T[F++]]^u[T[F++]]^l[T[F++]]^o[T[F++]]^s[T[F++]]^i[T[F++]]^r[T[F++]];for(P+=15;F<P;)S=S>>>8^r[(S^T[F++])&255];return~S}function k(T,A){for(var S=A^-1,P=0,F=T.length,U=0,re=0;P<F;)U=T.charCodeAt(P++),U<128?S=S>>>8^r[(S^U)&255]:U<2048?(S=S>>>8^r[(S^(192|U>>6&31))&255],S=S>>>8^r[(S^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,re=T.charCodeAt(P++)&1023,S=S>>>8^r[(S^(240|U>>8&7))&255],S=S>>>8^r[(S^(128|U>>2&63))&255],S=S>>>8^r[(S^(128|re>>6&15|(U&3)<<4))&255],S=S>>>8^r[(S^(128|re&63))&255]):(S=S>>>8^r[(S^(224|U>>12&15))&255],S=S>>>8^r[(S^(128|U>>6&63))&255],S=S>>>8^r[(S^(128|U&63))&255]);return~S}return e.table=r,e.bstr=_,e.buf=N,e.str=k,e}(),Qt=function(){var t={};t.version="1.2.1";function r(O,z){for(var L=O.split("/"),B=z.split("/"),q=0,H=0,ge=Math.min(L.length,B.length);q<ge;++q){if(H=L[q].length-B[q].length)return H;if(L[q]!=B[q])return L[q]<B[q]?-1:1}return L.length-B.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var z=O.lastIndexOf("/");return z===-1?O:O.slice(0,z+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var z=O.lastIndexOf("/");return z===-1?O:O.slice(z+1)}function i(O,z){typeof z=="string"&&(z=new Date(z));var L=z.getHours();L=L<<6|z.getMinutes(),L=L<<5|z.getSeconds()>>>1,O.write_shift(2,L);var B=z.getFullYear()-1980;B=B<<4|z.getMonth()+1,B=B<<5|z.getDate(),O.write_shift(2,B)}function s(O){var z=O.read_shift(2)&65535,L=O.read_shift(2)&65535,B=new Date,q=L&31;L>>>=5;var H=L&15;L>>>=4,B.setMilliseconds(0),B.setFullYear(L+1980),B.setMonth(H-1),B.setDate(q);var ge=z&31;z>>>=5;var Ne=z&63;return z>>>=6,B.setHours(z),B.setMinutes(Ne),B.setSeconds(ge<<1),B}function o(O){Hn(O,0);for(var z={},L=0;O.l<=O.length-4;){var B=O.read_shift(2),q=O.read_shift(2),H=O.l+q,ge={};switch(B){case 21589:L=O.read_shift(1),L&1&&(ge.mtime=O.read_shift(4)),q>5&&(L&2&&(ge.atime=O.read_shift(4)),L&4&&(ge.ctime=O.read_shift(4))),ge.mtime&&(ge.mt=new Date(ge.mtime*1e3));break}O.l=H,z[B]=ge}return z}var l;function u(){return l||(l={})}function c(O,z){if(O[0]==80&&O[1]==75)return it(O,z);if((O[0]|32)==109&&(O[1]|32)==105)return gn(O,z);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var L=3,B=512,q=0,H=0,ge=0,Ne=0,he=0,ye=[],we=O.slice(0,512);Hn(we,0);var Pe=h(we);switch(L=Pe[0],L){case 3:B=512;break;case 4:B=4096;break;case 0:if(Pe[1]==0)return it(O,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}B!==512&&(we=O.slice(0,B),Hn(we,28));var qe=O.slice(0,B);p(we,L);var Qe=we.read_shift(4,"i");if(L===3&&Qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Qe);we.l+=4,ge=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),Ne=we.read_shift(4,"i"),q=we.read_shift(4,"i"),he=we.read_shift(4,"i"),H=we.read_shift(4,"i");for(var Le=-1,Xe=0;Xe<109&&(Le=we.read_shift(4,"i"),!(Le<0));++Xe)ye[Xe]=Le;var vt=v(O,B);w(he,H,vt,B,ye);var nr=y(vt,ge,ye,B);nr[ge].name="!Directory",q>0&&Ne!==re&&(nr[Ne].name="!MiniFAT"),nr[ye[0]].name="!FAT",nr.fat_addrs=ye,nr.ssz=B;var ar={},Lr=[],bs=[],za=[];b(ge,nr,vt,Lr,q,ar,bs,Ne),E(bs,za,Lr),Lr.shift();var Es={FileIndex:bs,FullPaths:za};return z&&z.raw&&(Es.raw={header:qe,sectors:vt}),Es}function h(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(le,"Header Signature: "),O.l+=16;var z=O.read_shift(2,"u");return[O.read_shift(2,"u"),z]}function p(O,z){var L=9;switch(O.l+=2,L=O.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function v(O,z){for(var L=Math.ceil(O.length/z)-1,B=[],q=1;q<L;++q)B[q-1]=O.slice(q*z,(q+1)*z);return B[L-1]=O.slice(L*z),B}function E(O,z,L){for(var B=0,q=0,H=0,ge=0,Ne=0,he=L.length,ye=[],we=[];B<he;++B)ye[B]=we[B]=B,z[B]=L[B];for(;Ne<we.length;++Ne)B=we[Ne],q=O[B].L,H=O[B].R,ge=O[B].C,ye[B]===B&&(q!==-1&&ye[q]!==q&&(ye[B]=ye[q]),H!==-1&&ye[H]!==H&&(ye[B]=ye[H])),ge!==-1&&(ye[ge]=B),q!==-1&&B!=ye[B]&&(ye[q]=ye[B],we.lastIndexOf(q)<Ne&&we.push(q)),H!==-1&&B!=ye[B]&&(ye[H]=ye[B],we.lastIndexOf(H)<Ne&&we.push(H));for(B=1;B<he;++B)ye[B]===B&&(H!==-1&&ye[H]!==H?ye[B]=ye[H]:q!==-1&&ye[q]!==q&&(ye[B]=ye[q]));for(B=1;B<he;++B)if(O[B].type!==0){if(Ne=B,Ne!=ye[Ne])do Ne=ye[Ne],z[B]=z[Ne]+"/"+z[B];while(Ne!==0&&ye[Ne]!==-1&&Ne!=ye[Ne]);ye[B]=-1}for(z[0]+="/",B=1;B<he;++B)O[B].type!==2&&(z[B]+="/")}function g(O,z,L){for(var B=O.start,q=O.size,H=[],ge=B;L&&q>0&&ge>=0;)H.push(z.slice(ge*U,ge*U+U)),q-=U,ge=Ps(L,ge*4);return H.length===0?Ae(0):Jr(H).slice(0,O.size)}function w(O,z,L,B,q){var H=re;if(O===re){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ge=L[O],Ne=(B>>>2)-1;if(!ge)return;for(var he=0;he<Ne&&(H=Ps(ge,he*4))!==re;++he)q.push(H);w(Ps(ge,B-4),z-1,L,B,q)}}function x(O,z,L,B,q){var H=[],ge=[];q||(q=[]);var Ne=B-1,he=0,ye=0;for(he=z;he>=0;){q[he]=!0,H[H.length]=he,ge.push(O[he]);var we=L[Math.floor(he*4/B)];if(ye=he*4&Ne,B<4+ye)throw new Error("FAT boundary crossed: "+he+" 4 "+B);if(!O[we])break;he=Ps(O[we],ye)}return{nodes:H,data:vw([ge])}}function y(O,z,L,B){var q=O.length,H=[],ge=[],Ne=[],he=[],ye=B-1,we=0,Pe=0,qe=0,Qe=0;for(we=0;we<q;++we)if(Ne=[],qe=we+z,qe>=q&&(qe-=q),!ge[qe]){he=[];var Le=[];for(Pe=qe;Pe>=0;){Le[Pe]=!0,ge[Pe]=!0,Ne[Ne.length]=Pe,he.push(O[Pe]);var Xe=L[Math.floor(Pe*4/B)];if(Qe=Pe*4&ye,B<4+Qe)throw new Error("FAT boundary crossed: "+Pe+" 4 "+B);if(!O[Xe]||(Pe=Ps(O[Xe],Qe),Le[Pe]))break}H[qe]={nodes:Ne,data:vw([he])}}return H}function b(O,z,L,B,q,H,ge,Ne){for(var he=0,ye=B.length?2:0,we=z[O].data,Pe=0,qe=0,Qe;Pe<we.length;Pe+=128){var Le=we.slice(Pe,Pe+128);Hn(Le,64),qe=Le.read_shift(2),Qe=Dx(Le,0,qe-ye),B.push(Qe);var Xe={name:Qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},vt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);vt!==0&&(Xe.ct=_(Le,Le.l-8));var nr=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);nr!==0&&(Xe.mt=_(Le,Le.l-8)),Xe.start=Le.read_shift(4,"i"),Xe.size=Le.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=re,Xe.name=""),Xe.type===5?(he=Xe.start,q>0&&he!==re&&(z[he].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",z[Xe.start]===void 0&&(z[Xe.start]=x(L,Xe.start,z.fat_addrs,z.ssz)),z[Xe.start].name=Xe.name,Xe.content=z[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:he!==re&&Xe.start!==re&&z[he]&&(Xe.content=g(Xe,z[he].data,(z[Ne]||{}).data))),Xe.content&&Hn(Xe.content,0),H[Qe]=Xe,ge.push(Xe)}}function _(O,z){return new Date((Yn(O,z+4)/1e7*Math.pow(2,32)+Yn(O,z)/1e7-11644473600)*1e3)}function N(O,z){return u(),c(l.readFileSync(O),z)}function k(O,z){var L=z&&z.type;switch(L||qt&&Buffer.isBuffer(O)&&(L="buffer"),L||"base64"){case"file":return N(O,z);case"base64":return c(ka(Ti(O)),z);case"binary":return c(ka(O),z)}return c(O,z)}function T(O,z){var L=z||{},B=L.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=B+"/",O.FileIndex[0]={name:B,type:5}),L.CLSID&&(O.FileIndex[0].clsid=L.CLSID),A(O)}function A(O){var z="Sh33tJ5";if(!Qt.find(O,"/"+z)){var L=Ae(4);L[0]=55,L[1]=L[3]=50,L[2]=54,O.FileIndex.push({name:z,type:2,content:L,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+z),S(O)}}function S(O,z){T(O);for(var L=!1,B=!1,q=O.FullPaths.length-1;q>=0;--q){var H=O.FileIndex[q];switch(H.type){case 0:B?L=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(H.R*H.L*H.C)&&(L=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!z)){var ge=new Date(1987,1,19),Ne=0,he=Object.create?Object.create(null):{},ye=[];for(q=0;q<O.FullPaths.length;++q)he[O.FullPaths[q]]=!0,O.FileIndex[q].type!==0&&ye.push([O.FullPaths[q],O.FileIndex[q]]);for(q=0;q<ye.length;++q){var we=n(ye[q][0]);B=he[we],B||(ye.push([we,{name:a(we).replace("/",""),type:1,clsid:me,ct:ge,mt:ge,content:null}]),he[we]=!0)}for(ye.sort(function(Qe,Le){return r(Qe[0],Le[0])}),O.FullPaths=[],O.FileIndex=[],q=0;q<ye.length;++q)O.FullPaths[q]=ye[q][0],O.FileIndex[q]=ye[q][1];for(q=0;q<ye.length;++q){var Pe=O.FileIndex[q],qe=O.FullPaths[q];if(Pe.name=a(qe).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||me,q===0)Pe.C=ye.length>1?1:-1,Pe.size=0,Pe.type=5;else if(qe.slice(-1)=="/"){for(Ne=q+1;Ne<ye.length&&n(O.FullPaths[Ne])!=qe;++Ne);for(Pe.C=Ne>=ye.length?-1:Ne,Ne=q+1;Ne<ye.length&&n(O.FullPaths[Ne])!=n(qe);++Ne);Pe.R=Ne>=ye.length?-1:Ne,Pe.type=1}else n(O.FullPaths[q+1]||"")==n(qe)&&(Pe.R=q+1),Pe.type=2}}}function P(O,z){var L=z||{};if(L.fileType=="mad")return Ua(O,L);switch(S(O),L.fileType){case"zip":return It(O,L)}var B=function(Qe){for(var Le=0,Xe=0,vt=0;vt<Qe.FileIndex.length;++vt){var nr=Qe.FileIndex[vt];if(nr.content){var ar=nr.content.length;ar>0&&(ar<4096?Le+=ar+63>>6:Xe+=ar+511>>9)}}for(var Lr=Qe.FullPaths.length+3>>2,bs=Le+7>>3,za=Le+127>>7,Es=bs+Xe+Lr+za,ti=Es+127>>7,Gl=ti<=109?0:Math.ceil((ti-109)/127);Es+ti+Gl+127>>7>ti;)Gl=++ti<=109?0:Math.ceil((ti-109)/127);var wa=[1,Gl,ti,za,Lr,Xe,Le,0];return Qe.FileIndex[0].size=Le<<6,wa[7]=(Qe.FileIndex[0].start=wa[0]+wa[1]+wa[2]+wa[3]+wa[4]+wa[5])+(wa[6]+7>>3),wa}(O),q=Ae(B[7]<<9),H=0,ge=0;{for(H=0;H<8;++H)q.write_shift(1,pe[H]);for(H=0;H<8;++H)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),H=0;H<3;++H)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,B[2]),q.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:re),q.write_shift(4,B[3]),q.write_shift(-4,B[1]?B[0]-1:re),q.write_shift(4,B[1]),H=0;H<109;++H)q.write_shift(-4,H<B[2]?B[1]+H:-1)}if(B[1])for(ge=0;ge<B[1];++ge){for(;H<236+ge*127;++H)q.write_shift(-4,H<B[2]?B[1]+H:-1);q.write_shift(-4,ge===B[1]-1?re:ge+1)}var Ne=function(Qe){for(ge+=Qe;H<ge-1;++H)q.write_shift(-4,H+1);Qe&&(++H,q.write_shift(-4,re))};for(ge=H=0,ge+=B[1];H<ge;++H)q.write_shift(-4,Ee.DIFSECT);for(ge+=B[2];H<ge;++H)q.write_shift(-4,Ee.FATSECT);Ne(B[3]),Ne(B[4]);for(var he=0,ye=0,we=O.FileIndex[0];he<O.FileIndex.length;++he)we=O.FileIndex[he],we.content&&(ye=we.content.length,!(ye<4096)&&(we.start=ge,Ne(ye+511>>9)));for(Ne(B[6]+7>>3);q.l&511;)q.write_shift(-4,Ee.ENDOFCHAIN);for(ge=H=0,he=0;he<O.FileIndex.length;++he)we=O.FileIndex[he],we.content&&(ye=we.content.length,!(!ye||ye>=4096)&&(we.start=ge,Ne(ye+63>>6)));for(;q.l&511;)q.write_shift(-4,Ee.ENDOFCHAIN);for(H=0;H<B[4]<<2;++H){var Pe=O.FullPaths[H];if(!Pe||Pe.length===0){for(he=0;he<17;++he)q.write_shift(4,0);for(he=0;he<3;++he)q.write_shift(4,-1);for(he=0;he<12;++he)q.write_shift(4,0);continue}we=O.FileIndex[H],H===0&&(we.start=we.size?we.start-1:re);var qe=H===0&&L.root||we.name;if(ye=2*(qe.length+1),q.write_shift(64,qe,"utf16le"),q.write_shift(2,ye),q.write_shift(1,we.type),q.write_shift(1,we.color),q.write_shift(-4,we.L),q.write_shift(-4,we.R),q.write_shift(-4,we.C),we.clsid)q.write_shift(16,we.clsid,"hex");else for(he=0;he<4;++he)q.write_shift(4,0);q.write_shift(4,we.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,we.start),q.write_shift(4,we.size),q.write_shift(4,0)}for(H=1;H<O.FileIndex.length;++H)if(we=O.FileIndex[H],we.size>=4096)if(q.l=we.start+1<<9,qt&&Buffer.isBuffer(we.content))we.content.copy(q,q.l,0,we.size),q.l+=we.size+511&-512;else{for(he=0;he<we.size;++he)q.write_shift(1,we.content[he]);for(;he&511;++he)q.write_shift(1,0)}for(H=1;H<O.FileIndex.length;++H)if(we=O.FileIndex[H],we.size>0&&we.size<4096)if(qt&&Buffer.isBuffer(we.content))we.content.copy(q,q.l,0,we.size),q.l+=we.size+63&-64;else{for(he=0;he<we.size;++he)q.write_shift(1,we.content[he]);for(;he&63;++he)q.write_shift(1,0)}if(qt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function F(O,z){var L=O.FullPaths.map(function(he){return he.toUpperCase()}),B=L.map(function(he){var ye=he.split("/");return ye[ye.length-(he.slice(-1)=="/"?2:1)]}),q=!1;z.charCodeAt(0)===47?(q=!0,z=L[0].slice(0,-1)+z):q=z.indexOf("/")!==-1;var H=z.toUpperCase(),ge=q===!0?L.indexOf(H):B.indexOf(H);if(ge!==-1)return O.FileIndex[ge];var Ne=!H.match(n0);for(H=H.replace(zu,""),Ne&&(H=H.replace(n0,"!")),ge=0;ge<L.length;++ge)if((Ne?L[ge].replace(n0,"!"):L[ge]).replace(zu,"")==H||(Ne?B[ge].replace(n0,"!"):B[ge]).replace(zu,"")==H)return O.FileIndex[ge];return null}var U=64,re=-2,le="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(O,z,L){u();var B=P(O,L);l.writeFileSync(z,B)}function de(O){for(var z=new Array(O.length),L=0;L<O.length;++L)z[L]=String.fromCharCode(O[L]);return z.join("")}function Ce(O,z){var L=P(O,z);switch(z&&z.type||"buffer"){case"file":return u(),l.writeFileSync(z.filename,L),L;case"binary":return typeof L=="string"?L:de(L);case"base64":return Rc(typeof L=="string"?L:de(L));case"buffer":if(qt)return Buffer.isBuffer(L)?L:Ni(L);case"array":return typeof L=="string"?ka(L):L}return L}var Ye;function V(O){try{var z=O.InflateRaw,L=new z;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Ye=O;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function se(O,z){if(!Ye)return je(O,z);var L=Ye.InflateRaw,B=new L,q=B._processChunk(O.slice(O.l),B._finishFlushFlag);return O.l+=B.bytesRead,q}function ee(O){return Ye?Ye.deflateRawSync(O):Re(O)}var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function te(O){var z=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(z>>16|z>>8|z)&255}for(var K=typeof Uint8Array<"u",M=K?new Uint8Array(256):[],Q=0;Q<256;++Q)M[Q]=te(Q);function be(O,z){var L=M[O&255];return z<=8?L>>>8-z:(L=L<<8|M[O>>8&255],z<=16?L>>>16-z:(L=L<<8|M[O>>16&255],L>>>24-z))}function Te(O,z){var L=z&7,B=z>>>3;return(O[B]|(L<=6?0:O[B+1]<<8))>>>L&3}function J(O,z){var L=z&7,B=z>>>3;return(O[B]|(L<=5?0:O[B+1]<<8))>>>L&7}function I(O,z){var L=z&7,B=z>>>3;return(O[B]|(L<=4?0:O[B+1]<<8))>>>L&15}function j(O,z){var L=z&7,B=z>>>3;return(O[B]|(L<=3?0:O[B+1]<<8))>>>L&31}function Y(O,z){var L=z&7,B=z>>>3;return(O[B]|(L<=1?0:O[B+1]<<8))>>>L&127}function oe(O,z,L){var B=z&7,q=z>>>3,H=(1<<L)-1,ge=O[q]>>>B;return L<8-B||(ge|=O[q+1]<<8-B,L<16-B)||(ge|=O[q+2]<<16-B,L<24-B)||(ge|=O[q+3]<<24-B),ge&H}function Ze(O,z,L){var B=z&7,q=z>>>3;return B<=5?O[q]|=(L&7)<<B:(O[q]|=L<<B&255,O[q+1]=(L&7)>>8-B),z+3}function Ge(O,z,L){var B=z&7,q=z>>>3;return L=(L&1)<<B,O[q]|=L,z+1}function xt(O,z,L){var B=z&7,q=z>>>3;return L<<=B,O[q]|=L&255,L>>>=8,O[q+1]=L,z+8}function rt(O,z,L){var B=z&7,q=z>>>3;return L<<=B,O[q]|=L&255,L>>>=8,O[q+1]=L&255,O[q+2]=L>>>8,z+16}function zt(O,z){var L=O.length,B=2*L>z?2*L:z+5,q=0;if(L>=z)return O;if(qt){var H=nw(B);if(O.copy)O.copy(H);else for(;q<O.length;++q)H[q]=O[q];return H}else if(K){var ge=new Uint8Array(B);if(ge.set)ge.set(O);else for(;q<L;++q)ge[q]=O[q];return ge}return O.length=B,O}function ft(O){for(var z=new Array(O),L=0;L<O;++L)z[L]=0;return z}function ht(O,z,L){var B=1,q=0,H=0,ge=0,Ne=0,he=O.length,ye=K?new Uint16Array(32):ft(32);for(H=0;H<32;++H)ye[H]=0;for(H=he;H<L;++H)O[H]=0;he=O.length;var we=K?new Uint16Array(he):ft(he);for(H=0;H<he;++H)ye[q=O[H]]++,B<q&&(B=q),we[H]=0;for(ye[0]=0,H=1;H<=B;++H)ye[H+16]=Ne=Ne+ye[H-1]<<1;for(H=0;H<he;++H)Ne=O[H],Ne!=0&&(we[H]=ye[Ne+16]++);var Pe=0;for(H=0;H<he;++H)if(Pe=O[H],Pe!=0)for(Ne=be(we[H],B)>>B-Pe,ge=(1<<B+4-Pe)-1;ge>=0;--ge)z[Ne|ge<<Pe]=Pe&15|H<<4;return B}var kt=K?new Uint16Array(512):ft(512),Tt=K?new Uint16Array(32):ft(32);if(!K){for(var Dt=0;Dt<512;++Dt)kt[Dt]=0;for(Dt=0;Dt<32;++Dt)Tt[Dt]=0}(function(){for(var O=[],z=0;z<32;z++)O.push(5);ht(O,Tt,32);var L=[];for(z=0;z<=143;z++)L.push(8);for(;z<=255;z++)L.push(9);for(;z<=279;z++)L.push(7);for(;z<=287;z++)L.push(8);ht(L,kt,288)})();var ke=function(){for(var z=K?new Uint8Array(32768):[],L=0,B=0;L<X.length-1;++L)for(;B<X[L+1];++B)z[B]=L;for(;B<32768;++B)z[B]=29;var q=K?new Uint8Array(259):[];for(L=0,B=0;L<R.length-1;++L)for(;B<R[L+1];++B)q[B]=L;function H(Ne,he){for(var ye=0;ye<Ne.length;){var we=Math.min(65535,Ne.length-ye),Pe=ye+we==Ne.length;for(he.write_shift(1,+Pe),he.write_shift(2,we),he.write_shift(2,~we&65535);we-- >0;)he[he.l++]=Ne[ye++]}return he.l}function ge(Ne,he){for(var ye=0,we=0,Pe=K?new Uint16Array(32768):[];we<Ne.length;){var qe=Math.min(65535,Ne.length-we);if(qe<10){for(ye=Ze(he,ye,+(we+qe==Ne.length)),ye&7&&(ye+=8-(ye&7)),he.l=ye/8|0,he.write_shift(2,qe),he.write_shift(2,~qe&65535);qe-- >0;)he[he.l++]=Ne[we++];ye=he.l*8;continue}ye=Ze(he,ye,+(we+qe==Ne.length)+2);for(var Qe=0;qe-- >0;){var Le=Ne[we];Qe=(Qe<<5^Le)&32767;var Xe=-1,vt=0;if((Xe=Pe[Qe])&&(Xe|=we&-32768,Xe>we&&(Xe-=32768),Xe<we))for(;Ne[Xe+vt]==Ne[we+vt]&&vt<250;)++vt;if(vt>2){Le=q[vt],Le<=22?ye=xt(he,ye,M[Le+1]>>1)-1:(xt(he,ye,3),ye+=5,xt(he,ye,M[Le-23]>>5),ye+=3);var nr=Le<8?0:Le-4>>2;nr>0&&(rt(he,ye,vt-R[Le]),ye+=nr),Le=z[we-Xe],ye=xt(he,ye,M[Le]>>3),ye-=3;var ar=Le<4?0:Le-2>>1;ar>0&&(rt(he,ye,we-Xe-X[Le]),ye+=ar);for(var Lr=0;Lr<vt;++Lr)Pe[Qe]=we&32767,Qe=(Qe<<5^Ne[we])&32767,++we;qe-=vt-1}else Le<=143?Le=Le+48:ye=Ge(he,ye,1),ye=xt(he,ye,M[Le]),Pe[Qe]=we&32767,++we}ye=xt(he,ye,0)-1}return he.l=(ye+7)/8|0,he.l}return function(he,ye){return he.length<8?H(he,ye):ge(he,ye)}}();function Re(O){var z=Ae(50+Math.floor(O.length*1.1)),L=ke(O,z);return z.slice(0,L)}var $e=K?new Uint16Array(32768):ft(32768),dt=K?new Uint16Array(32768):ft(32768),xe=K?new Uint16Array(128):ft(128),ve=1,ae=1;function ue(O,z){var L=j(O,z)+257;z+=5;var B=j(O,z)+1;z+=5;var q=I(O,z)+4;z+=4;for(var H=0,ge=K?new Uint8Array(19):ft(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],he=1,ye=K?new Uint8Array(8):ft(8),we=K?new Uint8Array(8):ft(8),Pe=ge.length,qe=0;qe<q;++qe)ge[C[qe]]=H=J(O,z),he<H&&(he=H),ye[H]++,z+=3;var Qe=0;for(ye[0]=0,qe=1;qe<=he;++qe)we[qe]=Qe=Qe+ye[qe-1]<<1;for(qe=0;qe<Pe;++qe)(Qe=ge[qe])!=0&&(Ne[qe]=we[Qe]++);var Le=0;for(qe=0;qe<Pe;++qe)if(Le=ge[qe],Le!=0){Qe=M[Ne[qe]]>>8-Le;for(var Xe=(1<<7-Le)-1;Xe>=0;--Xe)xe[Qe|Xe<<Le]=Le&7|qe<<3}var vt=[];for(he=1;vt.length<L+B;)switch(Qe=xe[Y(O,z)],z+=Qe&7,Qe>>>=3){case 16:for(H=3+Te(O,z),z+=2,Qe=vt[vt.length-1];H-- >0;)vt.push(Qe);break;case 17:for(H=3+J(O,z),z+=3;H-- >0;)vt.push(0);break;case 18:for(H=11+Y(O,z),z+=7;H-- >0;)vt.push(0);break;default:vt.push(Qe),he<Qe&&(he=Qe);break}var nr=vt.slice(0,L),ar=vt.slice(L);for(qe=L;qe<286;++qe)nr[qe]=0;for(qe=B;qe<30;++qe)ar[qe]=0;return ve=ht(nr,$e,286),ae=ht(ar,dt,30),z}function Me(O,z){if(O[0]==3&&!(O[1]&3))return[so(z),2];for(var L=0,B=0,q=nw(z||1<<18),H=0,ge=q.length>>>0,Ne=0,he=0;!(B&1);){if(B=J(O,L),L+=3,B>>>1)B>>1==1?(Ne=9,he=5):(L=ue(O,L),Ne=ve,he=ae);else{L&7&&(L+=8-(L&7));var ye=O[L>>>3]|O[(L>>>3)+1]<<8;if(L+=32,ye>0)for(!z&&ge<H+ye&&(q=zt(q,H+ye),ge=q.length);ye-- >0;)q[H++]=O[L>>>3],L+=8;continue}for(;;){!z&&ge<H+32767&&(q=zt(q,H+32767),ge=q.length);var we=oe(O,L,Ne),Pe=B>>>1==1?kt[we]:$e[we];if(L+=Pe&15,Pe>>>=4,!(Pe>>>8&255))q[H++]=Pe;else{if(Pe==256)break;Pe-=257;var qe=Pe<8?0:Pe-4>>2;qe>5&&(qe=0);var Qe=H+R[Pe];qe>0&&(Qe+=oe(O,L,qe),L+=qe),we=oe(O,L,he),Pe=B>>>1==1?Tt[we]:dt[we],L+=Pe&15,Pe>>>=4;var Le=Pe<4?0:Pe-2>>1,Xe=X[Pe];for(Le>0&&(Xe+=oe(O,L,Le),L+=Le),!z&&ge<Qe&&(q=zt(q,Qe+100),ge=q.length);H<Qe;)q[H]=q[H-Xe],++H}}}return z?[q,L+7>>>3]:[q.slice(0,H),L+7>>>3]}function je(O,z){var L=O.slice(O.l||0),B=Me(L,z);return O.l+=B[1],B[0]}function et(O,z){if(O)typeof console<"u"&&console.error(z);else throw new Error(z)}function it(O,z){var L=O;Hn(L,0);var B=[],q=[],H={FileIndex:B,FullPaths:q};T(H,{root:z.root});for(var ge=L.length-4;(L[ge]!=80||L[ge+1]!=75||L[ge+2]!=5||L[ge+3]!=6)&&ge>=0;)--ge;L.l=ge+4,L.l+=4;var Ne=L.read_shift(2);L.l+=6;var he=L.read_shift(4);for(L.l=he,ge=0;ge<Ne;++ge){L.l+=20;var ye=L.read_shift(4),we=L.read_shift(4),Pe=L.read_shift(2),qe=L.read_shift(2),Qe=L.read_shift(2);L.l+=8;var Le=L.read_shift(4),Xe=o(L.slice(L.l+Pe,L.l+Pe+qe));L.l+=Pe+qe+Qe;var vt=L.l;L.l=Le+4,St(L,ye,we,H,Xe),L.l=vt}return H}function St(O,z,L,B,q){O.l+=2;var H=O.read_shift(2),ge=O.read_shift(2),Ne=s(O);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var he=O.read_shift(4),ye=O.read_shift(4),we=O.read_shift(4),Pe=O.read_shift(2),qe=O.read_shift(2),Qe="",Le=0;Le<Pe;++Le)Qe+=String.fromCharCode(O[O.l++]);if(qe){var Xe=o(O.slice(O.l,O.l+qe));(Xe[21589]||{}).mt&&(Ne=Xe[21589].mt),((q||{})[21589]||{}).mt&&(Ne=q[21589].mt)}O.l+=qe;var vt=O.slice(O.l,O.l+ye);switch(ge){case 8:vt=se(O,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ge)}var nr=!1;H&8&&(he=O.read_shift(4),he==134695760&&(he=O.read_shift(4),nr=!0),ye=O.read_shift(4),we=O.read_shift(4)),ye!=z&&et(nr,"Bad compressed size: "+z+" != "+ye),we!=L&&et(nr,"Bad uncompressed size: "+L+" != "+we),Gr(B,Qe,vt,{unsafe:!0,mt:Ne})}function It(O,z){var L=z||{},B=[],q=[],H=Ae(1),ge=L.compression?8:0,Ne=0,he=0,ye=0,we=0,Pe=0,qe=O.FullPaths[0],Qe=qe,Le=O.FileIndex[0],Xe=[],vt=0;for(he=1;he<O.FullPaths.length;++he)if(Qe=O.FullPaths[he].slice(qe.length),Le=O.FileIndex[he],!(!Le.size||!Le.content||Qe=="Sh33tJ5")){var nr=we,ar=Ae(Qe.length);for(ye=0;ye<Qe.length;++ye)ar.write_shift(1,Qe.charCodeAt(ye)&127);ar=ar.slice(0,ar.l),Xe[Pe]=hI.buf(Le.content,0);var Lr=Le.content;ge==8&&(Lr=ee(Lr)),H=Ae(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,Ne),H.write_shift(2,ge),Le.mt?i(H,Le.mt):H.write_shift(4,0),H.write_shift(-4,Xe[Pe]),H.write_shift(4,Lr.length),H.write_shift(4,Le.content.length),H.write_shift(2,ar.length),H.write_shift(2,0),we+=H.length,B.push(H),we+=ar.length,B.push(ar),we+=Lr.length,B.push(Lr),H=Ae(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,Ne),H.write_shift(2,ge),H.write_shift(4,0),H.write_shift(-4,Xe[Pe]),H.write_shift(4,Lr.length),H.write_shift(4,Le.content.length),H.write_shift(2,ar.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,nr),vt+=H.l,q.push(H),vt+=ar.length,q.push(ar),++Pe}return H=Ae(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Pe),H.write_shift(2,Pe),H.write_shift(4,vt),H.write_shift(4,we),H.write_shift(2,0),Jr([Jr(B),Jr(q),H])}var Ke={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wt(O,z){if(O.ctype)return O.ctype;var L=O.name||"",B=L.match(/\.([^\.]+)$/);return B&&Ke[B[1]]||z&&(B=(L=z).match(/[\.\\]([^\.\\])+$/),B&&Ke[B[1]])?Ke[B[1]]:"application/octet-stream"}function lt(O){for(var z=Rc(O),L=[],B=0;B<z.length;B+=76)L.push(z.slice(B,B+76));return L.join(`\r
`)+`\r
`}function kr(O){var z=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var we=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],B=z.split(`\r
`),q=0;q<B.length;++q){var H=B[q];if(H.length==0){L.push("");continue}for(var ge=0;ge<H.length;){var Ne=76,he=H.slice(ge,ge+Ne);he.charAt(Ne-1)=="="?Ne--:he.charAt(Ne-2)=="="?Ne-=2:he.charAt(Ne-3)=="="&&(Ne-=3),he=H.slice(ge,ge+Ne),ge+=Ne,ge<H.length&&(he+="="),L.push(he)}}return L.join(`\r
`)}function Nn(O){for(var z=[],L=0;L<O.length;++L){for(var B=O[L];L<=O.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+O[++L];z.push(B)}for(var q=0;q<z.length;++q)z[q]=z[q].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return ka(z.join(`\r
`))}function ra(O,z,L){for(var B="",q="",H="",ge,Ne=0;Ne<10;++Ne){var he=z[Ne];if(!he||he.match(/^\s*$/))break;var ye=he.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":B=ye[2].trim();break;case"content-type":H=ye[2].trim();break;case"content-transfer-encoding":q=ye[2].trim();break}}switch(++Ne,q.toLowerCase()){case"base64":ge=ka(Ti(z.slice(Ne).join("")));break;case"quoted-printable":ge=Nn(z.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var we=Gr(O,B.slice(L.length),ge,{unsafe:!0});H&&(we.ctype=H)}function gn(O,z){if(de(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=z&&z.root||"",B=(qt&&Buffer.isBuffer(O)?O.toString("binary"):de(O)).split(`\r
`),q=0,H="";for(q=0;q<B.length;++q)if(H=B[q],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),L||(L=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),H.slice(0,L.length)!=L););var ge=(B[1]||"").match(/boundary="(.*?)"/);if(!ge)throw new Error("MAD cannot find boundary");var Ne="--"+(ge[1]||""),he=[],ye=[],we={FileIndex:he,FullPaths:ye};T(we);var Pe,qe=0;for(q=0;q<B.length;++q){var Qe=B[q];Qe!==Ne&&Qe!==Ne+"--"||(qe++&&ra(we,B.slice(Pe,q),L),Pe=q)}return we}function Ua(O,z){var L=z||{},B=L.boundary||"SheetJS";B="------="+B;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],H=O.FullPaths[0],ge=H,Ne=O.FileIndex[0],he=1;he<O.FullPaths.length;++he)if(ge=O.FullPaths[he].slice(H.length),Ne=O.FileIndex[he],!(!Ne.size||!Ne.content||ge=="Sh33tJ5")){ge=ge.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(vt){return"_x"+vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(vt){return"_u"+vt.charCodeAt(0).toString(16)+"_"});for(var ye=Ne.content,we=qt&&Buffer.isBuffer(ye)?ye.toString("binary"):de(ye),Pe=0,qe=Math.min(1024,we.length),Qe=0,Le=0;Le<=qe;++Le)(Qe=we.charCodeAt(Le))>=32&&Qe<128&&++Pe;var Xe=Pe>=qe*4/5;q.push(B),q.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+ge),q.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),q.push("Content-Type: "+wt(Ne,ge)),q.push(""),q.push(Xe?kr(we):lt(we))}return q.push(B+`--\r
`),q.join(`\r
`)}function na(O){var z={};return T(z,O),z}function Gr(O,z,L,B){var q=B&&B.unsafe;q||T(O);var H=!q&&Qt.find(O,z);if(!H){var ge=O.FullPaths[0];z.slice(0,ge.length)==ge?ge=z:(ge.slice(-1)!="/"&&(ge+="/"),ge=(ge+z).replace("//","/")),H={name:a(z),type:2},O.FileIndex.push(H),O.FullPaths.push(ge),q||Qt.utils.cfb_gc(O)}return H.content=L,H.size=L?L.length:0,B&&(B.CLSID&&(H.clsid=B.CLSID),B.mt&&(H.mt=B.mt),B.ct&&(H.ct=B.ct)),H}function Hr(O,z){T(O);var L=Qt.find(O,z);if(L){for(var B=0;B<O.FileIndex.length;++B)if(O.FileIndex[B]==L)return O.FileIndex.splice(B,1),O.FullPaths.splice(B,1),!0}return!1}function aa(O,z,L){T(O);var B=Qt.find(O,z);if(B){for(var q=0;q<O.FileIndex.length;++q)if(O.FileIndex[q]==B)return O.FileIndex[q].name=a(L),O.FullPaths[q]=L,!0}return!1}function $l(O){S(O,!0)}return t.find=F,t.read=k,t.parse=c,t.write=Ce,t.writeFile=fe,t.utils={cfb_new:na,cfb_add:Gr,cfb_del:Hr,cfb_mov:aa,cfb_gc:$l,ReadShift:Wu,CheckField:l3,prep_blob:Hn,bconcat:Jr,use_zlib:V,_deflateRaw:Re,_inflateRaw:je,consts:Ee},t}();function pI(e){return typeof e=="string"?vh(e):Array.isArray(e)?UP(e):e}function sf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=vh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([pI(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=af(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function an(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fw(e,t){for(var r=[],n=an(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Tx(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function bh(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function mI(e){for(var t=[],r=an(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ed=new Date(1899,11,30,0,0,0);function jn(e,t){var r=e.getTime(),n=Ed.getTime()+(e.getTimezoneOffset()-Ed.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var GS=new Date,gI=Ed.getTime()+(GS.getTimezoneOffset()-Ed.getTimezoneOffset())*6e4,dw=GS.getTimezoneOffset();function HS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gI),t.getTimezoneOffset()!==dw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-dw)*6e4),t}var hw=new Date("2017-02-19T19:06:09.000Z"),VS=isNaN(hw.getFullYear())?new Date("2/19/17"):hw,xI=VS.getFullYear()==2017;function _n(e,t){var r=new Date(e);if(xI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(VS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Eh(e,t){if(qt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Mn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Mn(e[r]));return t}function yr(e,t){for(var r="";r.length<t;)r+=e;return r}function xi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var vI=["january","february","march","april","may","june","july","august","september","october","november","december"];function jc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&vI.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Nt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return qt?n=Ni(r):n=zP(r),Qt.utils.cfb_add(e,t,n)}Qt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Sx(){return Qt.utils.cfb_new()}var Cr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ax=Tx(yI),Nx=/[&<>'"]/g,wI=/[\u0000-\u0008\u000b-\u001f]/g;function Vt(e){var t=e+"";return t.replace(Nx,function(r){return Ax[r]}).replace(wI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function pw(e){return Vt(e).replace(/ /g,"_x0020_")}var YS=/[\u0000-\u001f]/g;function bI(e){var t=e+"";return t.replace(Nx,function(r){return Ax[r]}).replace(/\n/g,"<br/>").replace(YS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function EI(e){var t=e+"";return t.replace(Nx,function(r){return Ax[r]}).replace(YS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function _I(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function TI(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kp(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function mw(e){var t=so(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function gw(e){return Ni(e,"binary").toString("utf8")}var i0="foo bar baz",qu=qt&&(gw(i0)==Kp(i0)&&gw||mw(i0)==Kp(i0)&&mw)||Kp,Mc=qt?function(e){return Ni(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},SI=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),XS=/(^\s|\s$|\n)/;function en(e,t){return"<"+e+(t.match(XS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lc(e){return an(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?Lc(r):"")+(t!=null?(t.match(XS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Lg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function AI(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Vt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Vt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",Lg(e));throw new Error("Unable to serialize "+e)}var Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ul=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function NI(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function DI(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var xw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},vw=qt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ni(t)})):xw(e)}:xw,yw=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(bu(e,a)));return n.join("").replace(zu,"")},Dx=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(zu,""):yw(e,t,r)}:yw,ww=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},KS=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ww(e,t,r)}:ww,bw=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ro(e,a)));return n.join("")},of=qt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):bw(t,r,n)}:bw,ZS=function(e,t){var r=Yn(e,t);return r>0?of(e,t+4,t+4+r-1):""},QS=ZS,JS=function(e,t){var r=Yn(e,t);return r>0?of(e,t+4,t+4+r-1):""},e3=JS,t3=function(e,t){var r=2*Yn(e,t);return r>0?of(e,t+4,t+4+r-1):""},r3=t3,n3=function(t,r){var n=Yn(t,r);return n>0?Dx(t,r+4,r+4+n):""},a3=n3,i3=function(e,t){var r=Yn(e,t);return r>0?of(e,t+4,t+4+r):""},s3=i3,o3=function(e,t){return NI(e,t)},_d=o3,Cx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};qt&&(QS=function(t,r){if(!Buffer.isBuffer(t))return ZS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},e3=function(t,r){if(!Buffer.isBuffer(t))return JS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},r3=function(t,r){if(!Buffer.isBuffer(t))return t3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},a3=function(t,r){if(!Buffer.isBuffer(t))return n3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},s3=function(t,r){if(!Buffer.isBuffer(t))return i3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},_d=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):o3(t,r)},Cx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ro=function(e,t){return e[t]},bu=function(e,t){return e[t+1]*256+e[t]},CI=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Yn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ps=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Wu(e,t){var r="",n,a,i=[],s,o,l,u;switch(t){case"dbcs":if(u=this.l,qt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(bu(this,u)),u+=2;e*=2;break;case"utf8":r=of(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Dx(this,this.l,this.l+e);break;case"wstr":return Wu.call(this,e,"dbcs");case"lpstr-ansi":r=QS(this,this.l),e=4+Yn(this,this.l);break;case"lpstr-cp":r=e3(this,this.l),e=4+Yn(this,this.l);break;case"lpwstr":r=r3(this,this.l),e=4+2*Yn(this,this.l);break;case"lpp4":e=4+Yn(this,this.l),r=a3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Yn(this,this.l),r=s3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Ro(this,this.l+e++))!==0;)i.push(r0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=bu(this,this.l+e))!==0;)i.push(r0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Ro(this,u),this.l=u+1,o=Wu.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(r0(bu(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Ro(this,u),this.l=u+1,o=Wu.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(r0(Ro(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Ro(this,this.l),this.l++,n;case 2:return n=(t==="i"?CI:bu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ps:kI)(this,this.l),this.l+=4,n):(a=Yn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=_d(this,this.l):a=_d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=KS(this,this.l,e);break}}return this.l+=e,r}var OI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},FI=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},PI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function II(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)PI(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,OI(this,t,this.l);break;case 8:if(n=8,r==="f"){DI(this,t,this.l);break}case 16:break;case-4:n=4,FI(this,t,this.l);break}return this.l+=n,this}function l3(e,t){var r=KS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Hn(e,t){e.l=t,e.read_shift=Wu,e.chk=l3,e.write_shift=II}function Ja(e,t){e.l+=t}function Ae(e){var t=so(e);return Hn(t,0),t}function In(){var e=[],t=qt?256:2048,r=function(u){var c=Ae(u);return Hn(c,0),c},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),Jr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function Fe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=N7[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Cx(r)&&e.push(r)}}function $u(e,t,r){var n=Mn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ew(e,t,r){var n=Mn(e);return n.s=$u(n.s,t.s,r),n.e=$u(n.e,t.s,r),n}function Gu(e,t){if(e.cRel&&e.c<0)for(e=Mn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Mn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Kt(e);return!e.cRel&&e.cRel!=null&&(r=MI(r)),!e.rRel&&e.rRel!=null&&(r=RI(r)),r}function Zp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dn(e.s.c)+":"+(e.e.cRel?"":"$")+dn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rn(e.s.r)+":"+(e.e.rRel?"":"$")+rn(e.e.r):Gu(e.s,t.biff)+":"+Gu(e.e,t.biff)}function kx(e){return parseInt(jI(e),10)-1}function rn(e){return""+(e+1)}function RI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jI(e){return e.replace(/\$(\d+)$/,"$1")}function Ox(e){for(var t=LI(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function dn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function MI(e){return e.replace(/^([A-Z])/,"$$$1")}function LI(e){return e.replace(/^\$([A-Z])/,"$1")}function BI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Kt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Jn(e){var t=e.indexOf(":");return t==-1?{s:zr(e),e:zr(e)}:{s:zr(e.slice(0,t)),e:zr(e.slice(t+1))}}function Dr(e,t){return typeof t>"u"||typeof t=="number"?Dr(e.s,e.e):(typeof e!="string"&&(e=Kt(e)),typeof t!="string"&&(t=Kt(t)),e==t?e:e+":"+t)}function lr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function _w(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fs(e.z,r?jn(t):t)}catch{}try{return e.w=fs((e.XF||{}).numFmtId||(r?14:0),r?jn(t):t)}catch{return""+t}}function Si(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?lf[e.v]||e.v:t==null?_w(e,e.v):_w(e,t))}function xo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function u3(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=lr(i["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),s==-1&&(u.e.r=s=c.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var v={v:t[h][p]},E=s+h,g=o+p;if(u.s.r>E&&(u.s.r=E),u.s.c>g&&(u.s.c=g),u.e.r<E&&(u.e.r=E),u.e.c<g&&(u.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))v=t[h][p];else if(Array.isArray(v.v)&&(v.f=t[h][p][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||wr[14],n.cellDates?(v.t="d",v.w=fs(v.z,jn(v.v))):(v.t="n",v.v=jn(v.v),v.w=fs(v.z,v.v))):v.t="s";if(a)i[E]||(i[E]=[]),i[E][g]&&i[E][g].z&&(v.z=i[E][g].z),i[E][g]=v;else{var w=Kt({c:g,r:E});i[w]&&i[w].z&&(v.z=i[w].z),i[w]=v}}}return u.s.c<1e7&&(i["!ref"]=Dr(u)),i}function zl(e,t){return u3(null,e,t)}function UI(e){return e.read_shift(4,"i")}function ja(e,t){return t||(t=Ae(4)),t.write_shift(4,e),t}function hn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qr(e,t){var r=!1;return t==null&&(r=!0,t=Ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function zI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qI(e,t){return t||(t=Ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Fx(e,t){var r=e.l,n=e.read_shift(1),a=hn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(zI(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function WI(e,t){var r=!1;return t==null&&(r=!0,t=Ae(15+4*e.t.length)),t.write_shift(1,0),qr(e.t,t),r?t.slice(0,t.l):t}var $I=Fx;function GI(e,t){var r=!1;return t==null&&(r=!0,t=Ae(23+4*e.t.length)),t.write_shift(1,1),qr(e.t,t),t.write_shift(4,1),qI({},t),r?t.slice(0,t.l):t}function ya(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function vo(e,t){return t==null&&(t=Ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function yo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function wo(e,t){return t==null&&(t=Ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var HI=hn,c3=qr;function Px(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Td(e,t){var r=!1;return t==null&&(r=!0,t=Ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var VI=hn,Bg=Px,Ix=Td;function f3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?_d([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ps(t,0)>>2;return r?a/100:a}function d3(e,t){t==null&&(t=Ae(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function h3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function YI(e,t){return t||(t=Ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bo=h3,ql=YI;function Wl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oo(e,t){return(t||Ae(8)).write_shift(8,e,"f")}function XI(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=aR[a];u&&(t.rgb=Iw(u));break;case 2:t.rgb=Iw([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Sd(e,t){if(t||(t=Ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function KI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ZI(e,t){t||(t=Ae(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var p3=2,$n=3,s0=11,Ad=19,o0=64,QI=65,JI=71,eR=4108,tR=4126,Zr=80,Tw={1:{n:"CodePage",t:p3},2:{n:"Category",t:Zr},3:{n:"PresentationFormat",t:Zr},4:{n:"ByteCount",t:$n},5:{n:"LineCount",t:$n},6:{n:"ParagraphCount",t:$n},7:{n:"SlideCount",t:$n},8:{n:"NoteCount",t:$n},9:{n:"HiddenCount",t:$n},10:{n:"MultimediaClipCount",t:$n},11:{n:"ScaleCrop",t:s0},12:{n:"HeadingPairs",t:eR},13:{n:"TitlesOfParts",t:tR},14:{n:"Manager",t:Zr},15:{n:"Company",t:Zr},16:{n:"LinksUpToDate",t:s0},17:{n:"CharacterCount",t:$n},19:{n:"SharedDoc",t:s0},22:{n:"HyperlinksChanged",t:s0},23:{n:"AppVersion",t:$n,p:"version"},24:{n:"DigSig",t:QI},26:{n:"ContentType",t:Zr},27:{n:"ContentStatus",t:Zr},28:{n:"Language",t:Zr},29:{n:"Version",t:Zr},255:{},2147483648:{n:"Locale",t:Ad},2147483651:{n:"Behavior",t:Ad},1919054434:{}},Sw={1:{n:"CodePage",t:p3},2:{n:"Title",t:Zr},3:{n:"Subject",t:Zr},4:{n:"Author",t:Zr},5:{n:"Keywords",t:Zr},6:{n:"Comments",t:Zr},7:{n:"Template",t:Zr},8:{n:"LastAuthor",t:Zr},9:{n:"RevNumber",t:Zr},10:{n:"EditTime",t:o0},11:{n:"LastPrinted",t:o0},12:{n:"CreatedDate",t:o0},13:{n:"ModifiedDate",t:o0},14:{n:"PageCount",t:$n},15:{n:"WordCount",t:$n},16:{n:"CharCount",t:$n},17:{n:"Thumbnail",t:JI},18:{n:"Application",t:Zr},19:{n:"DocSecurity",t:$n},255:{},2147483648:{n:"Locale",t:Ad},2147483651:{n:"Behavior",t:Ad},1919054434:{}};function rR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var nR=rR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),aR=Mn(nR),lf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},iR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},l0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function m3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function g3(e,t){var r=mI(iR),n=[],a;n[n.length]=Cr,n[n.length]=Ue("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ue("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:l0[l][t.bookType]||l0[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:l0[l][t.bookType]||l0[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ut={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function x3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function fl(e){var t=[Cr,Ue("Relationships",null,{xmlns:Ur.RELS})];return an(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ut.HLINK,Ut.XPATH,Ut.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function sR(e){var t=[Cr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Aw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function oR(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function lR(e){var t=[Cr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Aw(e[r][0],e[r][1])),t.push(oR("",e[r][0]));return t.push(Aw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function v3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xd.version+"</meta:generator></office:meta></office:document-meta>"}var Vs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Qp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Vt(t),n[n.length]=r?Ue(e,t,r):en(e,t))}function y3(e,t){var r=t||{},n=[Cr,Ue("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Qp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Lg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Qp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Lg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Vs.length;++i){var s=Vs[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Qp(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],w3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function b3(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=Cr,t[t.length]=Ue("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),dl.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Vt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Vt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function E3(e){var t=[Cr,Ue("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return t.join("");var r=1;return an(e).forEach(function(a){++r,t[t.length]=Ue("property",AI(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Vt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Nw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function uR(e,t){var r=[];return an(Nw).map(function(n){for(var a=0;a<Vs.length;++a)if(Vs[a][1]==n)return Vs[a];for(a=0;a<dl.length;++a)if(dl[a][1]==n)return dl[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(en(Nw[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Vn.o})}function cR(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&an(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Vs.length;++s)if(i==Vs[s][1])return;for(s=0;s<dl.length;++s)if(i==dl[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Ue(pw(i),o,{"dt:dt":l}))}}),t&&an(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ue(pw(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Vn.o+'">'+a.join("")+"</"+n+">"}function fR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Ae(8);return s.write_shift(4,n),s.write_shift(4,a),s}function Dw(e,t){var r=Ae(4),n=Ae(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ae(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=fR(t);break;case 31:case 80:for(n=Ae(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Jr([r,n])}var _3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Cw(e,t,r){var n=Ae(8),a=[],i=[],s=8,o=0,l=Ae(8),u=Ae(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),a.push(u),s+=8+l.length,!t){u=Ae(8),u.write_shift(4,0),a.unshift(u);var c=[Ae(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=Ae(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Jr(c),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(_3.indexOf(e[o][0])>-1||w3.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],v=0;if(t){v=+t[e[o][0]];var E=r[v];if(E.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=Dw(E.t,p)}else{var w=dR(p);w==-1&&(w=31,p=String(p)),l=Dw(w,p)}i.push(l),u=Ae(8),u.write_shift(4,t?v:2+o),a.push(u),s+=8+l.length}var x=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,x),x+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Jr([n].concat(a).concat(i))}function kw(e,t,r,n,a,i){var s=Ae(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Qt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=Cw(e,r,n);if(o.push(l),a){var u=Cw(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(u)}return Jr(o)}function hR(e,t){t||(t=Ae(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function pR(e,t){return e.read_shift(t)===1}function wn(e,t){return t||(t=Ae(2)),t.write_shift(2,+!!e),t}function T3(e){return e.read_shift(2,"u")}function oa(e,t){return t||(t=Ae(2)),t.write_shift(2,e),t}function S3(e,t,r){return r||(r=Ae(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function A3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function mR(e){var t=e.t||"",r=Ae(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ae(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Jr(a)}function gR(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function xR(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):gR(e,n,r)}function vR(e,t,r){if(r.biff>5)return xR(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function N3(e,t,r){return r||(r=Ae(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Ow(e,t){t||(t=Ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function yR(e){var t=Ae(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Ow(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Ow(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function lo(e,t,r,n){return n||(n=Ae(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function wR(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function bR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function D3(e,t){return t||(t=Ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Rx(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ae(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function ER(e,t){var r=!t||t.biff==8,n=Ae(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _R(e,t){var r=!t||t.biff>=8?2:1,n=Ae(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function TR(e,t){var r=Ae(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=mR(e[a]);var i=Jr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function SR(){var e=Ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AR(e){var t=Ae(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function NR(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ae(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function DR(e,t,r,n){var a=Ae(10);return lo(e,t,n,a),a.write_shift(4,r),a}function CR(e,t,r,n,a){var i=!a||a.biff==8,s=Ae(8+ +i+(1+i)*r.length);return lo(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function kR(e,t,r,n){var a=r&&r.biff==5;n||(n=Ae(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function OR(e,t){var r=t.biff==8||!t.biff?4:2,n=Ae(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Fw(e,t,r,n){var a=r&&r.biff==5;n||(n=Ae(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function FR(e){var t=Ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function PR(e,t,r,n,a,i){var s=Ae(8);return lo(e,t,n,s),S3(r,i,s),s}function IR(e,t,r,n){var a=Ae(14);return lo(e,t,n,a),oo(r,a),a}function RR(e,t,r){if(r.biff<8)return jR(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(wR(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function jR(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=A3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function MR(e){var t=Ae(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)D3(e[r],t);return t}function LR(e){var t=Ae(24),r=zr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Jr([t,yR(e[1])])}function BR(e){var t=e[1].Tooltip,r=Ae(10+2*(t.length+1));r.write_shift(2,2048);var n=zr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function UR(e){return e||(e=Ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function zR(e,t,r){if(!r.cellStyles)return Ja(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function qR(e,t){var r=Ae(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function WR(e){for(var t=Ae(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function $R(e,t,r){var n=Ae(15);return cf(n,e,t),n.write_shift(8,r,"f"),n}function GR(e,t,r){var n=Ae(9);return cf(n,e,t),n.write_shift(2,r),n}var HR=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Tx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],c=so(1);switch(l.type){case"base64":c=ka(Ti(o));break;case"binary":c=ka(o);break;case"buffer":case"array":c=o;break}Hn(c,0);var h=c.read_shift(1),p=!!(h&136),v=!1,E=!1;switch(h){case 2:break;case 3:break;case 48:v=!0,p=!0;break;case 49:v=!0,p=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=c.read_shift(2)),c.l+=3,h!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=c.read_shift(2));var x=c.read_shift(2),y=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(y=e[c[c.l]]),c.l+=1,c.l+=2),E&&(c.l+=36);for(var b=[],_={},N=Math.min(c.length,h==2?521:w-10-(v?264:0)),k=E?32:11;c.l<N&&c[c.l]!=13;)switch(_={},_.name=vd.utils.decode(y,c.slice(c.l,c.l+k)).replace(/[\u0000\r\n].*$/g,""),c.l+=k,_.type=String.fromCharCode(c.read_shift(1)),h!=2&&!E&&(_.offset=c.read_shift(4)),_.len=c.read_shift(1),h==2&&(_.offset=c.read_shift(2)),_.dec=c.read_shift(1),_.name.length&&b.push(_),h!=2&&(c.l+=E?13:14),_.type){case"B":(!v||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(c[c.l]!==13&&(c.l=w-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=w;var T=0,A=0;for(u[0]=[],A=0;A!=b.length;++A)u[0][A]=b[A].name;for(;g-- >0;){if(c[c.l]===42){c.l+=x;continue}for(++c.l,u[++T]=[],A=0,A=0;A!=b.length;++A){var S=c.slice(c.l,c.l+b[A].len);c.l+=b[A].len,Hn(S,0);var P=vd.utils.decode(y,S);switch(b[A].type){case"C":P.trim().length&&(u[T][A]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[T][A]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[T][A]=P;break;case"F":u[T][A]=parseFloat(P.trim());break;case"+":case"I":u[T][A]=E?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[T][A]=!0;break;case"N":case"F":u[T][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[T][A]="##MEMO##"+(E?parseInt(P.trim(),10):S.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[T][A]=+P||0);break;case"@":u[T][A]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[T][A]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[T][A]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][A]=-S.read_shift(-8,"f");break;case"B":if(v&&b[A].len==8){u[T][A]=S.read_shift(8,"f");break}case"G":case"P":S.l+=b[A].len;break;case"0":if(b[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[A].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=zl(r(o,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function a(o,l){try{return xo(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var u=l||{};if(+u.codepage>=0&&Ic(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=In(),h=Od(o,{header:1,raw:!0,cellDates:!0}),p=h[0],v=h.slice(1),E=o["!cols"]||[],g=0,w=0,x=0,y=1;for(g=0;g<p.length;++g){if(((E[g]||{}).DBF||{}).name){p[g]=E[g].DBF.name,++x;continue}if(p[g]!=null){if(++x,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(w=0;w<1024;++w)if(p.indexOf(p[g]+"_"+w)==-1){p[g]+="_"+w;break}}}}var b=lr(o["!ref"]),_=[],N=[],k=[];for(g=0;g<=b.e.c-b.s.c;++g){var T="",A="",S=0,P=[];for(w=0;w<v.length;++w)v[w][g]!=null&&P.push(v[w][g]);if(P.length==0||p[g]==null){_[g]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=P[w]instanceof Date?"D":"C";break;default:A="C"}S=Math.max(S,String(P[w]).length),T=T&&T!=A?"C":A}S>250&&(S=250),A=((E[g]||{}).DBF||{}).type,A=="C"&&E[g].DBF.len>S&&(S=E[g].DBF.len),T=="B"&&A=="N"&&(T="N",k[g]=E[g].DBF.dec,S=E[g].DBF.len),N[g]=T=="C"||A=="N"?S:i[T]||0,y+=N[g],_[g]=T}var F=c.next(32);for(F.write_shift(4,318902576),F.write_shift(4,v.length),F.write_shift(2,296+32*x),F.write_shift(2,y),g=0;g<4;++g)F.write_shift(4,0);for(F.write_shift(4,0|(+t[kS]||3)<<8),g=0,w=0;g<p.length;++g)if(p[g]!=null){var U=c.next(32),re=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,re,"sbcs"),U.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),U.write_shift(4,w),U.write_shift(1,N[g]||i[_[g]]||0),U.write_shift(1,k[g]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),w+=N[g]||i[_[g]]||0}var le=c.next(264);for(le.write_shift(4,13),g=0;g<65;++g)le.write_shift(4,0);for(g=0;g<v.length;++g){var pe=c.next(y);for(pe.write_shift(1,0),w=0;w<p.length;++w)if(p[w]!=null)switch(_[w]){case"L":pe.write_shift(1,v[g][w]==null?63:v[g][w]?84:70);break;case"B":pe.write_shift(8,v[g][w]||0,"f");break;case"N":var me="0";for(typeof v[g][w]=="number"&&(me=v[g][w].toFixed(k[w]||0)),x=0;x<N[w]-me.length;++x)pe.write_shift(1,32);pe.write_shift(1,me,"sbcs");break;case"D":v[g][w]?(pe.write_shift(4,("0000"+v[g][w].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(v[g][w].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+v[g][w].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(v[g][w]!=null?v[g][w]:"").slice(0,N[w]);for(pe.write_shift(1,Ee,"sbcs"),x=0;x<N[w]-Ee.length;++x)pe.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),VR=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+an(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,v){var E=e[v];return typeof E=="number"?rw(E):E},n=function(p,v,E){var g=v.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return g==59?p:rw(g)};e["|"]=254;function a(p,v){switch(v.type){case"base64":return i(Ti(p),v);case"binary":return i(p,v);case"buffer":return i(qt&&Buffer.isBuffer(p)?p.toString("binary"):af(p),v);case"array":return i(Eh(p),v)}throw new Error("Unrecognized type "+v.type)}function i(p,v){var E=p.split(/[\n\r]+/),g=-1,w=-1,x=0,y=0,b=[],_=[],N=null,k={},T=[],A=[],S=[],P=0,F;for(+v.codepage>=0&&Ic(+v.codepage);x!==E.length;++x){P=0;var U=E[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),re=U.replace(/;;/g,"\0").split(";").map(function(C){return C.replace(/\u0000/g,";")}),le=re[0],pe;if(U.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&_.push(U.slice(3).replace(/;;/g,";"));break;case"C":var me=!1,Ee=!1,fe=!1,de=!1,Ce=-1,Ye=-1;for(y=1;y<re.length;++y)switch(re[y].charAt(0)){case"A":break;case"X":w=parseInt(re[y].slice(1))-1,Ee=!0;break;case"Y":for(g=parseInt(re[y].slice(1))-1,Ee||(w=0),F=b.length;F<=g;++F)b[F]=[];break;case"K":pe=re[y].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(xi(pe))?isNaN(jc(pe).getDate())||(pe=_n(pe)):(pe=xi(pe),N!==null&&qS(N)&&(pe=HS(pe))),me=!0;break;case"E":de=!0;var V=Gj(re[y].slice(1),{r:g,c:w});b[g][w]=[b[g][w],V];break;case"S":fe=!0,b[g][w]=[b[g][w],"S5S"];break;case"G":break;case"R":Ce=parseInt(re[y].slice(1))-1;break;case"C":Ye=parseInt(re[y].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+U)}if(me&&(b[g][w]&&b[g][w].length==2?b[g][w][0]=pe:b[g][w]=pe,N=null),fe){if(de)throw new Error("SYLK shared formula cannot have own formula");var se=Ce>-1&&b[Ce][Ye];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");b[g][w][1]=Hj(se[1],{r:g-Ce,c:w-Ye})}break;case"F":var ee=0;for(y=1;y<re.length;++y)switch(re[y].charAt(0)){case"X":w=parseInt(re[y].slice(1))-1,++ee;break;case"Y":for(g=parseInt(re[y].slice(1))-1,F=b.length;F<=g;++F)b[F]=[];break;case"M":P=parseInt(re[y].slice(1))/20;break;case"F":break;case"G":break;case"P":N=_[parseInt(re[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=re[y].slice(1).split(" "),F=parseInt(S[0],10);F<=parseInt(S[1],10);++F)P=parseInt(S[2],10),A[F-1]=P===0?{hidden:!0}:{wch:P},jx(A[F-1]);break;case"C":w=parseInt(re[y].slice(1))-1,A[w]||(A[w]={});break;case"R":g=parseInt(re[y].slice(1))-1,T[g]||(T[g]={}),P>0?(T[g].hpt=P,T[g].hpx=P3(P)):P===0&&(T[g].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+U)}ee<1&&(N=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+U)}}return T.length>0&&(k["!rows"]=T),A.length>0&&(k["!cols"]=A),v&&v.sheetRows&&(b=b.slice(0,v.sheetRows)),[b,k]}function s(p,v){var E=a(p,v),g=E[0],w=E[1],x=zl(g,v);return an(w).forEach(function(y){x[y]=w[y]}),x}function o(p,v){return xo(s(p,v),v)}function l(p,v,E,g){var w="C;Y"+(E+1)+";X"+(g+1)+";K";switch(p.t){case"n":w+=p.v||0,p.f&&!p.F&&(w+=";E"+Lx(p.f,{r:E,c:g}));break;case"b":w+=p.v?"TRUE":"FALSE";break;case"e":w+=p.w||p.v;break;case"d":w+='"'+(p.w||p.v)+'"';break;case"s":w+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(p,v){v.forEach(function(E,g){var w="F;W"+(g+1)+" "+(g+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Nd(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Dd(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&p.push(w)})}function c(p,v){v.forEach(function(E,g){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*Cd(E.hpx)+";"),w.length>2&&p.push(w+"R"+(g+1))})}function h(p,v){var E=["ID;PWXL;N;E"],g=[],w=lr(p["!ref"]),x,y=Array.isArray(p),b=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),p["!cols"]&&u(E,p["!cols"]),p["!rows"]&&c(E,p["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var _=w.s.r;_<=w.e.r;++_)for(var N=w.s.c;N<=w.e.c;++N){var k=Kt({r:_,c:N});x=y?(p[_]||[])[N]:p[k],!(!x||x.v==null&&(!x.f||x.F))&&g.push(l(x,p,_,N))}return E.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),YR=function(){function e(i,s){switch(s.type){case"base64":return t(Ti(i),s);case"binary":return t(i,s);case"buffer":return t(qt&&Buffer.isBuffer(i)?i.toString("binary"):af(i),s);case"array":return t(Eh(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,u=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var p=o[c].trim().split(","),v=p[0],E=p[1];++c;for(var g=o[c]||"";(g.match(/["]/g)||[]).length&1&&c<o.length-1;)g+=`
`+o[++c];switch(g=g.trim(),+v){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(xi(E))?isNaN(jc(E).getDate())?h[l][u]=E:h[l][u]=_n(E):h[l][u]=xi(E),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return zl(e(i,s),s)}function n(i,s){return xo(r(i,s),s)}var a=function(){var i=function(l,u,c,h,p){l.push(u),l.push(c+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=lr(l["!ref"]),h,p=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,c.e.r-c.s.r+1,""),i(u,"TUPLES",0,c.e.c-c.s.c+1,""),i(u,"DATA",0,0,"");for(var v=c.s.r;v<=c.e.r;++v){s(u,-1,0,"BOT");for(var E=c.s.c;E<=c.e.c;++E){var g=Kt({r:v,c:E});if(h=p?(l[v]||[])[E]:l[g],!h){s(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?s(u,1,0,"="+h.f):s(u,1,0,""):s(u,0,w,"V");break;case"b":s(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=fs(h.z||wr[14],jn(_n(h.v)))),s(u,0,h.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var x=`\r
`,y=u.join(x);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),C3=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var v=h.split(`
`),E=-1,g=-1,w=0,x=[];w!==v.length;++w){var y=v[w].trim().split(":");if(y[0]==="cell"){var b=zr(y[1]);if(x.length<=b.r)for(E=x.length;E<=b.r;++E)x[E]||(x[E]=[]);switch(E=b.r,g=b.c,y[2]){case"t":x[E][g]=e(y[3]);break;case"v":x[E][g]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[E][g]=!!+y[4];break;default:x[E][g]=+y[4];break}y[2]=="vtf"&&(x[E][g]=[x[E][g],_])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function n(h,p){return zl(r(h,p),p)}function a(h,p){return xo(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],v=[],E,g="",w=Jn(h["!ref"]),x=Array.isArray(h),y=w.s.r;y<=w.e.r;++y)for(var b=w.s.c;b<=w.e.c;++b)if(g=Kt({r:y,c:b}),E=x?(h[y]||[])[b]:h[g],!(!E||E.v==null||E.t==="z")){switch(v=["cell",g,"t"],E.t){case"s":case"str":v.push(t(E.v));break;case"n":E.f?(v[2]="vtf",v[3]="n",v[4]=E.v,v[5]=t(E.f)):(v[2]="v",v[3]=E.v);break;case"b":v[2]="vt"+(E.f?"f":"c"),v[3]="nl",v[4]=E.v?"1":"0",v[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var _=jn(_n(E.v));v[2]="vtc",v[3]="nd",v[4]=""+_,v[5]=E.w||fs(E.z||wr[14],_);break;case"e":continue}p.push(v.join(":"))}return p.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function c(h){return[i,s,o,s,u(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:c}}(),XR=function(){function e(c,h,p,v,E){E.raw?h[p][v]=c:c===""||(c==="TRUE"?h[p][v]=!0:c==="FALSE"?h[p][v]=!1:isNaN(xi(c))?isNaN(jc(c).getDate())?h[p][v]=c:h[p][v]=_n(c):h[p][v]=xi(c))}function t(c,h){var p=h||{},v=[];if(!c||c.length===0)return v;for(var E=c.split(/[\r\n]/),g=E.length-1;g>=0&&E[g].length===0;)--g;for(var w=10,x=0,y=0;y<=g;++y)x=E[y].indexOf(" "),x==-1?x=E[y].length:x++,w=Math.max(w,x);for(y=0;y<=g;++y){v[y]=[];var b=0;for(e(E[y].slice(0,w).trim(),v,y,b,p),b=1;b<=(E[y].length-w)/10+1;++b)e(E[y].slice(w+(b-1)*10,w+b*10).trim(),v,y,b,p)}return p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(c){for(var h={},p=!1,v=0,E=0;v<c.length;++v)(E=c.charCodeAt(v))==34?p=!p:!p&&E in r&&(h[E]=(h[E]||0)+1);E=[];for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&E.push([h[v],v]);if(!E.length){h=n;for(v in h)Object.prototype.hasOwnProperty.call(h,v)&&E.push([h[v],v])}return E.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[E.pop()[1]]||44}function i(c,h){var p=h||{},v="",E=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(v=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(v=c.charAt(4),c=c.slice(6)):v=a(c.slice(0,1024)):p&&p.FS?v=p.FS:v=a(c.slice(0,1024));var w=0,x=0,y=0,b=0,_=0,N=v.charCodeAt(0),k=!1,T=0,A=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var S=p.dateNF!=null?fI(p.dateNF):null;function P(){var F=c.slice(b,_),U={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)U.t="z";else if(p.raw)U.t="s",U.v=F;else if(F.trim().length===0)U.t="s",U.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(U.t="s",U.v=F.slice(2,-1).replace(/""/g,'"')):Vj(F)?(U.t="n",U.f=F.slice(1)):(U.t="s",U.v=F);else if(F=="TRUE")U.t="b",U.v=!0;else if(F=="FALSE")U.t="b",U.v=!1;else if(!isNaN(y=xi(F)))U.t="n",p.cellText!==!1&&(U.w=F),U.v=y;else if(!isNaN(jc(F).getDate())||S&&F.match(S)){U.z=p.dateNF||wr[14];var re=0;S&&F.match(S)&&(F=dI(F,p.dateNF,F.match(S)||[]),re=1),p.cellDates?(U.t="d",U.v=_n(F,re)):(U.t="n",U.v=jn(_n(F,re))),p.cellText!==!1&&(U.w=fs(U.z,U.v instanceof Date?jn(U.v):U.v)),p.cellNF||delete U.z}else U.t="s",U.v=F;if(U.t=="z"||(p.dense?(E[w]||(E[w]=[]),E[w][x]=U):E[Kt({c:x,r:w})]=U),b=_+1,A=c.charCodeAt(b),g.e.c<x&&(g.e.c=x),g.e.r<w&&(g.e.r=w),T==N)++x;else if(x=0,++w,p.sheetRows&&p.sheetRows<=w)return!0}e:for(;_<c.length;++_)switch(T=c.charCodeAt(_)){case 34:A===34&&(k=!k);break;case N:case 10:case 13:if(!k&&P())break e;break}return _-b>0&&P(),E["!ref"]=Dr(g),E}function s(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,h):zl(t(c,h),h)}function o(c,h){var p="",v=h.type=="string"?[0,0,0,0]:oB(c,h);switch(h.type){case"base64":p=Ti(c);break;case"binary":p=c;break;case"buffer":h.codepage==65001?p=c.toString("utf8"):h.codepage&&typeof vd<"u"||(p=qt&&Buffer.isBuffer(c)?c.toString("binary"):af(c));break;case"array":p=Eh(c);break;case"string":p=c;break;default:throw new Error("Unrecognized type "+h.type)}return v[0]==239&&v[1]==187&&v[2]==191?p=qu(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=qu(p):h.type=="binary"&&typeof vd<"u",p.slice(0,19)=="socialcalc:version:"?C3.to_sheet(h.type=="string"?p:qu(p),h):s(p,h)}function l(c,h){return xo(o(c,h),h)}function u(c){for(var h=[],p=lr(c["!ref"]),v,E=Array.isArray(c),g=p.s.r;g<=p.e.r;++g){for(var w=[],x=p.s.c;x<=p.e.c;++x){var y=Kt({r:g,c:x});if(v=E?(c[g]||[])[x]:c[y],!v||v.v==null){w.push("          ");continue}for(var b=(v.w||(Si(v),v.w)||"").slice(0,10);b.length<10;)b+=" ";w.push(b+(x===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),Pw=function(){function e(V,se,ee){if(V){Hn(V,V.l||0);for(var C=ee.Enum||Ce;V.l<V.length;){var R=V.read_shift(2),X=C[R]||C[65535],te=V.read_shift(2),K=V.l+te,M=X.f&&X.f(V,te,ee);if(V.l=K,se(M,X,R))return}}}function t(V,se){switch(se.type){case"base64":return r(ka(Ti(V)),se);case"binary":return r(ka(V),se);case"buffer":case"array":return r(V,se)}throw"Unsupported type "+se.type}function r(V,se){if(!V)return V;var ee=se||{},C=ee.dense?[]:{},R="Sheet1",X="",te=0,K={},M=[],Q=[],be={s:{r:0,c:0},e:{r:0,c:0}},Te=ee.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)ee.Enum=Ce,e(V,function(Y,oe,Ze){switch(Ze){case 0:ee.vers=Y,Y>=4096&&(ee.qpro=!0);break;case 6:be=Y;break;case 204:Y&&(X=Y);break;case 222:X=Y;break;case 15:case 51:ee.qpro||(Y[1].v=Y[1].v.slice(1));case 13:case 14:case 16:Ze==14&&(Y[2]&112)==112&&(Y[2]&15)>1&&(Y[2]&15)<15&&(Y[1].z=ee.dateNF||wr[14],ee.cellDates&&(Y[1].t="d",Y[1].v=HS(Y[1].v))),ee.qpro&&Y[3]>te&&(C["!ref"]=Dr(be),K[R]=C,M.push(R),C=ee.dense?[]:{},be={s:{r:0,c:0},e:{r:0,c:0}},te=Y[3],R=X||"Sheet"+(te+1),X="");var Ge=ee.dense?(C[Y[0].r]||[])[Y[0].c]:C[Kt(Y[0])];if(Ge){Ge.t=Y[1].t,Ge.v=Y[1].v,Y[1].z!=null&&(Ge.z=Y[1].z),Y[1].f!=null&&(Ge.f=Y[1].f);break}ee.dense?(C[Y[0].r]||(C[Y[0].r]=[]),C[Y[0].r][Y[0].c]=Y[1]):C[Kt(Y[0])]=Y[1];break}},ee);else if(V[2]==26||V[2]==14)ee.Enum=Ye,V[2]==14&&(ee.qpro=!0,V.l=0),e(V,function(Y,oe,Ze){switch(Ze){case 204:R=Y;break;case 22:Y[1].v=Y[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Y[3]>te&&(C["!ref"]=Dr(be),K[R]=C,M.push(R),C=ee.dense?[]:{},be={s:{r:0,c:0},e:{r:0,c:0}},te=Y[3],R="Sheet"+(te+1)),Te>0&&Y[0].r>=Te)break;ee.dense?(C[Y[0].r]||(C[Y[0].r]=[]),C[Y[0].r][Y[0].c]=Y[1]):C[Kt(Y[0])]=Y[1],be.e.c<Y[0].c&&(be.e.c=Y[0].c),be.e.r<Y[0].r&&(be.e.r=Y[0].r);break;case 27:Y[14e3]&&(Q[Y[14e3][0]]=Y[14e3][1]);break;case 1537:Q[Y[0]]=Y[1],Y[0]==te&&(R=Y[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(C["!ref"]=Dr(be),K[X||R]=C,M.push(X||R),!Q.length)return{SheetNames:M,Sheets:K};for(var J={},I=[],j=0;j<Q.length;++j)K[M[j]]?(I.push(Q[j]||M[j]),J[Q[j]]=K[Q[j]]||K[M[j]]):(I.push(Q[j]),J[Q[j]]={"!ref":"A1"});return{SheetNames:I,Sheets:J}}function n(V,se){var ee=se||{};if(+ee.codepage>=0&&Ic(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var C=In(),R=lr(V["!ref"]),X=Array.isArray(V),te=[];ze(C,0,i(1030)),ze(C,6,l(R));for(var K=Math.min(R.e.r,8191),M=R.s.r;M<=K;++M)for(var Q=rn(M),be=R.s.c;be<=R.e.c;++be){M===R.s.r&&(te[be]=dn(be));var Te=te[be]+Q,J=X?(V[M]||[])[be]:V[Te];if(!(!J||J.t=="z"))if(J.t=="n")(J.v|0)==J.v&&J.v>=-32768&&J.v<=32767?ze(C,13,v(M,be,J.v)):ze(C,14,g(M,be,J.v));else{var I=Si(J);ze(C,15,h(M,be,I.slice(0,239)))}}return ze(C,1),C.end()}function a(V,se){var ee=se||{};if(+ee.codepage>=0&&Ic(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var C=In();ze(C,0,s(V));for(var R=0,X=0;R<V.SheetNames.length;++R)(V.Sheets[V.SheetNames[R]]||{})["!ref"]&&ze(C,27,de(V.SheetNames[R],X++));var te=0;for(R=0;R<V.SheetNames.length;++R){var K=V.Sheets[V.SheetNames[R]];if(!(!K||!K["!ref"])){for(var M=lr(K["!ref"]),Q=Array.isArray(K),be=[],Te=Math.min(M.e.r,8191),J=M.s.r;J<=Te;++J)for(var I=rn(J),j=M.s.c;j<=M.e.c;++j){J===M.s.r&&(be[j]=dn(j));var Y=be[j]+I,oe=Q?(K[J]||[])[j]:K[Y];if(!(!oe||oe.t=="z"))if(oe.t=="n")ze(C,23,P(J,j,te,oe.v));else{var Ze=Si(oe);ze(C,22,T(J,j,te,Ze.slice(0,239)))}}++te}}return ze(C,1),C.end()}function i(V){var se=Ae(2);return se.write_shift(2,V),se}function s(V){var se=Ae(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var ee=0,C=0,R=0,X=0;X<V.SheetNames.length;++X){var te=V.SheetNames[X],K=V.Sheets[te];if(!(!K||!K["!ref"])){++R;var M=Jn(K["!ref"]);ee<M.e.r&&(ee=M.e.r),C<M.e.c&&(C=M.e.c)}}return ee>8191&&(ee=8191),se.write_shift(2,ee),se.write_shift(1,R),se.write_shift(1,C),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}function o(V,se,ee){var C={s:{c:0,r:0},e:{c:0,r:0}};return se==8&&ee.qpro?(C.s.c=V.read_shift(1),V.l++,C.s.r=V.read_shift(2),C.e.c=V.read_shift(1),V.l++,C.e.r=V.read_shift(2),C):(C.s.c=V.read_shift(2),C.s.r=V.read_shift(2),se==12&&ee.qpro&&(V.l+=2),C.e.c=V.read_shift(2),C.e.r=V.read_shift(2),se==12&&ee.qpro&&(V.l+=2),C.s.c==65535&&(C.s.c=C.e.c=C.s.r=C.e.r=0),C)}function l(V){var se=Ae(8);return se.write_shift(2,V.s.c),se.write_shift(2,V.s.r),se.write_shift(2,V.e.c),se.write_shift(2,V.e.r),se}function u(V,se,ee){var C=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(C[0].c=V.read_shift(1),C[3]=V.read_shift(1),C[0].r=V.read_shift(2),V.l+=2):(C[2]=V.read_shift(1),C[0].c=V.read_shift(2),C[0].r=V.read_shift(2)),C}function c(V,se,ee){var C=V.l+se,R=u(V,se,ee);if(R[1].t="s",ee.vers==20768){V.l++;var X=V.read_shift(1);return R[1].v=V.read_shift(X,"utf8"),R}return ee.qpro&&V.l++,R[1].v=V.read_shift(C-V.l,"cstr"),R}function h(V,se,ee){var C=Ae(7+ee.length);C.write_shift(1,255),C.write_shift(2,se),C.write_shift(2,V),C.write_shift(1,39);for(var R=0;R<C.length;++R){var X=ee.charCodeAt(R);C.write_shift(1,X>=128?95:X)}return C.write_shift(1,0),C}function p(V,se,ee){var C=u(V,se,ee);return C[1].v=V.read_shift(2,"i"),C}function v(V,se,ee){var C=Ae(7);return C.write_shift(1,255),C.write_shift(2,se),C.write_shift(2,V),C.write_shift(2,ee,"i"),C}function E(V,se,ee){var C=u(V,se,ee);return C[1].v=V.read_shift(8,"f"),C}function g(V,se,ee){var C=Ae(13);return C.write_shift(1,255),C.write_shift(2,se),C.write_shift(2,V),C.write_shift(8,ee,"f"),C}function w(V,se,ee){var C=V.l+se,R=u(V,se,ee);if(R[1].v=V.read_shift(8,"f"),ee.qpro)V.l=C;else{var X=V.read_shift(2);_(V.slice(V.l,V.l+X),R),V.l+=X}return R}function x(V,se,ee){var C=se&32768;return se&=-32769,se=(C?V:0)+(se>=8192?se-16384:se),(C?"":"$")+(ee?dn(se):rn(se))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(V,se){Hn(V,0);for(var ee=[],C=0,R="",X="",te="",K="";V.l<V.length;){var M=V[V.l++];switch(M){case 0:ee.push(V.read_shift(8,"f"));break;case 1:X=x(se[0].c,V.read_shift(2),!0),R=x(se[0].r,V.read_shift(2),!1),ee.push(X+R);break;case 2:{var Q=x(se[0].c,V.read_shift(2),!0),be=x(se[0].r,V.read_shift(2),!1);X=x(se[0].c,V.read_shift(2),!0),R=x(se[0].r,V.read_shift(2),!1),ee.push(Q+be+":"+X+R)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(V.read_shift(2));break;case 6:{for(var Te="";M=V[V.l++];)Te+=String.fromCharCode(M);ee.push('"'+Te.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:K=ee.pop(),te=ee.pop(),ee.push(["AND","OR"][M-20]+"("+te+","+K+")");break;default:if(M<32&&b[M])K=ee.pop(),te=ee.pop(),ee.push(te+b[M]+K);else if(y[M]){if(C=y[M][1],C==69&&(C=V[V.l++]),C>ee.length){console.error("WK1 bad formula parse 0x"+M.toString(16)+":|"+ee.join("|")+"|");return}var J=ee.slice(-C);ee.length-=C,ee.push(y[M][0]+"("+J.join(",")+")")}else return M<=7?console.error("WK1 invalid opcode "+M.toString(16)):M<=24?console.error("WK1 unsupported op "+M.toString(16)):M<=30?console.error("WK1 invalid opcode "+M.toString(16)):M<=115?console.error("WK1 unsupported function opcode "+M.toString(16)):console.error("WK1 unrecognized opcode "+M.toString(16))}}ee.length==1?se[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function N(V){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=V.read_shift(2),se[3]=V[V.l++],se[0].c=V[V.l++],se}function k(V,se){var ee=N(V);return ee[1].t="s",ee[1].v=V.read_shift(se-4,"cstr"),ee}function T(V,se,ee,C){var R=Ae(6+C.length);R.write_shift(2,V),R.write_shift(1,ee),R.write_shift(1,se),R.write_shift(1,39);for(var X=0;X<C.length;++X){var te=C.charCodeAt(X);R.write_shift(1,te>=128?95:te)}return R.write_shift(1,0),R}function A(V,se){var ee=N(V);ee[1].v=V.read_shift(2);var C=ee[1].v>>1;if(ee[1].v&1)switch(C&7){case 0:C=(C>>3)*5e3;break;case 1:C=(C>>3)*500;break;case 2:C=(C>>3)/20;break;case 3:C=(C>>3)/200;break;case 4:C=(C>>3)/2e3;break;case 5:C=(C>>3)/2e4;break;case 6:C=(C>>3)/16;break;case 7:C=(C>>3)/64;break}return ee[1].v=C,ee}function S(V,se){var ee=N(V),C=V.read_shift(4),R=V.read_shift(4),X=V.read_shift(2);if(X==65535)return C===0&&R===3221225472?(ee[1].t="e",ee[1].v=15):C===0&&R===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var te=X&32768;return X=(X&32767)-16446,ee[1].v=(1-te*2)*(R*Math.pow(2,X+32)+C*Math.pow(2,X)),ee}function P(V,se,ee,C){var R=Ae(14);if(R.write_shift(2,V),R.write_shift(1,ee),R.write_shift(1,se),C==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var X=0,te=0,K=0,M=0;return C<0&&(X=1,C=-C),te=Math.log2(C)|0,C/=Math.pow(2,te-31),M=C>>>0,M&2147483648||(C/=2,++te,M=C>>>0),C-=M,M|=2147483648,M>>>=0,C*=Math.pow(2,32),K=C>>>0,R.write_shift(4,K),R.write_shift(4,M),te+=16383+(X?32768:0),R.write_shift(2,te),R}function F(V,se){var ee=S(V);return V.l+=se-14,ee}function U(V,se){var ee=N(V),C=V.read_shift(4);return ee[1].v=C>>6,ee}function re(V,se){var ee=N(V),C=V.read_shift(8,"f");return ee[1].v=C,ee}function le(V,se){var ee=re(V);return V.l+=se-10,ee}function pe(V,se){return V[V.l+se-1]==0?V.read_shift(se,"cstr"):""}function me(V,se){var ee=V[V.l++];ee>se-1&&(ee=se-1);for(var C="";C.length<ee;)C+=String.fromCharCode(V[V.l++]);return C}function Ee(V,se,ee){if(!(!ee.qpro||se<21)){var C=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var R=V.read_shift(se-21,"cstr");return[C,R]}}function fe(V,se){for(var ee={},C=V.l+se;V.l<C;){var R=V.read_shift(2);if(R==14e3){for(ee[R]=[0,""],ee[R][0]=V.read_shift(2);V[V.l];)ee[R][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return ee}function de(V,se){var ee=Ae(5+V.length);ee.write_shift(2,14e3),ee.write_shift(2,se);for(var C=0;C<V.length;++C){var R=V.charCodeAt(C);ee[ee.l++]=R>127?95:R}return ee[ee.l++]=0,ee}var Ce={0:{n:"BOF",f:T3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:me},65535:{n:""}},Ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),KR=/^\s|\s$|[\t\n\r]/;function k3(e,t){if(!t.bookSST)return"";var r=[Cr];r[r.length]=Ue("sst",null,{xmlns:Ul[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(KR)&&(i+=' xml:space="preserve"'),i+=">"+Vt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ZR(e){return[e.read_shift(4),e.read_shift(4)]}function QR(e,t){return t||(t=Ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var JR=WI;function ej(e){var t=In();Fe(t,159,QR(e));for(var r=0;r<e.length;++r)Fe(t,19,JR(e[r]));return Fe(t,160),t.end()}function tj(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function O3(e){var t=0,r,n=tj(e),a=n.length+1,i,s,o,l,u;for(r=so(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^s;return t^52811}var rj=function(){function e(a,i){switch(i.type){case"base64":return t(Ti(a),i);case"binary":return t(a,i);case"buffer":return t(qt&&Buffer.isBuffer(a)?a.toString("binary"):af(a),i);case"array":return t(Eh(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,v=0,E,g=-1;E=p.exec(c);){switch(E[0]){case"\\cell":var w=c.slice(v,p.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var x={v:w,t:"s"};Array.isArray(o)?o[h][g]=x:o[Kt({r:h,c:g})]=x}break}v=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Dr(u),o}function r(a,i){return xo(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=lr(a["!ref"]),o,l=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var c=s.s.c;c<=s.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=s.s.c;c<=s.e.c;++c){var h=Kt({r:u,c});o=l?(a[u]||[])[c]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Si(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Iw(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var nj=6,vi=nj;function Nd(e){return Math.floor((e+Math.round(128/vi)/256)*vi)}function Dd(e){return Math.floor((e-5)/vi*100+.5)/100}function Ug(e){return Math.round((e*vi+5)/vi*256)/256}function jx(e){e.width?(e.wpx=Nd(e.width),e.wch=Dd(e.wpx),e.MDW=vi):e.wpx?(e.wch=Dd(e.wpx),e.width=Ug(e.wch),e.MDW=vi):typeof e.wch=="number"&&(e.width=Ug(e.wch),e.wpx=Nd(e.width),e.MDW=vi),e.customWidth&&delete e.customWidth}var aj=96,F3=aj;function Cd(e){return e*96/F3}function P3(e){return e*F3/96}function ij(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:n,formatCode:Vt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function sj(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function I3(e,t){var r=[Cr,Ue("styleSheet",null,{xmlns:Ul[0],"xmlns:vt":Ur.vt})],n;return e.SSF&&(n=ij(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=sj(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function oj(e,t){var r=e.read_shift(2),n=hn(e);return[r,n]}function lj(e,t,r){r||(r=Ae(6+4*t.length)),r.write_shift(2,e),qr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function uj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=KI(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=XI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=hn(e),n}function cj(e,t){t||(t=Ae(25+4*32)),t.write_shift(2,e.sz*20),ZI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Sd(e.color,t);var n=0;return n=2,t.write_shift(1,n),qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Jp,dj=Ja;function Rw(e,t){t||(t=Ae(4*3+8*7+16*1)),Jp||(Jp=Tx(fj));var r=Jp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Sd({auto:1},t),Sd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function hj(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function R3(e,t,r){r||(r=Ae(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fu(e,t){return t||(t=Ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var pj=Ja;function mj(e,t){return t||(t=Ae(51)),t.write_shift(1,0),fu(null,t),fu(null,t),fu(null,t),fu(null,t),fu(null,t),t.length>t.l?t.slice(0,t.l):t}function gj(e,t){return t||(t=Ae(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Td(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function xj(e,t,r){var n=Ae(2052);return n.write_shift(4,e),Td(t,n),Td(r,n),n.length>n.l?n.slice(0,n.l):n}function vj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Fe(e,615,ja(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Fe(e,44,lj(a,t[a]))}),Fe(e,616))}}function yj(e){var t=1;Fe(e,611,ja(t)),Fe(e,43,cj({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(e,612)}function wj(e){var t=2;Fe(e,603,ja(t)),Fe(e,45,Rw({patternType:"none"})),Fe(e,45,Rw({patternType:"gray125"})),Fe(e,604)}function bj(e){var t=1;Fe(e,613,ja(t)),Fe(e,46,mj()),Fe(e,614)}function Ej(e){var t=1;Fe(e,626,ja(t)),Fe(e,47,R3({numFmtId:0},65535)),Fe(e,627)}function _j(e,t){Fe(e,617,ja(t.length)),t.forEach(function(r){Fe(e,47,R3(r,0))}),Fe(e,618)}function Tj(e){var t=1;Fe(e,619,ja(t)),Fe(e,48,gj({xfId:0,name:"Normal"})),Fe(e,620)}function Sj(e){var t=0;Fe(e,505,ja(t)),Fe(e,506)}function Aj(e){var t=0;Fe(e,508,xj(t,"TableStyleMedium9","PivotStyleMedium4")),Fe(e,509)}function Nj(e,t){var r=In();return Fe(r,278),vj(r,e.SSF),yj(r),wj(r),bj(r),Ej(r),_j(r,t.cellXfs),Tj(r),Sj(r),Aj(r),Fe(r,279),r.end()}function j3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Cr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Dj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hn(e)}}function Cj(e){var t=Ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qr(e.name,t),t.slice(0,t.l)}function kj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Oj(e){var t=Ae(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Fj(e,t){var r=Ae(8+2*t.length);return r.write_shift(4,e),qr(t,r),r.slice(0,r.l)}function Pj(e){return e.l+=4,e.read_shift(4)!=0}function Ij(e,t){var r=Ae(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Rj(){var e=In();return Fe(e,332),Fe(e,334,ja(1)),Fe(e,335,Cj({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(e,336),Fe(e,339,Fj(1,"XLDAPR")),Fe(e,52),Fe(e,35,ja(514)),Fe(e,4096,ja(0)),Fe(e,4097,oa(1)),Fe(e,36),Fe(e,53),Fe(e,340),Fe(e,337,Ij(1)),Fe(e,51,Oj([[1,0]])),Fe(e,338),Fe(e,333),e.end()}function M3(){var e=[Cr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function jj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Kt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Zo=1024;function L3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Vn.v,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:mv":Vn.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zo<e*1e3;)Zo+=1e3;return t.forEach(function(i){var s=zr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ue("v:fill",l,o),c={on:"t",obscured:"t"};++Zo,a=a.concat(["<v:shape"+Lc({id:"_x0000_s"+Zo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ue("v:shadow",null,c),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",en("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),en("x:AutoFill","False"),en("x:Row",String(s.r)),en("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function B3(e){var t=[Cr,Ue("comments",null,{xmlns:Ul[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Vt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(Vt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(en("t",Vt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(en("t",Vt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Mj(e,t,r){var n=[Cr,Ue("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ue("threadedComment",en("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Lj(e){var t=[Cr,Ue("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":Ul[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Bj(e){var t={};t.iauthor=e.read_shift(4);var r=bo(e);return t.rfx=r.s,t.ref=Kt(r.s),e.l+=16,t}function Uj(e,t){return t==null&&(t=Ae(36)),t.write_shift(4,e[1].iauthor),ql(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var zj=hn;function qj(e){return qr(e.slice(0,54))}function Wj(e){var t=In(),r=[];return Fe(t,628),Fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Fe(t,632,qj(a.a)))})}),Fe(t,631),Fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:zr(n[0]),e:zr(n[0])};Fe(t,635,Uj([i,a])),a.t&&a.t.length>0&&Fe(t,637,GI(a)),Fe(t,636),delete a.iauthor})}),Fe(t,634),Fe(t,629),t.end()}function $j(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Qt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var U3=["xlsb","xlsm","xlam","biff8","xla"],Gj=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,c=s.length>0?parseInt(s,10)|0:0;return o?c+=t.c:--c,l?u+=t.r:--u,a+(o?"":"$")+dn(c)+(l?"":"$")+rn(u)}return function(a,i){return t=i,a.replace(e,r)}}(),Mx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Lx=function(){return function(t,r){return t.replace(Mx,function(n,a,i,s,o,l){var u=Ox(s)-(i?0:r.c),c=kx(l)-(o?0:r.r),h=c==0?"":o?c+1:"["+c+"]",p=u==0?"":i?u+1:"["+u+"]";return a+"R"+h+"C"+p})}}();function Hj(e,t){return e.replace(Mx,function(r,n,a,i,s,o){return n+(a=="$"?a+i:dn(Ox(i)+t.c))+(s=="$"?s+o:rn(kx(o)+t.r))})}function Vj(e){return e.length!=1}function Sr(e){e.l+=1}function ds(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function z3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return q3(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=ds(e),o=ds(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function q3(e){var t=ds(e),r=ds(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Yj(e,t,r){if(r.biff<8)return q3(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=ds(e),s=ds(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function W3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Xj(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ds(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Xj(e){var t=ds(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Kj(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Zj(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Qj(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Qj(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Jj(e,t,r){var n=(e[e.l++]&96)>>5,a=z3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function eM(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=z3(e,i,r);return[n,a,s]}function tM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function rM(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function nM(e,t,r){var n=(e[e.l++]&96)>>5,a=Yj(e,t-1,r);return[n,a]}function aM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iM(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function sM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function lM(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function uM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function $3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function cM(e){return e.read_shift(2),$3(e)}function fM(e){return e.read_shift(2),$3(e)}function dM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=W3(e,0,r);return[n,a]}function hM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Zj(e,0,r);return[n,a]}function pM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=W3(e,0,r);return[n,a,i]}function mM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[mL[a],V3[a],n]}function gM(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:xM(e);return[a,(i[0]===0?V3:pL)[i[1]]]}function xM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vM(e,t,r){e.l+=r&&r.biff==2?3:4}function yM(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function wM(e){return e.l++,lf[e.read_shift(1)]}function bM(e){return e.l++,e.read_shift(2)}function EM(e){return e.l++,e.read_shift(1)!==0}function _M(e){return e.l++,Wl(e)}function TM(e,t,r){return e.l++,A3(e,t-1,r)}function SM(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=pR(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=lf[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wl(e);break;case 2:r[1]=vR(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function AM(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?bo:bR)(e));return a}function NM(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=SM(e,r.biff);return s}function DM(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function CM(e,t,r){if(r.biff==5)return kM(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function kM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function OM(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function FM(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function PM(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function IM(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var RM=Ja,jM=Ja,MM=Ja;function uf(e,t,r){return e.l+=2,[Kj(e)]}function Bx(e){return e.l+=6,[]}var LM=uf,BM=Bx,UM=Bx,zM=uf;function G3(e){return e.l+=2,[T3(e),e.read_shift(2)&1]}var qM=uf,WM=G3,$M=Bx,GM=uf,HM=uf,VM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function YM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=VM[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function XM(e){return e.l+=2,[e.read_shift(4)]}function KM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ZM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function eL(e){return e.l+=4,[0,0]}var Mw={1:{n:"PtgExp",f:yM},2:{n:"PtgTbl",f:MM},3:{n:"PtgAdd",f:Sr},4:{n:"PtgSub",f:Sr},5:{n:"PtgMul",f:Sr},6:{n:"PtgDiv",f:Sr},7:{n:"PtgPower",f:Sr},8:{n:"PtgConcat",f:Sr},9:{n:"PtgLt",f:Sr},10:{n:"PtgLe",f:Sr},11:{n:"PtgEq",f:Sr},12:{n:"PtgGe",f:Sr},13:{n:"PtgGt",f:Sr},14:{n:"PtgNe",f:Sr},15:{n:"PtgIsect",f:Sr},16:{n:"PtgUnion",f:Sr},17:{n:"PtgRange",f:Sr},18:{n:"PtgUplus",f:Sr},19:{n:"PtgUminus",f:Sr},20:{n:"PtgPercent",f:Sr},21:{n:"PtgParen",f:Sr},22:{n:"PtgMissArg",f:Sr},23:{n:"PtgStr",f:TM},26:{n:"PtgSheet",f:KM},27:{n:"PtgEndSheet",f:ZM},28:{n:"PtgErr",f:wM},29:{n:"PtgBool",f:EM},30:{n:"PtgInt",f:bM},31:{n:"PtgNum",f:_M},32:{n:"PtgArray",f:aM},33:{n:"PtgFunc",f:mM},34:{n:"PtgFuncVar",f:gM},35:{n:"PtgName",f:DM},36:{n:"PtgRef",f:dM},37:{n:"PtgArea",f:Jj},38:{n:"PtgMemArea",f:OM},39:{n:"PtgMemErr",f:RM},40:{n:"PtgMemNoMem",f:jM},41:{n:"PtgMemFunc",f:FM},42:{n:"PtgRefErr",f:PM},43:{n:"PtgAreaErr",f:tM},44:{n:"PtgRefN",f:hM},45:{n:"PtgAreaN",f:nM},46:{n:"PtgMemAreaN",f:QM},47:{n:"PtgMemNoMemN",f:JM},57:{n:"PtgNameX",f:CM},58:{n:"PtgRef3d",f:pM},59:{n:"PtgArea3d",f:eM},60:{n:"PtgRefErr3d",f:IM},61:{n:"PtgAreaErr3d",f:rM},255:{}},tL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},rL={1:{n:"PtgElfLel",f:G3},2:{n:"PtgElfRw",f:GM},3:{n:"PtgElfCol",f:LM},6:{n:"PtgElfRwV",f:HM},7:{n:"PtgElfColV",f:zM},10:{n:"PtgElfRadical",f:qM},11:{n:"PtgElfRadicalS",f:$M},13:{n:"PtgElfColS",f:BM},15:{n:"PtgElfColSV",f:UM},16:{n:"PtgElfRadicalLel",f:WM},25:{n:"PtgList",f:YM},29:{n:"PtgSxName",f:XM},255:{}},nL={0:{n:"PtgAttrNoop",f:eL},1:{n:"PtgAttrSemi",f:uM},2:{n:"PtgAttrIf",f:oM},4:{n:"PtgAttrChoose",f:iM},8:{n:"PtgAttrGoto",f:sM},16:{n:"PtgAttrSum",f:vM},32:{n:"PtgAttrBaxcel",f:jw},33:{n:"PtgAttrBaxcel",f:jw},64:{n:"PtgAttrSpace",f:cM},65:{n:"PtgAttrSpaceSemi",f:fM},128:{n:"PtgAttrIfError",f:lM},255:{}};function aL(e,t,r,n){if(n.biff<8)return Ja(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=NM(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=AM(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Ja(e,t)),i}function iL(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Mw[i]||Mw[tL[i]],(i===24||i===25)&&(a=(i===24?rL:nL)[e[e.l+1]]),!a||!a.f?Ja(e,t):s.push([a.n,a.f(e,t,r)]);return s}function sL(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var oL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function H3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Lw(e,t,r){var n=H3(e,t,r);return n=="#REF"?n:lL(n,r)}function Dl(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],l,u,c,h=0,p=0,v,E="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",x=0,y=e[0].length;x<y;++x){var b=e[0][x];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=yr(" ",e[0][g][1][1]);break;case 1:w=yr("\r",e[0][g][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+w,g=-1}o.push(u+oL[b[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=$u(b[1][1],s,a),o.push(Gu(c,i));break;case"PtgRefN":c=r?$u(b[1][1],r,a):b[1][1],o.push(Gu(c,i));break;case"PtgRef3d":h=b[1][1],c=$u(b[1][2],s,a),E=Lw(n,h,a),o.push(E+"!"+Gu(c,i));break;case"PtgFunc":case"PtgFuncVar":var _=b[1][0],N=b[1][1];_||(_=0),_&=127;var k=_==0?[]:o.slice(-_);o.length-=_,N==="User"&&(N=k.shift()),o.push(N+"("+k.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":v=Ew(b[1][1],r?{s:r}:s,a),o.push(Zp(v,a));break;case"PtgArea":v=Ew(b[1][1],s,a),o.push(Zp(v,a));break;case"PtgArea3d":h=b[1][1],v=b[1][2],E=Lw(n,h,a),o.push(E+"!"+Zp(v,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=b[1][2];var T=(n.names||[])[p-1]||(n[0]||[])[p],A=T?T.Name:"SH33TJSNAME"+String(p);A&&A.slice(0,6)=="_xlfn."&&!a.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var S=b[1][1];p=b[1][2];var P;if(a.biff<=5)S<0&&(S=-S),n[S]&&(P=n[S][p]);else{var F="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][p]&&n[S][p].itab>0&&(F=n.SheetNames[n[S][p].itab-1]+"!"):F=n.SheetNames[p-1]+"!"),n[S]&&n[S][p])F+=n[S][p].Name;else if(n[0]&&n[0][p])F+=n[0][p].Name;else{var U=(H3(n,S,a)||"").split(";;");U[p-1]?F=U[p-1]:F+="SH33TJSERRX"}o.push(F);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var re="(",le=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:re=yr(" ",e[0][g][1][1])+re;break;case 3:re=yr("\r",e[0][g][1][1])+re;break;case 4:le=yr(" ",e[0][g][1][1])+le;break;case 5:le=yr("\r",e[0][g][1][1])+le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(re+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:b[1][1],r:b[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[Kt(c)]){var me=n.sharedf[Kt(c)];o.push(Dl(me,s,pe,n,a))}else{var Ee=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(Dl(u[1],s,pe,n,a)),Ee=!0;break}Ee||o.push(b[1])}break;case"PtgArray":o.push("{"+sL(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&fe.indexOf(e[0][x][0])==-1){b=e[0][g];var de=!0;switch(b[1][0]){case 4:de=!1;case 0:w=yr(" ",b[1][1]);break;case 5:de=!1;case 1:w=yr("\r",b[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((de?w:"")+o.pop()+(de?"":w)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function uL(e){if(e==null){var t=Ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return oo(e);return oo(0)}function cL(e,t,r,n,a){var i=lo(t,r,a),s=uL(e.v),o=Ae(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Ae(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var h=Jr([i,s,o,u]);return h}function _h(e,t,r){var n=e.read_shift(4),a=iL(e,n,r),i=e.read_shift(4),s=i>0?aL(e,i,a,r):null;return[a,s]}var fL=_h,Th=_h,dL=_h,hL=_h,pL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},V3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gL(e){var t="of:="+e.replace(Mx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function xL(e){return e.replace(/\./,"!")}var Hu=typeof Map<"u";function Ux(e,t,r){var n=0,a=e.length;if(r){if(Hu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Hu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Hu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Sh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(vi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Dd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Ug(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Y3(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ws(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){WS(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function vL(e,t,r){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function yL(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Dr(e[r])+'"/>';return t+"</mergeCells>"}function wL(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Mc(Vt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ue("outlinePr",null,u)}!i&&!o||(a[a.length]=Ue("sheetPr",o,s))}var bL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],EL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _L(e){var t={sheet:1};return bL.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),EL.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=O3(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function TL(e){return Y3(e),Ue("pageMargins",null,e)}function SL(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ue("col",null,Sh(a,n)));return r[r.length]="</cols>",r.join("")}function AL(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Dr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Jn(a);s.s.r==s.e.r&&(s.e.r=Jn(t["!ref"]).e.r,a=Dr(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}function NL(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function DL(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=lf[e.v];break;case"d":n&&n.cellDates?a=_n(e.v,-1).toISOString():(e=Mn(e),e.t="n",a=""+(e.v=jn(_n(e.v)))),typeof e.z>"u"&&(e.z=wr[14]);break;default:a=e.v;break}var o=en("v",Vt(a)),l={r:t},u=ws(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=en("v",""+Ux(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ue("f",Vt(e.f),c)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ue("c",o,l)}function CL(e,t,r,n){var a=[],i=[],s=lr(e["!ref"]),o="",l,u="",c=[],h=0,p=0,v=e["!rows"],E=Array.isArray(e),g={r:u},w,x=-1;for(p=s.s.c;p<=s.e.c;++p)c[p]=dn(p);for(h=s.s.r;h<=s.e.r;++h){for(i=[],u=rn(h),p=s.s.c;p<=s.e.c;++p){l=c[p]+u;var y=E?(e[h]||[])[p]:e[l];y!==void 0&&(o=DL(y,l,e,t))!=null&&i.push(o)}(i.length>0||v&&v[h])&&(g={r:u},v&&v[h]&&(w=v[h],w.hidden&&(g.hidden=1),x=-1,w.hpx?x=Cd(w.hpx):w.hpt&&(x=w.hpt),x>-1&&(g.ht=x,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),a[a.length]=Ue("row",i.join(""),g))}if(v)for(;h<v.length;++h)v&&v[h]&&(g={r:h+1},w=v[h],w.hidden&&(g.hidden=1),x=-1,w.hpx?x=Cd(w.hpx):w.hpt&&(x=w.hpt),x>-1&&(g.ht=x,g.customHeight=1),w.level&&(g.outlineLevel=w.level),a[a.length]=Ue("row","",g));return a.join("")}function X3(e,t,r,n){var a=[Cr,Ue("worksheet",null,{xmlns:Ul[0],"xmlns:r":Ur.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",c=lr(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=Dr(c)}n||(n={}),l["!comments"]=[];var h=[];wL(l,r,e,t,a),a[a.length]=Ue("dimension",null,{ref:u}),a[a.length]=NL(l,t,e,r),t.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=SL(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=CL(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=_L(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=AL(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=yL(l["!merges"]));var p=-1,v,E=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(v={ref:g[0]},g[1].Target.charAt(0)!="#"&&(E=Ht(n,-1,Vt(g[1].Target).replace(/#.*$/,""),Ut.HLINK),v["r:id"]="rId"+E),(p=g[1].Target.indexOf("#"))>-1&&(v.location=Vt(g[1].Target.slice(p+1))),g[1].Tooltip&&(v.tooltip=Vt(g[1].Tooltip)),a[a.length]=Ue("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=TL(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=en("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(E=Ht(n,-1,"../drawings/drawing"+(e+1)+".xml",Ut.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+E}),l["!drawing"]=h),l["!comments"].length>0&&(E=Ht(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ut.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+E}),l["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function kL(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function OL(e,t,r){var n=Ae(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Cd(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var h=-1,p=-1,v=c<<10;v<c+1<<10;++v){u.c=v;var E=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Kt(u)];E&&(h<0&&(h=v),p=v)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function FL(e,t,r,n){var a=OL(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Fe(e,0,a)}var PL=bo,IL=ql;function RL(){}function jL(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=HI(e),r}function ML(e,t,r){r==null&&(r=Ae(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Sd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),c3(e,r),r.slice(0,r.l)}function LL(e){var t=ya(e);return[t]}function BL(e,t,r){return r==null&&(r=Ae(8)),vo(t,r)}function UL(e){var t=yo(e);return[t]}function zL(e,t,r){return r==null&&(r=Ae(4)),wo(t,r)}function qL(e){var t=ya(e),r=e.read_shift(1);return[t,r,"b"]}function WL(e,t,r){return r==null&&(r=Ae(9)),vo(t,r),r.write_shift(1,e.v?1:0),r}function $L(e){var t=yo(e),r=e.read_shift(1);return[t,r,"b"]}function GL(e,t,r){return r==null&&(r=Ae(5)),wo(t,r),r.write_shift(1,e.v?1:0),r}function HL(e){var t=ya(e),r=e.read_shift(1);return[t,r,"e"]}function VL(e,t,r){return r==null&&(r=Ae(9)),vo(t,r),r.write_shift(1,e.v),r}function YL(e){var t=yo(e),r=e.read_shift(1);return[t,r,"e"]}function XL(e,t,r){return r==null&&(r=Ae(8)),wo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function KL(e){var t=ya(e),r=e.read_shift(4);return[t,r,"s"]}function ZL(e,t,r){return r==null&&(r=Ae(12)),vo(t,r),r.write_shift(4,t.v),r}function QL(e){var t=yo(e),r=e.read_shift(4);return[t,r,"s"]}function JL(e,t,r){return r==null&&(r=Ae(8)),wo(t,r),r.write_shift(4,t.v),r}function e9(e){var t=ya(e),r=Wl(e);return[t,r,"n"]}function t9(e,t,r){return r==null&&(r=Ae(16)),vo(t,r),oo(e.v,r),r}function r9(e){var t=yo(e),r=Wl(e);return[t,r,"n"]}function n9(e,t,r){return r==null&&(r=Ae(12)),wo(t,r),oo(e.v,r),r}function a9(e){var t=ya(e),r=f3(e);return[t,r,"n"]}function i9(e,t,r){return r==null&&(r=Ae(12)),vo(t,r),d3(e.v,r),r}function s9(e){var t=yo(e),r=f3(e);return[t,r,"n"]}function o9(e,t,r){return r==null&&(r=Ae(8)),wo(t,r),d3(e.v,r),r}function l9(e){var t=ya(e),r=Fx(e);return[t,r,"is"]}function u9(e){var t=ya(e),r=hn(e);return[t,r,"str"]}function c9(e,t,r){return r==null&&(r=Ae(12+4*e.v.length)),vo(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function f9(e){var t=yo(e),r=hn(e);return[t,r,"str"]}function d9(e,t,r){return r==null&&(r=Ae(8+4*e.v.length)),wo(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function h9(e,t,r){var n=e.l+t,a=ya(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=Dl(o,null,a,r.supbooks,r)}else e.l=n;return s}function p9(e,t,r){var n=e.l+t,a=ya(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=Dl(o,null,a,r.supbooks,r)}else e.l=n;return s}function m9(e,t,r){var n=e.l+t,a=ya(e);a.r=r["!row"];var i=Wl(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=Dl(o,null,a,r.supbooks,r)}else e.l=n;return s}function g9(e,t,r){var n=e.l+t,a=ya(e);a.r=r["!row"];var i=hn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Th(e,n-e.l,r);s[3]=Dl(o,null,a,r.supbooks,r)}else e.l=n;return s}var x9=bo,v9=ql;function y9(e,t){return t==null&&(t=Ae(4)),t.write_shift(4,e),t}function w9(e,t){var r=e.l+t,n=bo(e),a=Px(e),i=hn(e),s=hn(e),o=hn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function b9(e,t){var r=Ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ql({s:zr(e[0]),e:zr(e[0])},r),Ix("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return qr(a||"",r),qr(e[1].Tooltip||"",r),qr("",r),r.slice(0,r.l)}function E9(){}function _9(e,t,r){var n=e.l+t,a=h3(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=fL(e,n-e.l,r);s[1]=o}else e.l=n;return s}function T9(e,t,r){var n=e.l+t,a=bo(e),i=[a];if(r.cellFormula){var s=hL(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function S9(e,t,r){r==null&&(r=Ae(18));var n=Sh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var K3=["left","right","top","bottom","header","footer"];function A9(e){var t={};return K3.forEach(function(r){t[r]=Wl(e)}),t}function N9(e,t){return t==null&&(t=Ae(6*8)),Y3(e),K3.forEach(function(r){oo(e[r],t)}),t}function D9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function C9(e,t,r){r==null&&(r=Ae(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function k9(e){var t=Ae(24);return t.write_shift(4,4),t.write_shift(4,1),ql(e,t),t}function O9(e,t){return t==null&&(t=Ae(16*4+2)),t.write_shift(2,e.password?O3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function F9(){}function P9(){}function I9(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Mn(t),t.z=t.z||wr[14],t.v=jn(_n(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ws(a.cellXfs,t,a),t.l&&i["!links"].push([Kt(l),t.l]),t.c&&i["!comments"].push([Kt(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Ux(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?Fe(e,18,JL(t,l)):Fe(e,7,ZL(t,l))):(l.t="str",s?Fe(e,17,d9(t,l)):Fe(e,6,c9(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Fe(e,13,o9(t,l)):Fe(e,2,i9(t,l)):s?Fe(e,16,n9(t,l)):Fe(e,5,t9(t,l)),!0;case"b":return l.t="b",s?Fe(e,15,GL(t,l)):Fe(e,4,WL(t,l)),!0;case"e":return l.t="e",s?Fe(e,14,XL(t,l)):Fe(e,3,VL(t,l)),!0}return s?Fe(e,12,zL(t,l)):Fe(e,1,BL(t,l)),!0}function R9(e,t,r,n){var a=lr(t["!ref"]||"A1"),i,s="",o=[];Fe(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var c=a.s.r;c<=u;++c){s=rn(c),FL(e,t,a,c);var h=!1;if(c<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){c===a.s.r&&(o[p]=dn(p)),i=o[p]+s;var v=l?(t[c]||[])[p]:t[i];if(!v){h=!1;continue}h=I9(e,v,c,p,n,t,h)}}Fe(e,146)}function j9(e,t){!t||!t["!merges"]||(Fe(e,177,y9(t["!merges"].length)),t["!merges"].forEach(function(r){Fe(e,176,v9(r))}),Fe(e,178))}function M9(e,t){!t||!t["!cols"]||(Fe(e,390),t["!cols"].forEach(function(r,n){r&&Fe(e,60,S9(n,r))}),Fe(e,391))}function L9(e,t){!t||!t["!ref"]||(Fe(e,648),Fe(e,649,k9(lr(t["!ref"]))),Fe(e,650))}function B9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ht(r,-1,n[1].Target.replace(/#.*$/,""),Ut.HLINK);Fe(e,494,b9(n,a))}}),delete t["!links"]}function U9(e,t,r,n){if(t["!comments"].length>0){var a=Ht(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ut.VML);Fe(e,551,Ix("rId"+a)),t["!legacy"]=a}}function z9(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Dr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Jn(i);o.s.r==o.e.r&&(o.e.r=Jn(t["!ref"]).e.r,i=Dr(o));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Fe(e,161,ql(lr(i))),Fe(e,162)}}function q9(e,t,r){Fe(e,133),Fe(e,137,C9(t,r)),Fe(e,138),Fe(e,134)}function W9(e,t){t["!protect"]&&Fe(e,535,O9(t["!protect"]))}function $9(e,t,r,n){var a=In(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=lr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Fe(a,129),(r.vbaraw||s["!outline"])&&Fe(a,147,ML(o,s["!outline"])),Fe(a,148,IL(l)),q9(a,s,r.Workbook),M9(a,s),R9(a,s,e,t),W9(a,s),z9(a,s,r,e),j9(a,s),B9(a,s,n),s["!margins"]&&Fe(a,476,N9(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&L9(a,s),U9(a,s,e,n),Fe(a,130),a.end()}function G9(e,t){e.l+=10;var r=hn(e);return{name:r}}var H9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function V9(e){return!e.Workbook||!e.Workbook.WBProps?"false":TI(e.Workbook.WBProps.date1904)?"true":"false"}var Y9="][*?/\\".split("");function Z3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Y9.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function X9(e,t,r){e.forEach(function(n,a){Z3(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function K9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];X9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vL(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Q3(e){var t=[Cr];t[t.length]=Ue("workbook",null,{xmlns:Ul[0],"xmlns:r":Ur.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(H9.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ue("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Vt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ue("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ue("definedName",Vt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Z9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bg(e),r.name=hn(e),r}function Q9(e,t){return t||(t=Ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ix(e.strRelID,t),qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function J9(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?hn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function e7(e,t){t||(t=Ae(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),c3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function t7(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=VI(e),s=dL(e,0,r),o=Px(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function r7(e,t){Fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Fe(e,156,Q9(a))}Fe(e,144)}function n7(e,t){t||(t=Ae(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return qr("SheetJS",t),qr(xd.version,t),qr(xd.version,t),qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function a7(e,t){t||(t=Ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function i7(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Fe(e,135),Fe(e,158,a7(a)),Fe(e,136))}}function s7(e,t){var r=In();return Fe(r,131),Fe(r,128,n7()),Fe(r,153,e7(e.Workbook&&e.Workbook.WBProps||null)),i7(r,e),r7(r,e),Fe(r,132),r.end()}function o7(e,t,r){return(t.slice(-4)===".bin"?s7:Q3)(e)}function l7(e,t,r,n,a){return(t.slice(-4)===".bin"?$9:X3)(e,r,n,a)}function u7(e,t,r){return(t.slice(-4)===".bin"?Nj:I3)(e,r)}function c7(e,t,r){return(t.slice(-4)===".bin"?ej:k3)(e,r)}function f7(e,t,r){return(t.slice(-4)===".bin"?Wj:B3)(e)}function d7(e){return(e.slice(-4)===".bin"?Rj:M3)()}function h7(e,t){var r=[];return e.Props&&r.push(uR(e.Props,t)),e.Custprops&&r.push(cR(e.Props,e.Custprops)),r.join("")}function p7(){return""}function m7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":Vt(wr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),s))}),Ue("Styles",r.join(""))}function J3(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Lx(e.Ref,{r:0,c:0})})}function g7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(J3(a)))}return Ue("Names",r.join(""))}function x7(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(J3(o)))}return i.join("")}function v7(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(en("ProtectContents","True")),e["!protect"].objects&&a.push(en("ProtectObjects","True")),e["!protect"].scenarios&&a.push(en("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(en("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(en("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Vn.x})}function y7(e){return e.map(function(t){var r=_I(t.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":t.a})}).join("")}function w7(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Vt(Lx(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=zr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Vt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Vt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=s.c||u[c].s.r!=s.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=lf[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||wr[14]);break;case"s":h="String",p=EI(e.v||"");break}var v=ws(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+v),o["ss:Index"]=s.c+1;var E=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+E+"</Data>";return(e.c||[]).length>0&&(g+=y7(e.c)),Ue("Cell",g,o)}function b7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=P3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function E7(e,t,r,n){if(!e["!ref"])return"";var a=lr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,x){jx(w);var y=!!w.width,b=Sh(x,w),_={"ss:Index":x+1};y&&(_["ss:Width"]=Nd(b.width)),w.hidden&&(_["ss:Hidden"]="1"),o.push(Ue("Column",null,_))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var c=[b7(u,(e["!rows"]||[])[u])],h=a.s.c;h<=a.e.c;++h){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>u)&&!(i[s].e.c<h)&&!(i[s].e.r<u)){(i[s].s.c!=h||i[s].s.r!=u)&&(p=!0);break}if(!p){var v={r:u,c:h},E=Kt(v),g=l?(e[u]||[])[h]:e[E];c.push(w7(g,E,e,t,r,n,v))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function _7(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?x7(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?E7(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(v7(i,t,e,r)),n.join("")}function T7(e,t){t||(t={}),e.SSF||(e.SSF=Mn(wr)),e.SSF&&(wh(),yh(e.SSF),t.revssf=bh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(h7(e,t)),r.push(p7()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ue("Worksheet",_7(n,t,e),{"ss:Name":Vt(e.SheetNames[n])}));return r[2]=m7(e,t),r[3]=g7(e),Cr+Ue("Workbook",r.join(""),{xmlns:Vn.ss,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:ss":Vn.ss,"xmlns:dt":Vn.dt,"xmlns:html":Vn.html})}var em={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function S7(e,t){var r=[],n=[],a=[],i=0,s,o=fw(Tw,"n"),l=fw(Sw,"n");if(e.Props)for(s=an(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=an(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)_3.indexOf(a[i][0])>-1||w3.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Qt.utils.cfb_add(t,"/SummaryInformation",kw(n,em.SI,l,Sw)),(r.length||u.length)&&Qt.utils.cfb_add(t,"/DocumentSummaryInformation",kw(r,em.DSI,o,Tw,u.length?u:null,em.UDI))}function A7(e,t){var r=t||{},n=Qt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qt.utils.cfb_add(n,a,eA(e,r)),r.biff==8&&(e.Props||e.Custprops)&&S7(e,n),r.biff==8&&e.vbaraw&&$j(n,Qt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var N7={0:{f:kL},1:{f:LL},2:{f:a9},3:{f:HL},4:{f:qL},5:{f:e9},6:{f:u9},7:{f:KL},8:{f:g9},9:{f:m9},10:{f:h9},11:{f:p9},12:{f:UL},13:{f:s9},14:{f:YL},15:{f:$L},16:{f:r9},17:{f:f9},18:{f:QL},19:{f:Fx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:t7},40:{},42:{},43:{f:uj},44:{f:oj},45:{f:dj},46:{f:pj},47:{f:hj},48:{},49:{f:UI},50:{},51:{f:kj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zR},62:{f:l9},63:{f:jj},64:{f:F9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ja,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:D9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jL},148:{f:PL,p:16},151:{f:E9},152:{},153:{f:J9},154:{},155:{},156:{f:Z9},157:{},158:{},159:{T:1,f:ZR},160:{T:-1},161:{T:1,f:bo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:x9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Dj},336:{T:-1},337:{f:Pj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:RR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_9},427:{f:T9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:A9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:w9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zj},633:{T:1},634:{T:-1},635:{T:1,f:Bj},636:{T:-1},637:{f:$I},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:G9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:P9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ze(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Cx(r)&&e.push(r)}}function D7(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,i),c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function cf(e,t,r){return e||(e=Ae(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function C7(e,t,r,n){var a=Ae(9);return cf(a,e,t),S3(r,n||"b",a),a}function k7(e,t,r){var n=Ae(8+2*r.length);return cf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function O7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?jn(_n(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ze(e,2,GR(r,n,a)):ze(e,3,$R(r,n,a));return;case"b":case"e":ze(e,5,C7(r,n,t.v,t.t));return;case"s":case"str":ze(e,4,k7(r,n,(t.v||"").slice(0,255)));return}ze(e,1,cf(null,r,n))}function F7(e,t,r,n){var a=Array.isArray(t),i=lr(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Dr(i)}for(var u=i.s.r;u<=i.e.r;++u){o=rn(u);for(var c=i.s.c;c<=i.e.c;++c){u===i.s.r&&(l[c]=dn(c)),s=l[c]+o;var h=a?(t[u]||[])[c]:t[s];h&&O7(e,h,u,c)}}}function P7(e,t){for(var r=t||{},n=In(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,Rx(e,16,r)),F7(n,e.Sheets[e.SheetNames[a]],a,r),ze(n,10),n.end()}function I7(e,t,r){ze(e,49,NR({sz:12,name:"Arial"},r))}function R7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,1054,kR(a,t[a],r))})}function j7(e,t){var r=Ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=Ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),D3(lr(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function M7(e,t){for(var r=0;r<16;++r)ze(e,224,Fw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ze(e,224,Fw(n,0,t))})}function L7(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ze(e,440,LR(n)),n[1].Tooltip&&ze(e,2048,BR(n))}delete t["!links"]}function B7(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ze(e,125,qR(Sh(a,n),a))})}}function U7(e,t,r,n,a){var i=16+ws(a.cellXfs,t,a);if(t.v==null&&!t.bf){ze(e,513,lo(r,n,i));return}if(t.bf)ze(e,6,cL(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?jn(_n(t.v)):t.v;ze(e,515,IR(r,n,s,i));break;case"b":case"e":ze(e,517,PR(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Ux(a.Strings,t.v,a.revStrings);ze(e,253,DR(r,n,o,i))}else ze(e,516,CR(r,n,(t.v||"").slice(0,255),i,a));break;default:ze(e,513,lo(r,n,i))}}function z7(e,t,r){var n=In(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),u=t.biff==8,c,h="",p=[],v=lr(i["!ref"]||"A1"),E=u?65536:16384;if(v.e.c>255||v.e.r>=E){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,E-1)}ze(n,2057,Rx(r,16,t)),ze(n,13,oa(1)),ze(n,12,oa(100)),ze(n,15,wn(!0)),ze(n,17,wn(!1)),ze(n,16,oo(.001)),ze(n,95,wn(!0)),ze(n,42,wn(!1)),ze(n,43,wn(!1)),ze(n,130,oa(1)),ze(n,128,FR()),ze(n,131,wn(!1)),ze(n,132,wn(!1)),u&&B7(n,i["!cols"]),ze(n,512,OR(v,t)),u&&(i["!links"]=[]);for(var g=v.s.r;g<=v.e.r;++g){h=rn(g);for(var w=v.s.c;w<=v.e.c;++w){g===v.s.r&&(p[w]=dn(w)),c=p[w]+h;var x=l?(i[g]||[])[w]:i[c];x&&(U7(n,x,g,w,t),u&&x.l&&i["!links"].push([c,x.l]))}}var y=o.CodeName||o.name||a;return u&&ze(n,574,AR((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&ze(n,229,MR(i["!merges"])),u&&L7(n,i),ze(n,442,N3(y)),u&&j7(n,i),ze(n,10),n.end()}function q7(e,t,r){var n=In(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(ze(n,2057,Rx(e,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,o?oa(1200):null),ze(n,193,hR(2)),l&&ze(n,191),l&&ze(n,192),ze(n,226),ze(n,92,ER("SheetJS",r)),ze(n,66,oa(o?1200:1252)),o&&ze(n,353,oa(0)),o&&ze(n,448),ze(n,317,WR(e.SheetNames.length)),o&&e.vbaraw&&ze(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";ze(n,442,N3(u))}ze(n,156,oa(17)),ze(n,25,wn(!1)),ze(n,18,wn(!1)),ze(n,19,oa(0)),o&&ze(n,431,wn(!1)),o&&ze(n,444,oa(0)),ze(n,61,SR()),ze(n,64,wn(!1)),ze(n,141,oa(0)),ze(n,34,wn(V9(e)=="true")),ze(n,14,wn(!0)),o&&ze(n,439,wn(!1)),ze(n,218,oa(0)),I7(n,e,r),R7(n,e.SSF,r),M7(n,r),o&&ze(n,352,wn(!1));var c=n.end(),h=In();o&&ze(h,140,UR()),o&&r.Strings&&D7(h,252,TR(r.Strings)),ze(h,10);var p=h.end(),v=In(),E=0,g=0;for(g=0;g<e.SheetNames.length;++g)E+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var w=c.length+E+p.length;for(g=0;g<e.SheetNames.length;++g){var x=i[g]||{};ze(v,133,_R({pos:w,hs:x.Hidden||0,dt:0,name:e.SheetNames[g]},r)),w+=t[g].length}var y=v.end();if(E!=y.length)throw new Error("BS8 "+E+" != "+y.length);var b=[];return c.length&&b.push(c),y.length&&b.push(y),p.length&&b.push(p),Jr(b)}function W7(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Mn(wr)),e&&e.SSF&&(wh(),yh(e.SSF),r.revssf=bh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,zx(r),r.cellXfs=[],ws(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=z7(a,r,e);return n.unshift(q7(e,n,r)),Jr(n)}function eA(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Jn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return W7(e,t);case 4:case 3:case 2:return P7(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function $7(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var c=Kt({r,c:s}),h=n.dense?(e[r]||[])[s]:e[c],p=h&&h.v!=null&&(h.h||bI(h.w||(Si(h),h.w)||""))||"",v={};o>1&&(v.rowspan=o),l>1&&(v.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(v["data-t"]=h&&h.t||"z",h.v!=null&&(v["data-v"]=h.v),h.z!=null&&(v["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),v.id=(n.id||"sjs")+"-"+c,i.push(Ue("td",p,v))}}var E="<tr>";return E+i.join("")+"</tr>"}var G7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',H7="</body></html>";function V7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function tA(e,t){var r=t||{},n=r.header!=null?r.header:G7,a=r.footer!=null?r.footer:H7,i=[n],s=Jn(e["!ref"]);r.dense=Array.isArray(e),i.push(V7(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push($7(e,s,o,r));return i.push("</table>"+a),i.join("")}function rA(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?zr(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var c=Jn(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),a==-1&&(u.e.r=a=c.e.r+1)}var h=[],p=0,v=e["!rows"]||(e["!rows"]=[]),E=0,g=0,w=0,x=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);E<o.length&&g<l;++E){var _=o[E];if(Bw(_)){if(n.display)continue;v[g]={hidden:!0}}var N=_.children;for(w=x=0;w<N.length;++w){var k=N[w];if(!(n.display&&Bw(k))){var T=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):SI(k.innerHTML),A=k.getAttribute("data-z")||k.getAttribute("z");for(p=0;p<h.length;++p){var S=h[p];S.s.c==x+i&&S.s.r<g+a&&g+a<=S.e.r&&(x=S.e.c+1-i,p=-1)}b=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+a,c:x+i},e:{r:g+a+(y||1)-1,c:x+i+(b||1)-1}});var P={t:"s",v:T},F=k.getAttribute("data-t")||k.getAttribute("t")||"";T!=null&&(T.length==0?P.t=F||"z":n.raw||T.trim().length==0||F=="s"||(T==="TRUE"?P={t:"b",v:!0}:T==="FALSE"?P={t:"b",v:!1}:isNaN(xi(T))?isNaN(jc(T).getDate())||(P={t:"d",v:_n(T)},n.cellDates||(P={t:"n",v:jn(P.v)}),P.z=n.dateNF||wr[14]):P={t:"n",v:xi(T)})),P.z===void 0&&A!=null&&(P.z=A);var U="",re=k.getElementsByTagName("A");if(re&&re.length)for(var le=0;le<re.length&&!(re[le].hasAttribute("href")&&(U=re[le].getAttribute("href"),U.charAt(0)!="#"));++le);U&&U.charAt(0)!="#"&&(P.l={Target:U}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][x+i]=P):e[Kt({c:x+i,r:g+a})]=P,u.e.c<x+i&&(u.e.c=x+i),x+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=Dr(u),g>=l&&(e["!fullref"]=Dr((u.e.r=o.length-E+g-1+a,u))),e}function nA(e,t){var r=t||{},n=r.dense?[]:{};return rA(n,e,t)}function Y7(e,t){return xo(nA(e,t),t)}function Bw(e){var t="",r=X7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function X7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var K7=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Cr+t}}(),Uw=function(){var e=function(i){return Vt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+Vt(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,h=Jn(i["!ref"]||"A1"),p=i["!merges"]||[],v=0,E=Array.isArray(i);if(i["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",w=i["!rows"]||[];for(u=0;u<h.s.r;++u)g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),c=0;c<h.s.c;++c)l.push(t);for(;c<=h.e.c;++c){var x=!1,y={},b="";for(v=0;v!=p.length;++v)if(!(p[v].s.c>c)&&!(p[v].s.r>u)&&!(p[v].e.c<c)&&!(p[v].e.r<u)){(p[v].s.c!=c||p[v].s.r!=u)&&(x=!0),y["table:number-columns-spanned"]=p[v].e.c-p[v].s.c+1,y["table:number-rows-spanned"]=p[v].e.r-p[v].s.r+1;break}if(x){l.push(r);continue}var _=Kt({r:u,c}),N=E?(i[u]||[])[c]:i[_];if(N&&N.f&&(y["table:formula"]=Vt(gL(N.f)),N.F&&N.F.slice(0,_.length)==_)){var k=Jn(N.F);y["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,y["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!N){l.push(t);continue}switch(N.t){case"b":b=N.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=N.v?"true":"false";break;case"n":b=N.w||String(N.v||0),y["office:value-type"]="float",y["office:value"]=N.v||0;break;case"s":case"str":b=N.v==null?"":N.v,y["office:value-type"]="string";break;case"d":b=N.w||_n(N.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=_n(N.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(b);if(N.l&&N.l.Target){var A=N.l.Target;A=A.charAt(0)=="#"?"#"+xL(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),T=Ue("text:a",T,{"xlink:href":A.replace(/&/g,"&amp;")})}l.push("          "+Ue("table:table-cell",Ue("text:p",T,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;jx(h),h.ods=o;var p=u["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Cr],u=Lc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=Lc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(v3().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function aA(e,t){if(t.bookType=="fods")return Uw(e,t);var r=Sx(),n="",a=[],i=[];return n="mimetype",Nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Nt(r,n,Uw(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Nt(r,n,K7(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Nt(r,n,Cr+v3()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Nt(r,n,lR(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Nt(r,n,sR(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function kd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Z7(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ka(Mc(e))}function Q7(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function hs(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function J7(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Bc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function $t(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function hl(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Or(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Bc(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Bc(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Yr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push($t(n*8+a.type)),a.type==2&&t.push($t(a.data.length)),t.push(a.data))})}),hs(t)}function Sa(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Bc(e,n),i=Or(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:hl(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Or(o.data),u=hl(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=hl(i[3][0].data)>>>0>0),r.push(s)}return r}function Fo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:$t(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$t(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:$t(s.data.length)}],n[2].push({data:Yr(s.meta),type:2})});var i=Yr(n);t.push($t(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),hs(t)}function eB(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Bc(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[hs(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var c=hs(a);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function Aa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(eB(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return hs(t)}function Po(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=$t(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return hs(t)}function tm(e,t){var r=new Uint8Array(32),n=kd(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,J7(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function rm(e,t){var r=new Uint8Array(32),n=kd(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Pi(e){var t=Or(e);return Bc(t[1][0].data)}function tB(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&hl(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=kd(e[7][0].data),c=0,h=[],p=kd(e[4][0].data),v=0,E=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,c,!0),p.setUint16(g*2,v,!0);var w,x;switch(typeof t[g]){case"string":w=tm({t:"s",v:t[g]},r),x=rm({t:"s",v:t[g]},r);break;case"number":w=tm({t:"n",v:t[g]},r),x=rm({t:"n",v:t[g]},r);break;case"boolean":w=tm({t:"b",v:t[g]},r),x=rm({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(w),c+=w.length,E.push(x),v+=x.length,++l}for(e[2][0].data=$t(l);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=hs(h),e[3][0].data=hs(E),l}function rB(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Jn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Dr(n)));var i=Od(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(se){return se.forEach(function(ee){typeof ee=="string"&&s.push(ee)})});var o={},l=[],u=Qt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(se,ee){return[se,u.FullPaths[ee]]}).forEach(function(se){var ee=se[0],C=se[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var R=ee.content,X=Aa(R),te=Sa(X);te.forEach(function(K){l.push(K.id),o[K.id]={deps:[],location:C,type:hl(K.messages[0].meta[1][0].data)}})}}),l.sort(function(se,ee){return se-ee});var c=l.filter(function(se){return se>1}).map(function(se){return[se,$t(se)]});u.FileIndex.map(function(se,ee){return[se,u.FullPaths[ee]]}).forEach(function(se){var ee=se[0];if(se[1],!!ee.name.match(/\.iwa/)){var C=Sa(Aa(ee.content));C.forEach(function(R){R.messages.forEach(function(X){c.forEach(function(te){R.messages.some(function(K){return hl(K.meta[1][0].data)!=11006&&Q7(K.data,te[1])})&&o[te[0]].deps.push(R.id)})})})}});for(var h=Qt.find(u,o[1].location),p=Sa(Aa(h.content)),v,E=0;E<p.length;++E){var g=p[E];g.id==1&&(v=g)}var w=Pi(Or(v.messages[0].data)[1][0].data);for(h=Qt.find(u,o[w].location),p=Sa(Aa(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(v=g);for(w=Pi(Or(v.messages[0].data)[2][0].data),h=Qt.find(u,o[w].location),p=Sa(Aa(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(v=g);for(w=Pi(Or(v.messages[0].data)[2][0].data),h=Qt.find(u,o[w].location),p=Sa(Aa(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(v=g);var x=Or(v.messages[0].data);{x[6][0].data=$t(n.e.r+1),x[7][0].data=$t(n.e.c+1);var y=Pi(x[46][0].data),b=Qt.find(u,o[y].location),_=Sa(Aa(b.content));{for(var N=0;N<_.length&&_[N].id!=y;++N);if(_[N].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=Or(_[N].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var T=0;T<=n.e.c;++T){var A=[];A[1]=A[2]=[{type:0,data:$t(T+420690)}],k[1].push({type:2,data:Yr(A)}),k[2].push({type:0,data:$t(T)}),k[3].push({type:0,data:$t(T)})}k[4]=[],k[5]=[],k[6]=[];for(var S=0;S<=n.e.r;++S)A=[],A[1]=A[2]=[{type:0,data:$t(S+726270)}],k[4].push({type:2,data:Yr(A)}),k[5].push({type:0,data:$t(S)}),k[6].push({type:0,data:$t(S)});_[N].messages[0].data=Yr(k)}b.content=Po(Fo(_)),b.size=b.content.length,delete x[46];var P=Or(x[4][0].data);{P[7][0].data=$t(n.e.r+1);var F=Or(P[1][0].data),U=Pi(F[2][0].data);b=Qt.find(u,o[U].location),_=Sa(Aa(b.content));{if(_[0].id!=U)throw"Bad HeaderStorageBucket";var re=Or(_[0].messages[0].data);for(S=0;S<i.length;++S){var le=Or(re[2][0].data);le[1][0].data=$t(S),le[4][0].data=$t(i[S].length),re[2][S]={type:re[2][0].type,data:Yr(le)}}_[0].messages[0].data=Yr(re)}b.content=Po(Fo(_)),b.size=b.content.length;var pe=Pi(P[2][0].data);b=Qt.find(u,o[pe].location),_=Sa(Aa(b.content));{if(_[0].id!=pe)throw"Bad HeaderStorageBucket";for(re=Or(_[0].messages[0].data),T=0;T<=n.e.c;++T)le=Or(re[2][0].data),le[1][0].data=$t(T),le[4][0].data=$t(n.e.r+1),re[2][T]={type:re[2][0].type,data:Yr(le)};_[0].messages[0].data=Yr(re)}b.content=Po(Fo(_)),b.size=b.content.length;var me=Pi(P[4][0].data);(function(){for(var se=Qt.find(u,o[me].location),ee=Sa(Aa(se.content)),C,R=0;R<ee.length;++R){var X=ee[R];X.id==me&&(C=X)}var te=Or(C.messages[0].data);{te[3]=[];var K=[];s.forEach(function(be,Te){K[1]=[{type:0,data:$t(Te)}],K[2]=[{type:0,data:$t(1)}],K[3]=[{type:2,data:Z7(be)}],te[3].push({type:2,data:Yr(K)})})}C.messages[0].data=Yr(te);var M=Fo(ee),Q=Po(M);se.content=Q,se.size=se.content.length})();var Ee=Or(P[3][0].data);{var fe=Ee[1][0];delete Ee[2];var de=Or(fe.data);{var Ce=Pi(de[2][0].data);(function(){for(var se=Qt.find(u,o[Ce].location),ee=Sa(Aa(se.content)),C,R=0;R<ee.length;++R){var X=ee[R];X.id==Ce&&(C=X)}var te=Or(C.messages[0].data);{delete te[6],delete Ee[7];var K=new Uint8Array(te[5][0].data);te[5]=[];for(var M=0,Q=0;Q<=n.e.r;++Q){var be=Or(K);M+=tB(be,i[Q],s),be[1][0].data=$t(Q),te[5].push({data:Yr(be),type:2})}te[1]=[{type:0,data:$t(n.e.c+1)}],te[2]=[{type:0,data:$t(n.e.r+1)}],te[3]=[{type:0,data:$t(M)}],te[4]=[{type:0,data:$t(n.e.r+1)}]}C.messages[0].data=Yr(te);var Te=Fo(ee),J=Po(Te);se.content=J,se.size=se.content.length})()}fe.data=Yr(de)}P[3][0].data=Yr(Ee)}x[4][0].data=Yr(P)}v.messages[0].data=Yr(x);var Ye=Fo(p),V=Po(Ye);return h.content=V,h.size=h.content.length,u}function nB(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function zx(e){nB([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function aB(e,t){return t.bookType=="ods"?aA(e,t):t.bookType=="numbers"?rB(e,t):t.bookType=="xlsb"?iB(e,t):sB(e,t)}function iB(e,t){Zo=1024,e&&!e.SSF&&(e.SSF=Mn(wr)),e&&e.SSF&&(wh(),yh(e.SSF),t.revssf=bh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=U3.indexOf(t.bookType)>-1,a=m3();zx(t=t||{});var i=Sx(),s="",o=0;if(t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Nt(i,s,y3(e.Props,t)),a.coreprops.push(s),Ht(t.rels,2,s,Ut.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Nt(i,s,b3(e.Props)),a.extprops.push(s),Ht(t.rels,3,s,Ut.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Nt(i,s,E3(e.Custprops)),a.custprops.push(s),Ht(t.rels,4,s,Ut.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Nt(i,s,l7(o-1,s,t,e,c)),a.sheets.push(s),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ut.WS[0])}if(h){var v=h["!comments"],E=!1,g="";v&&v.length>0&&(g="xl/comments"+o+"."+r,Nt(i,g,f7(v,g)),a.comments.push(g),Ht(c,-1,"../comments"+o+"."+r,Ut.CMNT),E=!0),h["!legacy"]&&E&&Nt(i,"xl/drawings/vmlDrawing"+o+".vml",L3(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&Nt(i,x3(s),fl(c))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Nt(i,s,c7(t.Strings,s,t)),a.strs.push(s),Ht(t.wbrels,-1,"sharedStrings."+r,Ut.SST)),s="xl/workbook."+r,Nt(i,s,o7(e,s)),a.workbooks.push(s),Ht(t.rels,1,s,Ut.WB),s="xl/theme/theme1.xml",Nt(i,s,j3(e.Themes,t)),a.themes.push(s),Ht(t.wbrels,-1,"theme/theme1.xml",Ut.THEME),s="xl/styles."+r,Nt(i,s,u7(e,s,t)),a.styles.push(s),Ht(t.wbrels,-1,"styles."+r,Ut.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Nt(i,s,e.vbaraw),a.vba.push(s),Ht(t.wbrels,-1,"vbaProject.bin",Ut.VBA)),s="xl/metadata."+r,Nt(i,s,d7(s)),a.metadata.push(s),Ht(t.wbrels,-1,"metadata."+r,Ut.XLMETA),Nt(i,"[Content_Types].xml",g3(a,t)),Nt(i,"_rels/.rels",fl(t.rels)),Nt(i,"xl/_rels/workbook."+r+".rels",fl(t.wbrels)),delete t.revssf,delete t.ssf,i}function sB(e,t){Zo=1024,e&&!e.SSF&&(e.SSF=Mn(wr)),e&&e.SSF&&(wh(),yh(e.SSF),t.revssf=bh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Hu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=U3.indexOf(t.bookType)>-1,a=m3();zx(t=t||{});var i=Sx(),s="",o=0;if(t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Nt(i,s,y3(e.Props,t)),a.coreprops.push(s),Ht(t.rels,2,s,Ut.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Nt(i,s,b3(e.Props)),a.extprops.push(s),Ht(t.rels,3,s,Ut.EXT_PROPS),e.Custprops!==e.Props&&an(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Nt(i,s,E3(e.Custprops)),a.custprops.push(s),Ht(t.rels,4,s,Ut.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Nt(i,s,X3(o-1,t,e,h)),a.sheets.push(s),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ut.WS[0])}if(p){var E=p["!comments"],g=!1,w="";if(E&&E.length>0){var x=!1;E.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(x=!0)})}),x&&(w="xl/threadedComments/threadedComment"+o+"."+r,Nt(i,w,Mj(E,c,t)),a.threadedcomments.push(w),Ht(h,-1,"../threadedComments/threadedComment"+o+"."+r,Ut.TCMNT)),w="xl/comments"+o+"."+r,Nt(i,w,B3(E)),a.comments.push(w),Ht(h,-1,"../comments"+o+"."+r,Ut.CMNT),g=!0}p["!legacy"]&&g&&Nt(i,"xl/drawings/vmlDrawing"+o+".vml",L3(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Nt(i,x3(s),fl(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Nt(i,s,k3(t.Strings,t)),a.strs.push(s),Ht(t.wbrels,-1,"sharedStrings."+r,Ut.SST)),s="xl/workbook."+r,Nt(i,s,Q3(e)),a.workbooks.push(s),Ht(t.rels,1,s,Ut.WB),s="xl/theme/theme1.xml",Nt(i,s,j3(e.Themes,t)),a.themes.push(s),Ht(t.wbrels,-1,"theme/theme1.xml",Ut.THEME),s="xl/styles."+r,Nt(i,s,I3(e,t)),a.styles.push(s),Ht(t.wbrels,-1,"styles."+r,Ut.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Nt(i,s,e.vbaraw),a.vba.push(s),Ht(t.wbrels,-1,"vbaProject.bin",Ut.VBA)),s="xl/metadata."+r,Nt(i,s,M3()),a.metadata.push(s),Ht(t.wbrels,-1,"metadata."+r,Ut.XLMETA),c.length>1&&(s="xl/persons/person.xml",Nt(i,s,Lj(c)),a.people.push(s),Ht(t.wbrels,-1,"persons/person.xml",Ut.PEOPLE)),Nt(i,"[Content_Types].xml",g3(a,t)),Nt(i,"_rels/.rels",fl(t.rels)),Nt(i,"xl/_rels/workbook."+r+".rels",fl(t.wbrels)),delete t.revssf,delete t.ssf,i}function oB(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ti(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function iA(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return sf(t.file,Qt.write(e,{type:qt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Qt.write(e,t)}function lB(e,t){var r=Mn(t||{}),n=aB(e,r);return uB(n,r)}function uB(e,t){var r={},n=qt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Qt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(vh(a))}return t.password&&typeof encrypt_agile<"u"?iA(encrypt_agile(a,t.password),t):t.type==="file"?sf(t.file,a):t.type=="string"?qu(a):a}function cB(e,t){var r=t||{},n=A7(e,r);return iA(n,r)}function $a(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Rc(Mc(n));case"binary":return Mc(n);case"string":return e;case"file":return sf(t.file,n,"utf8");case"buffer":return qt?Ni(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$a(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fB(e,t){switch(t.type){case"base64":return Rc(e);case"binary":return e;case"string":return e;case"file":return sf(t.file,e,"binary");case"buffer":return qt?Ni(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function u0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Rc(r):t.type=="string"?qu(r):r;case"file":return sf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sA(e,t){BP(),K9(e);var r=Mn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=sA(e,r);return r.type="array",vh(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $a(T7(e,r),r);case"slk":case"sylk":return $a(VR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return $a(tA(e.Sheets[e.SheetNames[a]],r),r);case"txt":return fB(oA(e.Sheets[e.SheetNames[a]],r),r);case"csv":return $a(qx(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return $a(YR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return u0(HR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return $a(XR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return $a(rj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return $a(C3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return $a(aA(e,r),r);case"wk1":return u0(Pw.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return u0(Pw.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),u0(eA(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),cB(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lB(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dB(e,t,r,n,a,i,s,o){var l=rn(r),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var E=s?e[r][v]:e[n[v]+l];if(E===void 0||E.t===void 0){if(u===void 0)continue;i[v]!=null&&(p[i[v]]=u);continue}var g=E.v;switch(E.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[v]!=null){if(g==null)if(E.t=="e"&&g===null)p[i[v]]=null;else if(u!==void 0)p[i[v]]=u;else if(c&&g===null)p[i[v]]=null;else continue;else p[i[v]]=c&&(E.t!=="n"||E.t==="n"&&o.rawNumbers!==!1)?g:Si(E,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function Od(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=lr(c);break;case"number":l=lr(e["!ref"]),l.s.r=c;break;default:l=c}n>0&&(a=0);var h=rn(l.s.r),p=[],v=[],E=0,g=0,w=Array.isArray(e),x=l.s.r,y=0,b={};w&&!e[x]&&(e[x]=[]);var _=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(_[y]||{}).hidden)switch(p[y]=dn(y),r=w?e[x][y]:e[p[y]+h],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=p[y];break;case 3:i[y]=u.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Si(r,null,u),g=b[s]||0,!g)b[s]=1;else{do o=s+"_"+g++;while(b[o]);b[s]=g,b[o]=1}i[y]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(N[x]||{}).hidden){var k=dB(e,l,x,p,n,i,w,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(v[E++]=k.row)}return v.length=E,v}var zw=/"/g;function hB(e,t,r,n,a,i,s,o){for(var l=!0,u=[],c="",h=rn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var v=o.dense?(e[r]||[])[p]:e[n[p]+h];if(v==null)c="";else if(v.v!=null){l=!1,c=""+(o.rawNumbers&&v.t=="n"?v.v:Si(v,null,o));for(var E=0,g=0;E!==c.length;++E)if((g=c.charCodeAt(E))===a||g===i||g===34||o.forceQuotes){c='"'+c.replace(zw,'""')+'"';break}c=="ID"&&(c='"ID"')}else v.f!=null&&!v.F?(l=!1,c="="+v.f,c.indexOf(",")>=0&&(c='"'+c.replace(zw,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(s)}function qx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=lr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),c="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(p[E]||{}).hidden||(h[E]=dn(E));for(var g=0,w=a.s.r;w<=a.e.r;++w)(v[w]||{}).hidden||(c=hB(e,a,w,h,s,l,i,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((g++?o:"")+c)));return delete n.dense,r.join("")}function oA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=qx(e,t);return r}function pB(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=lr(e["!ref"]),i="",s=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=dn(o);for(var c=a.s.r;c<=a.e.r;++c)for(i=rn(c),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[c]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function lA(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?zr(n.origin):n.origin;s=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var h=lr(i["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),s==-1&&(s=h.e.r+1,c.e.r=s+t.length-1+a)}else s==-1&&(s=0,c.e.r=t.length-1+a);var p=n.header||[],v=0;t.forEach(function(g,w){an(g).forEach(function(x){(v=p.indexOf(x))==-1&&(p[v=p.length]=x);var y=g[x],b="z",_="",N=Kt({c:o+v,r:s+w+a});u=Uc(i,N),y&&typeof y=="object"&&!(y instanceof Date)?i[N]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=jn(y)),_=n.dateNF||wr[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,_&&(u.z=_)):i[N]=u={t:b,v:y},_&&(u.z=_))})}),c.e.c=Math.max(c.e.c,o+p.length-1);var E=rn(s);if(a)for(v=0;v<p.length;++v)i[dn(v+o)+E]={t:"s",v:p[v]};return i["!ref"]=Dr(c),i}function mB(e,t){return lA(null,e,t)}function Uc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Uc(e,Kt(t)):Uc(e,Kt({r:t,c:r||0}))}function gB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function xB(){return{SheetNames:[],Sheets:{}}}function vB(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(Z3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=gB(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function wB(e,t){return e.z=t,e}function uA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function bB(e,t,r){return uA(e,"#"+t,r)}function EB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _B(e,t,r,n){for(var a=typeof t!="string"?t:lr(t),i=typeof t=="string"?t:Dr(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=Uc(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var du={encode_col:dn,encode_row:rn,encode_cell:Kt,encode_range:Dr,decode_col:Ox,decode_row:kx,split_cell:BI,decode_cell:zr,decode_range:Jn,format_cell:Si,sheet_add_aoa:u3,sheet_add_json:lA,sheet_add_dom:rA,aoa_to_sheet:zl,json_to_sheet:mB,table_to_sheet:nA,table_to_book:Y7,sheet_to_csv:qx,sheet_to_txt:oA,sheet_to_json:Od,sheet_to_html:tA,sheet_to_formulae:pB,sheet_to_row_object_array:Od,sheet_get_cell:Uc,book_new:xB,book_append_sheet:vB,book_set_sheet_visibility:yB,cell_set_number_format:wB,cell_set_hyperlink:uA,cell_set_internal_link:bB,cell_add_comment:EB,sheet_set_array_formula:_B,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function cA(){return{settings:Qr(()=>Se.settings.get(1)),updateSettings:async n=>{await Se.settings.update(1,n)},resetYearlySequence:async()=>{await M_()}}}const Fd=1e5,qw=5e4,Ww=2e6,TB=16,SB=12,AB=256;function NB(e){if(e==null)return Fd;if(typeof e!="number"||!Number.isFinite(e)||!Number.isInteger(e))throw new Error("Invalid backup format: iterations must be a valid integer.");if(e<qw||e>Ww)throw new Error(`Invalid backup format: iterations must be between ${qw} and ${Ww}.`);return e}function DB(e){return new TextEncoder().encode(e)}function CB(e){return new TextDecoder().decode(e)}function nm(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);let r="";const n=t.byteLength,a=8192;for(let i=0;i<n;i+=a)r+=String.fromCharCode.apply(null,t.subarray(i,i+a));return window.btoa(r)}function am(e){const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}async function fA(e,t,r=Fd){const n=new TextEncoder,a=await window.crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:r,hash:"SHA-256"},a,{name:"AES-GCM",length:AB},!1,["encrypt","decrypt"])}async function kB(e,t){const r=JSON.stringify(e),n=DB(r),a=window.crypto.getRandomValues(new Uint8Array(TB)),i=window.crypto.getRandomValues(new Uint8Array(SB)),s=await fA(t,a,Fd),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},s,n);return{version:1,kdf:"PBKDF2-SHA256",salt:nm(a),iv:nm(i),ciphertext:nm(o),iterations:Fd}}async function OB(e,t){try{const r=am(e.salt),n=am(e.iv),a=am(e.ciphertext),i=NB(e.iterations),s=await fA(t,r,i),o=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:n},s,a),l=CB(o);return JSON.parse(l)}catch(r){throw console.error("Decryption failed:",r),new Error("Decryption failed. Wrong password or corrupted file.")}}function FB(e){return typeof e=="object"&&e!==null&&"ciphertext"in e&&"salt"in e&&"iv"in e&&"version"in e}const Eu=2;function PB(e){console.log("Migrating Backup: v1 -> v2");const t=e.participants.map(n=>{const a={...n};return delete a.groupNumber,delete a.autoGroup,delete a.manualGroup,a}),r=e.groups.map(n=>{const a={...n};return a.status==="planned"&&(a.groupNumber=null),a});return{...e,version:2,participants:t,groups:r}}function IB(e){let t=e.version||1,r=e;if(console.log(`Starting Import. Backup Version: ${t}. Current App Version: ${Eu}`),!r||typeof r!="object")throw new Error("Invalid backup file: data is not an object.");if(t>Eu)throw new Error(`Backup version ${t} is newer than this app version (${Eu}). Please update the app to import this file.`);for(;t<Eu;)try{switch(t){case 1:r=PB(r),t=2;break;default:throw new Error(`No migration strategy found for version ${t}`)}}catch(n){throw console.error(`Migration failed at step v${t}:`,n),new Error(`Migration failed: Could not upgrade backup from v${t} to v${t+1}`)}if(!Array.isArray(r.participants)||!Array.isArray(r.groups))throw new Error("Migration finished but result is malformed (missing arrays).");return r}const RB=({isOpen:e,mode:t,onConfirm:r,onCancel:n,error:a,isProcessing:i=!1})=>{const{t:s}=Tr(),[o,l]=_e.useState(""),[u,c]=_e.useState(!1);return e?f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:f.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full overflow-hidden animate-in fade-in zoom-in duration-200",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4 text-slate-800",children:[f.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:f.jsx(th,{className:"w-6 h-6 text-blue-600"})}),f.jsx("h3",{className:"text-xl font-bold",children:s(t==="export"?"crypto.exportTitle":"crypto.importTitle")})]}),f.jsx("p",{className:"text-slate-600 mb-6",children:s(t==="export"?"crypto.exportDescription":"crypto.importDescription")}),f.jsxs("form",{onSubmit:h=>{h.preventDefault(),o&&r(o)},className:"space-y-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:u?"text":"password",value:o,onChange:h=>l(h.target.value),placeholder:s("crypto.passwordPlaceholder"),className:"w-full px-4 py-3 pr-12 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0,disabled:i}),f.jsx("button",{type:"button",onClick:()=>c(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",tabIndex:-1,children:u?f.jsx(nk,{size:20}):f.jsx(Ag,{size:20})})]}),a&&f.jsxs("div",{className:"p-3 bg-red-50 text-red-600 text-sm rounded-lg flex items-center gap-2 animate-pulse",children:[f.jsx("span",{children:""})," ",a]}),f.jsxs("div",{className:"flex gap-3 pt-2",children:[f.jsx("button",{type:"button",onClick:n,disabled:i,className:"flex-1 px-4 py-2 text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium transition-colors",children:s("common.cancel")}),f.jsxs("button",{type:"submit",disabled:!o||i,className:"flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg font-bold shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2",children:[i&&f.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),s(t==="export"?"crypto.encryptAndExport":"crypto.decryptAndImport")]})]})]})]})})}):null};function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pd.apply(this,arguments)}function jB(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var MB=["cdnSuffix","cdnUrl","countryCode","style","svg"],LB="https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/",BB="svg",UB=127397,$w=function(t){var r=t.cdnSuffix,n=r===void 0?BB:r,a=t.cdnUrl,i=a===void 0?LB:a,s=t.countryCode,o=t.style,l=t.svg,u=l===void 0?!1:l,c=jB(t,MB);if(typeof s!="string")return null;if(u){var h=""+i+s.toLowerCase()+"."+n;return _e.createElement("img",Object.assign({},c,{src:h,style:Pd({display:"inline-block",width:"1em",height:"1em",verticalAlign:"middle"},o)}))}var p=s.toUpperCase().replace(/./g,function(v){return String.fromCodePoint(v.charCodeAt(0)+UB)});return _e.createElement("span",Object.assign({role:"img"},c,{style:Pd({display:"inline-block",fontSize:"1em",lineHeight:"1em",verticalAlign:"middle"},o)}),p)};const zB=({filteredParticipants:e})=>{var Dt;const{settings:t}=cA(),{language:r,setLanguage:n,t:a}=Tr(),[i,s]=_e.useState(!1),[o,l]=_e.useState(!1),[u,c]=_e.useState(null),[h,p]=_e.useState(null),v=(ke,Re,$e="info")=>{c({isOpen:!0,title:ke,message:Re,variant:$e})},E=(ke,Re,$e,dt="info",xe)=>{p({isOpen:!0,title:ke,message:Re,onConfirm:$e,variant:dt,confirmText:a("common.confirm")})},[g,w]=_e.useState(!1),[x,y]=_e.useState(""),[b,_]=_e.useState(0),[N,k]=_e.useState(null),[T,A]=_e.useState(!1),[S,P]=_e.useState(!1),[F,U]=_e.useState(""),[re,le]=_e.useState(!1),[pe,me]=_e.useState(null),[Ee,fe]=_e.useState({isOpen:!1,mode:"export",isProcessing:!1}),[de,Ce]=_e.useState(null),[Ye,V]=_e.useState(Bs()),[se,ee]=_e.useState(!1),[C,R]=_e.useState({date:"",status:"planned"}),X=()=>{Ce(null),V(Bs()),de==="setup"?v(a("common.success"),a("security.setupSuccess"),"success"):de==="disable"&&v(a("common.success"),a("security.disableSuccess"),"info")},te=Qr(()=>da(),[]),K=Qr(()=>U_(),[b]),M=Qr(()=>q_(),[b]),Q=Qr(()=>Se.participants.toArray(),[]),be=Qr(()=>Se.yearlyArchives.toArray(),[]),Te=ke=>a(ke===1?"group.participant_one":"group.participant_other"),J=async(ke,Re)=>{try{console.log("Validating and migrating backup...");const $e=IB(ke);if(!$e.groups||!$e.participants||!Array.isArray($e.groups)||!Array.isArray($e.participants))throw new Error("Invalid backup format after migration: missing groups or participants arrays");Re==="replace"?await Se.transaction("rw",[Se.participants,Se.groups,Se.settings],async()=>{await Se.participants.clear(),await Se.groups.clear(),$e.groups.length>0&&await Se.groups.bulkAdd($e.groups),$e.participants.length>0&&await Se.participants.bulkAdd($e.participants),$e.settings&&await Se.settings.update(1,$e.settings)}):await Se.transaction("rw",[Se.participants,Se.groups,Se.settings],async()=>{$e.groups.length>0&&await Se.groups.bulkPut($e.groups);for(const dt of $e.participants)if(await Se.participants.get(dt.id))await Se.participants.update(dt.id,dt);else{let ve=dt.uniqueNumber,ae=0;for(;!await vc(ve)&&ae<1e3;){const ue=await Se.settings.get(1);if(ue){const Me=ue.lastUniquePrefix+1,je=ue.lastUniqueSeq+1;ve=`${Me.toString().padStart(4,"0")}-${je.toString().padStart(3,"0")}`,await Se.settings.update(1,{lastUniquePrefix:Me,lastUniqueSeq:je})}ae++}await Se.participants.add({...dt,uniqueNumber:ve})}}),v(a("common.success"),a("import.success",{participants:String($e.participants.length),groups:String($e.groups.length)}),"success")}catch($e){console.error("Import processing failed:",$e),v(a("common.error"),`Failed to import: ${$e.message}`,"error")}finally{s(!1),fe($e=>({...$e,isOpen:!1,isProcessing:!1,pendingEncryptedData:null,pendingFile:null}))}},I=()=>{fe({isOpen:!0,mode:"export",isProcessing:!1})},j=async ke=>{fe(Re=>({...Re,isProcessing:!0,error:void 0}));try{const Re=await Se.participants.toArray(),$e=await Se.groups.toArray(),dt=await Se.settings.get(1),xe={version:Eu.toString(),timestamp:new Date().toISOString(),participants:Re,groups:$e,settings:dt},ve=await kB(xe,ke),ae=new Blob([JSON.stringify(ve,null,2)],{type:"application/json"}),ue=`course-backup-secure-${new Date().toISOString().split("T")[0]}.json`;await O0(ae,ue),fe(Me=>({...Me,isOpen:!1}))}catch(Re){console.error("Secure export failed:",Re),fe($e=>({...$e,error:"Encryption failed. Please try again."}))}finally{fe(Re=>({...Re,isProcessing:!1}))}},Y=async(ke,Re)=>{const $e=async()=>{s(!0);try{const dt=await ke.text(),xe=JSON.parse(dt);FB(xe)||xe&&typeof xe=="object"&&"ciphertext"in xe&&"salt"in xe?(fe({isOpen:!0,mode:"import",isProcessing:!1,pendingEncryptedData:xe,importMode:Re,pendingFile:ke}),s(!1)):await J(xe,Re)}catch(dt){console.error("File parsing failed:",dt),v(a("common.error"),"Invalid file format. Please upload a valid backup JSON.","error"),s(!1)}};Re==="replace"?E(a("common.warning"),a("tools.importReplaceWarning"),$e,"danger"):$e()},oe=async ke=>{if(!(!Ee.pendingEncryptedData||!Ee.importMode)){fe(Re=>({...Re,isProcessing:!0,error:void 0})),s(!0);try{const Re=await OB(Ee.pendingEncryptedData,ke);await J(Re,Ee.importMode)}catch(Re){console.error("Decryption failed:",Re),fe($e=>({...$e,isProcessing:!1,error:a("crypto.invalidPassword")})),s(!1)}}},Ze=async()=>{try{const ke=await Se.groups.toArray(),Re=e.length>0?e:await Se.participants.toArray(),$e=new Map,dt=new Map;ke.forEach(Ke=>{$e.set(Ke.courseStartDate,Ke.status),dt.set(Ke.courseStartDate,Ke.groupNumber)});const xe=[],ve=[],ae=[],ue=[],Me=Ke=>({"Company Name":Ke.companyName,"Person Name":Ke.personName,"Medical Date":at(Ke.medicalDate),"Course Start":at(Ke.courseStartDate),"Course End":at(Ke.courseEndDate),"Group No":dt.get(Ke.courseStartDate)||"","Unique Number":Ke.uniqueNumber,Sent:Ke.sent?"Yes":"No",Documents:Ke.documents?"Yes":"No","Handed Over":Ke.handedOver?"Yes":"No",Paid:Ke.paid?"Yes":"No",Completed:(Ke.completedOverride!==null?Ke.completedOverride:Ke.completedComputed)?"Yes":"No"});Re.forEach(Ke=>{const wt=$e.get(Ke.courseStartDate),lt=Me(Ke);wt==="active"?xe.push(lt):wt==="planned"?ve.push(lt):wt==="completed"?ae.push(lt):ue.push(lt)});const je=du.book_new(),et=(Ke,wt,lt)=>{if(Ke.length===0)return;lt&&Ke.sort(lt);const kr=du.json_to_sheet(Ke),Nn=Object.keys(Ke[0]||{}).map(ra=>({wch:Math.max(ra.length,15)}));kr["!cols"]=Nn,du.book_append_sheet(je,kr,wt)};if(et(xe,"Active Groups",(Ke,wt)=>(Ke["Unique Number"]||"").localeCompare(wt["Unique Number"]||"")),et(ve,"Planned Groups",(Ke,wt)=>Ke["Course Start"].localeCompare(wt["Course Start"])),et(ae,"Archived Groups",(Ke,wt)=>(wt["Group No"]||0)-(Ke["Group No"]||0)),et(ue,"Other"),je.SheetNames.length===0){const Ke=du.json_to_sheet([{Info:"No data found to export"}]);du.book_append_sheet(je,Ke,"Empty")}const it=sA(je,{bookType:"xlsx",type:"array"}),St=new Blob([it],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),It=`course-export-${new Date().toISOString().split("T")[0]}.xlsx`;await O0(St,It)}catch(ke){console.error("Excel export failed:",ke),v(a("common.error"),"Failed to export Excel file","error")}},Ge=async()=>{try{const ke=["Company Name","Person Name","Medical Date","Course Start Date","Course End Date","Group Number","Unique Number","Sent","Documents","Handed Over","Paid","Completed"],Re=e.length>0?await Se.groups.toArray():[],$e=new Map(Re.map(ue=>[ue.courseStartDate,ue.groupNumber])),dt=e.map(ue=>[ue.companyName,ue.personName,at(ue.medicalDate),at(ue.courseStartDate),at(ue.courseEndDate),$e.get(ue.courseStartDate)||"",ue.uniqueNumber,ue.sent?"Yes":"No",ue.documents?"Yes":"No",ue.handedOver?"Yes":"No",ue.paid?"Yes":"No",(ue.completedOverride!==null?ue.completedOverride:ue.completedComputed)?"Yes":"No"]),xe=[ke.join(","),...dt.map(ue=>ue.map(Me=>`"${Me}"`).join(","))].join(`
`),ve=new Blob([xe],{type:"text/csv"}),ae=`course-export-${new Date().toISOString().split("T")[0]}.csv`;await O0(ve,ae)}catch(ke){console.error("CSV export failed:",ke),v(a("common.error"),"Failed to export CSV file","error")}},xt=async(ke,Re)=>{try{const $e=`archive-${ke}`,dt=await Se.yearlyArchives.get($e);if(!dt){v(a("common.error"),a("tools.restoreGroupNotFound"),"error");return}const xe=dt.groups.find(je=>je.groupNumber===Re);if(!xe){v(a("common.error"),a("tools.restoreGroupGroupNotFound"),"error");return}const ve=dt.participants.filter(je=>je.courseStartDate===xe.courseStartDate);if(await Se.groups.where("groupNumber").equals(Re).first()){v(a("common.error"),a("tools.restoreGroupExists",{number:Re.toString()}),"error");return}await Se.groups.add({...xe,updatedAt:new Date().toISOString()});for(const je of ve)await Se.participants.add(je);const ue=dt.groups.filter(je=>je.groupNumber!==Re),Me=dt.participants.filter(je=>je.courseStartDate!==xe.courseStartDate);ue.length===0?await Se.yearlyArchives.delete($e):await Se.yearlyArchives.update($e,{groups:ue,participants:Me}),v(a("common.success"),a("tools.restoreGroupSuccess",{number:Re.toString()}),"success"),me(null)}catch($e){console.error("Restore failed:",$e),v(a("common.error"),a("tools.restoreGroupError",{error:$e.message}),"error")}},rt=async()=>{try{const ke=new Date().getFullYear(),Re=await Se.groups.toArray(),$e=await Se.participants.toArray(),dt=Re.some(et=>et.status==="active"),xe=Re.some(et=>et.status==="planned");if(dt||xe){v(a("common.warning"),a("tools.archiveGuardFail"),"warning"),P(!1),U("");return}const ve=Re.filter(et=>et.status!=="completed"?!1:new Date(et.courseStartDate).getFullYear()===ke);if(ve.length===0){v(a("common.info"),a("archive.noGroupsToArchive"),"info"),P(!1),U("");return}const ae=new Set(ve.map(et=>et.courseStartDate)),ue=$e.filter(et=>ae.has(et.courseStartDate)),Me=`archive-${ke}`;await Se.yearlyArchives.put({id:Me,year:ke,groups:ve,participants:ue,archivedAt:new Date().toISOString()}),await Se.groups.bulkDelete(ve.map(et=>et.id)),await Se.participants.bulkDelete(ue.map(et=>et.id));const je=await Se.settings.get(1);je&&await Se.settings.update(1,{lastUniquePrefix:je.lastUniquePrefix+1,lastUniqueSeq:0,lastResetYear:ke}),v(a("common.success"),a("tools.archiveYearSuccess",{count:ve.length.toString()}),"success"),P(!1),U("")}catch(ke){console.error("Archive failed:",ke),v(a("common.error"),a("archive.error"),"error")}},zt=async ke=>{try{const Re=await W_(ke);if(Re.needsConfirm&&Re.currentActive){const $e=await Se.groups.get(ke);$e&&k({type:"makeActive",groupId:ke,groupNumber:$e.groupNumber,currentActive:Re.currentActive})}else if(Re.success){_(dt=>dt+1);const $e=await Se.groups.get(ke);$e&&v(a("common.success"),a("tools.makeActiveSuccess",{number:$e.groupNumber?$e.groupNumber.toString():"Active"}),"success")}}catch(Re){v(a("common.error"),`${a("common.error")}: ${Re.message}`,"error")}},ft=async ke=>{try{const Re=await G_(ke);if(Re.needsConfirm&&Re.currentActive){const $e=await Se.groups.get(ke);$e&&k({type:"reopen",groupId:ke,groupNumber:$e.groupNumber,currentActive:Re.currentActive})}else Re.success&&(_($e=>$e+1),v(a("common.success"),a("tools.reopenSuccess"),"success"))}catch(Re){v(a("common.error"),`${a("common.error")}: ${Re.message}`,"error")}},ht=async()=>{if(N)try{const ke=N.currentActive.groupNumber,Re=N.groupNumber;await Qd(N.groupId,!0),k(null),_($e=>$e+1),v(a("common.success"),a("tools.makeActiveWithSwapSuccess",{new:(Re==null?void 0:Re.toString())||"Active",old:(ke==null?void 0:ke.toString())||"Active"}),"success")}catch(ke){v(a("common.error"),`${a("common.error")}: ${ke.message}`,"error")}},kt=async()=>{E(a("tools.returnToPlanned"),a("tools.returnToPlannedConfirm"),async()=>{try{await $_(),_(ke=>ke+1),v(a("common.success"),a("tools.returnToPlannedSuccess"),"success")}catch(ke){v(a("common.error"),`${a("common.error")}: ${ke.message}`,"error")}},"warning")},Tt=async()=>{try{if(!C.date){v(a("common.error"),a("tools.createGroupSelectDate"),"error");return}if(new Date(C.date).getDay()!==1){v(a("common.error"),a("tools.createGroupMustBeMonday"),"error");return}const Re=await Se.groups.where("courseStartDate").equals(C.date).first();if(Re){const xe=Re.status==="active"?a("tools.createGroupExistsActive"):Re.status==="planned"?a("tools.createGroupExistsPlanned"):a("tools.createGroupExistsCompleted");v(a("common.error"),xe.replace("{date}",at(C.date)),"error");return}if(C.status==="active"&&await da()){v(a("common.warning"),a("tools.createGroupActiveExists"),"warning");return}if(C.status==="planned"){const xe=await da();if(xe&&C.date<xe.courseStartDate){v(a("common.warning"),a("tools.createGroupBeforeActive"),"warning");return}}const{createGroup:$e}=await Pn(async()=>{const{createGroup:xe}=await Promise.resolve().then(()=>Y1);return{createGroup:xe}},void 0);await $e(C.date,C.status),ee(!1),R({date:"",status:"planned"}),_(xe=>xe+1);const dt=C.status==="active"?a("tools.groupActive"):a("tools.groupPlanned");v(a("common.success"),a("tools.createGroupSuccess",{status:dt,date:at(C.date)}),"success")}catch(ke){console.error("Failed to create group:",ke),v(a("common.error"),a("tools.createGroupFailed",{error:ke.message}),"error")}};return f.jsxs("div",{className:"space-y-6 pb-24 md:pb-6",children:[f.jsx(RB,{isOpen:Ee.isOpen,mode:Ee.mode,isProcessing:Ee.isProcessing,error:Ee.error,onCancel:()=>fe(ke=>({...ke,isOpen:!1})),onConfirm:ke=>{Ee.mode==="export"?j(ke):oe(ke)}}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:a("tools.language")}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{onClick:()=>n("en"),className:`flex-1 px-6 py-3 rounded-lg font-medium min-h-[48px] transition-colors duration-150 flex items-center justify-center gap-3 ${r==="en"?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx($w,{countryCode:"GB",svg:!0,style:{width:"2em",height:"1.5em",borderRadius:"4px"}}),"English"]}),f.jsxs("button",{onClick:()=>n("bg"),className:`flex-1 px-6 py-3 rounded-lg font-medium min-h-[48px] transition-colors duration-150 flex items-center justify-center gap-3 ${r==="bg"?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx($w,{countryCode:"BG",svg:!0,style:{width:"2em",height:"1.5em",borderRadius:"4px"}}),""]})]})]}),te&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-blue-400",children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Tg,{className:"w-5 h-5 text-blue-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-blue-700",children:a("tools.activeGroup")})]}),f.jsx("p",{className:"text-sm text-blue-600 mt-0.5",children:a("tools.activeGroupSubtitle")})]}),f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:f.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.groupNumber"),":"]})," ",te.groupNumber||f.jsx("span",{className:"italic text-slate-500",children:a("tools.pendingAssignedOnClose")})]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.courseStart"),":"]})," ",at(te.courseStartDate)]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.courseEnd"),":"]})," ",at(te.courseEndDate)]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("label",{className:"flex items-start gap-3 cursor-pointer min-h-[44px]",children:[f.jsx("input",{type:"checkbox",checked:g,onChange:ke=>w(ke.target.checked),className:"mt-1 w-5 h-5 text-blue-600 rounded border-slate-300 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-slate-700 flex-1",children:a("tools.closeGroupDescription")})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Type ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:te.groupNumber?`CLOSE-${te.groupNumber}`:"CLOSE"})," to confirm:"]}),f.jsx("input",{type:"text",value:x,onChange:ke=>y(ke.target.value),placeholder:te.groupNumber?`CLOSE-${te.groupNumber}`:"CLOSE",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",disabled:!g})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("button",{onClick:kt,className:"px-6 py-4 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-bold min-h-[48px] transition-colors duration-150",children:[" ",a("tools.returnToPlanned")]}),f.jsxs("button",{onClick:async()=>{try{await z_(),w(!1),y(""),_(ke=>ke+1),v(a("common.success"),a("tools.closeActiveSuccess"),"success")}catch(ke){console.error("Failed to close active group:",ke),v(a("common.error"),`${a("common.error")}: ${ke.message}`,"error")}},disabled:!g||x!==(te.groupNumber?`CLOSE-${te.groupNumber}`:"CLOSE"),className:"px-6 py-4 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold min-h-[48px] transition-colors duration-150",children:[" ",a("tools.archiveGroup")]})]})]})]}),N&&f.jsx(ts,{isOpen:!0,title:a("tools.changeActiveGroup"),message:a("tools.changeActiveGroupMessage",{current:(N.currentActive.groupNumber||"Active").toString(),new:(N.groupNumber||"Active").toString()}),confirmText:a("tools.changeActiveGroupConfirm"),cancelText:a("common.cancel"),onConfirm:ht,onClose:()=>k(null)}),se&&f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-md w-full p-6 space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:a("tools.createNewGroup")}),f.jsx("button",{onClick:()=>{ee(!1),R({date:"",status:"planned"})},className:"text-slate-400 hover:text-slate-600 transition-colors",children:f.jsx(Q1,{className:"w-6 h-6"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:a("tools.courseStartDateMonday")}),f.jsx("input",{type:"date",value:C.date,onChange:ke=>R(Re=>({...Re,date:ke.target.value})),className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:a("tools.groupStatus")}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("button",{onClick:()=>R(ke=>({...ke,status:"planned"})),className:`px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ${C.status==="planned"?"bg-amber-600 text-white ring-2 ring-amber-300":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx(Sg,{className:"w-5 h-5",strokeWidth:2}),a("tools.groupPlanned")]}),f.jsxs("button",{onClick:()=>R(ke=>({...ke,status:"active"})),className:`px-4 py-3 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ${C.status==="active"?"bg-green-600 text-white ring-2 ring-green-300":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx(Tg,{className:"w-5 h-5",strokeWidth:2}),a("tools.groupActive")]})]})]}),C.status==="active"&&te&&f.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm text-amber-800",children:[f.jsx(El,{className:"w-4 h-4 inline mr-1"}),a("tools.createGroupActiveWarning")]})]}),f.jsxs("div",{className:"flex gap-3 pt-2",children:[f.jsx("button",{onClick:()=>{ee(!1),R({date:"",status:"planned"})},className:"flex-1 px-4 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 font-medium transition-colors",children:a("common.cancel")}),f.jsx("button",{onClick:Tt,disabled:!C.date,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors",children:a("tools.createGroup")})]})]})}),f.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg shadow-sm border-2 border-blue-200",children:f.jsxs("div",{className:"flex items-start justify-between gap-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(yu,{className:"w-5 h-5 text-blue-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-blue-700",children:a("tools.manualGroupCreation")})]}),f.jsx("p",{className:"text-sm text-blue-600",children:a("tools.manualGroupCreationSubtitle")})]}),f.jsxs("button",{onClick:()=>ee(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-lg font-medium transition-all duration-200 flex items-center gap-2 whitespace-nowrap",children:[f.jsx(yu,{className:"w-5 h-5",strokeWidth:2}),a("tools.newGroup")]})]})}),K&&K.length>0&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-amber-300",children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Sg,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-amber-700",children:a("tools.plannedGroups")})]}),f.jsx("p",{className:"text-sm text-amber-600 mt-0.5 ml-7",children:a("tools.plannedGroupsSubtitle")})]}),f.jsx("div",{className:"space-y-3",children:K.map(ke=>{const Re=(Q==null?void 0:Q.filter($e=>$e.courseStartDate===ke.courseStartDate).length)||0;return f.jsx("div",{className:"border border-amber-200 rounded-lg p-4 bg-amber-50 hover:shadow-md hover:border-amber-300 transition-all duration-200",children:f.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsxs("h4",{className:"font-semibold text-amber-900",children:[a("group.number")," ",ke.groupNumber]}),f.jsx("span",{className:"px-2 py-0.5 bg-amber-200 text-amber-800 text-xs font-medium rounded-full",children:a("group.planned")})]}),f.jsxs("div",{className:"text-sm text-amber-800 space-y-1",children:[f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(yu,{className:"w-4 h-4",strokeWidth:2}),at(ke.courseStartDate)," - ",at(ke.courseEndDate)]}),f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(_l,{className:"w-4 h-4",strokeWidth:2}),Re," ",Te(Re)]})]})]}),f.jsx("div",{className:"flex flex-col gap-2",children:f.jsxs("button",{onClick:()=>zt(ke.id),className:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 hover:shadow-lg text-sm font-medium transition-all duration-200 flex items-center gap-2",children:[f.jsx(ro,{className:"w-4 h-4 shrink-0",strokeWidth:2}),f.jsx("span",{children:a("tools.makeActive")})]})})]})},ke.id)})})]}),M&&M.length>0&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-slate-300",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(X1,{className:"w-5 h-5 text-slate-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-slate-700",children:a("tools.archiveCompleted")}),f.jsxs("span",{className:"text-sm text-slate-500",children:["(",M.length,")"]})]}),f.jsx("p",{className:"text-sm text-slate-600 mt-0.5 ml-7",children:a("tools.completedCourses")})]}),M.length>2&&f.jsxs("button",{onClick:()=>A(!T),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",children:[a(T?"tools.hide":"tools.showAll"),f.jsx(q2,{className:`w-4 h-4 transition-transform ${T?"rotate-180":""}`,strokeWidth:2})]})]}),f.jsx("div",{className:"space-y-3",children:(T?M:M.slice(0,2)).map(ke=>{const Re=(Q==null?void 0:Q.filter($e=>$e.courseStartDate===ke.courseStartDate).length)||0;return f.jsx("div",{className:"border border-slate-300 rounded-lg p-4 bg-slate-50 hover:shadow-md hover:border-slate-400 transition-all duration-200",children:f.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsxs("h4",{className:"font-semibold text-slate-800",children:[a("group.number")," ",ke.groupNumber]}),f.jsx("span",{className:"px-2 py-0.5 bg-slate-200 text-slate-700 text-xs font-medium rounded-full",children:a("group.completed")})]}),f.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(yu,{className:"w-4 h-4",strokeWidth:2}),at(ke.courseStartDate)," - ",at(ke.courseEndDate)]}),f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(_l,{className:"w-4 h-4",strokeWidth:2}),Re," ",Te(Re)]}),ke.closedAt&&f.jsxs("p",{className:"flex items-center gap-1 text-xs text-slate-500",children:[f.jsx(aT,{className:"w-3.5 h-3.5",strokeWidth:2}),a("tools.completedOn"),": ",at(ke.closedAt.split("T")[0])," ",new Date(ke.closedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]})]}),f.jsx("div",{className:"flex flex-col gap-2",children:f.jsxs("button",{onClick:()=>ft(ke.id),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-lg text-sm font-medium transition-all duration-200 flex items-center gap-2",children:[f.jsx(yk,{className:"w-4 h-4 shrink-0",strokeWidth:2}),f.jsx("span",{children:a("tools.reopenForEdits")})]})})]})},ke.id)})})]}),t&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(iT,{className:"w-5 h-5 text-blue-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-blue-600",children:a("tools.currentSequence")})]}),f.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.prefix"),":"]})," ",t.lastUniquePrefix]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.sequence"),":"]})," ",t.lastUniqueSeq]}),t.lastResetYear&&f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.lastReset"),":"]})," ",t.lastResetYear]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(G2,{className:"w-5 h-5 text-emerald-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-emerald-600",children:a("tools.exportData")})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("button",{onClick:I,className:"w-full px-6 py-4 bg-blue-100 text-blue-800 border border-blue-300 rounded-lg hover:bg-blue-200 hover:border-blue-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(xk,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportFullBackup")]}),f.jsxs("button",{onClick:Ze,className:"w-full px-6 py-4 bg-emerald-100 text-emerald-800 border border-emerald-300 rounded-lg hover:bg-emerald-200 hover:border-emerald-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(sk,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportExcel")]}),f.jsxs("button",{onClick:Ge,className:"w-full px-6 py-4 bg-slate-100 text-slate-800 border border-slate-300 rounded-lg hover:bg-slate-200 hover:border-slate-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(lk,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportCSV")]})]}),f.jsx("p",{className:"text-xs text-slate-500 mt-3",children:a("tools.exportNote")})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(sT,{className:"w-5 h-5 text-blue-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-blue-600",children:a("tools.importData")})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"w-full px-6 py-4 bg-blue-100 text-blue-800 border border-blue-300 rounded-lg hover:bg-blue-200 hover:border-blue-400 cursor-pointer text-center font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(G2,{className:"w-5 h-5",strokeWidth:2}),a("tools.importMerge"),f.jsx("input",{type:"file",accept:".json",onChange:ke=>{var Re;(Re=ke.target.files)!=null&&Re[0]&&(Y(ke.target.files[0],"merge"),ke.target.value="")},className:"hidden",disabled:i})]}),f.jsxs("label",{className:"w-full px-6 py-4 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg hover:bg-amber-200 hover:border-amber-400 cursor-pointer text-center font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(El,{className:"w-5 h-5",strokeWidth:2}),a("tools.importReplace"),f.jsx("input",{type:"file",accept:".json",onChange:ke=>{var Re;(Re=ke.target.files)!=null&&Re[0]&&(Y(ke.target.files[0],"replace"),ke.target.value="")},className:"hidden",disabled:i})]})]}),f.jsxs("p",{className:"text-xs text-slate-500 mt-3",children:[a("tools.importMergeNote")," ",f.jsx("br",{}),f.jsx("span",{className:"text-amber-600 font-semibold",children:a("tools.importReplaceWarning")})]}),i&&!Ee.isOpen&&f.jsx("div",{className:"text-center mt-4 text-blue-600 font-medium animate-pulse",children:"Processing..."})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(th,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-amber-600",children:a("security.title")})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("h4",{className:"font-semibold text-slate-700",children:a(Ye?"security.enabled":"security.disabled")}),Ye&&f.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-medium",children:a("security.active")})]}),f.jsx("p",{className:"text-sm text-slate-500 max-w-md",children:a(Ye?"security.descriptionEnabled":"security.descriptionDisabled")})]}),f.jsx("div",{className:"flex flex-col gap-2",children:Ye?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>CS(),className:"px-4 py-2 bg-slate-800 text-white hover:bg-slate-900 rounded-lg text-sm font-medium transition-colors shadow-sm",children:a("security.lockNow")}),f.jsx("button",{onClick:()=>Ce("disable"),className:"px-4 py-2 text-red-600 hover:bg-red-50 border border-red-200 rounded-lg text-sm font-medium transition-colors",children:a("security.disable")})]}):f.jsx("button",{onClick:()=>Ce("setup"),className:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors shadow-sm",children:a("security.setPin")})})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-2 border-orange-200",children:[f.jsxs("button",{onClick:()=>l(!o),className:"w-full flex items-center justify-between py-2 min-h-[44px]",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Z1,{className:"w-5 h-5 text-orange-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-orange-600",children:a("tools.advancedSettings")})]}),f.jsx(q2,{className:`w-6 h-6 transition-transform ${o?"rotate-180":""}`,strokeWidth:2})]}),o&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-orange-200 space-y-6",children:[f.jsx(qB,{onArchive:()=>P(!0),onViewArchives:()=>le(!0)}),f.jsx(GB,{showAlert:v})]})]}),S&&f.jsx(WB,{isOpen:S,onClose:()=>{P(!1),U("")},onConfirm:rt,confirmText:F,onConfirmTextChange:U}),re&&f.jsx($B,{isOpen:re,onClose:()=>le(!1),archives:be||[],onRestoreGroup:(ke,Re)=>me({year:ke,groupNumber:Re})}),f.jsx(ts,{isOpen:pe!==null,onClose:()=>me(null),onConfirm:()=>{pe&&xt(pe.year,pe.groupNumber)},title:a("tools.restoreGroupTitle"),message:a("tools.restoreGroupMessage",{number:((Dt=pe==null?void 0:pe.groupNumber)==null?void 0:Dt.toString())||""}),confirmText:a("tools.restoreGroupConfirm"),cancelText:a("common.cancel"),variant:"warning"}),u&&f.jsx(bx,{isOpen:u.isOpen,onClose:()=>c(null),title:u.title,message:u.message,variant:u.variant}),h&&f.jsx(ts,{isOpen:h.isOpen,onClose:()=>p(null),onConfirm:h.onConfirm,title:h.title,message:h.message,confirmText:h.confirmText,cancelText:a("common.cancel"),variant:h.variant}),de&&f.jsx(DS,{mode:de,onSuccess:X,onCancel:()=>Ce(null)})]})},qB=({onArchive:e,onViewArchives:t})=>{const{t:r}=Tr(),n=new Date().getFullYear(),a=Qr(()=>Se.groups.toArray(),[]),i=Qr(()=>Se.participants.toArray(),[]),s=(a==null?void 0:a.filter(p=>p.status==="active").length)||0,o=(a==null?void 0:a.filter(p=>p.status==="planned").length)||0,l=s>0||o>0,u=!l,c=(a==null?void 0:a.filter(p=>p.status!=="completed"?!1:new Date(p.courseStartDate).getFullYear()===n))||[],h=(i==null?void 0:i.filter(p=>c.some(v=>v.courseStartDate===p.courseStartDate)).length)||0;return f.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(X1,{className:"w-5 h-5 text-purple-600",strokeWidth:2}),f.jsx("h4",{className:"text-lg font-bold text-purple-600",children:r("archive.title")})]}),f.jsx("p",{className:"text-sm text-slate-700 mb-4",children:r("archive.description")}),f.jsxs("div",{className:"bg-white border border-slate-300 rounded-lg p-3 mb-4",children:[f.jsx("h5",{className:"text-sm font-semibold text-slate-800 mb-2",children:r("tools.archiveReadinessTitle")}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[s===0?f.jsx(ro,{className:"w-5 h-5 text-emerald-600",strokeWidth:2}):f.jsx($2,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("span",{className:"text-slate-700",children:r("tools.archiveActiveGroups")})]}),f.jsx("span",{className:`font-semibold ${s===0?"text-emerald-700":"text-amber-700"}`,children:s})]}),f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[o===0?f.jsx(ro,{className:"w-5 h-5 text-emerald-600",strokeWidth:2}):f.jsx($2,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("span",{className:"text-slate-700",children:r("tools.archivePlannedGroups")})]}),f.jsx("span",{className:`font-semibold ${o===0?"text-emerald-700":"text-amber-700"}`,children:o})]})]}),f.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:u?f.jsxs("p",{className:"text-xs text-emerald-700 flex items-start gap-1.5",children:[f.jsx("span",{className:"text-emerald-600 mt-0.5",children:""}),f.jsx("span",{children:r("tools.archiveReady")})]}):f.jsxs("p",{className:"text-xs text-amber-800 flex items-start gap-1.5",children:[f.jsx(K1,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0",strokeWidth:2}),f.jsx("span",{children:r("tools.archiveNotReady")})]})})]}),c.length>0?f.jsxs("div",{className:"bg-white p-3 rounded mb-4 text-sm space-y-1",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.currentYear"),":"]})," ",n]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.groupsToArchive"),":"]})," ",c.length]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.participantsToArchive"),":"]})," ",h]})]}):f.jsx("div",{className:"bg-white p-3 rounded mb-4 text-sm text-slate-600",children:r("archive.noGroupsToArchive")}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("button",{onClick:e,disabled:c.length===0||l,className:"w-full px-6 py-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-slate-400 disabled:cursor-not-allowed font-bold min-h-[48px] transition-colors",title:l?"     ":"    ",children:r("archive.button")}),f.jsxs("button",{onClick:t,className:"w-full px-6 py-4 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-medium min-h-[48px] transition-colors",children:[" ",r("archive.viewArchives")]})]})]})},WB=({isOpen:e,onClose:t,onConfirm:r,confirmText:n,onConfirmTextChange:a})=>{const{t:i}=Tr(),s=new Date().getFullYear(),o=Qr(()=>Se.groups.toArray(),[]),l=Qr(()=>Se.participants.toArray(),[]),u=(o==null?void 0:o.some(w=>w.status==="active"))||!1,c=(o==null?void 0:o.some(w=>w.status==="planned"))||!1,h=u||c,p=(o==null?void 0:o.filter(w=>w.status!=="completed"?!1:new Date(w.courseStartDate).getFullYear()===s))||[],v=(l==null?void 0:l.filter(w=>p.some(x=>x.courseStartDate===w.courseStartDate)).length)||0,E=`ARCHIVE-${s}`,g=n===E&&!h;return e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[f.jsx("h3",{className:"text-xl font-bold text-purple-600 mb-4",children:i("archive.confirmTitle")}),h?f.jsxs("div",{className:"bg-red-50 border-2 border-red-400 p-4 rounded mb-4",children:[f.jsx("p",{className:"text-sm text-red-900 font-semibold mb-2",children:i("tools.archiveCannotArchive")}),f.jsx("p",{className:"text-sm text-red-800 mb-3",children:i("tools.archiveCannotArchiveMessage")}),u&&f.jsx("p",{className:"text-xs text-red-700",children:i("tools.archiveHasActiveGroups")}),c&&f.jsx("p",{className:"text-xs text-red-700",children:i("tools.archiveHasPlannedGroups")})]}):f.jsx("p",{className:"text-slate-700 mb-4",children:i("tools.archiveConfirmMessage",{groups:p.length.toString(),participants:v.toString(),year:s.toString()})}),!h&&f.jsxs("div",{className:"mb-6",children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[i("archive.typeToConfirm")," ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:E})," ",i("archive.toConfirm"),":"]}),f.jsx("input",{type:"text",value:n,onChange:w=>a(w.target.value),placeholder:E,className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 border border-slate-200 rounded-lg hover:bg-slate-50",children:i(h?"tools.archiveCloseButton":"common.cancel")}),!h&&f.jsx("button",{onClick:r,disabled:!g,className:"flex-1 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold",children:i("archive.button")})]})]})}):null},$B=({isOpen:e,onClose:t,archives:r,onRestoreGroup:n})=>{const{t:a}=Tr(),[i,s]=_e.useState(null),[o,l]=_e.useState(null);return e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:a("archive.yearlyArchives")}),f.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:f.jsx(Q1,{className:"w-6 h-6",strokeWidth:2})})]}),r.length===0?f.jsx("p",{className:"text-slate-600 text-center py-8",children:a("archive.noArchives")}):f.jsx("div",{className:"space-y-4",children:r.sort((u,c)=>c.year-u.year).map(u=>f.jsxs("div",{className:"border border-slate-300 rounded-lg",children:[f.jsxs("button",{onClick:()=>s(i===u.year?null:u.year),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-slate-50 transition-colors rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(W2,{className:`w-5 h-5 text-slate-600 transition-transform ${i===u.year?"rotate-90":""}`,strokeWidth:2}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-bold text-slate-900",children:[a("archive.year")," ",u.year]}),f.jsxs("div",{className:"text-sm text-slate-600",children:[u.groups.length," ",a("archive.groups"),", ",u.participants.length," ",a("archive.participants")]})]})]}),f.jsxs("div",{className:"text-xs text-slate-500",children:[a("archive.archived"),": ",at(u.archivedAt.split("T")[0])]})]}),i===u.year&&f.jsx("div",{className:"border-t border-slate-200 p-4 space-y-2",children:u.groups.sort((c,h)=>h.groupNumber-c.groupNumber).map(c=>{const h=u.participants.filter(p=>p.groupNumber===c.groupNumber);return f.jsxs("div",{className:"border border-slate-200 rounded-lg",children:[f.jsxs("button",{onClick:()=>l(o===c.groupNumber?null:c.groupNumber),className:"w-full px-3 py-2 flex items-center justify-between hover:bg-slate-50 transition-colors rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(W2,{className:`w-4 h-4 text-slate-600 transition-transform ${o===c.groupNumber?"rotate-90":""}`,strokeWidth:2}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-semibold text-slate-900",children:[a("group.number")," ",c.groupNumber]}),f.jsxs("div",{className:"text-xs text-slate-600",children:[at(c.courseStartDate)," - ",at(c.courseEndDate)]})]})]}),f.jsxs("div",{className:"text-xs text-slate-600",children:[h.length," ",a("archive.participants")]})]}),o===c.groupNumber&&f.jsxs("div",{className:"border-t border-slate-200 p-3",children:[f.jsxs("div",{className:"mb-3",children:[f.jsxs("button",{onClick:()=>n(u.year,c.groupNumber),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition-colors flex items-center justify-center gap-2",children:[f.jsx(sT,{className:"w-5 h-5",strokeWidth:2}),a("tools.restoreGroupConfirm")]}),f.jsx("p",{className:"text-xs text-slate-600 mt-2 text-center",children:a("tools.restoreGroupWillRestore")})]}),f.jsx("div",{className:"space-y-2",children:h.map(p=>f.jsxs("div",{className:"bg-slate-50 p-2 rounded text-sm",children:[f.jsx("div",{className:"font-semibold text-slate-900",children:p.personName}),f.jsx("div",{className:"text-slate-600",children:p.companyName}),f.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[a("participant.uniqueNumber"),": ",p.uniqueNumber]})]},p.id))})]})]},c.id)})})]},u.id))}),f.jsx("div",{className:"mt-6",children:f.jsx("button",{onClick:t,className:"w-full px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-medium",children:a("common.close")})})]})}):null},GB=({showAlert:e})=>{const{settings:t,resetYearlySequence:r}=cA(),{t:n}=Tr(),[a,i]=_e.useState(!1),[s,o]=_e.useState(""),[l,u]=_e.useState(!1),c=Qr(()=>Se.participants.toArray(),[]),h=(c==null?void 0:c.reduce((x,y)=>{const b=parseInt(y.uniqueNumber.split("-")[0],10);return b>x?b:x},0))||0,v=`RESET-${new Date().getFullYear()}`,E=a&&s===v,g=()=>{u(!0)},w=async()=>{try{await r(),e(n("common.success"),n("tools.resetSequenceSuccess"),"success"),i(!1),o(""),u(!1)}catch(x){console.error("Failed to reset sequence:",x),e(n("common.error"),n("tools.resetSequenceFailed"),"error")}};return f.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border-2 border-red-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(El,{className:"w-5 h-5 text-red-600",strokeWidth:2}),f.jsx("h4",{className:"text-lg font-bold text-red-600",children:n("tools.dangerZone")})]}),f.jsx("p",{className:"text-sm text-slate-700 mb-4",children:n("tools.resetSequenceDescription2")}),t&&f.jsxs("div",{className:"bg-white p-3 rounded mb-4 text-sm",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[n("tools.current"),":"]})," ",t.lastUniquePrefix.toString().padStart(4,"0"),"-",t.lastUniqueSeq.toString().padStart(3,"0")]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[n("tools.nextAfterReset"),":"]})," ",(h+1).toString().padStart(4,"0"),"-001"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("label",{className:"flex items-start gap-3 cursor-pointer min-h-[44px]",children:[f.jsx("input",{type:"checkbox",checked:a,onChange:x=>i(x.target.checked),className:"mt-1 w-5 h-5 text-red-600 rounded border-slate-300 focus:ring-red-500"}),f.jsx("span",{className:"text-sm text-slate-700 flex-1",children:n("tools.resetSequenceCheckbox")})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Type ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:v})," to confirm:"]}),f.jsx("input",{type:"text",value:s,onChange:x=>o(x.target.value),placeholder:v,className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 min-h-[44px]",disabled:!a})]}),f.jsx("button",{onClick:g,disabled:!E,className:"w-full px-6 py-4 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold min-h-[48px]",children:n("tools.resetButton")})]}),l&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[f.jsx("h3",{className:"text-xl font-bold text-red-600 mb-4",children:n("modal.finalConfirmation")}),f.jsx("p",{className:"text-slate-700 mb-6",children:n("tools.resetSequenceFinalConfirm")}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-3 border border-slate-200 rounded-lg hover:bg-slate-50 min-h-[48px]",children:n("tools.resetSequenceCancel")}),f.jsx("button",{onClick:w,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-bold min-h-[48px]",children:n("tools.resetSequenceConfirmButton")})]})]})})]})};function HB(){const{t:e}=Tr(),{participants:t,deleteParticipant:r}=eh(),{groups:n}=P5(),{collapsedSections:a,toggleSection:i,expandSection:s,resetToDefaults:o,setCollapsedState:l}=I5(),[u,c]=_e.useState("participants"),[h,p]=_e.useState(!1),[v,E]=_e.useState(),[g,w]=_e.useState(!1),[x,y]=_e.useState(!1),[b,_]=_e.useState(0);_e.useEffect(()=>{setTimeout(async()=>{try{console.log("App initializing..."),await H_();const{syncGroups:M}=await Pn(async()=>{const{syncGroups:Q}=await Promise.resolve().then(()=>Y1);return{syncGroups:Q}},void 0);await M(),console.log("App initialization complete.")}catch(M){console.error("CRITICAL: Failed to initialize groups:",M)}},100)},[]);const[N,k]=_e.useState(""),[T,A]=_e.useState(""),[S,P]=_e.useState({sent:null,documents:null,handedOver:null,paid:null,completed:null}),[F,U]=_e.useState({start:"",end:""}),[re,le]=_e.useState(null),pe=_e.useMemo(()=>N!==""||T!==""||S.sent!==null||S.documents!==null||S.handedOver!==null||S.paid!==null||S.completed!==null||F.start!==""||F.end!=="",[N,T,S,F]);_e.useEffect(()=>{pe?(re||le({...a}),a.active&&s("active"),a.planned&&s("planned"),a.completed&&s("completed")):re&&(l(re),le(null))},[pe]);const me=_e.useMemo(()=>{if(!t)return[];const K=new Date().getFullYear();return t.filter(M=>{const Q=n==null?void 0:n.find(Te=>Te.courseStartDate===M.courseStartDate);if((M.completedOverride!==null?M.completedOverride:M.completedComputed)&&(Q==null?void 0:Q.status)==="completed"&&new Date(M.courseStartDate).getFullYear()!==K)return!1;if(N){const Te=N.toLowerCase();if(!(M.companyName.toLowerCase().includes(Te)||M.personName.toLowerCase().includes(Te)||M.uniqueNumber.toLowerCase().includes(Te)))return!1}if(T){const Te=parseInt(T,10);if(Q&&Q.groupNumber!==Te||!Q)return!1}return!(F.start&&M.courseStartDate<F.start||F.end&&M.courseStartDate>=F.end||S.sent!==null&&M.sent!==S.sent||S.documents!==null&&M.documents!==S.documents||S.handedOver!==null&&M.handedOver!==S.handedOver||S.paid!==null&&M.paid!==S.paid||S.completed!==null&&(M.completedOverride!==null?M.completedOverride:M.completedComputed)!==S.completed)})},[t,n,N,T,S,F]),Ee=(t==null?void 0:t.length)||0,fe=me.length,de=(n==null?void 0:n.length)||0,Ce=_e.useMemo(()=>new Set(me.map(M=>M.courseStartDate)).size,[me]),Ye=_e.useMemo(()=>me.filter(K=>K.completedOverride!==null?K.completedOverride:K.completedComputed).length,[me]),V=()=>{E(void 0),p(!0)},se=K=>{E(K),p(!0)},ee=()=>{p(!1),E(void 0)},C=(K,M)=>{P(Q=>({...Q,[K]:M}))},R=()=>{k(""),A(""),P({sent:null,documents:null,handedOver:null,paid:null,completed:null}),U({start:"",end:""})},X=K=>{k(K.searchTerm),A(K.courseStartDate||""),P({sent:null,documents:null,handedOver:null,paid:null,completed:null}),U({start:"",end:""})},te=(K,M)=>{switch(K){case"search":k("");break;case"group":A("");break;case"dateStart":U(Q=>({...Q,start:""}));break;case"dateEnd":U(Q=>({...Q,end:""}));break;case"status":M&&P(Q=>({...Q,[M]:null}));break;case"all":R();break}};return f.jsx("div",{className:"min-h-screen bg-slate-50",children:f.jsxs(FP,{children:[f.jsx(PP,{activeTab:u,onTabChange:c}),u==="participants"?f.jsxs("main",{className:"container mx-auto px-4 py-6 pb-24 md:pb-6",children:[f.jsx(IP,{totalParticipants:Ee,visibleParticipants:fe,totalCourses:de,visibleCourses:Ce,completedCount:Ye}),f.jsx(SP,{activeFilters:{searchText:N,selectedGroup:T,dateRange:F,statusFilters:S},onRemoveFilter:te,groups:(n==null?void 0:n.filter(K=>K.groupNumber!==null&&K.groupNumber!==void 0).map(K=>({...K,groupNumber:K.groupNumber})))||[]}),f.jsxs("div",{className:"hidden md:flex flex-wrap gap-3 mb-6",children:[f.jsxs("button",{onClick:V,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 shadow font-medium",children:["+ ",e("participants.add")]}),f.jsx("button",{onClick:()=>w(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow font-medium",children:e("filters.title")})]}),f.jsx("div",{className:"md:hidden mb-4",children:f.jsxs("button",{onClick:()=>w(!0),className:"w-full px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow font-medium min-h-[48px]",children:[" ",e("filters.title")]})}),f.jsxs("div",{className:"md:bg-white md:rounded-lg md:shadow",children:[f.jsxs("div",{className:"hidden md:block",children:[f.jsx("div",{className:"p-4 border-b",children:f.jsxs("h2",{className:"text-xl font-semibold text-slate-900",children:[e("participants.title")," ",fe<Ee&&`(${fe} ${e("participants.of")} ${Ee})`]})}),f.jsx("div",{className:"p-4",children:f.jsx(wP,{participants:me,onEdit:se,onDelete:r,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:pe,onFilterChange:X,groupRefreshKey:b})})]}),f.jsx("div",{className:"md:hidden",children:f.jsx(EP,{participants:me,onEdit:se,onDelete:r,onSelectionChange:y,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:pe})})]})]}):f.jsx("main",{className:"container mx-auto px-4 py-6",children:f.jsx(zB,{filteredParticipants:me,onNavigateHome:()=>{_(K=>K+1),c("participants")}})}),f.jsx(TP,{isOpen:g,onClose:()=>w(!1),searchText:N,onSearchTextChange:k,selectedGroup:T,onSelectedGroupChange:A,statusFilters:S,onStatusFilterChange:C,dateRange:F,onDateRangeChange:U,groups:(n==null?void 0:n.filter(K=>K.groupNumber!==null&&K.groupNumber!==void 0).map(K=>({...K,groupNumber:K.groupNumber})))||[],onResetToDefaults:o,visibleCount:fe,totalCount:Ee}),f.jsx(_P,{isOpen:h,onClose:ee,participant:v}),u==="participants"&&!x&&f.jsx(jP,{onClick:V}),f.jsx(RP,{activeTab:u,onTabChange:c})]})})}function VB(){return f.jsx(j5,{children:f.jsx(HB,{})})}class YB extends _e.Component{constructor(){super(...arguments);Eo(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("Uncaught error:",r,n)}render(){var r;return this.state.hasError?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:f.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),f.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error. This might be due to a data consistency issue."}),f.jsx("div",{className:"bg-gray-100 p-3 rounded mb-4 overflow-auto max-h-32 text-xs font-mono text-red-800",children:(r=this.state.error)==null?void 0:r.message}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Reload Application"}),f.jsx("button",{onClick:()=>{window.confirm("Delete all local data and reset? This cannot be undone.")&&(indexedDB.deleteDatabase("CourseManagementDB"),localStorage.clear(),window.location.reload())},className:"flex-1 px-4 py-2 bg-red-100 text-red-700 border border-red-200 rounded hover:bg-red-200 transition",children:"Reset Data"})]})]})}):this.props.children}}im.createRoot(document.getElementById("root")).render(f.jsx(Fs.StrictMode,{children:f.jsx(YB,{children:f.jsx(VB,{})})}));
