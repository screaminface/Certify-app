async function r(i,o){if("showSaveFilePicker"in window)try{const e=o.split(".").pop()||"",c={suggestedName:o,types:[]};e==="json"?c.types=[{description:"JSON файл",accept:{"application/json":[".json"]}}]:e==="xlsx"?c.types=[{description:"Excel файл",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}]:e==="csv"?c.types=[{description:"CSV файл",accept:{"text/csv":[".csv"]}}]:e==="docx"&&(c.types=[{description:"Word документ",accept:{"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"]}}]);const n=await(await window.showSaveFilePicker(c)).createWritable();await n.write(i),await n.close();return}catch(e){if(e.name==="AbortError")return;console.warn("File System Access API failed, using fallback:",e)}const s=URL.createObjectURL(i),t=document.createElement("a");t.href=s,t.download=o,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)}export{r as s};
