var bA=Object.defineProperty;var _A=(e,t,r)=>t in e?bA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var vo=(e,t,r)=>_A(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Iw={exports:{}},Nd={},Rw={exports:{}},kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jc=Symbol.for("react.element"),TA=Symbol.for("react.portal"),SA=Symbol.for("react.fragment"),AA=Symbol.for("react.strict_mode"),CA=Symbol.for("react.profiler"),DA=Symbol.for("react.provider"),NA=Symbol.for("react.context"),kA=Symbol.for("react.forward_ref"),OA=Symbol.for("react.suspense"),FA=Symbol.for("react.memo"),PA=Symbol.for("react.lazy"),rv=Symbol.iterator;function IA(e){return e===null||typeof e!="object"?null:(e=rv&&e[rv]||e["@@iterator"],typeof e=="function"?e:null)}var Lw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mw=Object.assign,jw={};function Sl(e,t,r){this.props=e,this.context=t,this.refs=jw,this.updater=r||Lw}Sl.prototype.isReactComponent={};Sl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Sl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bw(){}Bw.prototype=Sl.prototype;function Ig(e,t,r){this.props=e,this.context=t,this.refs=jw,this.updater=r||Lw}var Rg=Ig.prototype=new Bw;Rg.constructor=Ig;Mw(Rg,Sl.prototype);Rg.isPureReactComponent=!0;var nv=Array.isArray,Uw=Object.prototype.hasOwnProperty,Lg={current:null},zw={key:!0,ref:!0,__self:!0,__source:!0};function Ww(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)Uw.call(t,n)&&!zw.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:jc,type:e,key:i,ref:s,props:a,_owner:Lg.current}}function RA(e,t){return{$$typeof:jc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Mg(e){return typeof e=="object"&&e!==null&&e.$$typeof===jc}function LA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var av=/\/+/g;function kh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?LA(""+e.key):t.toString(36)}function s0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case jc:case TA:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+kh(s,0):n,nv(a)?(r="",e!=null&&(r=e.replace(av,"$&/")+"/"),s0(a,t,r,"",function(u){return u})):a!=null&&(Mg(a)&&(a=RA(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(av,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",nv(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+kh(i,o);s+=s0(i,t,r,l,a)}else if(l=IA(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+kh(i,o++),s+=s0(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function wf(e,t,r){if(e==null)return e;var n=[],a=0;return s0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function MA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sn={current:null},o0={transition:null},jA={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:o0,ReactCurrentOwner:Lg};function qw(){throw Error("act(...) is not supported in production builds of React.")}kt.Children={map:wf,forEach:function(e,t,r){wf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return wf(e,function(){t++}),t},toArray:function(e){return wf(e,function(t){return t})||[]},only:function(e){if(!Mg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};kt.Component=Sl;kt.Fragment=SA;kt.Profiler=CA;kt.PureComponent=Ig;kt.StrictMode=AA;kt.Suspense=OA;kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jA;kt.act=qw;kt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Mw({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Lg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Uw.call(t,l)&&!zw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:jc,type:e.type,key:a,ref:i,props:n,_owner:s}};kt.createContext=function(e){return e={$$typeof:NA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:DA,_context:e},e.Consumer=e};kt.createElement=Ww;kt.createFactory=function(e){var t=Ww.bind(null,e);return t.type=e,t};kt.createRef=function(){return{current:null}};kt.forwardRef=function(e){return{$$typeof:kA,render:e}};kt.isValidElement=Mg;kt.lazy=function(e){return{$$typeof:PA,_payload:{_status:-1,_result:e},_init:MA}};kt.memo=function(e,t){return{$$typeof:FA,type:e,compare:t===void 0?null:t}};kt.startTransition=function(e){var t=o0.transition;o0.transition={};try{e()}finally{o0.transition=t}};kt.unstable_act=qw;kt.useCallback=function(e,t){return Sn.current.useCallback(e,t)};kt.useContext=function(e){return Sn.current.useContext(e)};kt.useDebugValue=function(){};kt.useDeferredValue=function(e){return Sn.current.useDeferredValue(e)};kt.useEffect=function(e,t){return Sn.current.useEffect(e,t)};kt.useId=function(){return Sn.current.useId()};kt.useImperativeHandle=function(e,t,r){return Sn.current.useImperativeHandle(e,t,r)};kt.useInsertionEffect=function(e,t){return Sn.current.useInsertionEffect(e,t)};kt.useLayoutEffect=function(e,t){return Sn.current.useLayoutEffect(e,t)};kt.useMemo=function(e,t){return Sn.current.useMemo(e,t)};kt.useReducer=function(e,t,r){return Sn.current.useReducer(e,t,r)};kt.useRef=function(e){return Sn.current.useRef(e)};kt.useState=function(e){return Sn.current.useState(e)};kt.useSyncExternalStore=function(e,t,r){return Sn.current.useSyncExternalStore(e,t,r)};kt.useTransition=function(){return Sn.current.useTransition()};kt.version="18.3.1";Rw.exports=kt;var Ae=Rw.exports;const ks=Pg(Ae);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BA=Ae,UA=Symbol.for("react.element"),zA=Symbol.for("react.fragment"),WA=Object.prototype.hasOwnProperty,qA=BA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$A={key:!0,ref:!0,__self:!0,__source:!0};function $w(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)WA.call(t,n)&&!$A.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:UA,type:e,key:i,ref:s,props:a,_owner:qA.current}}Nd.Fragment=zA;Nd.jsx=$w;Nd.jsxs=$w;Iw.exports=Nd;var f=Iw.exports,Jp={},Hw={exports:{}},Qn={},Vw={exports:{}},Gw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ue,ce){var De=ue.length;ue.push(ce);e:for(;0<De;){var Ve=De-1>>>1,Y=ue[Ve];if(0<a(Y,ce))ue[Ve]=ce,ue[De]=Y,De=Ve;else break e}}function r(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var ce=ue[0],De=ue.pop();if(De!==ce){ue[0]=De;e:for(var Ve=0,Y=ue.length,se=Y>>>1;Ve<se;){var ee=2*(Ve+1)-1,D=ue[ee],F=ee+1,V=ue[F];if(0>a(D,De))F<Y&&0>a(V,D)?(ue[Ve]=V,ue[F]=De,Ve=F):(ue[Ve]=D,ue[ee]=De,Ve=ee);else if(F<Y&&0>a(V,De))ue[Ve]=V,ue[F]=De,Ve=F;else break e}}return ce}function a(ue,ce){var De=ue.sortIndex-ce.sortIndex;return De!==0?De:ue.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,h=null,p=3,x=!1,E=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(ue){for(var ce=r(u);ce!==null;){if(ce.callback===null)n(u);else if(ce.startTime<=ue)n(u),ce.sortIndex=ce.expirationTime,t(l,ce);else break;ce=r(u)}}function T(ue){if(g=!1,b(ue),!E)if(r(l)!==null)E=!0,ye(N);else{var ce=r(u);ce!==null&&_e(T,ce.startTime-ue)}}function N(ue,ce){E=!1,g&&(g=!1,v(S),S=-1),x=!0;var De=p;try{for(b(ce),h=r(l);h!==null&&(!(h.expirationTime>ce)||ue&&!I());){var Ve=h.callback;if(typeof Ve=="function"){h.callback=null,p=h.priorityLevel;var Y=Ve(h.expirationTime<=ce);ce=e.unstable_now(),typeof Y=="function"?h.callback=Y:h===r(l)&&n(l),b(ce)}else n(l);h=r(l)}if(h!==null)var se=!0;else{var ee=r(u);ee!==null&&_e(T,ee.startTime-ce),se=!1}return se}finally{h=null,p=De,x=!1}}var k=!1,_=null,S=-1,A=5,P=-1;function I(){return!(e.unstable_now()-P<A)}function W(){if(_!==null){var ue=e.unstable_now();P=ue;var ce=!0;try{ce=_(!0,ue)}finally{ce?te():(k=!1,_=null)}}else k=!1}var te;if(typeof y=="function")te=function(){y(W)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ve=oe.port2;oe.port1.onmessage=W,te=function(){ve.postMessage(null)}}else te=function(){w(W,0)};function ye(ue){_=ue,k||(k=!0,te())}function _e(ue,ce){S=w(function(){ue(e.unstable_now())},ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ue){ue.callback=null},e.unstable_continueExecution=function(){E||x||(E=!0,ye(N))},e.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ue?Math.floor(1e3/ue):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ue){switch(p){case 1:case 2:case 3:var ce=3;break;default:ce=p}var De=p;p=ce;try{return ue()}finally{p=De}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ue,ce){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var De=p;p=ue;try{return ce()}finally{p=De}},e.unstable_scheduleCallback=function(ue,ce,De){var Ve=e.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?Ve+De:Ve):De=Ve,ue){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=De+Y,ue={id:c++,callback:ce,priorityLevel:ue,startTime:De,expirationTime:Y,sortIndex:-1},De>Ve?(ue.sortIndex=De,t(u,ue),r(l)===null&&ue===r(u)&&(g?(v(S),S=-1):g=!0,_e(T,De-Ve))):(ue.sortIndex=Y,t(l,ue),E||x||(E=!0,ye(N))),ue},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(ue){var ce=p;return function(){var De=p;p=ce;try{return ue.apply(this,arguments)}finally{p=De}}}})(Gw);Vw.exports=Gw;var HA=Vw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VA=Ae,Xn=HA;function Le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yw=new Set,qu={};function io(e,t){cl(e,t),cl(e+"Capture",t)}function cl(e,t){for(qu[e]=t,e=0;e<t.length;e++)Yw.add(t[e])}var vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),em=Object.prototype.hasOwnProperty,GA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iv={},sv={};function YA(e){return em.call(sv,e)?!0:em.call(iv,e)?!1:GA.test(e)?sv[e]=!0:(iv[e]=!0,!1)}function XA(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function KA(e,t,r,n){if(t===null||typeof t>"u"||XA(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function An(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rn[e]=new An(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rn[t]=new An(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rn[e]=new An(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rn[e]=new An(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rn[e]=new An(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rn[e]=new An(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rn[e]=new An(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rn[e]=new An(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rn[e]=new An(e,5,!1,e.toLowerCase(),null,!1,!1)});var jg=/[\-:]([a-z])/g;function Bg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(jg,Bg);rn[t]=new An(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(jg,Bg);rn[t]=new An(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(jg,Bg);rn[t]=new An(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rn[e]=new An(e,1,!1,e.toLowerCase(),null,!1,!1)});rn.xlinkHref=new An("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rn[e]=new An(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ug(e,t,r,n){var a=rn.hasOwnProperty(t)?rn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(KA(t,r,a,n)&&(r=null),n||a===null?YA(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Si=VA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ef=Symbol.for("react.element"),Po=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),zg=Symbol.for("react.strict_mode"),tm=Symbol.for("react.profiler"),Xw=Symbol.for("react.provider"),Kw=Symbol.for("react.context"),Wg=Symbol.for("react.forward_ref"),rm=Symbol.for("react.suspense"),nm=Symbol.for("react.suspense_list"),qg=Symbol.for("react.memo"),Ri=Symbol.for("react.lazy"),Zw=Symbol.for("react.offscreen"),ov=Symbol.iterator;function Gl(e){return e===null||typeof e!="object"?null:(e=ov&&e[ov]||e["@@iterator"],typeof e=="function"?e:null)}var mr=Object.assign,Oh;function cu(e){if(Oh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Oh=t&&t[1]||""}return`
`+Oh+e}var Fh=!1;function Ph(e,t){if(!e||Fh)return"";Fh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Fh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?cu(e):""}function ZA(e){switch(e.tag){case 5:return cu(e.type);case 16:return cu("Lazy");case 13:return cu("Suspense");case 19:return cu("SuspenseList");case 0:case 2:case 15:return e=Ph(e.type,!1),e;case 11:return e=Ph(e.type.render,!1),e;case 1:return e=Ph(e.type,!0),e;default:return""}}function am(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Io:return"Fragment";case Po:return"Portal";case tm:return"Profiler";case zg:return"StrictMode";case rm:return"Suspense";case nm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Kw:return(e.displayName||"Context")+".Consumer";case Xw:return(e._context.displayName||"Context")+".Provider";case Wg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qg:return t=e.displayName||null,t!==null?t:am(e.type)||"Memo";case Ri:t=e._payload,e=e._init;try{return am(e(t))}catch{}}return null}function QA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return am(t);case 8:return t===zg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ts(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Qw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function JA(e){var t=Qw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bf(e){e._valueTracker||(e._valueTracker=JA(e))}function Jw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Qw(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function C0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function im(e,t){var r=t.checked;return mr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function lv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ts(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function eE(e,t){t=t.checked,t!=null&&Ug(e,"checked",t,!1)}function sm(e,t){eE(e,t);var r=ts(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?om(e,t.type,r):t.hasOwnProperty("defaultValue")&&om(e,t.type,ts(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function uv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function om(e,t,r){(t!=="number"||C0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var fu=Array.isArray;function Yo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ts(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function lm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Le(91));return mr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Le(92));if(fu(r)){if(1<r.length)throw Error(Le(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ts(r)}}function tE(e,t){var r=ts(t.value),n=ts(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function fv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function um(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _f,nE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_f=_f||document.createElement("div"),_f.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_f.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function $u(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var yu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},e4=["Webkit","ms","Moz","O"];Object.keys(yu).forEach(function(e){e4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),yu[t]=yu[e]})});function aE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||yu.hasOwnProperty(e)&&yu[e]?(""+t).trim():t+"px"}function iE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=aE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var t4=mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cm(e,t){if(t){if(t4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Le(62))}}function fm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dm=null;function $g(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hm=null,Xo=null,Ko=null;function dv(e){if(e=zc(e)){if(typeof hm!="function")throw Error(Le(280));var t=e.stateNode;t&&(t=Id(t),hm(e.stateNode,e.type,t))}}function sE(e){Xo?Ko?Ko.push(e):Ko=[e]:Xo=e}function oE(){if(Xo){var e=Xo,t=Ko;if(Ko=Xo=null,dv(e),t)for(e=0;e<t.length;e++)dv(t[e])}}function lE(e,t){return e(t)}function uE(){}var Ih=!1;function cE(e,t,r){if(Ih)return e(t,r);Ih=!0;try{return lE(e,t,r)}finally{Ih=!1,(Xo!==null||Ko!==null)&&(uE(),oE())}}function Hu(e,t){var r=e.stateNode;if(r===null)return null;var n=Id(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Le(231,t,typeof r));return r}var pm=!1;if(vi)try{var Yl={};Object.defineProperty(Yl,"passive",{get:function(){pm=!0}}),window.addEventListener("test",Yl,Yl),window.removeEventListener("test",Yl,Yl)}catch{pm=!1}function r4(e,t,r,n,a,i,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(c){this.onError(c)}}var wu=!1,D0=null,N0=!1,mm=null,n4={onError:function(e){wu=!0,D0=e}};function a4(e,t,r,n,a,i,s,o,l){wu=!1,D0=null,r4.apply(n4,arguments)}function i4(e,t,r,n,a,i,s,o,l){if(a4.apply(this,arguments),wu){if(wu){var u=D0;wu=!1,D0=null}else throw Error(Le(198));N0||(N0=!0,mm=u)}}function so(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function fE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function hv(e){if(so(e)!==e)throw Error(Le(188))}function s4(e){var t=e.alternate;if(!t){if(t=so(e),t===null)throw Error(Le(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return hv(a),e;if(i===n)return hv(a),t;i=i.sibling}throw Error(Le(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Le(189))}}if(r.alternate!==n)throw Error(Le(190))}if(r.tag!==3)throw Error(Le(188));return r.stateNode.current===r?e:t}function dE(e){return e=s4(e),e!==null?hE(e):null}function hE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hE(e);if(t!==null)return t;e=e.sibling}return null}var pE=Xn.unstable_scheduleCallback,pv=Xn.unstable_cancelCallback,o4=Xn.unstable_shouldYield,l4=Xn.unstable_requestPaint,_r=Xn.unstable_now,u4=Xn.unstable_getCurrentPriorityLevel,Hg=Xn.unstable_ImmediatePriority,mE=Xn.unstable_UserBlockingPriority,k0=Xn.unstable_NormalPriority,c4=Xn.unstable_LowPriority,gE=Xn.unstable_IdlePriority,kd=null,Ya=null;function f4(e){if(Ya&&typeof Ya.onCommitFiberRoot=="function")try{Ya.onCommitFiberRoot(kd,e,void 0,(e.current.flags&128)===128)}catch{}}var ka=Math.clz32?Math.clz32:p4,d4=Math.log,h4=Math.LN2;function p4(e){return e>>>=0,e===0?32:31-(d4(e)/h4|0)|0}var Tf=64,Sf=4194304;function du(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function O0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=du(o):(i&=s,i!==0&&(n=du(i)))}else s=r&~a,s!==0?n=du(s):i!==0&&(n=du(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ka(t),a=1<<r,n|=e[r],t&=~a;return n}function m4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function g4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-ka(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=m4(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function gm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xE(){var e=Tf;return Tf<<=1,!(Tf&4194240)&&(Tf=64),e}function Rh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Bc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ka(t),e[t]=r}function x4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ka(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Vg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ka(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Gt=0;function vE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yE,Gg,wE,EE,bE,xm=!1,Af=[],Vi=null,Gi=null,Yi=null,Vu=new Map,Gu=new Map,ji=[],v4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mv(e,t){switch(e){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":Yi=null;break;case"pointerover":case"pointerout":Vu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gu.delete(t.pointerId)}}function Xl(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=zc(t),t!==null&&Gg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function y4(e,t,r,n,a){switch(t){case"focusin":return Vi=Xl(Vi,e,t,r,n,a),!0;case"dragenter":return Gi=Xl(Gi,e,t,r,n,a),!0;case"mouseover":return Yi=Xl(Yi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Vu.set(i,Xl(Vu.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Gu.set(i,Xl(Gu.get(i)||null,e,t,r,n,a)),!0}return!1}function _E(e){var t=Fs(e.target);if(t!==null){var r=so(t);if(r!==null){if(t=r.tag,t===13){if(t=fE(r),t!==null){e.blockedOn=t,bE(e.priority,function(){wE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function l0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=vm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dm=n,r.target.dispatchEvent(n),dm=null}else return t=zc(r),t!==null&&Gg(t),e.blockedOn=r,!1;t.shift()}return!0}function gv(e,t,r){l0(e)&&r.delete(t)}function w4(){xm=!1,Vi!==null&&l0(Vi)&&(Vi=null),Gi!==null&&l0(Gi)&&(Gi=null),Yi!==null&&l0(Yi)&&(Yi=null),Vu.forEach(gv),Gu.forEach(gv)}function Kl(e,t){e.blockedOn===t&&(e.blockedOn=null,xm||(xm=!0,Xn.unstable_scheduleCallback(Xn.unstable_NormalPriority,w4)))}function Yu(e){function t(a){return Kl(a,e)}if(0<Af.length){Kl(Af[0],e);for(var r=1;r<Af.length;r++){var n=Af[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Vi!==null&&Kl(Vi,e),Gi!==null&&Kl(Gi,e),Yi!==null&&Kl(Yi,e),Vu.forEach(t),Gu.forEach(t),r=0;r<ji.length;r++)n=ji[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ji.length&&(r=ji[0],r.blockedOn===null);)_E(r),r.blockedOn===null&&ji.shift()}var Zo=Si.ReactCurrentBatchConfig,F0=!0;function E4(e,t,r,n){var a=Gt,i=Zo.transition;Zo.transition=null;try{Gt=1,Yg(e,t,r,n)}finally{Gt=a,Zo.transition=i}}function b4(e,t,r,n){var a=Gt,i=Zo.transition;Zo.transition=null;try{Gt=4,Yg(e,t,r,n)}finally{Gt=a,Zo.transition=i}}function Yg(e,t,r,n){if(F0){var a=vm(e,t,r,n);if(a===null)Hh(e,t,n,P0,r),mv(e,n);else if(y4(a,e,t,r,n))n.stopPropagation();else if(mv(e,n),t&4&&-1<v4.indexOf(e)){for(;a!==null;){var i=zc(a);if(i!==null&&yE(i),i=vm(e,t,r,n),i===null&&Hh(e,t,n,P0,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Hh(e,t,n,null,r)}}var P0=null;function vm(e,t,r,n){if(P0=null,e=$g(n),e=Fs(e),e!==null)if(t=so(e),t===null)e=null;else if(r=t.tag,r===13){if(e=fE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return P0=e,null}function TE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(u4()){case Hg:return 1;case mE:return 4;case k0:case c4:return 16;case gE:return 536870912;default:return 16}default:return 16}}var zi=null,Xg=null,u0=null;function SE(){if(u0)return u0;var e,t=Xg,r=t.length,n,a="value"in zi?zi.value:zi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return u0=a.slice(e,1<n?1-n:void 0)}function c0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cf(){return!0}function xv(){return!1}function Jn(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cf:xv,this.isPropagationStopped=xv,this}return mr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cf)},persist:function(){},isPersistent:Cf}),t}var Al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kg=Jn(Al),Uc=mr({},Al,{view:0,detail:0}),_4=Jn(Uc),Lh,Mh,Zl,Od=mr({},Uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zl&&(Zl&&e.type==="mousemove"?(Lh=e.screenX-Zl.screenX,Mh=e.screenY-Zl.screenY):Mh=Lh=0,Zl=e),Lh)},movementY:function(e){return"movementY"in e?e.movementY:Mh}}),vv=Jn(Od),T4=mr({},Od,{dataTransfer:0}),S4=Jn(T4),A4=mr({},Uc,{relatedTarget:0}),jh=Jn(A4),C4=mr({},Al,{animationName:0,elapsedTime:0,pseudoElement:0}),D4=Jn(C4),N4=mr({},Al,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),k4=Jn(N4),O4=mr({},Al,{data:0}),yv=Jn(O4),F4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},I4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function R4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=I4[e])?!!t[e]:!1}function Zg(){return R4}var L4=mr({},Uc,{key:function(e){if(e.key){var t=F4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=c0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zg,charCode:function(e){return e.type==="keypress"?c0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?c0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),M4=Jn(L4),j4=mr({},Od,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wv=Jn(j4),B4=mr({},Uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zg}),U4=Jn(B4),z4=mr({},Al,{propertyName:0,elapsedTime:0,pseudoElement:0}),W4=Jn(z4),q4=mr({},Od,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$4=Jn(q4),H4=[9,13,27,32],Qg=vi&&"CompositionEvent"in window,Eu=null;vi&&"documentMode"in document&&(Eu=document.documentMode);var V4=vi&&"TextEvent"in window&&!Eu,AE=vi&&(!Qg||Eu&&8<Eu&&11>=Eu),Ev=" ",bv=!1;function CE(e,t){switch(e){case"keyup":return H4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ro=!1;function G4(e,t){switch(e){case"compositionend":return DE(t);case"keypress":return t.which!==32?null:(bv=!0,Ev);case"textInput":return e=t.data,e===Ev&&bv?null:e;default:return null}}function Y4(e,t){if(Ro)return e==="compositionend"||!Qg&&CE(e,t)?(e=SE(),u0=Xg=zi=null,Ro=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return AE&&t.locale!=="ko"?null:t.data;default:return null}}var X4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _v(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!X4[e.type]:t==="textarea"}function NE(e,t,r,n){sE(n),t=I0(t,"onChange"),0<t.length&&(r=new Kg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var bu=null,Xu=null;function K4(e){UE(e,0)}function Fd(e){var t=jo(e);if(Jw(t))return e}function Z4(e,t){if(e==="change")return t}var kE=!1;if(vi){var Bh;if(vi){var Uh="oninput"in document;if(!Uh){var Tv=document.createElement("div");Tv.setAttribute("oninput","return;"),Uh=typeof Tv.oninput=="function"}Bh=Uh}else Bh=!1;kE=Bh&&(!document.documentMode||9<document.documentMode)}function Sv(){bu&&(bu.detachEvent("onpropertychange",OE),Xu=bu=null)}function OE(e){if(e.propertyName==="value"&&Fd(Xu)){var t=[];NE(t,Xu,e,$g(e)),cE(K4,t)}}function Q4(e,t,r){e==="focusin"?(Sv(),bu=t,Xu=r,bu.attachEvent("onpropertychange",OE)):e==="focusout"&&Sv()}function J4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fd(Xu)}function eC(e,t){if(e==="click")return Fd(t)}function tC(e,t){if(e==="input"||e==="change")return Fd(t)}function rC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ia=typeof Object.is=="function"?Object.is:rC;function Ku(e,t){if(Ia(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!em.call(t,a)||!Ia(e[a],t[a]))return!1}return!0}function Av(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cv(e,t){var r=Av(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Av(r)}}function FE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?FE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function PE(){for(var e=window,t=C0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=C0(e.document)}return t}function Jg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nC(e){var t=PE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&FE(r.ownerDocument.documentElement,r)){if(n!==null&&Jg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Cv(r,i);var s=Cv(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var aC=vi&&"documentMode"in document&&11>=document.documentMode,Lo=null,ym=null,_u=null,wm=!1;function Dv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wm||Lo==null||Lo!==C0(n)||(n=Lo,"selectionStart"in n&&Jg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_u&&Ku(_u,n)||(_u=n,n=I0(ym,"onSelect"),0<n.length&&(t=new Kg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Lo)))}function Df(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Mo={animationend:Df("Animation","AnimationEnd"),animationiteration:Df("Animation","AnimationIteration"),animationstart:Df("Animation","AnimationStart"),transitionend:Df("Transition","TransitionEnd")},zh={},IE={};vi&&(IE=document.createElement("div").style,"AnimationEvent"in window||(delete Mo.animationend.animation,delete Mo.animationiteration.animation,delete Mo.animationstart.animation),"TransitionEvent"in window||delete Mo.transitionend.transition);function Pd(e){if(zh[e])return zh[e];if(!Mo[e])return e;var t=Mo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in IE)return zh[e]=t[r];return e}var RE=Pd("animationend"),LE=Pd("animationiteration"),ME=Pd("animationstart"),jE=Pd("transitionend"),BE=new Map,Nv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hs(e,t){BE.set(e,t),io(t,[e])}for(var Wh=0;Wh<Nv.length;Wh++){var qh=Nv[Wh],iC=qh.toLowerCase(),sC=qh[0].toUpperCase()+qh.slice(1);hs(iC,"on"+sC)}hs(RE,"onAnimationEnd");hs(LE,"onAnimationIteration");hs(ME,"onAnimationStart");hs("dblclick","onDoubleClick");hs("focusin","onFocus");hs("focusout","onBlur");hs(jE,"onTransitionEnd");cl("onMouseEnter",["mouseout","mouseover"]);cl("onMouseLeave",["mouseout","mouseover"]);cl("onPointerEnter",["pointerout","pointerover"]);cl("onPointerLeave",["pointerout","pointerover"]);io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));io("onBeforeInput",["compositionend","keypress","textInput","paste"]);io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oC=new Set("cancel close invalid load scroll toggle".split(" ").concat(hu));function kv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,i4(n,t,void 0,e),e.currentTarget=null}function UE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;kv(a,o,u),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;kv(a,o,u),i=l}}}if(N0)throw e=mm,N0=!1,mm=null,e}function ir(e,t){var r=t[Sm];r===void 0&&(r=t[Sm]=new Set);var n=e+"__bubble";r.has(n)||(zE(t,e,2,!1),r.add(n))}function $h(e,t,r){var n=0;t&&(n|=4),zE(r,e,n,t)}var Nf="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Nf]){e[Nf]=!0,Yw.forEach(function(r){r!=="selectionchange"&&(oC.has(r)||$h(r,!1,e),$h(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nf]||(t[Nf]=!0,$h("selectionchange",!1,t))}}function zE(e,t,r,n){switch(TE(t)){case 1:var a=E4;break;case 4:a=b4;break;default:a=Yg}r=a.bind(null,t,r,e),a=void 0,!pm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Hh(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Fs(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}cE(function(){var u=i,c=$g(r),h=[];e:{var p=BE.get(e);if(p!==void 0){var x=Kg,E=e;switch(e){case"keypress":if(c0(r)===0)break e;case"keydown":case"keyup":x=M4;break;case"focusin":E="focus",x=jh;break;case"focusout":E="blur",x=jh;break;case"beforeblur":case"afterblur":x=jh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=vv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=S4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=U4;break;case RE:case LE:case ME:x=D4;break;case jE:x=W4;break;case"scroll":x=_4;break;case"wheel":x=$4;break;case"copy":case"cut":case"paste":x=k4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=wv}var g=(t&4)!==0,w=!g&&e==="scroll",v=g?p!==null?p+"Capture":null:p;g=[];for(var y=u,b;y!==null;){b=y;var T=b.stateNode;if(b.tag===5&&T!==null&&(b=T,v!==null&&(T=Hu(y,v),T!=null&&g.push(Qu(y,T,b)))),w)break;y=y.return}0<g.length&&(p=new x(p,E,null,r,c),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",p&&r!==dm&&(E=r.relatedTarget||r.fromElement)&&(Fs(E)||E[yi]))break e;if((x||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,x?(E=r.relatedTarget||r.toElement,x=u,E=E?Fs(E):null,E!==null&&(w=so(E),E!==w||E.tag!==5&&E.tag!==6)&&(E=null)):(x=null,E=u),x!==E)){if(g=vv,T="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=wv,T="onPointerLeave",v="onPointerEnter",y="pointer"),w=x==null?p:jo(x),b=E==null?p:jo(E),p=new g(T,y+"leave",x,r,c),p.target=w,p.relatedTarget=b,T=null,Fs(c)===u&&(g=new g(v,y+"enter",E,r,c),g.target=b,g.relatedTarget=w,T=g),w=T,x&&E)t:{for(g=x,v=E,y=0,b=g;b;b=yo(b))y++;for(b=0,T=v;T;T=yo(T))b++;for(;0<y-b;)g=yo(g),y--;for(;0<b-y;)v=yo(v),b--;for(;y--;){if(g===v||v!==null&&g===v.alternate)break t;g=yo(g),v=yo(v)}g=null}else g=null;x!==null&&Ov(h,p,x,g,!1),E!==null&&w!==null&&Ov(h,w,E,g,!0)}}e:{if(p=u?jo(u):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var N=Z4;else if(_v(p))if(kE)N=tC;else{N=J4;var k=Q4}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=eC);if(N&&(N=N(e,u))){NE(h,N,r,c);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&om(p,"number",p.value)}switch(k=u?jo(u):window,e){case"focusin":(_v(k)||k.contentEditable==="true")&&(Lo=k,ym=u,_u=null);break;case"focusout":_u=ym=Lo=null;break;case"mousedown":wm=!0;break;case"contextmenu":case"mouseup":case"dragend":wm=!1,Dv(h,r,c);break;case"selectionchange":if(aC)break;case"keydown":case"keyup":Dv(h,r,c)}var _;if(Qg)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Ro?CE(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(AE&&r.locale!=="ko"&&(Ro||S!=="onCompositionStart"?S==="onCompositionEnd"&&Ro&&(_=SE()):(zi=c,Xg="value"in zi?zi.value:zi.textContent,Ro=!0)),k=I0(u,S),0<k.length&&(S=new yv(S,e,null,r,c),h.push({event:S,listeners:k}),_?S.data=_:(_=DE(r),_!==null&&(S.data=_)))),(_=V4?G4(e,r):Y4(e,r))&&(u=I0(u,"onBeforeInput"),0<u.length&&(c=new yv("onBeforeInput","beforeinput",null,r,c),h.push({event:c,listeners:u}),c.data=_))}UE(h,t)})}function Qu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function I0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Hu(e,r),i!=null&&n.unshift(Qu(e,i,a)),i=Hu(e,t),i!=null&&n.push(Qu(e,i,a))),e=e.return}return n}function yo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ov(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,a?(l=Hu(r,i),l!=null&&s.unshift(Qu(r,l,o))):a||(l=Hu(r,i),l!=null&&s.push(Qu(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var lC=/\r\n?/g,uC=/\u0000|\uFFFD/g;function Fv(e){return(typeof e=="string"?e:""+e).replace(lC,`
`).replace(uC,"")}function kf(e,t,r){if(t=Fv(t),Fv(e)!==t&&r)throw Error(Le(425))}function R0(){}var Em=null,bm=null;function _m(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Tm=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,Pv=typeof Promise=="function"?Promise:void 0,fC=typeof queueMicrotask=="function"?queueMicrotask:typeof Pv<"u"?function(e){return Pv.resolve(null).then(e).catch(dC)}:Tm;function dC(e){setTimeout(function(){throw e})}function Vh(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Yu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Yu(t)}function Xi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Iv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Cl=Math.random().toString(36).slice(2),Ga="__reactFiber$"+Cl,Ju="__reactProps$"+Cl,yi="__reactContainer$"+Cl,Sm="__reactEvents$"+Cl,hC="__reactListeners$"+Cl,pC="__reactHandles$"+Cl;function Fs(e){var t=e[Ga];if(t)return t;for(var r=e.parentNode;r;){if(t=r[yi]||r[Ga]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Iv(e);e!==null;){if(r=e[Ga])return r;e=Iv(e)}return t}e=r,r=e.parentNode}return null}function zc(e){return e=e[Ga]||e[yi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function jo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Le(33))}function Id(e){return e[Ju]||null}var Am=[],Bo=-1;function ps(e){return{current:e}}function or(e){0>Bo||(e.current=Am[Bo],Am[Bo]=null,Bo--)}function rr(e,t){Bo++,Am[Bo]=e.current,e.current=t}var rs={},pn=ps(rs),Nn=ps(!1),Hs=rs;function fl(e,t){var r=e.type.contextTypes;if(!r)return rs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function kn(e){return e=e.childContextTypes,e!=null}function L0(){or(Nn),or(pn)}function Rv(e,t,r){if(pn.current!==rs)throw Error(Le(168));rr(pn,t),rr(Nn,r)}function WE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Le(108,QA(e)||"Unknown",a));return mr({},r,n)}function M0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||rs,Hs=pn.current,rr(pn,e),rr(Nn,Nn.current),!0}function Lv(e,t,r){var n=e.stateNode;if(!n)throw Error(Le(169));r?(e=WE(e,t,Hs),n.__reactInternalMemoizedMergedChildContext=e,or(Nn),or(pn),rr(pn,e)):or(Nn),rr(Nn,r)}var ii=null,Rd=!1,Gh=!1;function qE(e){ii===null?ii=[e]:ii.push(e)}function mC(e){Rd=!0,qE(e)}function ms(){if(!Gh&&ii!==null){Gh=!0;var e=0,t=Gt;try{var r=ii;for(Gt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ii=null,Rd=!1}catch(a){throw ii!==null&&(ii=ii.slice(e+1)),pE(Hg,ms),a}finally{Gt=t,Gh=!1}}return null}var Uo=[],zo=0,j0=null,B0=0,sa=[],oa=0,Vs=null,li=1,ui="";function Cs(e,t){Uo[zo++]=B0,Uo[zo++]=j0,j0=e,B0=t}function $E(e,t,r){sa[oa++]=li,sa[oa++]=ui,sa[oa++]=Vs,Vs=e;var n=li;e=ui;var a=32-ka(n)-1;n&=~(1<<a),r+=1;var i=32-ka(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,li=1<<32-ka(t)+a|r<<a|n,ui=i+e}else li=1<<i|r<<a|n,ui=e}function e1(e){e.return!==null&&(Cs(e,1),$E(e,1,0))}function t1(e){for(;e===j0;)j0=Uo[--zo],Uo[zo]=null,B0=Uo[--zo],Uo[zo]=null;for(;e===Vs;)Vs=sa[--oa],sa[oa]=null,ui=sa[--oa],sa[oa]=null,li=sa[--oa],sa[oa]=null}var Yn=null,Gn=null,fr=!1,Aa=null;function HE(e,t){var r=la(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Mv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yn=e,Gn=Xi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yn=e,Gn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Vs!==null?{id:li,overflow:ui}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=la(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Yn=e,Gn=null,!0):!1;default:return!1}}function Cm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Dm(e){if(fr){var t=Gn;if(t){var r=t;if(!Mv(e,t)){if(Cm(e))throw Error(Le(418));t=Xi(r.nextSibling);var n=Yn;t&&Mv(e,t)?HE(n,r):(e.flags=e.flags&-4097|2,fr=!1,Yn=e)}}else{if(Cm(e))throw Error(Le(418));e.flags=e.flags&-4097|2,fr=!1,Yn=e}}}function jv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yn=e}function Of(e){if(e!==Yn)return!1;if(!fr)return jv(e),fr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_m(e.type,e.memoizedProps)),t&&(t=Gn)){if(Cm(e))throw VE(),Error(Le(418));for(;t;)HE(e,t),t=Xi(t.nextSibling)}if(jv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Gn=Xi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Gn=null}}else Gn=Yn?Xi(e.stateNode.nextSibling):null;return!0}function VE(){for(var e=Gn;e;)e=Xi(e.nextSibling)}function dl(){Gn=Yn=null,fr=!1}function r1(e){Aa===null?Aa=[e]:Aa.push(e)}var gC=Si.ReactCurrentBatchConfig;function Ql(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Le(309));var n=r.stateNode}if(!n)throw Error(Le(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Le(284));if(!r._owner)throw Error(Le(290,e))}return e}function Ff(e,t){throw e=Object.prototype.toString.call(t),Error(Le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Bv(e){var t=e._init;return t(e._payload)}function GE(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=Ji(v,y),v.index=0,v.sibling=null,v}function i(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,b,T){return y===null||y.tag!==6?(y=ep(b,v.mode,T),y.return=v,y):(y=a(y,b),y.return=v,y)}function l(v,y,b,T){var N=b.type;return N===Io?c(v,y,b.props.children,T,b.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ri&&Bv(N)===y.type)?(T=a(y,b.props),T.ref=Ql(v,y,b),T.return=v,T):(T=x0(b.type,b.key,b.props,null,v.mode,T),T.ref=Ql(v,y,b),T.return=v,T)}function u(v,y,b,T){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=tp(b,v.mode,T),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function c(v,y,b,T,N){return y===null||y.tag!==7?(y=Bs(b,v.mode,T,N),y.return=v,y):(y=a(y,b),y.return=v,y)}function h(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=ep(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ef:return b=x0(y.type,y.key,y.props,null,v.mode,b),b.ref=Ql(v,null,y),b.return=v,b;case Po:return y=tp(y,v.mode,b),y.return=v,y;case Ri:var T=y._init;return h(v,T(y._payload),b)}if(fu(y)||Gl(y))return y=Bs(y,v.mode,b,null),y.return=v,y;Ff(v,y)}return null}function p(v,y,b,T){var N=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:o(v,y,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ef:return b.key===N?l(v,y,b,T):null;case Po:return b.key===N?u(v,y,b,T):null;case Ri:return N=b._init,p(v,y,N(b._payload),T)}if(fu(b)||Gl(b))return N!==null?null:c(v,y,b,T,null);Ff(v,b)}return null}function x(v,y,b,T,N){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(b)||null,o(y,v,""+T,N);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ef:return v=v.get(T.key===null?b:T.key)||null,l(y,v,T,N);case Po:return v=v.get(T.key===null?b:T.key)||null,u(y,v,T,N);case Ri:var k=T._init;return x(v,y,b,k(T._payload),N)}if(fu(T)||Gl(T))return v=v.get(b)||null,c(y,v,T,N,null);Ff(y,T)}return null}function E(v,y,b,T){for(var N=null,k=null,_=y,S=y=0,A=null;_!==null&&S<b.length;S++){_.index>S?(A=_,_=null):A=_.sibling;var P=p(v,_,b[S],T);if(P===null){_===null&&(_=A);break}e&&_&&P.alternate===null&&t(v,_),y=i(P,y,S),k===null?N=P:k.sibling=P,k=P,_=A}if(S===b.length)return r(v,_),fr&&Cs(v,S),N;if(_===null){for(;S<b.length;S++)_=h(v,b[S],T),_!==null&&(y=i(_,y,S),k===null?N=_:k.sibling=_,k=_);return fr&&Cs(v,S),N}for(_=n(v,_);S<b.length;S++)A=x(_,v,S,b[S],T),A!==null&&(e&&A.alternate!==null&&_.delete(A.key===null?S:A.key),y=i(A,y,S),k===null?N=A:k.sibling=A,k=A);return e&&_.forEach(function(I){return t(v,I)}),fr&&Cs(v,S),N}function g(v,y,b,T){var N=Gl(b);if(typeof N!="function")throw Error(Le(150));if(b=N.call(b),b==null)throw Error(Le(151));for(var k=N=null,_=y,S=y=0,A=null,P=b.next();_!==null&&!P.done;S++,P=b.next()){_.index>S?(A=_,_=null):A=_.sibling;var I=p(v,_,P.value,T);if(I===null){_===null&&(_=A);break}e&&_&&I.alternate===null&&t(v,_),y=i(I,y,S),k===null?N=I:k.sibling=I,k=I,_=A}if(P.done)return r(v,_),fr&&Cs(v,S),N;if(_===null){for(;!P.done;S++,P=b.next())P=h(v,P.value,T),P!==null&&(y=i(P,y,S),k===null?N=P:k.sibling=P,k=P);return fr&&Cs(v,S),N}for(_=n(v,_);!P.done;S++,P=b.next())P=x(_,v,S,P.value,T),P!==null&&(e&&P.alternate!==null&&_.delete(P.key===null?S:P.key),y=i(P,y,S),k===null?N=P:k.sibling=P,k=P);return e&&_.forEach(function(W){return t(v,W)}),fr&&Cs(v,S),N}function w(v,y,b,T){if(typeof b=="object"&&b!==null&&b.type===Io&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ef:e:{for(var N=b.key,k=y;k!==null;){if(k.key===N){if(N=b.type,N===Io){if(k.tag===7){r(v,k.sibling),y=a(k,b.props.children),y.return=v,v=y;break e}}else if(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ri&&Bv(N)===k.type){r(v,k.sibling),y=a(k,b.props),y.ref=Ql(v,k,b),y.return=v,v=y;break e}r(v,k);break}else t(v,k);k=k.sibling}b.type===Io?(y=Bs(b.props.children,v.mode,T,b.key),y.return=v,v=y):(T=x0(b.type,b.key,b.props,null,v.mode,T),T.ref=Ql(v,y,b),T.return=v,v=T)}return s(v);case Po:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=tp(b,v.mode,T),y.return=v,v=y}return s(v);case Ri:return k=b._init,w(v,y,k(b._payload),T)}if(fu(b))return E(v,y,b,T);if(Gl(b))return g(v,y,b,T);Ff(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=ep(b,v.mode,T),y.return=v,v=y),s(v)):r(v,y)}return w}var hl=GE(!0),YE=GE(!1),U0=ps(null),z0=null,Wo=null,n1=null;function a1(){n1=Wo=z0=null}function i1(e){var t=U0.current;or(U0),e._currentValue=t}function Nm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qo(e,t){z0=e,n1=Wo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dn=!0),e.firstContext=null)}function fa(e){var t=e._currentValue;if(n1!==e)if(e={context:e,memoizedValue:t,next:null},Wo===null){if(z0===null)throw Error(Le(308));Wo=e,z0.dependencies={lanes:0,firstContext:e}}else Wo=Wo.next=e;return t}var Ps=null;function s1(e){Ps===null?Ps=[e]:Ps.push(e)}function XE(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,s1(t)):(r.next=a.next,a.next=r),t.interleaved=r,wi(e,n)}function wi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Li=!1;function o1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ki(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Lt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,wi(e,r)}return a=n.interleaved,a===null?(t.next=t,s1(n)):(t.next=a.next,a.next=t),n.interleaved=t,wi(e,r)}function f0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Vg(e,r)}}function Uv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function W0(e,t,r,n){var a=e.updateQueue;Li=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?i=u:s.next=u,s=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(i!==null){var h=a.baseState;s=0,c=u=l=null,o=i;do{var p=o.lane,x=o.eventTime;if((n&p)===p){c!==null&&(c=c.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var E=e,g=o;switch(p=t,x=r,g.tag){case 1:if(E=g.payload,typeof E=="function"){h=E.call(x,h,p);break e}h=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=g.payload,p=typeof E=="function"?E.call(x,h,p):E,p==null)break e;h=mr({},h,p);break e;case 2:Li=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else x={eventTime:x,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=x,l=h):c=c.next=x,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=h),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ys|=s,e.lanes=s,e.memoizedState=h}}function zv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Le(191,a));a.call(n)}}}var Wc={},Xa=ps(Wc),ec=ps(Wc),tc=ps(Wc);function Is(e){if(e===Wc)throw Error(Le(174));return e}function l1(e,t){switch(rr(tc,t),rr(ec,e),rr(Xa,Wc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:um(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=um(t,e)}or(Xa),rr(Xa,t)}function pl(){or(Xa),or(ec),or(tc)}function ZE(e){Is(tc.current);var t=Is(Xa.current),r=um(t,e.type);t!==r&&(rr(ec,e),rr(Xa,r))}function u1(e){ec.current===e&&(or(Xa),or(ec))}var dr=ps(0);function q0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yh=[];function c1(){for(var e=0;e<Yh.length;e++)Yh[e]._workInProgressVersionPrimary=null;Yh.length=0}var d0=Si.ReactCurrentDispatcher,Xh=Si.ReactCurrentBatchConfig,Gs=0,pr=null,Or=null,Mr=null,$0=!1,Tu=!1,rc=0,xC=0;function sn(){throw Error(Le(321))}function f1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ia(e[r],t[r]))return!1;return!0}function d1(e,t,r,n,a,i){if(Gs=i,pr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,d0.current=e===null||e.memoizedState===null?EC:bC,e=r(n,a),Tu){i=0;do{if(Tu=!1,rc=0,25<=i)throw Error(Le(301));i+=1,Mr=Or=null,t.updateQueue=null,d0.current=_C,e=r(n,a)}while(Tu)}if(d0.current=H0,t=Or!==null&&Or.next!==null,Gs=0,Mr=Or=pr=null,$0=!1,t)throw Error(Le(300));return e}function h1(){var e=rc!==0;return rc=0,e}function $a(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?pr.memoizedState=Mr=e:Mr=Mr.next=e,Mr}function da(){if(Or===null){var e=pr.alternate;e=e!==null?e.memoizedState:null}else e=Or.next;var t=Mr===null?pr.memoizedState:Mr.next;if(t!==null)Mr=t,Or=e;else{if(e===null)throw Error(Le(310));Or=e,e={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Mr===null?pr.memoizedState=Mr=e:Mr=Mr.next=e}return Mr}function nc(e,t){return typeof t=="function"?t(e):t}function Kh(e){var t=da(),r=t.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=e;var n=Or,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,u=i;do{var c=u.lane;if((Gs&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,s=n):l=l.next=h,pr.lanes|=c,Ys|=c}u=u.next}while(u!==null&&u!==i);l===null?s=n:l.next=o,Ia(n,t.memoizedState)||(Dn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,pr.lanes|=i,Ys|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Zh(e){var t=da(),r=t.queue;if(r===null)throw Error(Le(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Ia(i,t.memoizedState)||(Dn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function QE(){}function JE(e,t){var r=pr,n=da(),a=t(),i=!Ia(n.memoizedState,a);if(i&&(n.memoizedState=a,Dn=!0),n=n.queue,p1(rb.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Mr!==null&&Mr.memoizedState.tag&1){if(r.flags|=2048,ac(9,tb.bind(null,r,n,a,t),void 0,null),zr===null)throw Error(Le(349));Gs&30||eb(r,t,a)}return a}function eb(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=pr.updateQueue,t===null?(t={lastEffect:null,stores:null},pr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tb(e,t,r,n){t.value=r,t.getSnapshot=n,nb(t)&&ab(e)}function rb(e,t,r){return r(function(){nb(t)&&ab(e)})}function nb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ia(e,r)}catch{return!0}}function ab(e){var t=wi(e,1);t!==null&&Oa(t,e,1,-1)}function Wv(e){var t=$a();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nc,lastRenderedState:e},t.queue=e,e=e.dispatch=wC.bind(null,pr,e),[t.memoizedState,e]}function ac(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=pr.updateQueue,t===null?(t={lastEffect:null,stores:null},pr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ib(){return da().memoizedState}function h0(e,t,r,n){var a=$a();pr.flags|=e,a.memoizedState=ac(1|t,r,void 0,n===void 0?null:n)}function Ld(e,t,r,n){var a=da();n=n===void 0?null:n;var i=void 0;if(Or!==null){var s=Or.memoizedState;if(i=s.destroy,n!==null&&f1(n,s.deps)){a.memoizedState=ac(t,r,i,n);return}}pr.flags|=e,a.memoizedState=ac(1|t,r,i,n)}function qv(e,t){return h0(8390656,8,e,t)}function p1(e,t){return Ld(2048,8,e,t)}function sb(e,t){return Ld(4,2,e,t)}function ob(e,t){return Ld(4,4,e,t)}function lb(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ub(e,t,r){return r=r!=null?r.concat([e]):null,Ld(4,4,lb.bind(null,t,e),r)}function m1(){}function cb(e,t){var r=da();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&f1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function fb(e,t){var r=da();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&f1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function db(e,t,r){return Gs&21?(Ia(r,t)||(r=xE(),pr.lanes|=r,Ys|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dn=!0),e.memoizedState=r)}function vC(e,t){var r=Gt;Gt=r!==0&&4>r?r:4,e(!0);var n=Xh.transition;Xh.transition={};try{e(!1),t()}finally{Gt=r,Xh.transition=n}}function hb(){return da().memoizedState}function yC(e,t,r){var n=Qi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pb(e))mb(t,r);else if(r=XE(e,t,r,n),r!==null){var a=bn();Oa(r,e,n,a),gb(r,t,n)}}function wC(e,t,r){var n=Qi(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pb(e))mb(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Ia(o,s)){var l=t.interleaved;l===null?(a.next=a,s1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=XE(e,t,a,n),r!==null&&(a=bn(),Oa(r,e,n,a),gb(r,t,n))}}function pb(e){var t=e.alternate;return e===pr||t!==null&&t===pr}function mb(e,t){Tu=$0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gb(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Vg(e,r)}}var H0={readContext:fa,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},EC={readContext:fa,useCallback:function(e,t){return $a().memoizedState=[e,t===void 0?null:t],e},useContext:fa,useEffect:qv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,h0(4194308,4,lb.bind(null,t,e),r)},useLayoutEffect:function(e,t){return h0(4194308,4,e,t)},useInsertionEffect:function(e,t){return h0(4,2,e,t)},useMemo:function(e,t){var r=$a();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=$a();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yC.bind(null,pr,e),[n.memoizedState,e]},useRef:function(e){var t=$a();return e={current:e},t.memoizedState=e},useState:Wv,useDebugValue:m1,useDeferredValue:function(e){return $a().memoizedState=e},useTransition:function(){var e=Wv(!1),t=e[0];return e=vC.bind(null,e[1]),$a().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=pr,a=$a();if(fr){if(r===void 0)throw Error(Le(407));r=r()}else{if(r=t(),zr===null)throw Error(Le(349));Gs&30||eb(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,qv(rb.bind(null,n,i,e),[e]),n.flags|=2048,ac(9,tb.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=$a(),t=zr.identifierPrefix;if(fr){var r=ui,n=li;r=(n&~(1<<32-ka(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=rc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=xC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bC={readContext:fa,useCallback:cb,useContext:fa,useEffect:p1,useImperativeHandle:ub,useInsertionEffect:sb,useLayoutEffect:ob,useMemo:fb,useReducer:Kh,useRef:ib,useState:function(){return Kh(nc)},useDebugValue:m1,useDeferredValue:function(e){var t=da();return db(t,Or.memoizedState,e)},useTransition:function(){var e=Kh(nc)[0],t=da().memoizedState;return[e,t]},useMutableSource:QE,useSyncExternalStore:JE,useId:hb,unstable_isNewReconciler:!1},_C={readContext:fa,useCallback:cb,useContext:fa,useEffect:p1,useImperativeHandle:ub,useInsertionEffect:sb,useLayoutEffect:ob,useMemo:fb,useReducer:Zh,useRef:ib,useState:function(){return Zh(nc)},useDebugValue:m1,useDeferredValue:function(e){var t=da();return Or===null?t.memoizedState=e:db(t,Or.memoizedState,e)},useTransition:function(){var e=Zh(nc)[0],t=da().memoizedState;return[e,t]},useMutableSource:QE,useSyncExternalStore:JE,useId:hb,unstable_isNewReconciler:!1};function Ta(e,t){if(e&&e.defaultProps){t=mr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function km(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:mr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Md={isMounted:function(e){return(e=e._reactInternals)?so(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=bn(),a=Qi(e),i=fi(n,a);i.payload=t,r!=null&&(i.callback=r),t=Ki(e,i,a),t!==null&&(Oa(t,e,a,n),f0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=bn(),a=Qi(e),i=fi(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ki(e,i,a),t!==null&&(Oa(t,e,a,n),f0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=bn(),n=Qi(e),a=fi(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ki(e,a,n),t!==null&&(Oa(t,e,n,r),f0(t,e,n))}};function $v(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Ku(r,n)||!Ku(a,i):!0}function xb(e,t,r){var n=!1,a=rs,i=t.contextType;return typeof i=="object"&&i!==null?i=fa(i):(a=kn(t)?Hs:pn.current,n=t.contextTypes,i=(n=n!=null)?fl(e,a):rs),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Md,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Hv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Md.enqueueReplaceState(t,t.state,null)}function Om(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},o1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=fa(i):(i=kn(t)?Hs:pn.current,a.context=fl(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(km(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Md.enqueueReplaceState(a,a.state,null),W0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ml(e,t){try{var r="",n=t;do r+=ZA(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Qh(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Fm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var TC=typeof WeakMap=="function"?WeakMap:Map;function vb(e,t,r){r=fi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){G0||(G0=!0,Wm=n),Fm(e,t)},r}function yb(e,t,r){r=fi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Fm(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Fm(e,t),typeof n!="function"&&(Zi===null?Zi=new Set([this]):Zi.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function Vv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new TC;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=jC.bind(null,e,t,r),t.then(e,e))}function Gv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Yv(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fi(-1,1),t.tag=2,Ki(r,t,1))),r.lanes|=1),e)}var SC=Si.ReactCurrentOwner,Dn=!1;function vn(e,t,r,n){t.child=e===null?YE(t,null,r,n):hl(t,e.child,r,n)}function Xv(e,t,r,n,a){r=r.render;var i=t.ref;return Qo(t,a),n=d1(e,t,r,n,i,a),r=h1(),e!==null&&!Dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ei(e,t,a)):(fr&&r&&e1(t),t.flags|=1,vn(e,t,n,a),t.child)}function Kv(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!_1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,wb(e,t,i,n,a)):(e=x0(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ku,r(s,n)&&e.ref===t.ref)return Ei(e,t,a)}return t.flags|=1,e=Ji(i,n),e.ref=t.ref,e.return=t,t.child=e}function wb(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Ku(i,n)&&e.ref===t.ref)if(Dn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Dn=!0);else return t.lanes=e.lanes,Ei(e,t,a)}return Pm(e,t,r,n,a)}function Eb(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rr($o,qn),qn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rr($o,qn),qn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,rr($o,qn),qn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,rr($o,qn),qn|=n;return vn(e,t,a,r),t.child}function bb(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pm(e,t,r,n,a){var i=kn(r)?Hs:pn.current;return i=fl(t,i),Qo(t,a),r=d1(e,t,r,n,i,a),n=h1(),e!==null&&!Dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ei(e,t,a)):(fr&&n&&e1(t),t.flags|=1,vn(e,t,r,a),t.child)}function Zv(e,t,r,n,a){if(kn(r)){var i=!0;M0(t)}else i=!1;if(Qo(t,a),t.stateNode===null)p0(e,t),xb(t,r,n),Om(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=fa(u):(u=kn(r)?Hs:pn.current,u=fl(t,u));var c=r.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Hv(t,s,n,u),Li=!1;var p=t.memoizedState;s.state=p,W0(t,n,s,a),l=t.memoizedState,o!==n||p!==l||Nn.current||Li?(typeof c=="function"&&(km(t,r,c,n),l=t.memoizedState),(o=Li||$v(t,r,o,n,p,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,KE(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ta(t.type,o),s.props=u,h=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=fa(l):(l=kn(r)?Hs:pn.current,l=fl(t,l));var x=r.getDerivedStateFromProps;(c=typeof x=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==h||p!==l)&&Hv(t,s,n,l),Li=!1,p=t.memoizedState,s.state=p,W0(t,n,s,a);var E=t.memoizedState;o!==h||p!==E||Nn.current||Li?(typeof x=="function"&&(km(t,r,x,n),E=t.memoizedState),(u=Li||$v(t,r,u,n,p,E,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,E,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,E,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=E),s.props=n,s.state=E,s.context=l,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Im(e,t,r,n,i,a)}function Im(e,t,r,n,a,i){bb(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&Lv(t,r,!1),Ei(e,t,i);n=t.stateNode,SC.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=hl(t,e.child,null,i),t.child=hl(t,null,o,i)):vn(e,t,o,i),t.memoizedState=n.state,a&&Lv(t,r,!0),t.child}function _b(e){var t=e.stateNode;t.pendingContext?Rv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Rv(e,t.context,!1),l1(e,t.containerInfo)}function Qv(e,t,r,n,a){return dl(),r1(a),t.flags|=256,vn(e,t,r,n),t.child}var Rm={dehydrated:null,treeContext:null,retryLane:0};function Lm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Tb(e,t,r){var n=t.pendingProps,a=dr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),rr(dr,a&1),e===null)return Dm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ud(s,n,0,null),e=Bs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Lm(r),t.memoizedState=Rm,e):g1(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return AC(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ji(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Ji(o,i):(i=Bs(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Lm(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Rm,n}return i=e.child,e=i.sibling,n=Ji(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function g1(e,t){return t=Ud({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pf(e,t,r,n){return n!==null&&r1(n),hl(t,e.child,null,r),e=g1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function AC(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Qh(Error(Le(422))),Pf(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ud({mode:"visible",children:n.children},a,0,null),i=Bs(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&hl(t,e.child,null,s),t.child.memoizedState=Lm(s),t.memoizedState=Rm,i);if(!(t.mode&1))return Pf(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Le(419)),n=Qh(i,n,void 0),Pf(e,t,s,n)}if(o=(s&e.childLanes)!==0,Dn||o){if(n=zr,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,wi(e,a),Oa(n,e,a,-1))}return b1(),n=Qh(Error(Le(421))),Pf(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=BC.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Gn=Xi(a.nextSibling),Yn=t,fr=!0,Aa=null,e!==null&&(sa[oa++]=li,sa[oa++]=ui,sa[oa++]=Vs,li=e.id,ui=e.overflow,Vs=t),t=g1(t,n.children),t.flags|=4096,t)}function Jv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Nm(e.return,t,r)}function Jh(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Sb(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(vn(e,t,n.children,r),n=dr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Jv(e,r,t);else if(e.tag===19)Jv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(rr(dr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&q0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Jh(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&q0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Jh(t,!0,r,null,i);break;case"together":Jh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function p0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ei(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ys|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Le(153));if(t.child!==null){for(e=t.child,r=Ji(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ji(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function CC(e,t,r){switch(t.tag){case 3:_b(t),dl();break;case 5:ZE(t);break;case 1:kn(t.type)&&M0(t);break;case 4:l1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;rr(U0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(rr(dr,dr.current&1),t.flags|=128,null):r&t.child.childLanes?Tb(e,t,r):(rr(dr,dr.current&1),e=Ei(e,t,r),e!==null?e.sibling:null);rr(dr,dr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Sb(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),rr(dr,dr.current),n)break;return null;case 22:case 23:return t.lanes=0,Eb(e,t,r)}return Ei(e,t,r)}var Ab,Mm,Cb,Db;Ab=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Mm=function(){};Cb=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Is(Xa.current);var i=null;switch(r){case"input":a=im(e,a),n=im(e,n),i=[];break;case"select":a=mr({},a,{value:void 0}),n=mr({},n,{value:void 0}),i=[];break;case"textarea":a=lm(e,a),n=lm(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=R0)}cm(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ir("scroll",e),i||o===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};Db=function(e,t,r,n){r!==n&&(t.flags|=4)};function Jl(e,t){if(!fr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function on(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function DC(e,t,r){var n=t.pendingProps;switch(t1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(t),null;case 1:return kn(t.type)&&L0(),on(t),null;case 3:return n=t.stateNode,pl(),or(Nn),or(pn),c1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Of(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Aa!==null&&(Hm(Aa),Aa=null))),Mm(e,t),on(t),null;case 5:u1(t);var a=Is(tc.current);if(r=t.type,e!==null&&t.stateNode!=null)Cb(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Le(166));return on(t),null}if(e=Is(Xa.current),Of(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Ga]=t,n[Ju]=i,e=(t.mode&1)!==0,r){case"dialog":ir("cancel",n),ir("close",n);break;case"iframe":case"object":case"embed":ir("load",n);break;case"video":case"audio":for(a=0;a<hu.length;a++)ir(hu[a],n);break;case"source":ir("error",n);break;case"img":case"image":case"link":ir("error",n),ir("load",n);break;case"details":ir("toggle",n);break;case"input":lv(n,i),ir("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ir("invalid",n);break;case"textarea":cv(n,i),ir("invalid",n)}cm(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&kf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&kf(n.textContent,o,e),a=["children",""+o]):qu.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&ir("scroll",n)}switch(r){case"input":bf(n),uv(n,i,!0);break;case"textarea":bf(n),fv(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=R0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Ga]=t,e[Ju]=n,Ab(e,t,!1,!1),t.stateNode=e;e:{switch(s=fm(r,n),r){case"dialog":ir("cancel",e),ir("close",e),a=n;break;case"iframe":case"object":case"embed":ir("load",e),a=n;break;case"video":case"audio":for(a=0;a<hu.length;a++)ir(hu[a],e);a=n;break;case"source":ir("error",e),a=n;break;case"img":case"image":case"link":ir("error",e),ir("load",e),a=n;break;case"details":ir("toggle",e),a=n;break;case"input":lv(e,n),a=im(e,n),ir("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=mr({},n,{value:void 0}),ir("invalid",e);break;case"textarea":cv(e,n),a=lm(e,n),ir("invalid",e);break;default:a=n}cm(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?iE(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&nE(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&$u(e,l):typeof l=="number"&&$u(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&ir("scroll",e):l!=null&&Ug(e,i,l,s))}switch(r){case"input":bf(e),uv(e,n,!1);break;case"textarea":bf(e),fv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ts(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Yo(e,!!n.multiple,i,!1):n.defaultValue!=null&&Yo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=R0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return on(t),null;case 6:if(e&&t.stateNode!=null)Db(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Le(166));if(r=Is(tc.current),Is(Xa.current),Of(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ga]=t,(i=n.nodeValue!==r)&&(e=Yn,e!==null))switch(e.tag){case 3:kf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&kf(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ga]=t,t.stateNode=n}return on(t),null;case 13:if(or(dr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(fr&&Gn!==null&&t.mode&1&&!(t.flags&128))VE(),dl(),t.flags|=98560,i=!1;else if(i=Of(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Le(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Le(317));i[Ga]=t}else dl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;on(t),i=!1}else Aa!==null&&(Hm(Aa),Aa=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||dr.current&1?Fr===0&&(Fr=3):b1())),t.updateQueue!==null&&(t.flags|=4),on(t),null);case 4:return pl(),Mm(e,t),e===null&&Zu(t.stateNode.containerInfo),on(t),null;case 10:return i1(t.type._context),on(t),null;case 17:return kn(t.type)&&L0(),on(t),null;case 19:if(or(dr),i=t.memoizedState,i===null)return on(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Jl(i,!1);else{if(Fr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=q0(e),s!==null){for(t.flags|=128,Jl(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return rr(dr,dr.current&1|2),t.child}e=e.sibling}i.tail!==null&&_r()>gl&&(t.flags|=128,n=!0,Jl(i,!1),t.lanes=4194304)}else{if(!n)if(e=q0(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Jl(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!fr)return on(t),null}else 2*_r()-i.renderingStartTime>gl&&r!==1073741824&&(t.flags|=128,n=!0,Jl(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=_r(),t.sibling=null,r=dr.current,rr(dr,n?r&1|2:r&1),t):(on(t),null);case 22:case 23:return E1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?qn&1073741824&&(on(t),t.subtreeFlags&6&&(t.flags|=8192)):on(t),null;case 24:return null;case 25:return null}throw Error(Le(156,t.tag))}function NC(e,t){switch(t1(t),t.tag){case 1:return kn(t.type)&&L0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pl(),or(Nn),or(pn),c1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return u1(t),null;case 13:if(or(dr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Le(340));dl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return or(dr),null;case 4:return pl(),null;case 10:return i1(t.type._context),null;case 22:case 23:return E1(),null;case 24:return null;default:return null}}var If=!1,ln=!1,kC=typeof WeakSet=="function"?WeakSet:Set,tt=null;function qo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vr(e,t,n)}else r.current=null}function jm(e,t,r){try{r()}catch(n){vr(e,t,n)}}var e2=!1;function OC(e,t){if(Em=F0,e=PE(),Jg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,u=0,c=0,h=e,p=null;t:for(;;){for(var x;h!==r||a!==0&&h.nodeType!==3||(o=s+a),h!==i||n!==0&&h.nodeType!==3||(l=s+n),h.nodeType===3&&(s+=h.nodeValue.length),(x=h.firstChild)!==null;)p=h,h=x;for(;;){if(h===e)break t;if(p===r&&++u===a&&(o=s),p===i&&++c===n&&(l=s),(x=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=x}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(bm={focusedElem:e,selectionRange:r},F0=!1,tt=t;tt!==null;)if(t=tt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,tt=e;else for(;tt!==null;){t=tt;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var g=E.memoizedProps,w=E.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ta(t.type,g),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(T){vr(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,tt=e;break}tt=t.return}return E=e2,e2=!1,E}function Su(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&jm(t,r,i)}a=a.next}while(a!==n)}}function jd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Bm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Nb(e){var t=e.alternate;t!==null&&(e.alternate=null,Nb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ga],delete t[Ju],delete t[Sm],delete t[hC],delete t[pC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kb(e){return e.tag===5||e.tag===3||e.tag===4}function t2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Um(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=R0));else if(n!==4&&(e=e.child,e!==null))for(Um(e,t,r),e=e.sibling;e!==null;)Um(e,t,r),e=e.sibling}function zm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(zm(e,t,r),e=e.sibling;e!==null;)zm(e,t,r),e=e.sibling}var Yr=null,Sa=!1;function Ni(e,t,r){for(r=r.child;r!==null;)Ob(e,t,r),r=r.sibling}function Ob(e,t,r){if(Ya&&typeof Ya.onCommitFiberUnmount=="function")try{Ya.onCommitFiberUnmount(kd,r)}catch{}switch(r.tag){case 5:ln||qo(r,t);case 6:var n=Yr,a=Sa;Yr=null,Ni(e,t,r),Yr=n,Sa=a,Yr!==null&&(Sa?(e=Yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Yr.removeChild(r.stateNode));break;case 18:Yr!==null&&(Sa?(e=Yr,r=r.stateNode,e.nodeType===8?Vh(e.parentNode,r):e.nodeType===1&&Vh(e,r),Yu(e)):Vh(Yr,r.stateNode));break;case 4:n=Yr,a=Sa,Yr=r.stateNode.containerInfo,Sa=!0,Ni(e,t,r),Yr=n,Sa=a;break;case 0:case 11:case 14:case 15:if(!ln&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&jm(r,t,s),a=a.next}while(a!==n)}Ni(e,t,r);break;case 1:if(!ln&&(qo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vr(r,t,o)}Ni(e,t,r);break;case 21:Ni(e,t,r);break;case 22:r.mode&1?(ln=(n=ln)||r.memoizedState!==null,Ni(e,t,r),ln=n):Ni(e,t,r);break;default:Ni(e,t,r)}}function r2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new kC),t.forEach(function(n){var a=UC.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ya(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Yr=o.stateNode,Sa=!1;break e;case 3:Yr=o.stateNode.containerInfo,Sa=!0;break e;case 4:Yr=o.stateNode.containerInfo,Sa=!0;break e}o=o.return}if(Yr===null)throw Error(Le(160));Ob(i,s,a),Yr=null,Sa=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){vr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Fb(t,e),t=t.sibling}function Fb(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ya(t,e),za(e),n&4){try{Su(3,e,e.return),jd(3,e)}catch(g){vr(e,e.return,g)}try{Su(5,e,e.return)}catch(g){vr(e,e.return,g)}}break;case 1:ya(t,e),za(e),n&512&&r!==null&&qo(r,r.return);break;case 5:if(ya(t,e),za(e),n&512&&r!==null&&qo(r,r.return),e.flags&32){var a=e.stateNode;try{$u(a,"")}catch(g){vr(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&eE(a,i),fm(o,s);var u=fm(o,i);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?iE(a,h):c==="dangerouslySetInnerHTML"?nE(a,h):c==="children"?$u(a,h):Ug(a,c,h,u)}switch(o){case"input":sm(a,i);break;case"textarea":tE(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Yo(a,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?Yo(a,!!i.multiple,i.defaultValue,!0):Yo(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ju]=i}catch(g){vr(e,e.return,g)}}break;case 6:if(ya(t,e),za(e),n&4){if(e.stateNode===null)throw Error(Le(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vr(e,e.return,g)}}break;case 3:if(ya(t,e),za(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Yu(t.containerInfo)}catch(g){vr(e,e.return,g)}break;case 4:ya(t,e),za(e);break;case 13:ya(t,e),za(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(y1=_r())),n&4&&r2(e);break;case 22:if(c=r!==null&&r.memoizedState!==null,e.mode&1?(ln=(u=ln)||c,ya(t,e),ln=u):ya(t,e),za(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(tt=e,c=e.child;c!==null;){for(h=tt=c;tt!==null;){switch(p=tt,x=p.child,p.tag){case 0:case 11:case 14:case 15:Su(4,p,p.return);break;case 1:qo(p,p.return);var E=p.stateNode;if(typeof E.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(g){vr(n,r,g)}}break;case 5:qo(p,p.return);break;case 22:if(p.memoizedState!==null){a2(h);continue}}x!==null?(x.return=p,tt=x):a2(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{a=h.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=aE("display",s))}catch(g){vr(e,e.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){vr(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ya(t,e),za(e),n&4&&r2(e);break;case 21:break;default:ya(t,e),za(e)}}function za(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(kb(r)){var n=r;break e}r=r.return}throw Error(Le(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&($u(a,""),n.flags&=-33);var i=t2(e);zm(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=t2(e);Um(e,o,s);break;default:throw Error(Le(161))}}catch(l){vr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function FC(e,t,r){tt=e,Pb(e)}function Pb(e,t,r){for(var n=(e.mode&1)!==0;tt!==null;){var a=tt,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||If;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||ln;o=If;var u=ln;if(If=s,(ln=l)&&!u)for(tt=a;tt!==null;)s=tt,l=s.child,s.tag===22&&s.memoizedState!==null?i2(a):l!==null?(l.return=s,tt=l):i2(a);for(;i!==null;)tt=i,Pb(i),i=i.sibling;tt=a,If=o,ln=u}n2(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,tt=i):n2(e)}}function n2(e){for(;tt!==null;){var t=tt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ln||jd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ln)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ta(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&zv(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}zv(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Yu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}ln||t.flags&512&&Bm(t)}catch(p){vr(t,t.return,p)}}if(t===e){tt=null;break}if(r=t.sibling,r!==null){r.return=t.return,tt=r;break}tt=t.return}}function a2(e){for(;tt!==null;){var t=tt;if(t===e){tt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,tt=r;break}tt=t.return}}function i2(e){for(;tt!==null;){var t=tt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{jd(4,t)}catch(l){vr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){vr(t,a,l)}}var i=t.return;try{Bm(t)}catch(l){vr(t,i,l)}break;case 5:var s=t.return;try{Bm(t)}catch(l){vr(t,s,l)}}}catch(l){vr(t,t.return,l)}if(t===e){tt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,tt=o;break}tt=t.return}}var PC=Math.ceil,V0=Si.ReactCurrentDispatcher,x1=Si.ReactCurrentOwner,ua=Si.ReactCurrentBatchConfig,Lt=0,zr=null,Sr=null,en=0,qn=0,$o=ps(0),Fr=0,ic=null,Ys=0,Bd=0,v1=0,Au=null,Cn=null,y1=0,gl=1/0,ai=null,G0=!1,Wm=null,Zi=null,Rf=!1,Wi=null,Y0=0,Cu=0,qm=null,m0=-1,g0=0;function bn(){return Lt&6?_r():m0!==-1?m0:m0=_r()}function Qi(e){return e.mode&1?Lt&2&&en!==0?en&-en:gC.transition!==null?(g0===0&&(g0=xE()),g0):(e=Gt,e!==0||(e=window.event,e=e===void 0?16:TE(e.type)),e):1}function Oa(e,t,r,n){if(50<Cu)throw Cu=0,qm=null,Error(Le(185));Bc(e,r,n),(!(Lt&2)||e!==zr)&&(e===zr&&(!(Lt&2)&&(Bd|=r),Fr===4&&Bi(e,en)),On(e,n),r===1&&Lt===0&&!(t.mode&1)&&(gl=_r()+500,Rd&&ms()))}function On(e,t){var r=e.callbackNode;g4(e,t);var n=O0(e,e===zr?en:0);if(n===0)r!==null&&pv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&pv(r),t===1)e.tag===0?mC(s2.bind(null,e)):qE(s2.bind(null,e)),fC(function(){!(Lt&6)&&ms()}),r=null;else{switch(vE(n)){case 1:r=Hg;break;case 4:r=mE;break;case 16:r=k0;break;case 536870912:r=gE;break;default:r=k0}r=zb(r,Ib.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ib(e,t){if(m0=-1,g0=0,Lt&6)throw Error(Le(327));var r=e.callbackNode;if(Jo()&&e.callbackNode!==r)return null;var n=O0(e,e===zr?en:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=X0(e,n);else{t=n;var a=Lt;Lt|=2;var i=Lb();(zr!==e||en!==t)&&(ai=null,gl=_r()+500,js(e,t));do try{LC();break}catch(o){Rb(e,o)}while(!0);a1(),V0.current=i,Lt=a,Sr!==null?t=0:(zr=null,en=0,t=Fr)}if(t!==0){if(t===2&&(a=gm(e),a!==0&&(n=a,t=$m(e,a))),t===1)throw r=ic,js(e,0),Bi(e,n),On(e,_r()),r;if(t===6)Bi(e,n);else{if(a=e.current.alternate,!(n&30)&&!IC(a)&&(t=X0(e,n),t===2&&(i=gm(e),i!==0&&(n=i,t=$m(e,i))),t===1))throw r=ic,js(e,0),Bi(e,n),On(e,_r()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Le(345));case 2:Ds(e,Cn,ai);break;case 3:if(Bi(e,n),(n&130023424)===n&&(t=y1+500-_r(),10<t)){if(O0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){bn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Tm(Ds.bind(null,e,Cn,ai),t);break}Ds(e,Cn,ai);break;case 4:if(Bi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ka(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=_r()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*PC(n/1960))-n,10<n){e.timeoutHandle=Tm(Ds.bind(null,e,Cn,ai),n);break}Ds(e,Cn,ai);break;case 5:Ds(e,Cn,ai);break;default:throw Error(Le(329))}}}return On(e,_r()),e.callbackNode===r?Ib.bind(null,e):null}function $m(e,t){var r=Au;return e.current.memoizedState.isDehydrated&&(js(e,t).flags|=256),e=X0(e,t),e!==2&&(t=Cn,Cn=r,t!==null&&Hm(t)),e}function Hm(e){Cn===null?Cn=e:Cn.push.apply(Cn,e)}function IC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ia(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bi(e,t){for(t&=~v1,t&=~Bd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ka(t),n=1<<r;e[r]=-1,t&=~n}}function s2(e){if(Lt&6)throw Error(Le(327));Jo();var t=O0(e,0);if(!(t&1))return On(e,_r()),null;var r=X0(e,t);if(e.tag!==0&&r===2){var n=gm(e);n!==0&&(t=n,r=$m(e,n))}if(r===1)throw r=ic,js(e,0),Bi(e,t),On(e,_r()),r;if(r===6)throw Error(Le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ds(e,Cn,ai),On(e,_r()),null}function w1(e,t){var r=Lt;Lt|=1;try{return e(t)}finally{Lt=r,Lt===0&&(gl=_r()+500,Rd&&ms())}}function Xs(e){Wi!==null&&Wi.tag===0&&!(Lt&6)&&Jo();var t=Lt;Lt|=1;var r=ua.transition,n=Gt;try{if(ua.transition=null,Gt=1,e)return e()}finally{Gt=n,ua.transition=r,Lt=t,!(Lt&6)&&ms()}}function E1(){qn=$o.current,or($o)}function js(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cC(r)),Sr!==null)for(r=Sr.return;r!==null;){var n=r;switch(t1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&L0();break;case 3:pl(),or(Nn),or(pn),c1();break;case 5:u1(n);break;case 4:pl();break;case 13:or(dr);break;case 19:or(dr);break;case 10:i1(n.type._context);break;case 22:case 23:E1()}r=r.return}if(zr=e,Sr=e=Ji(e.current,null),en=qn=t,Fr=0,ic=null,v1=Bd=Ys=0,Cn=Au=null,Ps!==null){for(t=0;t<Ps.length;t++)if(r=Ps[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Ps=null}return e}function Rb(e,t){do{var r=Sr;try{if(a1(),d0.current=H0,$0){for(var n=pr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}$0=!1}if(Gs=0,Mr=Or=pr=null,Tu=!1,rc=0,x1.current=null,r===null||r.return===null){Fr=1,ic=t,Sr=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=en,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var x=Gv(s);if(x!==null){x.flags&=-257,Yv(x,s,o,i,t),x.mode&1&&Vv(i,u,t),t=x,l=u;var E=t.updateQueue;if(E===null){var g=new Set;g.add(l),t.updateQueue=g}else E.add(l);break e}else{if(!(t&1)){Vv(i,u,t),b1();break e}l=Error(Le(426))}}else if(fr&&o.mode&1){var w=Gv(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Yv(w,s,o,i,t),r1(ml(l,o));break e}}i=l=ml(l,o),Fr!==4&&(Fr=2),Au===null?Au=[i]:Au.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=vb(i,l,t);Uv(i,v);break e;case 1:o=l;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Zi===null||!Zi.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var T=yb(i,o,t);Uv(i,T);break e}}i=i.return}while(i!==null)}jb(r)}catch(N){t=N,Sr===r&&r!==null&&(Sr=r=r.return);continue}break}while(!0)}function Lb(){var e=V0.current;return V0.current=H0,e===null?H0:e}function b1(){(Fr===0||Fr===3||Fr===2)&&(Fr=4),zr===null||!(Ys&268435455)&&!(Bd&268435455)||Bi(zr,en)}function X0(e,t){var r=Lt;Lt|=2;var n=Lb();(zr!==e||en!==t)&&(ai=null,js(e,t));do try{RC();break}catch(a){Rb(e,a)}while(!0);if(a1(),Lt=r,V0.current=n,Sr!==null)throw Error(Le(261));return zr=null,en=0,Fr}function RC(){for(;Sr!==null;)Mb(Sr)}function LC(){for(;Sr!==null&&!o4();)Mb(Sr)}function Mb(e){var t=Ub(e.alternate,e,qn);e.memoizedProps=e.pendingProps,t===null?jb(e):Sr=t,x1.current=null}function jb(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=NC(r,t),r!==null){r.flags&=32767,Sr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Fr=6,Sr=null;return}}else if(r=DC(r,t,qn),r!==null){Sr=r;return}if(t=t.sibling,t!==null){Sr=t;return}Sr=t=e}while(t!==null);Fr===0&&(Fr=5)}function Ds(e,t,r){var n=Gt,a=ua.transition;try{ua.transition=null,Gt=1,MC(e,t,r,n)}finally{ua.transition=a,Gt=n}return null}function MC(e,t,r,n){do Jo();while(Wi!==null);if(Lt&6)throw Error(Le(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Le(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(x4(e,i),e===zr&&(Sr=zr=null,en=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Rf||(Rf=!0,zb(k0,function(){return Jo(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ua.transition,ua.transition=null;var s=Gt;Gt=1;var o=Lt;Lt|=4,x1.current=null,OC(e,r),Fb(r,e),nC(bm),F0=!!Em,bm=Em=null,e.current=r,FC(r),l4(),Lt=o,Gt=s,ua.transition=i}else e.current=r;if(Rf&&(Rf=!1,Wi=e,Y0=a),i=e.pendingLanes,i===0&&(Zi=null),f4(r.stateNode),On(e,_r()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(G0)throw G0=!1,e=Wm,Wm=null,e;return Y0&1&&e.tag!==0&&Jo(),i=e.pendingLanes,i&1?e===qm?Cu++:(Cu=0,qm=e):Cu=0,ms(),null}function Jo(){if(Wi!==null){var e=vE(Y0),t=ua.transition,r=Gt;try{if(ua.transition=null,Gt=16>e?16:e,Wi===null)var n=!1;else{if(e=Wi,Wi=null,Y0=0,Lt&6)throw Error(Le(331));var a=Lt;for(Lt|=4,tt=e.current;tt!==null;){var i=tt,s=i.child;if(tt.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(tt=u;tt!==null;){var c=tt;switch(c.tag){case 0:case 11:case 15:Su(8,c,i)}var h=c.child;if(h!==null)h.return=c,tt=h;else for(;tt!==null;){c=tt;var p=c.sibling,x=c.return;if(Nb(c),c===u){tt=null;break}if(p!==null){p.return=x,tt=p;break}tt=x}}}var E=i.alternate;if(E!==null){var g=E.child;if(g!==null){E.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}tt=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,tt=s;else e:for(;tt!==null;){if(i=tt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Su(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,tt=v;break e}tt=i.return}}var y=e.current;for(tt=y;tt!==null;){s=tt;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,tt=b;else e:for(s=y;tt!==null;){if(o=tt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:jd(9,o)}}catch(N){vr(o,o.return,N)}if(o===s){tt=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,tt=T;break e}tt=o.return}}if(Lt=a,ms(),Ya&&typeof Ya.onPostCommitFiberRoot=="function")try{Ya.onPostCommitFiberRoot(kd,e)}catch{}n=!0}return n}finally{Gt=r,ua.transition=t}}return!1}function o2(e,t,r){t=ml(r,t),t=vb(e,t,1),e=Ki(e,t,1),t=bn(),e!==null&&(Bc(e,1,t),On(e,t))}function vr(e,t,r){if(e.tag===3)o2(e,e,r);else for(;t!==null;){if(t.tag===3){o2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Zi===null||!Zi.has(n))){e=ml(r,e),e=yb(t,e,1),t=Ki(t,e,1),e=bn(),t!==null&&(Bc(t,1,e),On(t,e));break}}t=t.return}}function jC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=bn(),e.pingedLanes|=e.suspendedLanes&r,zr===e&&(en&r)===r&&(Fr===4||Fr===3&&(en&130023424)===en&&500>_r()-y1?js(e,0):v1|=r),On(e,t)}function Bb(e,t){t===0&&(e.mode&1?(t=Sf,Sf<<=1,!(Sf&130023424)&&(Sf=4194304)):t=1);var r=bn();e=wi(e,t),e!==null&&(Bc(e,t,r),On(e,r))}function BC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Bb(e,r)}function UC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Le(314))}n!==null&&n.delete(t),Bb(e,r)}var Ub;Ub=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nn.current)Dn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Dn=!1,CC(e,t,r);Dn=!!(e.flags&131072)}else Dn=!1,fr&&t.flags&1048576&&$E(t,B0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;p0(e,t),e=t.pendingProps;var a=fl(t,pn.current);Qo(t,r),a=d1(null,t,n,e,a,r);var i=h1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,kn(n)?(i=!0,M0(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,o1(t),a.updater=Md,t.stateNode=a,a._reactInternals=t,Om(t,n,e,r),t=Im(null,t,n,!0,i,r)):(t.tag=0,fr&&i&&e1(t),vn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(p0(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=WC(n),e=Ta(n,e),a){case 0:t=Pm(null,t,n,e,r);break e;case 1:t=Zv(null,t,n,e,r);break e;case 11:t=Xv(null,t,n,e,r);break e;case 14:t=Kv(null,t,n,Ta(n.type,e),r);break e}throw Error(Le(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ta(n,a),Pm(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ta(n,a),Zv(e,t,n,a,r);case 3:e:{if(_b(t),e===null)throw Error(Le(387));n=t.pendingProps,i=t.memoizedState,a=i.element,KE(e,t),W0(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=ml(Error(Le(423)),t),t=Qv(e,t,n,r,a);break e}else if(n!==a){a=ml(Error(Le(424)),t),t=Qv(e,t,n,r,a);break e}else for(Gn=Xi(t.stateNode.containerInfo.firstChild),Yn=t,fr=!0,Aa=null,r=YE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(dl(),n===a){t=Ei(e,t,r);break e}vn(e,t,n,r)}t=t.child}return t;case 5:return ZE(t),e===null&&Dm(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,_m(n,a)?s=null:i!==null&&_m(n,i)&&(t.flags|=32),bb(e,t),vn(e,t,s,r),t.child;case 6:return e===null&&Dm(t),null;case 13:return Tb(e,t,r);case 4:return l1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=hl(t,null,n,r):vn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ta(n,a),Xv(e,t,n,a,r);case 7:return vn(e,t,t.pendingProps,r),t.child;case 8:return vn(e,t,t.pendingProps.children,r),t.child;case 12:return vn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,rr(U0,n._currentValue),n._currentValue=s,i!==null)if(Ia(i.value,s)){if(i.children===a.children&&!Nn.current){t=Ei(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=fi(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Nm(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Le(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Nm(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}vn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Qo(t,r),a=fa(a),n=n(a),t.flags|=1,vn(e,t,n,r),t.child;case 14:return n=t.type,a=Ta(n,t.pendingProps),a=Ta(n.type,a),Kv(e,t,n,a,r);case 15:return wb(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ta(n,a),p0(e,t),t.tag=1,kn(n)?(e=!0,M0(t)):e=!1,Qo(t,r),xb(t,n,a),Om(t,n,a,r),Im(null,t,n,!0,e,r);case 19:return Sb(e,t,r);case 22:return Eb(e,t,r)}throw Error(Le(156,t.tag))};function zb(e,t){return pE(e,t)}function zC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(e,t,r,n){return new zC(e,t,r,n)}function _1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function WC(e){if(typeof e=="function")return _1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wg)return 11;if(e===qg)return 14}return 2}function Ji(e,t){var r=e.alternate;return r===null?(r=la(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function x0(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")_1(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Io:return Bs(r.children,a,i,t);case zg:s=8,a|=8;break;case tm:return e=la(12,r,t,a|2),e.elementType=tm,e.lanes=i,e;case rm:return e=la(13,r,t,a),e.elementType=rm,e.lanes=i,e;case nm:return e=la(19,r,t,a),e.elementType=nm,e.lanes=i,e;case Zw:return Ud(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xw:s=10;break e;case Kw:s=9;break e;case Wg:s=11;break e;case qg:s=14;break e;case Ri:s=16,n=null;break e}throw Error(Le(130,e==null?e:typeof e,""))}return t=la(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Bs(e,t,r,n){return e=la(7,e,n,t),e.lanes=r,e}function Ud(e,t,r,n){return e=la(22,e,n,t),e.elementType=Zw,e.lanes=r,e.stateNode={isHidden:!1},e}function ep(e,t,r){return e=la(6,e,null,t),e.lanes=r,e}function tp(e,t,r){return t=la(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qC(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rh(0),this.expirationTimes=Rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rh(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function T1(e,t,r,n,a,i,s,o,l){return e=new qC(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=la(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},o1(i),e}function $C(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Po,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Wb(e){if(!e)return rs;e=e._reactInternals;e:{if(so(e)!==e||e.tag!==1)throw Error(Le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(kn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Le(171))}if(e.tag===1){var r=e.type;if(kn(r))return WE(e,r,t)}return t}function qb(e,t,r,n,a,i,s,o,l){return e=T1(r,n,!0,e,a,i,s,o,l),e.context=Wb(null),r=e.current,n=bn(),a=Qi(r),i=fi(n,a),i.callback=t??null,Ki(r,i,a),e.current.lanes=a,Bc(e,a,n),On(e,n),e}function zd(e,t,r,n){var a=t.current,i=bn(),s=Qi(a);return r=Wb(r),t.context===null?t.context=r:t.pendingContext=r,t=fi(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ki(a,t,s),e!==null&&(Oa(e,a,s,i),f0(e,a,s)),s}function K0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function l2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function S1(e,t){l2(e,t),(e=e.alternate)&&l2(e,t)}function HC(){return null}var $b=typeof reportError=="function"?reportError:function(e){console.error(e)};function A1(e){this._internalRoot=e}Wd.prototype.render=A1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Le(409));zd(e,t,null,null)};Wd.prototype.unmount=A1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xs(function(){zd(null,e,null,null)}),t[yi]=null}};function Wd(e){this._internalRoot=e}Wd.prototype.unstable_scheduleHydration=function(e){if(e){var t=EE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ji.length&&t!==0&&t<ji[r].priority;r++);ji.splice(r,0,e),r===0&&_E(e)}};function C1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function u2(){}function VC(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=K0(s);i.call(u)}}var s=qb(t,n,e,0,null,!1,!1,"",u2);return e._reactRootContainer=s,e[yi]=s.current,Zu(e.nodeType===8?e.parentNode:e),Xs(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=K0(l);o.call(u)}}var l=T1(e,0,!1,null,null,!1,!1,"",u2);return e._reactRootContainer=l,e[yi]=l.current,Zu(e.nodeType===8?e.parentNode:e),Xs(function(){zd(t,l,r,n)}),l}function $d(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=K0(s);o.call(l)}}zd(t,s,e,a)}else s=VC(r,t,e,a,n);return K0(s)}yE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=du(t.pendingLanes);r!==0&&(Vg(t,r|1),On(t,_r()),!(Lt&6)&&(gl=_r()+500,ms()))}break;case 13:Xs(function(){var n=wi(e,1);if(n!==null){var a=bn();Oa(n,e,1,a)}}),S1(e,1)}};Gg=function(e){if(e.tag===13){var t=wi(e,134217728);if(t!==null){var r=bn();Oa(t,e,134217728,r)}S1(e,134217728)}};wE=function(e){if(e.tag===13){var t=Qi(e),r=wi(e,t);if(r!==null){var n=bn();Oa(r,e,t,n)}S1(e,t)}};EE=function(){return Gt};bE=function(e,t){var r=Gt;try{return Gt=e,t()}finally{Gt=r}};hm=function(e,t,r){switch(t){case"input":if(sm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Id(n);if(!a)throw Error(Le(90));Jw(n),sm(n,a)}}}break;case"textarea":tE(e,r);break;case"select":t=r.value,t!=null&&Yo(e,!!r.multiple,t,!1)}};lE=w1;uE=Xs;var GC={usingClientEntryPoint:!1,Events:[zc,jo,Id,sE,oE,w1]},eu={findFiberByHostInstance:Fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YC={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Si.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dE(e),e===null?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||HC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lf.isDisabled&&Lf.supportsFiber)try{kd=Lf.inject(YC),Ya=Lf}catch{}}Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GC;Qn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C1(t))throw Error(Le(200));return $C(e,t,null,r)};Qn.createRoot=function(e,t){if(!C1(e))throw Error(Le(299));var r=!1,n="",a=$b;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=T1(e,1,!1,null,null,r,!1,n,a),e[yi]=t.current,Zu(e.nodeType===8?e.parentNode:e),new A1(t)};Qn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Le(188)):(e=Object.keys(e).join(","),Error(Le(268,e)));return e=dE(t),e=e===null?null:e.stateNode,e};Qn.flushSync=function(e){return Xs(e)};Qn.hydrate=function(e,t,r){if(!qd(t))throw Error(Le(200));return $d(null,e,t,!0,r)};Qn.hydrateRoot=function(e,t,r){if(!C1(e))throw Error(Le(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=$b;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=qb(t,null,e,1,r??null,a,!1,i,s),e[yi]=t.current,Zu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Wd(t)};Qn.render=function(e,t,r){if(!qd(t))throw Error(Le(200));return $d(null,e,t,!1,r)};Qn.unmountComponentAtNode=function(e){if(!qd(e))throw Error(Le(40));return e._reactRootContainer?(Xs(function(){$d(null,null,e,!1,function(){e._reactRootContainer=null,e[yi]=null})}),!0):!1};Qn.unstable_batchedUpdates=w1;Qn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!qd(r))throw Error(Le(200));if(e==null||e._reactInternals===void 0)throw Error(Le(38));return $d(e,t,r,!1,n)};Qn.version="18.3.1-next-f1338f8080-20240426";function Hb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hb)}catch(e){console.error(e)}}Hb(),Hw.exports=Qn;var XC=Hw.exports,c2=XC;Jp.createRoot=c2.createRoot,Jp.hydrateRoot=c2.hydrateRoot;const KC="modulepreload",ZC=function(e){return"/Certify-app/"+e},f2={},Ra=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=ZC(l),l in f2)return;f2[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":KC,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((p,x)=>{h.addEventListener("load",p),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},sr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ar=Object.keys,cn=Array.isArray;function Tn(e,t){return typeof t!="object"||Ar(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||sr.Promise||(sr.Promise=Promise);const sc=Object.getPrototypeOf,QC={}.hasOwnProperty;function Kn(e,t){return QC.call(e,t)}function xl(e,t){typeof t=="function"&&(t=t(sc(e))),(typeof Reflect>"u"?Ar:Reflect.ownKeys)(t).forEach(r=>{di(e,r,t[r])})}const Vb=Object.defineProperty;function di(e,t,r,n){Vb(e,t,Tn(r&&Kn(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function el(e){return{from:function(t){return e.prototype=Object.create(t.prototype),di(e.prototype,"constructor",e),{extend:xl.bind(null,e.prototype)}}}}const JC=Object.getOwnPropertyDescriptor;function D1(e,t){let r;return JC(e,t)||(r=sc(e))&&D1(r,t)}const eD=[].slice;function Z0(e,t,r){return eD.call(e,t,r)}function Gb(e,t){return t(e)}function pu(e){if(!e)throw new Error("Assertion Failed")}function Yb(e){sr.setImmediate?setImmediate(e):setTimeout(e,0)}function Xb(e,t){return e.reduce((r,n,a)=>{var i=t(n,a);return i&&(r[i[0]]=i[1]),r},{})}function hi(e,t){if(typeof t=="string"&&Kn(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,a=t.length;n<a;++n){var i=hi(e,t[n]);r.push(i)}return r}var s=t.indexOf(".");if(s!==-1){var o=e[t.substr(0,s)];return o==null?void 0:hi(o,t.substr(s+1))}}function Fa(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){pu(typeof r!="string"&&"length"in r);for(var n=0,a=t.length;n<a;++n)Fa(e,t[n],r[n])}else{var i=t.indexOf(".");if(i!==-1){var s=t.substr(0,i),o=t.substr(i+1);if(o==="")r===void 0?cn(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=r;else{var l=e[s];l&&Kn(e,s)||(l=e[s]={}),Fa(l,o,r)}}else r===void 0?cn(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Kb(e){var t={};for(var r in e)Kn(e,r)&&(t[r]=e[r]);return t}const tD=[].concat;function Zb(e){return tD.apply([],e)}const Qb="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Zb([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>sr[e]),rD=Qb.map(e=>sr[e]);Xb(Qb,e=>[e,!0]);let Mi=null;function qc(e){Mi=typeof WeakMap<"u"&&new WeakMap;const t=Vm(e);return Mi=null,t}function Vm(e){if(!e||typeof e!="object")return e;let t=Mi&&Mi.get(e);if(t)return t;if(cn(e)){t=[],Mi&&Mi.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Vm(e[r]))}else if(rD.indexOf(e.constructor)>=0)t=e;else{const i=sc(e);for(var a in t=i===Object.prototype?{}:Object.create(i),Mi&&Mi.set(e,t),e)Kn(e,a)&&(t[a]=Vm(e[a]))}return t}const{toString:nD}={};function Gm(e){return nD.call(e).slice(8,-1)}const Ym=typeof Symbol<"u"?Symbol.iterator:"@@iterator",aD=typeof Ym=="symbol"?function(e){var t;return e!=null&&(t=e[Ym])&&t.apply(e)}:function(){return null},Oo={};function oi(e){var t,r,n,a;if(arguments.length===1){if(cn(e))return e.slice();if(this===Oo&&typeof e=="string")return[e];if(a=aD(e)){for(r=[];!(n=a.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const N1=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Ja=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Jb(e,t){Ja=e,e_=t}var e_=()=>!0;const iD=!new Error("").stack;function oo(){if(iD)try{throw oo.arguments,new Error}catch(e){return e}return new Error}function Xm(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(e_).map(n=>`
`+n).join("")):""}var t_=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],k1=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(t_),sD={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function tl(e,t){this._e=oo(),this.name=e,this.message=t}function r_(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,a)=>a.indexOf(r)===n).join(`
`)}function Q0(e,t,r,n){this._e=oo(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=r_(e,t)}function Du(e,t){this._e=oo(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=r_(e,t)}el(tl).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Xm(this._e,2))}},toString:function(){return this.name+": "+this.message}}),el(Q0).from(tl),el(Du).from(tl);var O1=k1.reduce((e,t)=>(e[t]=t+"Error",e),{});const oD=tl;var ht=k1.reduce((e,t)=>{var r=t+"Error";function n(a,i){this._e=oo(),this.name=r,a?typeof a=="string"?(this.message=`${a}${i?`
 `+i:""}`,this.inner=i||null):typeof a=="object"&&(this.message=`${a.name} ${a.message}`,this.inner=a):(this.message=sD[t]||r,this.inner=null)}return el(n).from(oD),e[t]=n,e},{});ht.Syntax=SyntaxError,ht.Type=TypeError,ht.Range=RangeError;var d2=t_.reduce((e,t)=>(e[t+"Error"]=ht[t],e),{}),v0=k1.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ht[t]),e),{});function er(){}function oc(e){return e}function lD(e,t){return e==null||e===oc?t:function(r){return t(e(r))}}function Ks(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function uD(e,t){return e===er?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Ks(n,this.onsuccess):n),a&&(this.onerror=this.onerror?Ks(a,this.onerror):a),i!==void 0?i:r}}function cD(e,t){return e===er?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Ks(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Ks(n,this.onerror):n)}}function fD(e,t){return e===er?t:function(r){var n=e.apply(this,arguments);Tn(r,n);var a=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?Ks(a,this.onsuccess):a),i&&(this.onerror=this.onerror?Ks(i,this.onerror):i),n===void 0?s===void 0?void 0:s:Tn(n,s)}}function dD(e,t){return e===er?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function F1(e,t){return e===er?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,a=arguments.length,i=new Array(a);a--;)i[a]=arguments[a];return r.then(function(){return t.apply(n,i)})}return t.apply(this,arguments)}}v0.ModifyError=Q0,v0.DexieError=tl,v0.BulkError=Du;var lc={};const n_=100,[Km,J0,Zm]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,sc(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,sc(t),e]})(),a_=J0&&J0.then,y0=Km&&Km.constructor,P1=!!Zm;var Qm=!1,hD=Zm?()=>{Zm.then(Mf)}:sr.setImmediate?setImmediate.bind(null,Mf):sr.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Mf(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Mf,0)},Nu=function(e,t){mu.push([e,t]),ed&&(hD(),ed=!1)},Jm=!0,ed=!0,Us=[],w0=[],eg=null,tg=oc,rl={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:m2,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{m2(e[0],e[1])}catch{}})}},ot=rl,mu=[],zs=0,E0=[];function Je(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=er,this._lib=!1;var t=this._PSD=ot;if(Ja&&(this._stackHolder=oo(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==lc)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ng(this,this._value))}this._state=null,this._value=null,++t.ref,s_(this,e)}const rg={get:function(){var e=ot,t=td;function r(n,a){var i=!e.global&&(e!==ot||t!==td);const s=i&&!bi();var o=new Je((l,u)=>{I1(this,new i_(rd(n,e,i,s),rd(a,e,i,s),l,u,e))});return Ja&&u_(o,this),o}return r.prototype=lc,r},set:function(e){di(this,"then",e&&e.prototype===lc?rg:{get:function(){return e},set:rg.set})}};function i_(e,t,r,n,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=a}function s_(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&$c();r&&typeof r.then=="function"?s_(e,(a,i)=>{r instanceof Je?r._then(a,i):r.then(a,i)}):(e._state=!0,e._value=r,o_(e)),n&&Hc()}},ng.bind(null,e))}catch(r){ng(e,r)}}function ng(e,t){if(w0.push(t),e._state===null){var r=e._lib&&$c();t=tg(t),e._state=!1,e._value=t,Ja&&t!==null&&typeof t=="object"&&!t._promise&&function(n,a,i){try{n.apply(null,i)}catch{}}(()=>{var n=D1(t,"stack");t._promise=e,di(t,"stack",{get:()=>Qm?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){Us.some(a=>a._value===n._value)||Us.push(n)}(e),o_(e),r&&Hc()}}function o_(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)I1(e,t[r]);var a=e._PSD;--a.ref||a.finalize(),zs===0&&(++zs,Nu(()=>{--zs==0&&R1()},[]))}function I1(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++zs,Nu(pD,[r,e,t])}else e._listeners.push(t)}function pD(e,t,r){try{eg=t;var n,a=t._value;t._state?n=e(a):(w0.length&&(w0=[]),n=e(a),w0.indexOf(a)===-1&&function(i){for(var s=Us.length;s;)if(Us[--s]._value===i._value)return void Us.splice(s,1)}(t)),r.resolve(n)}catch(i){r.reject(i)}finally{eg=null,--zs==0&&R1(),--r.psd.ref||r.psd.finalize()}}function l_(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var a,i,s=e._value;s!=null?(a=s.name||"Error",i=s.message||s,n=Xm(s,0)):(a=s,i=""),t.push(a+(i?": "+i:"")+n)}return Ja&&((n=Xm(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&l_(e._prev,t,r)),t}function u_(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Mf(){$c()&&Hc()}function $c(){var e=Jm;return Jm=!1,ed=!1,e}function Hc(){var e,t,r;do for(;mu.length>0;)for(e=mu,mu=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(mu.length>0);Jm=!0,ed=!0}function R1(){var e=Us;Us=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=E0.slice(0),r=t.length;r;)t[--r]()}function jf(e){return new Je(lc,!1,e)}function cr(e,t){var r=ot;return function(){var n=$c(),a=ot;try{return as(r,!0),e.apply(this,arguments)}catch(i){t&&t(i)}finally{as(a,!1),n&&Hc()}}}xl(Je.prototype,{then:rg,_then:function(e,t){I1(this,new i_(null,null,e,t,ot))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):jf(n)):this.then(null,n=>n&&n.name===t?r(n):jf(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),jf(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Qm=!0;var e=l_(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Qm=!1}}},timeout:function(e,t){return e<1/0?new Je((r,n)=>{var a=setTimeout(()=>n(new ht.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&di(Je.prototype,Symbol.toStringTag,"Dexie.Promise"),rl.env=c_(),xl(Je,{all:function(){var e=oi.apply(null,arguments).map(Bf);return new Je(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((a,i)=>Je.resolve(a).then(s=>{e[i]=s,--n||t(e)},r))})},resolve:e=>{if(e instanceof Je)return e;if(e&&typeof e.then=="function")return new Je((r,n)=>{e.then(r,n)});var t=new Je(lc,!0,e);return u_(t,eg),t},reject:jf,race:function(){var e=oi.apply(null,arguments).map(Bf);return new Je((t,r)=>{e.map(n=>Je.resolve(n).then(t,r))})},PSD:{get:()=>ot,set:e=>ot=e},totalEchoes:{get:()=>td},newPSD:ns,usePSD:Nl,scheduler:{get:()=>Nu,set:e=>{Nu=e}},rejectionMapper:{get:()=>tg,set:e=>{tg=e}},follow:(e,t)=>new Je((r,n)=>ns((a,i)=>{var s=ot;s.unhandleds=[],s.onunhandled=i,s.finalize=Ks(function(){(function(o){function l(){o(),E0.splice(E0.indexOf(l),1)}E0.push(l),++zs,Nu(()=>{--zs==0&&R1()},[])})(()=>{this.unhandleds.length===0?a():i(this.unhandleds[0])})},s.finalize),e()},t,r,n))}),y0&&(y0.allSettled&&di(Je,"allSettled",function(){const e=oi.apply(null,arguments).map(Bf);return new Je(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((a,i)=>Je.resolve(a).then(s=>n[i]={status:"fulfilled",value:s},s=>n[i]={status:"rejected",reason:s}).then(()=>--r||t(n)))})}),y0.any&&typeof AggregateError<"u"&&di(Je,"any",function(){const e=oi.apply(null,arguments).map(Bf);return new Je((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const a=new Array(n);e.forEach((i,s)=>Je.resolve(i).then(o=>t(o),o=>{a[s]=o,--n||r(new AggregateError(a))}))})}));const un={awaits:0,echoes:0,id:0};var mD=0,b0=[],rp=0,td=0,gD=0;function ns(e,t,r,n){var a=ot,i=Object.create(a);i.parent=a,i.ref=0,i.global=!1,i.id=++gD;var s=rl.env;i.env=P1?{Promise:Je,PromiseProp:{value:Je,configurable:!0,writable:!0},all:Je.all,race:Je.race,allSettled:Je.allSettled,any:Je.any,resolve:Je.resolve,reject:Je.reject,nthen:h2(s.nthen,i),gthen:h2(s.gthen,i)}:{},t&&Tn(i,t),++a.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Nl(i,e,r,n);return i.ref===0&&i.finalize(),o}function Dl(){return un.id||(un.id=++mD),++un.awaits,un.echoes+=n_,un.id}function bi(){return!!un.awaits&&(--un.awaits==0&&(un.id=0),un.echoes=un.awaits*n_,!0)}function Bf(e){return un.echoes&&e&&e.constructor===y0?(Dl(),e.then(t=>(bi(),t),t=>(bi(),Pr(t)))):e}function xD(e){++td,un.echoes&&--un.echoes!=0||(un.echoes=un.id=0),b0.push(ot),as(e,!0)}function vD(){var e=b0[b0.length-1];b0.pop(),as(e,!1)}function as(e,t){var r=ot;if((t?!un.echoes||rp++&&e===ot:!rp||--rp&&e===ot)||f_(t?xD.bind(null,e):vD),e!==ot&&(ot=e,r===rl&&(rl.env=c_()),P1)){var n=rl.env.Promise,a=e.env;J0.then=a.nthen,n.prototype.then=a.gthen,(r.global||e.global)&&(Object.defineProperty(sr,"Promise",a.PromiseProp),n.all=a.all,n.race=a.race,n.resolve=a.resolve,n.reject=a.reject,a.allSettled&&(n.allSettled=a.allSettled),a.any&&(n.any=a.any))}}function c_(){var e=sr.Promise;return P1?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(sr,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:J0.then,gthen:e.prototype.then}:{}}function Nl(e,t,r,n,a){var i=ot;try{return as(e,!0),t(r,n,a)}finally{as(i,!1)}}function f_(e){a_.call(Km,e)}function rd(e,t,r,n){return typeof e!="function"?e:function(){var a=ot;r&&Dl(),as(t,!0);try{return e.apply(this,arguments)}finally{as(a,!1),n&&f_(bi)}}}function h2(e,t){return function(r,n){return e.call(this,rd(r,t),rd(n,t))}}(""+a_).indexOf("[native code]")===-1&&(Dl=bi=er);const p2="unhandledrejection";function m2(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,a={promise:t,reason:e};if(sr.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(p2,!0,!0),Tn(n,a)):sr.CustomEvent&&Tn(n=new CustomEvent(p2,{detail:a}),a),n&&sr.dispatchEvent&&(dispatchEvent(n),!sr.PromiseRejectionEvent&&sr.onunhandledrejection))try{sr.onunhandledrejection(n)}catch{}Ja&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Pr=Je.reject;function ag(e,t,r,n){if(e.idbdb&&(e._state.openComplete||ot.letThrough||e._vip)){var a=e._createTransaction(t,r,e._dbSchema);try{a.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===O1.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>ag(e,t,r,n))):Pr(i)}return a._promise(t,(i,s)=>ns(()=>(ot.trans=a,n(i,s,a)))).then(i=>a._completion.then(()=>i))}if(e._state.openComplete)return Pr(new ht.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Pr(new ht.DatabaseClosed);e.open().catch(er)}return e._state.dbReadyPromise.then(()=>ag(e,t,r,n))}const g2="3.2.7",Rs="",ig=-1/0,ni="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",d_="String expected.",ku=[],Hd=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),yD=Hd,wD=Hd,h_=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),Vd="__dbnames",np="readonly",ap="readwrite";function Zs(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const p_={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Uf(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=qc(t))[e],t)}class ED{_trans(t,r,n){const a=this._tx||ot.trans,i=this.name;function s(l,u,c){if(!c.schema[i])throw new ht.NotFound("Table "+i+" not part of transaction");return r(c.idbtrans,c)}const o=$c();try{return a&&a.db===this.db?a===ot.trans?a._promise(t,s,n):ns(()=>a._promise(t,s,n),{trans:a,transless:ot.transless||ot}):ag(this.db,t,[this.name],s)}finally{o&&Hc()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(a=>this.hook.reading.fire(a))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(cn(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Ar(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&r.every(c=>u.keyPath.indexOf(c)>=0)){for(let c=0;c<r.length;++c)if(r.indexOf(u.keyPath[c])===-1)return!1;return!0}return!1}).sort((u,c)=>u.keyPath.length-c.keyPath.length)[0];if(n&&this.db._maxKey!==Rs){const u=n.keyPath.slice(0,r.length);return this.where(u).equals(u.map(c=>t[c]))}!n&&Ja&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:a}=this.schema,i=this.db._deps.indexedDB;function s(u,c){try{return i.cmp(u,c)===0}catch{return!1}}const[o,l]=r.reduce(([u,c],h)=>{const p=a[h],x=t[h];return[u||p,u||!p?Zs(c,p&&p.multi?E=>{const g=hi(E,h);return cn(g)&&g.some(w=>s(x,w))}:E=>s(x,hi(E,h))):c]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,cn(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const a=Object.create(t.prototype);for(var i in n)if(Kn(n,i))try{a[i]=n[i]}catch{}return a};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Tn(this,t)})}add(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let i=t;return a&&n&&(i=Uf(a)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:r!=null?[r]:null,values:[i]})).then(s=>s.numFailures?Je.reject(s.failures[0]):s.lastResult).then(s=>{if(a)try{Fa(t,a,s)}catch{}return s})}update(t,r){if(typeof t!="object"||cn(t))return this.where(":id").equals(t).modify(r);{const n=hi(t,this.schema.primKey.keyPath);if(n===void 0)return Pr(new ht.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Ar(r).forEach(a=>{Fa(t,a,r[a])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:a}=this.schema.primKey;let i=t;return a&&n&&(i=Uf(a)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[i],keys:r!=null?[r]:null})).then(s=>s.numFailures?Je.reject(s.failures[0]):s.lastResult).then(s=>{if(a)try{Fa(t,a,s)}catch{}return s})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?Je.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:p_})).then(t=>t.numFailures?Je.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(a=>this.hook.reading.fire(a))))}bulkAdd(t,r,n){const a=Array.isArray(r)?r:void 0,i=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&a)throw new ht.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new ht.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(Uf(l)):t;return this.core.mutate({trans:s,type:"add",keys:a,values:c,wantResults:i}).then(({numFailures:h,results:p,lastResult:x,failures:E})=>{if(h===0)return i?p:x;throw new Du(`${this.name}.bulkAdd(): ${h} of ${u} operations failed`,E)})})}bulkPut(t,r,n){const a=Array.isArray(r)?r:void 0,i=(n=n||(a?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&a)throw new ht.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new ht.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let c=l&&o?t.map(Uf(l)):t;return this.core.mutate({trans:s,type:"put",keys:a,values:c,wantResults:i}).then(({numFailures:h,results:p,lastResult:x,failures:E})=>{if(h===0)return i?p:x;throw new Du(`${this.name}.bulkPut(): ${h} of ${u} operations failed`,E)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:a,failures:i})=>{if(n===0)return a;throw new Du(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,i)})}}function Ou(e){var t={},r=function(s,o){if(o){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return t[s].subscribe.apply(null,u),e}if(typeof s=="string")return t[s]};r.addEventType=i;for(var n=1,a=arguments.length;n<a;++n)i(arguments[n]);return r;function i(s,o,l){if(typeof s!="object"){var u;o||(o=dD),l||(l=er);var c={subscribers:[],fire:l,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=o(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(p){return p!==h}),c.fire=c.subscribers.reduce(o,l)}};return t[s]=r[s]=c,c}Ar(u=s).forEach(function(h){var p=u[h];if(cn(p))i(h,u[h][0],u[h][1]);else{if(p!=="asap")throw new ht.InvalidArgument("Invalid event config");var x=i(h,oc,function(){for(var E=arguments.length,g=new Array(E);E--;)g[E]=arguments[E];x.subscribers.forEach(function(w){Yb(function(){w.apply(null,g)})})})}})}}function tu(e,t){return el(t).from({prototype:e}),t}function wo(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function ip(e,t){e.filter=Zs(e.filter,t)}function sp(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>Zs(n(),t()):t,e.justLimit=r&&!n}function _0(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new ht.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function x2(e,t,r){const n=_0(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function zf(e,t,r,n){const a=e.replayFilter?Zs(e.filter,e.replayFilter()):e.filter;if(e.or){const i={},s=(o,l,u)=>{if(!a||a(l,u,p=>l.stop(p),p=>l.fail(p))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),Kn(i,h)||(i[h]=!0,t(o,l,u))}};return Promise.all([e.or._iterate(s,r),v2(x2(e,n,r),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return v2(x2(e,n,r),Zs(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function v2(e,t,r,n){var a=cr(n?(i,s,o)=>r(n(i),s,o):r);return e.then(i=>{if(i)return i.start(()=>{var s=()=>i.continue();t&&!t(i,o=>s=o,o=>{i.stop(o),s=er},o=>{i.fail(o),s=er})||a(i.value,i,o=>s=o),s()})})}function En(e,t){try{const r=y2(e),n=y2(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(a,i){const s=a.length,o=i.length,l=s<o?s:o;for(let u=0;u<l;++u)if(a[u]!==i[u])return a[u]<i[u]?-1:1;return s===o?0:s<o?-1:1}(w2(e),w2(t));case"Array":return function(a,i){const s=a.length,o=i.length,l=s<o?s:o;for(let u=0;u<l;++u){const c=En(a[u],i[u]);if(c!==0)return c}return s===o?0:s<o?-1:1}(e,t)}}catch{}return NaN}function y2(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=Gm(e);return r==="ArrayBuffer"?"binary":r}function w2(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class bD{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Pr.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Pr.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=Zs(r.algorithm,t)}_iterate(t,r){return zf(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Tn(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>zf(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,a=n.table.core;if(wo(n,!0))return a.count({trans:r,query:{index:_0(n,a.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var i=0;return zf(n,()=>(++i,!1),r,a).then(()=>i)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),a=n[0],i=n.length-1;function s(u,c){return c?s(u[n[c]],c-1):u[a]}var o=this._ctx.dir==="next"?1:-1;function l(u,c){var h=s(u,i),p=s(c,i);return h<p?-o:h>p?o:0}return this.toArray(function(u){return u.sort(l)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&wo(n,!0)&&n.limit>0){const{valueMapper:a}=n,i=_0(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(({result:s})=>a?s.map(a):s)}{const a=[];return zf(n,i=>a.push(i),r,n.table.core).then(()=>a)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,wo(r)?sp(r,()=>{var n=t;return(a,i)=>n===0||(n===1?(--n,!1):(i(()=>{a.advance(n),n=0}),!1))}):sp(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),sp(this._ctx,()=>{var r=t;return function(n,a,i){return--r<=0&&a(i),r>=0}},!0),this}until(t,r){return ip(this._ctx,function(n,a,i){return!t(n.value)||(a(i),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return ip(this._ctx,function(a){return t(a.value)}),r=this._ctx,n=t,r.isMatch=Zs(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.key,a)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,a){t(a.primaryKey,a)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,i){n.push(i.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&wo(r,!0)&&r.limit>0)return this._read(a=>{var i=_0(r,r.table.core.schema);return r.table.core.query({trans:a,values:!1,limit:r.limit,query:{index:i,range:r.range}})}).then(({result:a})=>a).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(a,i){n.push(i.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return ip(this._ctx,function(a){var i=a.primaryKey.toString(),s=Kn(n,i);return n[i]=!0,!s}),this}modify(t){var r=this._ctx;return this._write(n=>{var a;if(typeof t=="function")a=t;else{var i=Ar(t),s=i.length;a=function(g){for(var w=!1,v=0;v<s;++v){var y=i[v],b=t[y];hi(g,y)!==b&&(Fa(g,y,b),w=!0)}return w}}const o=r.table.core,{outbound:l,extractKey:u}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[];let p=0;const x=[],E=(g,w)=>{const{failures:v,numFailures:y}=w;p+=g-y;for(let b of Ar(v))h.push(v[b])};return this.clone().primaryKeys().then(g=>{const w=v=>{const y=Math.min(c,g.length-v);return o.getMany({trans:n,keys:g.slice(v,v+y),cache:"immutable"}).then(b=>{const T=[],N=[],k=l?[]:null,_=[];for(let A=0;A<y;++A){const P=b[A],I={value:qc(P),primKey:g[v+A]};a.call(I,I.value,I)!==!1&&(I.value==null?_.push(g[v+A]):l||En(u(P),u(I.value))===0?(N.push(I.value),l&&k.push(g[v+A])):(_.push(g[v+A]),T.push(I.value)))}const S=wo(r)&&r.limit===1/0&&(typeof t!="function"||t===op)&&{index:r.index,range:r.range};return Promise.resolve(T.length>0&&o.mutate({trans:n,type:"add",values:T}).then(A=>{for(let P in A.failures)_.splice(parseInt(P),1);E(T.length,A)})).then(()=>(N.length>0||S&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:k,values:N,criteria:S,changeSpec:typeof t!="function"&&t}).then(A=>E(N.length,A))).then(()=>(_.length>0||S&&t===op)&&o.mutate({trans:n,type:"delete",keys:_,criteria:S}).then(A=>E(_.length,A))).then(()=>g.length>v+y&&w(v+c))})};return w(0).then(()=>{if(h.length>0)throw new Q0("Error modifying one or more objects",h,p,x);return g.length})})})}delete(){var t=this._ctx,r=t.range;return wo(t)&&(t.isPrimKey&&!wD||r.type===3)?this._write(n=>{const{primaryKey:a}=t.table.core.schema,i=r;return t.table.core.count({trans:n,query:{index:a,range:i}}).then(s=>t.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(({failures:o,lastResult:l,results:u,numFailures:c})=>{if(c)throw new Q0("Could not delete some values",Object.keys(o).map(h=>o[h]),s-c);return s-c}))}):this.modify(op)}}const op=(e,t)=>t.value=null;function _D(e,t){return e<t?-1:e===t?0:1}function TD(e,t){return e>t?-1:e===t?0:1}function zn(e,t,r){var n=e instanceof g_?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function Eo(e){return new e.Collection(e,()=>m_("")).limit(0)}function SD(e,t,r,n,a,i){for(var s=Math.min(e.length,n.length),o=-1,l=0;l<s;++l){var u=t[l];if(u!==n[l])return a(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):a(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;a(e[l],u)<0&&(o=l)}return s<n.length&&i==="next"?e+r.substr(e.length):s<e.length&&i==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function Wf(e,t,r,n){var a,i,s,o,l,u,c,h=r.length;if(!r.every(g=>typeof g=="string"))return zn(e,d_);function p(g){a=function(v){return v==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(g),i=function(v){return v==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(g),s=g==="next"?_D:TD;var w=r.map(function(v){return{lower:i(v),upper:a(v)}}).sort(function(v,y){return s(v.lower,y.lower)});o=w.map(function(v){return v.upper}),l=w.map(function(v){return v.lower}),u=g,c=g==="next"?"":n}p("next");var x=new e.Collection(e,()=>Ii(o[0],l[h-1]+n));x._ondirectionchange=function(g){p(g)};var E=0;return x._addAlgorithm(function(g,w,v){var y=g.key;if(typeof y!="string")return!1;var b=i(y);if(t(b,l,E))return!0;for(var T=null,N=E;N<h;++N){var k=SD(y,b,o[N],l[N],s,u);k===null&&T===null?E=N+1:(T===null||s(T,k)>0)&&(T=k)}return w(T!==null?function(){g.continue(T+c)}:v),!1}),x}function Ii(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function m_(e){return{type:1,lower:e,upper:e}}class g_{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,a){n=n!==!1,a=a===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||a)&&(!n||!a)?Eo(this):new this.Collection(this,()=>Ii(t,r,!n,!a))}catch{return zn(this,ni)}}equals(t){return t==null?zn(this,ni):new this.Collection(this,()=>m_(t))}above(t){return t==null?zn(this,ni):new this.Collection(this,()=>Ii(t,void 0,!0))}aboveOrEqual(t){return t==null?zn(this,ni):new this.Collection(this,()=>Ii(t,void 0,!1))}below(t){return t==null?zn(this,ni):new this.Collection(this,()=>Ii(void 0,t,!1,!0))}belowOrEqual(t){return t==null?zn(this,ni):new this.Collection(this,()=>Ii(void 0,t))}startsWith(t){return typeof t!="string"?zn(this,d_):this.between(t,t+Rs,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Wf(this,(r,n)=>r.indexOf(n[0])===0,[t],Rs)}equalsIgnoreCase(t){return Wf(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=oi.apply(Oo,arguments);return t.length===0?Eo(this):Wf(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=oi.apply(Oo,arguments);return t.length===0?Eo(this):Wf(this,(r,n)=>n.some(a=>r.indexOf(a)===0),t,Rs)}anyOf(){const t=oi.apply(Oo,arguments);let r=this._cmp;try{t.sort(r)}catch{return zn(this,ni)}if(t.length===0)return Eo(this);const n=new this.Collection(this,()=>Ii(t[0],t[t.length-1]));n._ondirectionchange=i=>{r=i==="next"?this._ascending:this._descending,t.sort(r)};let a=0;return n._addAlgorithm((i,s,o)=>{const l=i.key;for(;r(l,t[a])>0;)if(++a,a===t.length)return s(o),!1;return r(l,t[a])===0||(s(()=>{i.continue(t[a])}),!1)}),n}notEqual(t){return this.inAnyRange([[ig,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=oi.apply(Oo,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return zn(this,ni)}const r=t.reduce((n,a)=>n?n.concat([[n[n.length-1][1],a]]):[[ig,a]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,a=this._ascending,i=this._descending,s=this._min,o=this._max;if(t.length===0)return Eo(this);if(!t.every(y=>y[0]!==void 0&&y[1]!==void 0&&a(y[0],y[1])<=0))return zn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ht.InvalidArgument);const l=!r||r.includeLowers!==!1,u=r&&r.includeUppers===!0;let c,h=a;function p(y,b){return h(y[0],b[0])}try{c=t.reduce(function(y,b){let T=0,N=y.length;for(;T<N;++T){const k=y[T];if(n(b[0],k[1])<0&&n(b[1],k[0])>0){k[0]=s(k[0],b[0]),k[1]=o(k[1],b[1]);break}}return T===N&&y.push(b),y},[]),c.sort(p)}catch{return zn(this,ni)}let x=0;const E=u?y=>a(y,c[x][1])>0:y=>a(y,c[x][1])>=0,g=l?y=>i(y,c[x][0])>0:y=>i(y,c[x][0])>=0;let w=E;const v=new this.Collection(this,()=>Ii(c[0][0],c[c.length-1][1],!l,!u));return v._ondirectionchange=y=>{y==="next"?(w=E,h=a):(w=g,h=i),c.sort(p)},v._addAlgorithm((y,b,T)=>{for(var N=y.key;w(N);)if(++x,x===c.length)return b(T),!1;return!!function(k){return!E(k)&&!g(k)}(N)||(this._cmp(N,c[x][1])===0||this._cmp(N,c[x][0])===0||b(()=>{h===a?y.continue(c[x][0]):y.continue(c[x][1])}),!1)}),v}startsWithAnyOf(){const t=oi.apply(Oo,arguments);return t.every(r=>typeof r=="string")?t.length===0?Eo(this):this.inAnyRange(t.map(r=>[r,r+Rs])):zn(this,"startsWithAnyOf() only works with strings")}}function Ha(e){return cr(function(t){return uc(t),e(t.target.error),!1})}function uc(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const cc="storagemutated",Ui="x-storagemutated-1",is=Ou(null,cc);class AD{_lock(){return pu(!ot.global),++this._reculock,this._reculock!==1||ot.global||(ot.lockOwnerFor=this),this}_unlock(){if(pu(!ot.global),--this._reculock==0)for(ot.global||(ot.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Nl(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&ot.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(pu(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new ht.DatabaseClosed(n);case"MissingAPIError":throw new ht.MissingAPI(n.message,n);default:throw new ht.OpenFailed(n)}if(!this.active)throw new ht.TransactionInactive;return pu(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=cr(a=>{uc(a),this._reject(t.error)}),t.onabort=cr(a=>{uc(a),this.active&&this._reject(new ht.Abort(t.error)),this.active=!1,this.on("abort").fire(a)}),t.oncomplete=cr(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&is.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Pr(new ht.ReadOnly("Transaction is readonly"));if(!this.active)return Pr(new ht.TransactionInactive);if(this._locked())return new Je((i,s)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(i,s)},ot])});if(n)return ns(()=>{var i=new Je((s,o)=>{this._lock();const l=r(s,o,this);l&&l.then&&l.then(s,o)});return i.finally(()=>this._unlock()),i._lib=!0,i});var a=new Je((i,s)=>{var o=r(i,s,this);o&&o.then&&o.then(i,s)});return a._lib=!0,a}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=Je.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var a=r.idbtrans.objectStore(r.storeNames[0]);(function s(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(a.get(-1/0).onsuccess=s)})()}var i=r._waitingFor;return new Je((s,o)=>{n.then(l=>r._waitingQueue.push(cr(s.bind(null,l))),l=>r._waitingQueue.push(cr(o.bind(null,l)))).finally(()=>{r._waitingFor===i&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ht.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Kn(r,t))return r[t];const n=this.schema[t];if(!n)throw new ht.NotFound("Table "+t+" not part of transaction");const a=new this.db.Table(t,n,this);return a.core=this.db.core.table(t),r[t]=a,a}}function sg(e,t,r,n,a,i,s){return{name:e,keyPath:t,unique:r,multi:n,auto:a,compound:i,src:(r&&!s?"&":"")+(n?"*":"")+(a?"++":"")+x_(t)}}function x_(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function v_(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:Xb(r,n=>[n.name,n])}}let fc=e=>{try{return e.only([[]]),fc=()=>[[]],[[]]}catch{return fc=()=>Rs,Rs}};function og(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>hi(n,t)}(e):t=>hi(t,e)}function E2(e){return[].slice.call(e)}let CD=0;function Fu(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function DD(e,t,r){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:c,lowerOpen:h,upperOpen:p}=l;return u===void 0?c===void 0?null:t.upperBound(c,!!p):c===void 0?t.lowerBound(u,!!h):t.bound(u,c,!!h,!!p)}const{schema:a,hasGetAll:i}=function(l,u){const c=E2(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(h=>u.objectStore(h)).map(h=>{const{keyPath:p,autoIncrement:x}=h,E=cn(p),g=p==null,w={},v={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:E,keyPath:p,autoIncrement:x,unique:!0,extractKey:og(p)},indexes:E2(h.indexNames).map(y=>h.index(y)).map(y=>{const{name:b,unique:T,multiEntry:N,keyPath:k}=y,_={name:b,compound:cn(k),keyPath:k,unique:T,multiEntry:N,extractKey:og(k)};return w[Fu(k)]=_,_}),getIndexByKeyPath:y=>w[Fu(y)]};return w[":id"]=v.primaryKey,p!=null&&(w[Fu(p)]=v.primaryKey),v})},hasGetAll:c.length>0&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=a.tables.map(l=>function(u){const c=u.name;return{name:c,schema:u,mutate:function({trans:h,type:p,keys:x,values:E,range:g}){return new Promise((w,v)=>{w=cr(w);const y=h.objectStore(c),b=y.keyPath==null,T=p==="put"||p==="add";if(!T&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:N}=x||E||{length:1};if(x&&E&&x.length!==E.length)throw new Error("Given keys array must have same length as given values array.");if(N===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let k;const _=[],S=[];let A=0;const P=W=>{++A,uc(W)};if(p==="deleteRange"){if(g.type===4)return w({numFailures:A,failures:S,results:[],lastResult:void 0});g.type===3?_.push(k=y.clear()):_.push(k=y.delete(n(g)))}else{const[W,te]=T?b?[E,x]:[E,null]:[x,null];if(T)for(let oe=0;oe<N;++oe)_.push(k=te&&te[oe]!==void 0?y[p](W[oe],te[oe]):y[p](W[oe])),k.onerror=P;else for(let oe=0;oe<N;++oe)_.push(k=y[p](W[oe])),k.onerror=P}const I=W=>{const te=W.target.result;_.forEach((oe,ve)=>oe.error!=null&&(S[ve]=oe.error)),w({numFailures:A,failures:S,results:p==="delete"?x:_.map(oe=>oe.result),lastResult:te})};k.onerror=W=>{P(W),I(W)},k.onsuccess=I})},getMany:({trans:h,keys:p})=>new Promise((x,E)=>{x=cr(x);const g=h.objectStore(c),w=p.length,v=new Array(w);let y,b=0,T=0;const N=_=>{const S=_.target;v[S._pos]=S.result,++T===b&&x(v)},k=Ha(E);for(let _=0;_<w;++_)p[_]!=null&&(y=g.get(p[_]),y._pos=_,y.onsuccess=N,y.onerror=k,++b);b===0&&x(v)}),get:({trans:h,key:p})=>new Promise((x,E)=>{x=cr(x);const g=h.objectStore(c).get(p);g.onsuccess=w=>x(w.target.result),g.onerror=Ha(E)}),query:function(h){return p=>new Promise((x,E)=>{x=cr(x);const{trans:g,values:w,limit:v,query:y}=p,b=v===1/0?void 0:v,{index:T,range:N}=y,k=g.objectStore(c),_=T.isPrimaryKey?k:k.index(T.name),S=n(N);if(v===0)return x({result:[]});if(h){const A=w?_.getAll(S,b):_.getAllKeys(S,b);A.onsuccess=P=>x({result:P.target.result}),A.onerror=Ha(E)}else{let A=0;const P=w||!("openKeyCursor"in _)?_.openCursor(S):_.openKeyCursor(S),I=[];P.onsuccess=W=>{const te=P.result;return te?(I.push(w?te.value:te.primaryKey),++A===v?x({result:I}):void te.continue()):x({result:I})},P.onerror=Ha(E)}})}(i),openCursor:function({trans:h,values:p,query:x,reverse:E,unique:g}){return new Promise((w,v)=>{w=cr(w);const{index:y,range:b}=x,T=h.objectStore(c),N=y.isPrimaryKey?T:T.index(y.name),k=E?g?"prevunique":"prev":g?"nextunique":"next",_=p||!("openKeyCursor"in N)?N.openCursor(n(b),k):N.openKeyCursor(n(b),k);_.onerror=Ha(v),_.onsuccess=cr(S=>{const A=_.result;if(!A)return void w(null);A.___id=++CD,A.done=!1;const P=A.continue.bind(A);let I=A.continuePrimaryKey;I&&(I=I.bind(A));const W=A.advance.bind(A),te=()=>{throw new Error("Cursor not stopped")};A.trans=h,A.stop=A.continue=A.continuePrimaryKey=A.advance=()=>{throw new Error("Cursor not started")},A.fail=cr(v),A.next=function(){let oe=1;return this.start(()=>oe--?this.continue():this.stop()).then(()=>this)},A.start=oe=>{const ve=new Promise((_e,ue)=>{_e=cr(_e),_.onerror=Ha(ue),A.fail=ue,A.stop=ce=>{A.stop=A.continue=A.continuePrimaryKey=A.advance=te,_e(ce)}}),ye=()=>{if(_.result)try{oe()}catch(_e){A.fail(_e)}else A.done=!0,A.start=()=>{throw new Error("Cursor behind last entry")},A.stop()};return _.onsuccess=cr(_e=>{_.onsuccess=ye,ye()}),A.continue=P,A.continuePrimaryKey=I,A.advance=W,ye(),ve},w(A)},v)})},count({query:h,trans:p}){const{index:x,range:E}=h;return new Promise((g,w)=>{const v=p.objectStore(c),y=x.isPrimaryKey?v:v.index(x.name),b=n(E),T=b?y.count(b):y.count();T.onsuccess=cr(N=>g(N.target.result)),T.onerror=Ha(w)})}}}(l)),o={};return s.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:e.transaction.bind(e),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:fc(t),schema:a}}function lg({_novip:e},t){const r=t.db,n=function(a,i,{IDBKeyRange:s,indexedDB:o},l){return{dbcore:function(c,h){return h.reduce((p,{create:x})=>({...p,...x(p)}),c)}(DD(i,s,l),a.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(a=>{const i=a.name;e.core.schema.tables.some(s=>s.name===i)&&(a.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=a.core))})}function nd({_novip:e},t,r,n){r.forEach(a=>{const i=n[a];t.forEach(s=>{const o=D1(s,a);(!o||"value"in o&&o.value===void 0)&&(s===e.Transaction.prototype||s instanceof e.Transaction?di(s,a,{get(){return this.table(a)},set(l){Vb(this,a,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):s[a]=new e.Table(a,i))})})}function ug({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function ND(e,t){return e._cfg.version-t._cfg.version}function kD(e,t,r,n){const a=e._dbSchema,i=e._createTransaction("readwrite",e._storeNames,a);i.create(r),i._completion.catch(n);const s=i._reject.bind(i),o=ot.transless||ot;ns(()=>{ot.trans=i,ot.transless=o,t===0?(Ar(a).forEach(l=>{lp(r,l,a[l].primKey,a[l].indexes)}),lg(e,r),Je.follow(()=>e.on.populate.fire(i)).catch(s)):function({_novip:l},u,c,h){const p=[],x=l._versions;let E=l._dbSchema=fg(l,l.idbdb,h),g=!1;const w=x.filter(y=>y._cfg.version>=u);function v(){return p.length?Je.resolve(p.shift()(c.idbtrans)).then(v):Je.resolve()}return w.forEach(y=>{p.push(()=>{const b=E,T=y._cfg.dbschema;dg(l,b,h),dg(l,T,h),E=l._dbSchema=T;const N=y_(b,T);N.add.forEach(_=>{lp(h,_[0],_[1].primKey,_[1].indexes)}),N.change.forEach(_=>{if(_.recreate)throw new ht.Upgrade("Not yet support for changing primary key");{const S=h.objectStore(_.name);_.add.forEach(A=>cg(S,A)),_.change.forEach(A=>{S.deleteIndex(A.name),cg(S,A)}),_.del.forEach(A=>S.deleteIndex(A))}});const k=y._cfg.contentUpgrade;if(k&&y._cfg.version>u){lg(l,h),c._memoizedTables={},g=!0;let _=Kb(T);N.del.forEach(I=>{_[I]=b[I]}),ug(l,[l.Transaction.prototype]),nd(l,[l.Transaction.prototype],Ar(_),_),c.schema=_;const S=N1(k);let A;S&&Dl();const P=Je.follow(()=>{if(A=k(c),A&&S){var I=bi.bind(null,null);A.then(I,I)}});return A&&typeof A.then=="function"?Je.resolve(A):P.then(()=>A)}}),p.push(b=>{(!g||!yD)&&function(T,N){[].slice.call(N.db.objectStoreNames).forEach(k=>T[k]==null&&N.db.deleteObjectStore(k))}(y._cfg.dbschema,b),ug(l,[l.Transaction.prototype]),nd(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),v().then(()=>{var y,b;b=h,Ar(y=E).forEach(T=>{b.db.objectStoreNames.contains(T)||lp(b,T,y[T].primKey,y[T].indexes)})})}(e,t,i,r).catch(s)})}function y_(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const a=e[n],i=t[n];if(a){const s={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||a.primKey.auto!==i.primKey.auto&&!Hd)s.recreate=!0,r.change.push(s);else{const o=a.idxByName,l=i.idxByName;let u;for(u in o)l[u]||s.del.push(u);for(u in l){const c=o[u],h=l[u];c?c.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,i])}return r}function lp(e,t,r,n){const a=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(i=>cg(a,i)),a}function cg(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function fg(e,t,r){const n={};return Z0(t.objectStoreNames,0).forEach(a=>{const i=r.objectStore(a);let s=i.keyPath;const o=sg(x_(s),s||"",!1,!1,!!i.autoIncrement,s&&typeof s!="string",!0),l=[];for(let c=0;c<i.indexNames.length;++c){const h=i.index(i.indexNames[c]);s=h.keyPath;var u=sg(h.name,s,!!h.unique,!!h.multiEntry,!1,s&&typeof s!="string",!1);l.push(u)}n[a]=v_(a,o,l)}),n}function dg({_novip:e},t,r){const n=r.db.objectStoreNames;for(let a=0;a<n.length;++a){const i=n[a],s=r.objectStore(i);e._hasGetAll="getAll"in s;for(let o=0;o<s.indexNames.length;++o){const l=s.indexNames[o],u=s.index(l).keyPath,c=typeof u=="string"?u:"["+Z0(u).join("+")+"]";if(t[i]){const h=t[i].idxByName[c];h&&(h.name=l,delete t[i].idxByName[c],t[i].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&sr.WorkerGlobalScope&&sr instanceof sr.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class OD{_parseStoresSpec(t,r){Ar(t).forEach(n=>{if(t[n]!==null){var a=t[n].split(",").map((s,o)=>{const l=(s=s.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return sg(l,u||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),cn(u),o===0)}),i=a.shift();if(i.multi)throw new ht.Schema("Primary key cannot be multi-valued");a.forEach(s=>{if(s.auto)throw new ht.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new ht.Schema("Index must have a name and cannot be an empty string")}),r[n]=v_(n,i,a)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Tn(this._cfg.storesSource,t):t;const n=r._versions,a={};let i={};return n.forEach(s=>{Tn(a,s._cfg.storesSource),i=s._cfg.dbschema={},s._parseStoresSpec(a,i)}),r._dbSchema=i,ug(r,[r._allTables,r,r.Transaction.prototype]),nd(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Ar(i),i),r._storeNames=Ar(i),this}upgrade(t){return this._cfg.contentUpgrade=F1(this._cfg.contentUpgrade||er,t),this}}function L1(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Ws(Vd,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function M1(e){return e&&typeof e.databases=="function"}function hg(e){return ns(function(){return ot.letThrough=!0,e()})}function FD(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function PD(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Pr(t.dbOpenError):e);Ja&&(t.openCanceller._stackHolder=oo()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function a(){if(t.openCanceller!==n)throw new ht.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,s=null,o=!1;const l=()=>new Je((u,c)=>{if(a(),!r)throw new ht.MissingAPI;const h=e.name,p=t.autoSchema?r.open(h):r.open(h,Math.round(10*e.verno));if(!p)throw new ht.MissingAPI;p.onerror=Ha(c),p.onblocked=cr(e._fireOnBlocked),p.onupgradeneeded=cr(x=>{if(s=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=uc,s.abort(),p.result.close();const g=r.deleteDatabase(h);g.onsuccess=g.onerror=cr(()=>{c(new ht.NoSuchDatabase(`Database ${h} doesnt exist`))})}else{s.onerror=Ha(c);var E=x.oldVersion>Math.pow(2,62)?0:x.oldVersion;o=E<1,e._novip.idbdb=p.result,kD(e,E/10,s,c)}},c),p.onsuccess=cr(()=>{s=null;const x=e._novip.idbdb=p.result,E=Z0(x.objectStoreNames);if(E.length>0)try{const w=x.transaction((g=E).length===1?g[0]:g,"readonly");t.autoSchema?function({_novip:v},y,b){v.verno=y.version/10;const T=v._dbSchema=fg(0,y,b);v._storeNames=Z0(y.objectStoreNames,0),nd(v,[v._allTables],Ar(T),T)}(e,x,w):(dg(e,e._dbSchema,w),function(v,y){const b=y_(fg(0,v.idbdb,y),v._dbSchema);return!(b.add.length||b.change.some(T=>T.add.length||T.change.length))}(e,w)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),lg(e,w)}catch{}var g;ku.push(e),x.onversionchange=cr(w=>{t.vcFired=!0,e.on("versionchange").fire(w)}),x.onclose=cr(w=>{e.on("close").fire(w)}),o&&function({indexedDB:w,IDBKeyRange:v},y){!M1(w)&&y!==Vd&&L1(w,v).put({name:y}).catch(er)}(e._deps,h),u()},c)}).catch(u=>u&&u.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):Je.reject(u));return Je.race([n,(typeof navigator>"u"?Je.resolve():FD()).then(l)]).then(()=>(a(),t.onReadyBeingFired=[],Je.resolve(hg(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let c=t.onReadyBeingFired.reduce(F1,er);return t.onReadyBeingFired=[],Je.resolve(hg(()=>c(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{s&&s.abort()}catch{}return n===t.openCanceller&&e._close(),Pr(u)}).finally(()=>{t.openComplete=!0,i()})}function pg(e){var t=i=>e.next(i),r=a(t),n=a(i=>e.throw(i));function a(i){return s=>{var o=i(s),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(r,n):cn(l)?Promise.all(l).then(r,n):r(l)}}return a(t)()}function ID(e,t,r){var n=arguments.length;if(n<2)throw new ht.InvalidArgument("Too few arguments");for(var a=new Array(n-1);--n;)a[n-1]=arguments[n];return r=a.pop(),[e,Zb(a),r]}function w_(e,t,r,n,a){return Je.resolve().then(()=>{const i=ot.transless||ot,s=e._createTransaction(t,r,e._dbSchema,n),o={trans:s,transless:i};if(n)s.idbtrans=n.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===O1.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>w_(e,t,r,null,a))):Pr(h)}const l=N1(a);let u;l&&Dl();const c=Je.follow(()=>{if(u=a.call(s,s),u)if(l){var h=bi.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=pg(u))},o);return(u&&typeof u.then=="function"?Je.resolve(u).then(h=>s.active?h:Pr(new ht.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>u)).then(h=>(n&&s._resolve(),s._completion.then(()=>h))).catch(h=>(s._reject(h),Pr(h)))})}function qf(e,t,r){const n=cn(e)?e.slice():[e];for(let a=0;a<r;++a)n.push(t);return n}const RD={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,a={},i=[];function s(c,h,p){const x=Fu(c),E=a[x]=a[x]||[],g=c==null?0:typeof c=="string"?1:c.length,w=h>0,v={...p,isVirtual:w,keyTail:h,keyLength:g,extractKey:og(c),unique:!w&&p.unique};return E.push(v),v.isPrimaryKey||i.push(v),g>1&&s(g===2?c[0]:c.slice(0,g-1),h+1,p),E.sort((y,b)=>y.keyTail-b.keyTail),v}const o=s(n.primaryKey.keyPath,0,n.primaryKey);a[":id"]=[o];for(const c of n.indexes)s(c.keyPath,0,c);function l(c){const h=c.query.index;return h.isVirtual?{...c,query:{index:h,range:(p=c.query.range,x=h.keyTail,{type:p.type===1?2:p.type,lower:qf(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,x),lowerOpen:!0,upper:qf(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,x),upperOpen:!0})}}:c;var p,x}return{...r,schema:{...n,primaryKey:o,indexes:i,getIndexByKeyPath:function(c){const h=a[Fu(c)];return h&&h[0]}},count:c=>r.count(l(c)),query:c=>r.query(l(c)),openCursor(c){const{keyTail:h,isVirtual:p,keyLength:x}=c.query.index;return p?r.openCursor(l(c)).then(E=>E&&function(g){return Object.create(g,{continue:{value:function(v){v!=null?g.continue(qf(v,c.reverse?e.MAX_KEY:e.MIN_KEY,h)):c.unique?g.continue(g.key.slice(0,x).concat(c.reverse?e.MIN_KEY:e.MAX_KEY,h)):g.continue()}},continuePrimaryKey:{value(v,y){g.continuePrimaryKey(qf(v,e.MAX_KEY,h),y)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const v=g.key;return x===1?v[0]:v.slice(0,x)}},value:{get:()=>g.value}})}(E)):r.openCursor(c)}}}}}};function j1(e,t,r,n){return r=r||{},n=n||"",Ar(e).forEach(a=>{if(Kn(t,a)){var i=e[a],s=t[a];if(typeof i=="object"&&typeof s=="object"&&i&&s){const o=Gm(i);o!==Gm(s)?r[n+a]=t[a]:o==="Object"?j1(i,s,r,n+a+"."):i!==s&&(r[n+a]=t[a])}else i!==s&&(r[n+a]=t[a])}else r[n+a]=void 0}),Ar(t).forEach(a=>{Kn(e,a)||(r[n+a]=t[a])}),r}const LD={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(i){const s=ot.trans,{deleting:o,creating:l,updating:u}=s.table(t).hook;switch(i.type){case"add":if(l.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"put":if(l.fire===er&&u.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"delete":if(o.fire===er)break;return s._promise("readwrite",()=>c(i),!0);case"deleteRange":if(o.fire===er)break;return s._promise("readwrite",()=>function(p){return h(p.trans,p.range,1e4)}(i),!0)}return r.mutate(i);function c(p){const x=ot.trans,E=p.keys||function(g,w){return w.type==="delete"?w.keys:w.keys||w.values.map(g.extractKey)}(n,p);if(!E)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:E}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(g,w,v){return w.type==="add"?Promise.resolve([]):g.getMany({trans:w.trans,keys:v,cache:"immutable"})}(r,p,E).then(g=>{const w=E.map((v,y)=>{const b=g[y],T={onerror:null,onsuccess:null};if(p.type==="delete")o.fire.call(T,v,b,x);else if(p.type==="add"||b===void 0){const N=l.fire.call(T,v,p.values[y],x);v==null&&N!=null&&(v=N,p.keys[y]=v,n.outbound||Fa(p.values[y],n.keyPath,v))}else{const N=j1(b,p.values[y]),k=u.fire.call(T,N,v,b,x);if(k){const _=p.values[y];Object.keys(k).forEach(S=>{Kn(_,S)?_[S]=k[S]:Fa(_,S,k[S])})}}return T});return r.mutate(p).then(({failures:v,results:y,numFailures:b,lastResult:T})=>{for(let N=0;N<E.length;++N){const k=y?y[N]:E[N],_=w[N];k==null?_.onerror&&_.onerror(v[N]):_.onsuccess&&_.onsuccess(p.type==="put"&&g[N]?p.values[N]:k)}return{failures:v,results:y,numFailures:b,lastResult:T}}).catch(v=>(w.forEach(y=>y.onerror&&y.onerror(v)),Promise.reject(v)))})}function h(p,x,E){return r.query({trans:p,values:!1,query:{index:n,range:x},limit:E}).then(({result:g})=>c({type:"delete",keys:g,trans:p}).then(w=>w.numFailures>0?Promise.reject(w.failures[0]):g.length<E?{failures:[],numFailures:0,lastResult:void 0}:h(p,{...x,lower:g[g.length-1],lowerOpen:!0},E)))}}}}})};function E_(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let a=0,i=0;a<t.keys.length&&i<e.length;++a)En(t.keys[a],e[i])===0&&(n.push(r?qc(t.values[a]):t.values[a]),++i);return n.length===e.length?n:null}catch{return null}}const MD={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const a=E_(n.keys,n.trans._cache,n.cache==="clone");return a?Je.resolve(a):r.getMany(n).then(i=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?qc(i):i},i))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function B1(e){return!("from"in e)}const si=function(e,t){if(!this){const r=new si;return e&&"d"in e&&Tn(r,e),r}Tn(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function dc(e,t,r){const n=En(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(B1(e))return Tn(e,{from:t,to:r,d:1});const a=e.l,i=e.r;if(En(r,e.from)<0)return a?dc(a,t,r):e.l={from:t,to:r,d:1,l:null,r:null},b2(e);if(En(t,e.to)>0)return i?dc(i,t,r):e.r={from:t,to:r,d:1,l:null,r:null},b2(e);En(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),En(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const s=!e.r;a&&!e.l&&ad(e,a),i&&s&&ad(e,i)}function ad(e,t){B1(t)||function r(n,{from:a,to:i,l:s,r:o}){dc(n,a,i),s&&r(n,s),o&&r(n,o)}(e,t)}function jD(e,t){const r=mg(t);let n=r.next();if(n.done)return!1;let a=n.value;const i=mg(e);let s=i.next(a.from),o=s.value;for(;!n.done&&!s.done;){if(En(o.from,a.to)<=0&&En(o.to,a.from)>=0)return!0;En(a.from,o.from)<0?a=(n=r.next(o.from)).value:o=(s=i.next(a.from)).value}return!1}function mg(e){let t=B1(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&En(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||En(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function b2(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),a=n>1?"r":n<-1?"l":"";if(a){const i=a==="r"?"l":"r",s={...e},o=e[a];e.from=o.from,e.to=o.to,e[a]=o[a],s[a]=o[i],e[i]=s,s.d=_2(s)}e.d=_2(e)}function _2({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}xl(si.prototype,{add(e){return ad(this,e),this},addKey(e){return dc(this,e,e),this},addKeys(e){return e.forEach(t=>dc(this,t,t)),this},[Ym](){return mg(this)}});const BD={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new si(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const a=e.table(n),{schema:i}=a,{primaryKey:s}=i,{extractKey:o,outbound:l}=s,u={...a,mutate:p=>{const x=p.trans,E=x.mutatedParts||(x.mutatedParts={}),g=k=>{const _=`idb://${t}/${n}/${k}`;return E[_]||(E[_]=new si)},w=g(""),v=g(":dels"),{type:y}=p;let[b,T]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const N=p.trans._cache;return a.mutate(p).then(k=>{if(cn(b)){y!=="delete"&&(b=k.results),w.addKeys(b);const _=E_(b,N);_||y==="add"||v.addKeys(b),(_||T)&&function(S,A,P,I){function W(te){const oe=S(te.name||"");function ve(_e){return _e!=null?te.extractKey(_e):null}const ye=_e=>te.multiEntry&&cn(_e)?_e.forEach(ue=>oe.addKey(ue)):oe.addKey(_e);(P||I).forEach((_e,ue)=>{const ce=P&&ve(P[ue]),De=I&&ve(I[ue]);En(ce,De)!==0&&(ce!=null&&ye(ce),De!=null&&ye(De))})}A.indexes.forEach(W)}(g,i,_,T)}else if(b){const _={from:b.lower,to:b.upper};v.add(_),w.add(_)}else w.add(r),v.add(r),i.indexes.forEach(_=>g(_.name).add(r));return k})}},c=({query:{index:p,range:x}})=>{var E,g;return[p,new si((E=x.lower)!==null&&E!==void 0?E:e.MIN_KEY,(g=x.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},h={get:p=>[s,new si(p.key)],getMany:p=>[s,new si().addKeys(p.keys)],count:c,query:c,openCursor:c};return Ar(h).forEach(p=>{u[p]=function(x){const{subscr:E}=ot;if(E){const g=T=>{const N=`idb://${t}/${n}/${T}`;return E[N]||(E[N]=new si)},w=g(""),v=g(":dels"),[y,b]=h[p](x);if(g(y.name||"").add(b),!y.isPrimaryKey){if(p!=="count"){const T=p==="query"&&l&&x.values&&a.query({...x,values:!1});return a[p].apply(this,arguments).then(N=>{if(p==="query"){if(l&&x.values)return T.then(({result:_})=>(w.addKeys(_),N));const k=x.values?N.result.map(o):N.result;x.values?w.addKeys(k):v.addKeys(k)}else if(p==="openCursor"){const k=N,_=x.values;return k&&Object.create(k,{key:{get:()=>(v.addKey(k.primaryKey),k.key)},primaryKey:{get(){const S=k.primaryKey;return v.addKey(S),S}},value:{get:()=>(_&&w.addKey(k.primaryKey),k.value)}})}return N})}v.add(r)}}return a[p].apply(this,arguments)}}),u}}}};class Ws{constructor(t,r){this._middlewares={},this.verno=0;const n=Ws.dependencies;this._options=r={addons:Ws.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:a}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:er,dbReadyPromise:null,cancelOpen:er,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;i.dbReadyPromise=new Je(o=>{i.dbReadyResolve=o}),i.openCanceller=new Je((o,l)=>{i.cancelOpen=l}),this._state=i,this.name=t,this.on=Ou(this,"populate","blocked","versionchange","close",{ready:[F1,er]}),this.on.ready.subscribe=Gb(this.on.ready.subscribe,o=>(l,u)=>{Ws.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||Je.resolve().then(l),u&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),u&&o(l);else{o(l);const h=this;u||o(function p(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(p)})}})}),this.Collection=(s=this,tu(bD.prototype,function(o,l){this.db=s;let u=p_,c=null;if(l)try{u=l()}catch(E){c=E}const h=o._ctx,p=h.table,x=p.hook.reading.fire;this._ctx={table:p,index:h.index,isPrimKey:!h.index||p.schema.primKey.keyPath&&h.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:x!==oc?x:null}})),this.Table=function(o){return tu(ED.prototype,function(l,u,c){this.db=o,this._tx=c,this.name=l,this.schema=u,this.hook=o._allTables[l]?o._allTables[l].hook:Ou(null,{creating:[uD,er],reading:[lD,oc],updating:[fD,er],deleting:[cD,er]})})}(this),this.Transaction=function(o){return tu(AD.prototype,function(l,u,c,h,p){this.db=o,this.mode=l,this.storeNames=u,this.schema=c,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=Ou(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Je((x,E)=>{this._resolve=x,this._reject=E}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},x=>{var E=this.active;return this.active=!1,this.on.error.fire(x),this.parent?this.parent._reject(x):E&&this.idbtrans&&this.idbtrans.abort(),Pr(x)})})}(this),this.Version=function(o){return tu(OD.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return tu(g_.prototype,function(l,u,c){this.db=o,this._ctx={table:l,index:u===":id"?null:u,or:c};const h=o._deps.indexedDB;if(!h)throw new ht.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(p,x)=>h.cmp(x,p),this._max=(p,x)=>h.cmp(p,x)>0?p:x,this._min=(p,x)=>h.cmp(p,x)<0?p:x,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=fc(r.IDBKeyRange),this._createTransaction=(o,l,u,c)=>new this.Transaction(o,l,u,this._options.chromeTransactionDurability,c),this._fireOnBlocked=o=>{this.on("blocked").fire(o),ku.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(RD),this.use(LD),this.use(BD),this.use(MD),this.vip=Object.create(this,{_vip:{value:!0}}),a.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new ht.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new ht.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(a=>a._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(ND),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||ot.letThrough||this._vip)?t():new Je((r,n)=>{if(this._state.openComplete)return n(new ht.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new ht.DatabaseClosed);this.open().catch(er)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:a}){a&&this.unuse({stack:t,name:a});const i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:r,level:n??10,name:a}),i.sort((s,o)=>s.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(a=>n?a.create!==n:!!r&&a.name!==r)),this}open(){return PD(this)}_close(){const t=this._state,r=ku.indexOf(this);if(r>=0&&ku.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new Je(n=>{t.dbReadyResolve=n}),t.openCanceller=new Je((n,a)=>{t.cancelOpen=a})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new ht.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new Je((n,a)=>{const i=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=cr(()=>{(function({indexedDB:o,IDBKeyRange:l},u){!M1(o)&&u!==Vd&&L1(o,l).delete(u).catch(er)})(this._deps,this.name),n()}),s.onerror=Ha(a),s.onblocked=this._fireOnBlocked};if(t)throw new ht.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(i):i()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ar(this._allTables).map(t=>this._allTables[t])}transaction(){const t=ID.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let a=ot.trans;a&&a.db===this&&t.indexOf("!")===-1||(a=null);const i=t.indexOf("?")!==-1;let s,o;t=t.replace("!","").replace("?","");try{if(o=r.map(u=>{var c=u instanceof this.Table?u.name:u;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),t=="r"||t===np)s=np;else{if(t!="rw"&&t!=ap)throw new ht.InvalidArgument("Invalid transaction mode: "+t);s=ap}if(a){if(a.mode===np&&s===ap){if(!i)throw new ht.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a=null}a&&o.forEach(u=>{if(a&&a.storeNames.indexOf(u)===-1){if(!i)throw new ht.SubTransaction("Table "+u+" not included in parent transaction.");a=null}}),i&&a&&!a.active&&(a=null)}}catch(u){return a?a._promise(null,(c,h)=>{h(u)}):Pr(u)}const l=w_.bind(null,this,s,o,a,n);return a?a._promise(s,l,"lock"):ot.trans?Nl(ot.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!Kn(this._allTables,t))throw new ht.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const UD=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class zD{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[UD](){return this}}function b_(e,t){return Ar(t).forEach(r=>{ad(e[r]||(e[r]=new si),t[r])}),e}function __(e){let t,r=!1;const n=new zD(a=>{const i=N1(e);let s=!1,o={},l={};const u={get closed(){return s},unsubscribe:()=>{s=!0,is.storagemutated.unsubscribe(x)}};a.start&&a.start(u);let c=!1,h=!1;function p(){return Ar(l).some(g=>o[g]&&jD(o[g],l[g]))}const x=g=>{b_(o,g),p()&&E()},E=()=>{if(c||s)return;o={};const g={},w=function(v){i&&Dl();const y=()=>ns(e,{subscr:v,trans:null}),b=ot.trans?Nl(ot.transless,y):y();return i&&b.then(bi,bi),b}(g);h||(is(cc,x),h=!0),c=!0,Promise.resolve(w).then(v=>{r=!0,t=v,c=!1,s||(p()?E():(o={},l=g,a.next&&a.next(v)))},v=>{c=!1,r=!1,a.error&&a.error(v),u.unsubscribe()})};return E(),u});return n.hasValue=()=>r,n.getValue=()=>t,n}let gg;try{gg={indexedDB:sr.indexedDB||sr.mozIndexedDB||sr.webkitIndexedDB||sr.msIndexedDB,IDBKeyRange:sr.IDBKeyRange||sr.webkitIDBKeyRange}}catch{gg={indexedDB:null,IDBKeyRange:null}}const Ss=Ws;function T0(e){let t=ci;try{ci=!0,is.storagemutated.fire(e)}finally{ci=t}}xl(Ss,{...v0,delete:e=>new Ss(e,{addons:[]}).delete(),exists:e=>new Ss(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return M1(t)?Promise.resolve(t.databases()).then(n=>n.map(a=>a.name).filter(a=>a!==Vd)):L1(t,r).toCollection().primaryKeys()}(Ss.dependencies).then(e)}catch{return Pr(new ht.MissingAPI)}},defineClass:()=>function(e){Tn(this,e)},ignoreTransaction:e=>ot.trans?Nl(ot.transless,e):e(),vip:hg,async:function(e){return function(){try{var t=pg(e.apply(this,arguments));return t&&typeof t.then=="function"?t:Je.resolve(t)}catch(r){return Pr(r)}}},spawn:function(e,t,r){try{var n=pg(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:Je.resolve(n)}catch(a){return Pr(a)}},currentTransaction:{get:()=>ot.trans||null},waitFor:function(e,t){const r=Je.resolve(typeof e=="function"?Ss.ignoreTransaction(e):e).timeout(t||6e4);return ot.trans?ot.trans.waitFor(r):r},Promise:Je,debug:{get:()=>Ja,set:e=>{Jb(e,e==="dexie"?()=>!0:h_)}},derive:el,extend:Tn,props:xl,override:Gb,Events:Ou,on:is,liveQuery:__,extendObservabilitySet:b_,getByKeyPath:hi,setByKeyPath:Fa,delByKeyPath:function(e,t){typeof t=="string"?Fa(e,t,void 0):"length"in t&&[].map.call(t,function(r){Fa(e,r,void 0)})},shallowClone:Kb,deepClone:qc,getObjectDiff:j1,cmp:En,asap:Yb,minKey:ig,addons:[],connections:ku,errnames:O1,dependencies:gg,semVer:g2,version:g2.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),Ss.maxKey=fc(Ss.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(is(cc,e=>{if(!ci){let t;Hd?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Ui,!0,!0,e)):t=new CustomEvent(Ui,{detail:e}),ci=!0,dispatchEvent(t),ci=!1}}),addEventListener(Ui,({detail:e})=>{ci||T0(e)}));let ci=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Ui);typeof e.unref=="function"&&e.unref(),is(cc,t=>{ci||e.postMessage(t)}),e.onmessage=t=>{t.data&&T0(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){is(cc,t=>{try{ci||(typeof localStorage<"u"&&localStorage.setItem(Ui,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Ui,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Ui){const r=JSON.parse(t.newValue);r&&T0(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Ui&&T0(t.changedParts)})}Je.rejectionMapper=function(e,t){if(!e||e instanceof tl||e instanceof TypeError||e instanceof SyntaxError||!e.name||!d2[e.name])return e;var r=new d2[e.name](t||e.message,e);return"stack"in e&&di(r,"stack",{get:function(){return this.inner.stack}}),r},Jb(Ja,h_);function WD(e,t,r){var n,a;typeof e=="function"?(n=t||[],a=r):(n=[],a=t);var i=ks.useRef({hasResult:!1,result:a,error:null}),s=ks.useReducer(function(u){return u+1},0);s[0];var o=s[1],l=ks.useMemo(function(){var u=typeof e=="function"?e():e;if(!u||typeof u.subscribe!="function")throw e===u?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!i.current.hasResult&&typeof window<"u"&&(typeof u.hasValue!="function"||u.hasValue()))if(typeof u.getValue=="function")i.current.result=u.getValue(),i.current.hasResult=!0;else{var c=u.subscribe(function(h){i.current.result=h,i.current.hasResult=!0});typeof c=="function"?c():c.unsubscribe()}return u},n);if(ks.useDebugValue(i.current.result),ks.useEffect(function(){var u=l.subscribe(function(c){var h=i.current;(h.error!==null||h.result!==c)&&(h.error=null,h.result=c,h.hasResult=!0,o())},function(c){var h=i.current;h.error!==c&&(h.error=c,o())});return typeof u=="function"?u:u.unsubscribe.bind(u)},n),i.current.error)throw i.current.error;return i.current.result}function Zr(e,t,r){return WD(function(){return __(e)},t||[],r)}let $f;const qD=new Uint8Array(16);function $D(){if(!$f&&($f=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$f))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $f(qD)}const Vr=[];for(let e=0;e<256;++e)Vr.push((e+256).toString(16).slice(1));function HD(e,t=0){return Vr[e[t+0]]+Vr[e[t+1]]+Vr[e[t+2]]+Vr[e[t+3]]+"-"+Vr[e[t+4]]+Vr[e[t+5]]+"-"+Vr[e[t+6]]+Vr[e[t+7]]+"-"+Vr[e[t+8]]+Vr[e[t+9]]+"-"+Vr[e[t+10]]+Vr[e[t+11]]+Vr[e[t+12]]+Vr[e[t+13]]+Vr[e[t+14]]+Vr[e[t+15]]}const VD=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),T2={randomUUID:VD};function T_(e,t,r){if(T2.randomUUID&&!e)return T2.randomUUID();e=e||{};const n=e.random||(e.rng||$D)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,HD(n)}class GD extends Ws{constructor(){super("CourseManagementDB");vo(this,"groups");vo(this,"participants");vo(this,"settings");vo(this,"yearlyArchives");this.version(1).stores({groups:"id, groupNumber, courseStartDate",participants:"id, groupNumber, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}),this.version(2).stores({groups:"id, groupNumber, courseStartDate",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>r.table("participants").toCollection().modify(n=>{n.autoGroup=n.groupNumber,n.manualGroup=null})),this.version(3).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>{const n=new Date().toISOString();return r.table("groups").toCollection().modify(a=>{a.status=a.groupNumber===1?"active":"planned",a.createdAt=n,a.updatedAt=n})}),this.version(4).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id"}).upgrade(r=>{const n=new Date().toISOString();r.table("participants").toCollection().modify(a=>{a.createdAt=a.createdAt||n,a.updatedAt=a.updatedAt||n,(a.completedComputed||a.completedOverride===!0)&&(a.completedAt=a.completedAt||n)}),r.table("groups").toCollection().modify(a=>{a.isLocked=a.status==="completed"})}),this.version(5).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate",settings:"id",yearlyArchives:"id, year"}),this.version(6).stores({groups:"id, groupNumber, courseStartDate, status",participants:"id, groupNumber, autoGroup, uniqueNumber, companyName, personName, courseStartDate, egn",settings:"id",yearlyArchives:"id, year"}).upgrade(r=>r.table("participants").toCollection().modify(n=>{n.egn=n.egn||"",n.birthPlace=n.birthPlace||"",n.citizenship=n.citizenship||""})),this.version(7).stores({groups:"id, courseStartDate, status, groupNumber",participants:"id, courseStartDate, uniqueNumber, companyName, personName, egn",settings:"id",yearlyArchives:"id, year"}).upgrade(async r=>{await r.table("participants").toCollection().modify(n=>{delete n.groupNumber,delete n.autoGroup,delete n.manualGroup}),await r.table("groups").toCollection().modify(n=>{n.status==="planned"&&(n.groupNumber=null)})})}}const ke=new GD;async function YD(){try{await ke.settings.count()===0&&await ke.settings.add({id:1,lastUniquePrefix:3533,lastUniqueSeq:0,lastResetYear:null})}catch(e){console.error("Failed to initialize settings:",e)}}YD().catch(e=>{console.error("CRITICAL DB INIT FAILURE:",e)});function S_(e){const t=new Date(e),r=t.getDay();if(r===1)return t;const n=r===0?1:8-r;return t.setDate(t.getDate()+n),t}function id(e){const t=new Date(e),r=S_(t),n=new Date(r);return n.setDate(n.getDate()+7),{courseStartDate:r.toISOString().split("T")[0],courseEndDate:n.toISOString().split("T")[0]}}const XD=Object.freeze(Object.defineProperty({__proto__:null,computeCourseDates:id,nextMonday:S_},Symbol.toStringTag,{value:"Module"}));function Gd(e,t){return`${e.toString().padStart(4,"0")}-${t}`}function vl(e){const t=e.match(/^(\d{4})-(\d+)$/);return t?{prefix:parseInt(t[1],10),seq:parseInt(t[2],10)}:null}async function Vc(e=!1){const t=await ke.participants.toArray();let r=null;for(const n of t){if(!n.uniqueNumber)continue;const a=vl(n.uniqueNumber);a&&(r?(a.prefix>r.prefix||a.prefix===r.prefix&&a.seq>r.seq)&&(r=a):r=a)}if(!e){const n=await ke.settings.get(1);if(n){const a={prefix:n.lastUniquePrefix,seq:n.lastUniqueSeq};r?(a.prefix>r.prefix||a.prefix===r.prefix&&a.seq>r.seq)&&(r=a):r=a}}return r}async function U1(){const e=await ke.settings.get(1);if(!e)throw new Error("Settings not initialized");let t=e.lastUniquePrefix,r=e.lastUniqueSeq;const n=await Vc();n&&(n.prefix>t?(t=n.prefix,r=n.seq):n.prefix===t&&n.seq>r&&(r=n.seq));const a=t+1,i=r+1;return Gd(a,i)}async function KD(e){const t=await ke.groups.get(e);if(!t)return;if(t.status!=="active"){console.warn(`Attempted to assign numbers to non-active group ${e}`);return}const n=(await ke.participants.where("courseStartDate").equals(t.courseStartDate).toArray()).filter(u=>!u.uniqueNumber);if(n.length===0)return;n.sort((u,c)=>{const h=new Date(u.createdAt||0).getTime(),p=new Date(c.createdAt||0).getTime();return h!==p?h-p:(u.id||"").localeCompare(c.id||"")});const a=await ke.settings.get(1);if(!a)throw new Error("Settings not initialized");let i=a.lastUniquePrefix,s=a.lastUniqueSeq;const o=await Vc();o&&(o.prefix>i?(i=o.prefix,s=o.seq):o.prefix===i&&o.seq>s&&(s=o.seq));const l=[];for(const u of n){i++,s++;const c=Gd(i,s);l.push({id:u.id,uniqueNumber:c})}for(const u of l)await ke.participants.update(u.id,{uniqueNumber:u.uniqueNumber});await ke.settings.update(1,{lastUniquePrefix:i,lastUniqueSeq:s})}async function A_(){const e=await ke.settings.get(1);if(!e)return;const t=e.lastUniquePrefix+1;await ke.settings.update(1,{lastUniquePrefix:t,lastUniqueSeq:0,lastResetYear:new Date().getFullYear()})}async function ZD(e){const t=vl(e);if(!t)return;const{prefix:r}=t,n=await ke.participants.filter(s=>!!s.uniqueNumber).toArray(),a=[];for(const s of n){const o=vl(s.uniqueNumber);if(o&&o.prefix>r){const l=o.prefix-1,u=o.seq-1,c=Gd(l,u);a.push({id:s.id,newNum:c,newPrefix:l,newSeq:u})}}for(const s of a)await ke.participants.update(s.id,{uniqueNumber:s.newNum});const i=await Vc();i&&await ke.settings.update(1,{lastUniquePrefix:i.prefix,lastUniqueSeq:i.seq})}async function hc(e,t){const n=await ke.participants.where("uniqueNumber").equals(e).toArray();return t?n.length===0||n.length===1&&n[0].id===t:n.length===0}async function C_(){return null}function D_(e){return/^\d{4}-\d+$/.test(e)}async function QD(e){const t=await ke.participants.where("courseStartDate").equals(e).toArray();for(const n of t)n.uniqueNumber&&await ke.participants.update(n.id,{uniqueNumber:""});const r=await Vc(!0);r&&await ke.settings.update(1,{lastUniquePrefix:r.prefix,lastUniqueSeq:r.seq})}const pc=Object.freeze(Object.defineProperty({__proto__:null,assignUniqueNumbersForGroupActivation:KD,checkForGaps:C_,clearUniqueNumbersForGroup:QD,formatUniqueNumber:Gd,generateNextUniqueNumber:U1,getGlobalMaxUniqueNumber:Vc,isUniqueNumberAvailable:hc,isValidUniqueNumberFormat:D_,parseUniqueNumber:vl,realignUniqueNumbers:ZD,resetYearlySequence:A_},Symbol.toStringTag,{value:"Module"}));async function Ai(){return ke.groups.where("status").equals("active").first()}async function N_(e){const t=await ke.groups.where("courseStartDate").equals(e).first();if(!t)return;const{assignUniqueNumbersForGroupActivation:r}=await Ra(async()=>{const{assignUniqueNumbersForGroupActivation:n}=await Promise.resolve().then(()=>pc);return{assignUniqueNumbersForGroupActivation:n}},void 0);await r(t.id)}async function k_(){return ke.groups.where("status").equals("planned").sortBy("courseStartDate")}async function sd(e){const{computeCourseDates:t}=await Ra(async()=>{const{computeCourseDates:l}=await Promise.resolve().then(()=>XD);return{computeCourseDates:l}},void 0),{isMedicalValidForCourse:r}=await Ra(async()=>{const{isMedicalValidForCourse:l}=await Promise.resolve().then(()=>Tk);return{isMedicalValidForCourse:l}},void 0),{courseStartDate:n}=t(e),a=await ke.groups.toArray(),i=a.find(l=>l.status==="active"),s=a.filter(l=>l.status==="planned").sort((l,u)=>l.courseStartDate.localeCompare(u.courseStartDate)),o=a.find(l=>l.courseStartDate===n);if(o&&o.status==="completed"){const l=[];i&&l.push(i),l.push(...s),l.sort((c,h)=>c.courseStartDate.localeCompare(h.courseStartDate));const u=l.find(c=>c.courseStartDate<n?!1:r(e,c.courseStartDate));return u?{group:u,shouldCreate:!1}:{group:o,shouldCreate:!1}}return o?{group:o,shouldCreate:!1}:i&&n<i.courseStartDate?{group:{id:"stub_past",status:"completed",courseStartDate:n,courseEndDate:"",groupNumber:-1,createdAt:"",updatedAt:"",isLocked:!0},shouldCreate:!1}:{group:null,shouldCreate:!0,createsForDate:n}}async function z1(e,t="planned"){const r=await ke.groups.where("courseStartDate").equals(e).first();if(r)return r.status!==t&&t==="active"&&console.warn(`Group for ${e} already exists with status ${r.status}. Returning existing.`),r;let n=null;t==="active"&&(n=null);const a=new Date(e);a.setDate(a.getDate()+7);const i=new Date().toISOString(),s={id:T_(),groupNumber:n,courseStartDate:e,courseEndDate:a.toISOString().split("T")[0],status:t,createdAt:i,updatedAt:i,isLocked:!1};return await ke.groups.add(s),s}async function O_(){const e=await Ai();if(!e)throw new Error("No active group to close");const t=new Date().toISOString();let r=e.groupNumber;if(r==null){const n=await ke.groups.where("status").equals("completed").toArray(),a=new Set(n.map(s=>s.groupNumber).filter(s=>s!=null&&s>0));let i=1;for(;a.has(i);)i++;r=i,console.log(`Assigning Group Number ${r} to closed group (Gap filling/Next sequential)`)}await ke.groups.update(e.id,{status:"completed",groupNumber:r,updatedAt:t,closedAt:t,isLocked:!0})}async function S0(){const e=await ke.participants.toArray(),t=await ke.groups.toArray(),r=t.find(E=>E.status==="active"),n=t.filter(E=>E.status==="active");for(const E of n)await N_(E.courseStartDate);for(const E of t){const g=new Date(E.courseStartDate);if(g.getDay()!==1){console.warn(`Found invalid group start date ${E.courseStartDate} (Day: ${g.getDay()}). Fixing to Monday.`);const w=g.getDay(),v=w===0?1:8-w,y=new Date(g);y.setDate(g.getDate()+v);const b=y.toISOString().split("T")[0];await ke.groups.update(E.id,{courseStartDate:b,courseEndDate:new Date(y.getTime()+7*24*60*60*1e3).toISOString().split("T")[0]});const T=e.filter(N=>N.courseStartDate===E.courseStartDate);for(const N of T)await ke.participants.update(N.id,{courseStartDate:b,courseEndDate:new Date(y.getTime()+7*24*60*60*1e3).toISOString().split("T")[0]})}}const a=new Set;e.forEach(E=>a.add(E.courseStartDate));let i;if(r)i=new Date(r.courseStartDate);else{const E=new Date,g=E.getDay(),w=g===0?1:g===1?0:8-g;i=new Date(E),i.setHours(12,0,0,0),i.setDate(E.getDate()+w)}const s=new Date(i);s.setDate(s.getDate()+7);const o=new Date(i);o.setDate(o.getDate()+14),a.add(s.toISOString().split("T")[0]),a.add(o.toISOString().split("T")[0]);const l=new Set(t.map(E=>E.courseStartDate));for(const E of a)l.has(E)||(console.log(`Creating missing planned group for ${E}`),await z1(E,"planned"));const u=await ke.groups.toArray(),c=new Map;e.forEach(E=>{c.set(E.courseStartDate,(c.get(E.courseStartDate)||0)+1)});const h=new Map;u.forEach(E=>{const g=h.get(E.courseStartDate)||[];g.push(E),h.set(E.courseStartDate,g)});for(const[E,g]of h)if(g.length>1){console.warn(`Found ${g.length} duplicate groups for ${E}. Merging and cleaning up...`);const w=g.sort((b,T)=>{const N=S=>S.status==="completed"?3:S.status==="active"?2:1,k=N(b),_=N(T);return k!==_?_-k:0}),v=w[0],y=w.slice(1);for(const b of y)console.warn(`Merging participants from duplicate group ${b.id} to ${v.id}`),await ke.groups.delete(b.id)}const x=(await ke.groups.toArray()).filter(E=>E.status==="planned");if(x.length>2){const E=x.filter(w=>(c.get(w.courseStartDate)||0)===0);let g=x.length;E.sort((w,v)=>v.courseStartDate.localeCompare(w.courseStartDate));for(const w of E){if(g<=2)break;console.log(`Pruning excess empty planned group: ${w.courseStartDate}`),await ke.groups.delete(w.id),g--}}}function Ho(e){return e?e.status==="completed"&&e.isLocked:!1}async function F_(){return ke.groups.where("status").equals("completed").reverse().sortBy("groupNumber")}async function P_(e){const t=await ke.groups.get(e);if(!t)throw new Error("Group not found");if(t.status==="active")return{success:!0};const r=await Ai();return r&&r.id!==e?{success:!1,needsConfirm:!0,currentActive:r}:await Yd(e)}async function Yd(e,t=!1){const r=await ke.groups.get(e);if(!r)throw new Error("Group not found");const n=new Date().toISOString();if(t){const s=await Ai();if(s){await ke.groups.update(s.id,{status:"planned",updatedAt:n,activatedAt:void 0,groupNumber:null});const{clearUniqueNumbersForGroup:o}=await Ra(async()=>{const{clearUniqueNumbersForGroup:l}=await Promise.resolve().then(()=>pc);return{clearUniqueNumbersForGroup:l}},void 0);await o(s.courseStartDate)}}let a=r.groupNumber;r.status==="planned"&&a===null&&(a=null),await ke.groups.update(e,{groupNumber:a,status:"active",activatedAt:n,updatedAt:n,isLocked:!1});const{assignUniqueNumbersForGroupActivation:i}=await Ra(async()=>{const{assignUniqueNumbersForGroupActivation:s}=await Promise.resolve().then(()=>pc);return{assignUniqueNumbersForGroupActivation:s}},void 0);return await i(e),{success:!0}}async function I_(){const e=await Ai();if(!e)throw new Error("No active group to set as planned");const t=new Date().toISOString();await ke.groups.update(e.id,{status:"planned",updatedAt:t,activatedAt:void 0});const{clearUniqueNumbersForGroup:r}=await Ra(async()=>{const{clearUniqueNumbersForGroup:n}=await Promise.resolve().then(()=>pc);return{clearUniqueNumbersForGroup:n}},void 0);await r(e.courseStartDate)}async function R_(e){const t=await ke.groups.get(e);if(!t)throw new Error("Group not found");if(t.status!=="completed")throw new Error("Only archived groups can be reopened");const r=await Ai();return r?{success:!1,needsConfirm:!0,currentActive:r}:await Yd(e)}async function L_(){const e=await ke.groups.where("status").equals("active").toArray();if(e.length<=1)return;console.warn(` Found ${e.length} active groups! Fixing...`);const t=e.sort((i,s)=>new Date(s.updatedAt).getTime()-new Date(i.updatedAt).getTime()),r=t[0],n=t.slice(1),a=new Date().toISOString();for(const i of n)await ke.groups.update(i.id,{status:"planned",updatedAt:a,activatedAt:void 0}),console.warn(` Moved Group ${i.groupNumber} from active to planned`);console.log(` Kept Group ${r.groupNumber} as active`)}const M_=Object.freeze(Object.defineProperty({__proto__:null,activateGroupDirectly:Yd,closeActiveGroup:O_,createGroup:z1,ensureSingleActiveGroup:L_,generateUniqueNumbersForGroup:N_,getActiveGroup:Ai,getCompletedGroups:F_,getPlannedGroups:k_,getSuggestedGroup:sd,isGroupReadOnly:Ho,makeGroupActive:P_,reopenArchivedGroup:R_,setActiveToPlanned:I_,syncGroups:S0},Symbol.toStringTag,{value:"Module"})),j_=6048e5,JD=864e5,B_=6e4,U_=36e5,S2=Symbol.for("constructDateFrom");function La(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&S2 in e?e[S2](t):e instanceof Date?new e.constructor(t):new Date(t)}function Wr(e,t){return La(t||e,e)}function eN(e,t,r){const n=Wr(e,r==null?void 0:r.in);if(isNaN(t))return La(e,NaN);const a=n.getDate(),i=La(e,n.getTime());i.setMonth(n.getMonth()+t+1,0);const s=i.getDate();return a>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}let tN={};function Xd(){return tN}function mc(e,t){var o,l,u,c;const r=Xd(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((c=(u=r.locale)==null?void 0:u.options)==null?void 0:c.weekStartsOn)??0,a=Wr(e,t==null?void 0:t.in),i=a.getDay(),s=(i<n?7:0)+i-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function od(e,t){return mc(e,{...t,weekStartsOn:1})}function z_(e,t){const r=Wr(e,t==null?void 0:t.in),n=r.getFullYear(),a=La(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=od(a),s=La(r,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const o=od(s);return r.getTime()>=i.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function A2(e){const t=Wr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function rN(e,...t){const r=La.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function C2(e,t){const r=Wr(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function nN(e,t,r){const[n,a]=rN(r==null?void 0:r.in,e,t),i=C2(n),s=C2(a),o=+i-A2(i),l=+s-A2(s);return Math.round((o-l)/JD)}function aN(e,t){const r=z_(e,t),n=La(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),od(n)}function iN(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function sN(e){return!(!iN(e)&&typeof e!="number"||isNaN(+Wr(e)))}function oN(e,t){const r=Wr(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const lN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uN=(e,t,r)=>{let n;const a=lN[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function up(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const cN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dN={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hN={date:up({formats:cN,defaultWidth:"full"}),time:up({formats:fN,defaultWidth:"full"}),dateTime:up({formats:dN,defaultWidth:"full"})},pN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mN=(e,t,r,n)=>pN[e];function ru(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;a=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const gN={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xN={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vN={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yN={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},EN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bN=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},_N={ordinalNumber:bN,era:ru({values:gN,defaultWidth:"wide"}),quarter:ru({values:xN,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ru({values:vN,defaultWidth:"wide"}),day:ru({values:yN,defaultWidth:"wide"}),dayPeriod:ru({values:wN,defaultWidth:"wide",formattingValues:EN,defaultFormattingWidth:"wide"})};function nu(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?SN(o,h=>h.test(s)):TN(o,h=>h.test(s));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const c=t.slice(s.length);return{value:u,rest:c}}}function TN(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function SN(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function AN(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const CN=/^(\d+)(th|st|nd|rd)?/i,DN=/\d+/i,NN={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kN={any:[/^b/i,/^(a|c)/i]},ON={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FN={any:[/1/i,/2/i,/3/i,/4/i]},PN={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},IN={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},RN={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},LN={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},MN={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},jN={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},BN={ordinalNumber:AN({matchPattern:CN,parsePattern:DN,valueCallback:e=>parseInt(e,10)}),era:nu({matchPatterns:NN,defaultMatchWidth:"wide",parsePatterns:kN,defaultParseWidth:"any"}),quarter:nu({matchPatterns:ON,defaultMatchWidth:"wide",parsePatterns:FN,defaultParseWidth:"any",valueCallback:e=>e+1}),month:nu({matchPatterns:PN,defaultMatchWidth:"wide",parsePatterns:IN,defaultParseWidth:"any"}),day:nu({matchPatterns:RN,defaultMatchWidth:"wide",parsePatterns:LN,defaultParseWidth:"any"}),dayPeriod:nu({matchPatterns:MN,defaultMatchWidth:"any",parsePatterns:jN,defaultParseWidth:"any"})},UN={code:"en-US",formatDistance:uN,formatLong:hN,formatRelative:mN,localize:_N,match:BN,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zN(e,t){const r=Wr(e,t==null?void 0:t.in);return nN(r,oN(r))+1}function WN(e,t){const r=Wr(e,t==null?void 0:t.in),n=+od(r)-+aN(r);return Math.round(n/j_)+1}function W_(e,t){var c,h,p,x;const r=Wr(e,t==null?void 0:t.in),n=r.getFullYear(),a=Xd(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(p=a.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??1,s=La((t==null?void 0:t.in)||e,0);s.setFullYear(n+1,0,i),s.setHours(0,0,0,0);const o=mc(s,t),l=La((t==null?void 0:t.in)||e,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const u=mc(l,t);return+r>=+o?n+1:+r>=+u?n:n-1}function qN(e,t){var o,l,u,c;const r=Xd(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(u=r.locale)==null?void 0:u.options)==null?void 0:c.firstWeekContainsDate)??1,a=W_(e,t),i=La((t==null?void 0:t.in)||e,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),mc(i,t)}function $N(e,t){const r=Wr(e,t==null?void 0:t.in),n=+mc(r,t)-+qN(r,t);return Math.round(n/j_)+1}function $t(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ki={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return $t(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):$t(r+1,2)},d(e,t){return $t(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return $t(e.getHours()%12||12,t.length)},H(e,t){return $t(e.getHours(),t.length)},m(e,t){return $t(e.getMinutes(),t.length)},s(e,t){return $t(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return $t(a,t.length)}},bo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},D2={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return ki.y(e,t)},Y:function(e,t,r,n){const a=W_(e,n),i=a>0?a:1-a;if(t==="YY"){const s=i%100;return $t(s,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):$t(i,t.length)},R:function(e,t){const r=z_(e);return $t(r,t.length)},u:function(e,t){const r=e.getFullYear();return $t(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return $t(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return $t(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ki.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return $t(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=$N(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):$t(a,t.length)},I:function(e,t,r){const n=WN(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):$t(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ki.d(e,t)},D:function(e,t,r){const n=zN(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):$t(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return $t(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return $t(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return $t(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=bo.noon:n===0?a=bo.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=bo.evening:n>=12?a=bo.afternoon:n>=4?a=bo.morning:a=bo.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ki.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ki.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):$t(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):$t(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ki.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ki.s(e,t)},S:function(e,t){return ki.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return k2(n);case"XXXX":case"XX":return Ns(n);case"XXXXX":case"XXX":default:return Ns(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return k2(n);case"xxxx":case"xx":return Ns(n);case"xxxxx":case"xxx":default:return Ns(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+N2(n,":");case"OOOO":default:return"GMT"+Ns(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+N2(n,":");case"zzzz":default:return"GMT"+Ns(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return $t(n,t.length)},T:function(e,t,r){return $t(+e,t.length)}};function N2(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+$t(i,2)}function k2(e,t){return e%60===0?(e>0?"-":"+")+$t(Math.abs(e)/60,2):Ns(e,t)}function Ns(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=$t(Math.trunc(n/60),2),i=$t(n%60,2);return r+a+t+i}const O2=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},q_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},HN=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return O2(e,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",O2(n,t)).replace("{{time}}",q_(a,t))},VN={p:q_,P:HN},GN=/^D+$/,YN=/^Y+$/,XN=["D","DD","YY","YYYY"];function KN(e){return GN.test(e)}function ZN(e){return YN.test(e)}function QN(e,t,r){const n=JN(e,t,r);if(console.warn(n),XN.includes(e))throw new RangeError(n)}function JN(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ek=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tk=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rk=/^'([^]*?)'?$/,nk=/''/g,ak=/[a-zA-Z]/;function ik(e,t,r){var c,h,p,x;const n=Xd(),a=n.locale??UN,i=n.firstWeekContainsDate??((h=(c=n.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??1,s=n.weekStartsOn??((x=(p=n.locale)==null?void 0:p.options)==null?void 0:x.weekStartsOn)??0,o=Wr(e,r==null?void 0:r.in);if(!sN(o))throw new RangeError("Invalid time value");let l=t.match(tk).map(E=>{const g=E[0];if(g==="p"||g==="P"){const w=VN[g];return w(E,a.formatLong)}return E}).join("").match(ek).map(E=>{if(E==="''")return{isToken:!1,value:"'"};const g=E[0];if(g==="'")return{isToken:!1,value:sk(E)};if(D2[g])return{isToken:!0,value:E};if(g.match(ak))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:E}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const u={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return l.map(E=>{if(!E.isToken)return E.value;const g=E.value;(ZN(g)||KN(g))&&QN(g,t,String(e));const w=D2[g[0]];return w(o,g,a.localize,u)}).join("")}function sk(e){const t=e.match(rk);return t?t[1].replace(nk,"'"):e}function ok(e,t){return+Wr(e)<+Wr(t)}function lk(e,t){return+Wr(e)==+Wr(t)}function ld(e,t){const r=()=>La(t==null?void 0:t.in,NaN),a=dk(e);let i;if(a.date){const u=hk(a.date,2);i=pk(u.restDateString,u.year)}if(!i||isNaN(+i))return r();const s=+i;let o=0,l;if(a.time&&(o=mk(a.time),isNaN(o)))return r();if(a.timezone){if(l=gk(a.timezone),isNaN(l))return r()}else{const u=new Date(s+o),c=Wr(0,t==null?void 0:t.in);return c.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),c.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),c}return Wr(s+o+l,t==null?void 0:t.in)}const Hf={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},uk=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ck=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fk=/^([+-])(\d{2})(?::?(\d{2}))?$/;function dk(e){const t={},r=e.split(Hf.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Hf.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Hf.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=Hf.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function hk(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function pk(e,t){if(t===null)return new Date(NaN);const r=e.match(uk);if(!r)return new Date(NaN);const n=!!r[4],a=au(r[1]),i=au(r[2])-1,s=au(r[3]),o=au(r[4]),l=au(r[5])-1;if(n)return Ek(t,o,l)?xk(t,o,l):new Date(NaN);{const u=new Date(0);return!yk(t,i,s)||!wk(t,a)?new Date(NaN):(u.setUTCFullYear(t,i,Math.max(a,s)),u)}}function au(e){return e?parseInt(e):1}function mk(e){const t=e.match(ck);if(!t)return NaN;const r=cp(t[1]),n=cp(t[2]),a=cp(t[3]);return bk(r,n,a)?r*U_+n*B_+a*1e3:NaN}function cp(e){return e&&parseFloat(e.replace(",","."))||0}function gk(e){if(e==="Z")return 0;const t=e.match(fk);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return _k(n,a)?r*(n*U_+a*B_):NaN}function xk(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}const vk=[31,null,31,30,31,30,31,31,30,31,30,31];function $_(e){return e%400===0||e%4===0&&e%100!==0}function yk(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(vk[t]||($_(e)?29:28))}function wk(e,t){return t>=1&&t<=($_(e)?366:365)}function Ek(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function bk(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function _k(e,t){return t>=0&&t<=59}function H_(e,t,r){return eN(e,-6,r)}function V_(e){const r=H_(new Date);return ld(e)>=r}function nl(e,t){const r=ld(e),n=ld(t);if(!ok(r,n)&&!lk(r,n))return!1;const a=H_(n);return r>=a}function rt(e){try{const t=ld(e);return ik(t,"dd.MM.yyyy")}catch{return e}}const Pu="       6     .",Tk=Object.freeze(Object.defineProperty({__proto__:null,MEDICAL_EXPIRED_MESSAGE:Pu,formatDateBG:rt,isMedicalDateValid:V_,isMedicalValidForCourse:nl},Symbol.toStringTag,{value:"Module"}));function Kd(){return{participants:Zr(()=>ke.participants.orderBy("courseStartDate").toArray()),addParticipant:async s=>{const{courseStartDate:o}=id(s.medicalDate);if(!nl(s.medicalDate,o))throw new Error(Pu);const{group:l,shouldCreate:u,createsForDate:c}=await sd(s.medicalDate),h=l?l.courseStartDate:c||o,p=(()=>{const y=new Date(h);return y.setDate(y.getDate()+7),y.toISOString().split("T")[0]})();if(!nl(s.medicalDate,h))throw new Error(Pu);if((await ke.groups.where("courseStartDate").equals(h).toArray()).some(y=>y.status==="completed"))throw new Error("         (  ).");if((l==null?void 0:l.status)==="completed")throw new Error("        .");if(u){const b=await Ai()?"planned":"active";await z1(h,b)}let E;if(s.uniqueNumber){if(!await hc(s.uniqueNumber))throw new Error("Unique number already exists");E=s.uniqueNumber}else(l==null?void 0:l.status)==="active"?E=await U1():E="";const g=!1,w=new Date().toISOString(),v={id:T_(),companyName:s.companyName,personName:s.personName,egn:s.egn||"",birthPlace:s.birthPlace||"",citizenship:s.citizenship||"",medicalDate:s.medicalDate,courseStartDate:h,courseEndDate:p,uniqueNumber:E,sent:!1,documents:!1,handedOver:!1,paid:!1,completedOverride:null,completedComputed:g,createdAt:w,updatedAt:w};return await ke.participants.add(v),await S0(),v},updateParticipant:async(s,o)=>{const l=await ke.participants.get(s);if(!l)throw new Error("Participant not found");const u=await ke.groups.where("courseStartDate").equals(l.courseStartDate).first();if(Ho(u))throw new Error("       .      Tools.");const c={};if(o.companyName!==void 0&&(c.companyName=o.companyName),o.personName!==void 0&&(c.personName=o.personName),o.egn!==void 0&&(c.egn=o.egn),o.birthPlace!==void 0&&(c.birthPlace=o.birthPlace),o.citizenship!==void 0&&(c.citizenship=o.citizenship),o.medicalDate&&o.medicalDate!==l.medicalDate){const{courseStartDate:y,courseEndDate:b}=id(o.medicalDate);if(!nl(o.medicalDate,y))throw new Error(Pu);c.medicalDate=o.medicalDate,c.courseStartDate=y,c.courseEndDate=b}if(o.uniqueNumber&&o.uniqueNumber!==l.uniqueNumber){if(!await hc(o.uniqueNumber,s))throw new Error("Unique number already exists");c.uniqueNumber=o.uniqueNumber}o.sent!==void 0&&(c.sent=o.sent),o.documents!==void 0&&(c.documents=o.documents),o.handedOver!==void 0&&(c.handedOver=o.handedOver),o.paid!==void 0&&(c.paid=o.paid);const h=c.sent!==void 0?c.sent:l.sent,p=c.documents!==void 0?c.documents:l.documents,x=c.handedOver!==void 0?c.handedOver:l.handedOver,E=c.paid!==void 0?c.paid:l.paid,g=h&&p&&x&&E;c.completedComputed=g,c.updatedAt=new Date().toISOString();const w=l.completedOverride!==null?l.completedOverride:l.completedComputed,v=c.completedOverride!==void 0&&c.completedOverride!==null?c.completedOverride:c.completedOverride===null?g:l.completedOverride!==null?l.completedOverride:g;!w&&v&&(c.completedAt=new Date().toISOString()),await ke.participants.update(s,c),await S0()},deleteParticipant:async s=>{const o=await ke.participants.get(s);if(await ke.participants.delete(s),o&&o.uniqueNumber){const{realignUniqueNumbers:l}=await Ra(async()=>{const{realignUniqueNumbers:u}=await Promise.resolve().then(()=>pc);return{realignUniqueNumbers:u}},void 0);await l(o.uniqueNumber)}await S0()},resetCompletedOverride:async s=>{await ke.participants.update(s,{completedOverride:null})},getParticipant:async s=>ke.participants.get(s)}}function Sk(){return{groups:Zr(()=>ke.groups.orderBy("groupNumber").toArray()),getGroup:async n=>ke.groups.where("groupNumber").equals(n).first(),getGroupsWithCounts:async()=>{const n=await ke.groups.orderBy("groupNumber").toArray();return await Promise.all(n.map(async i=>{const s=i.groupNumber!==null?await ke.participants.where("groupNumber").equals(i.groupNumber).count():0;return{...i,participantCount:s}}))}}}const na={active:"groups-collapsed-active",planned:"groups-collapsed-planned",completed:"groups-collapsed-completed"};function Ak(){const[e,t]=Ae.useState(()=>{const s=localStorage.getItem(na.active),o=localStorage.getItem(na.planned),l=localStorage.getItem(na.completed);return o==="true"||s==="true"?(localStorage.setItem(na.active,"false"),localStorage.setItem(na.planned,"false"),localStorage.setItem(na.completed,"true"),{active:!1,planned:!1,completed:!0}):{active:s==="true",planned:o==="true",completed:l===null?!0:l==="true"}});return Ae.useEffect(()=>{localStorage.setItem(na.active,String(e.active)),localStorage.setItem(na.planned,String(e.planned)),localStorage.setItem(na.completed,String(e.completed))},[e]),{collapsedSections:e,toggleSection:s=>{t(o=>({...o,[s]:!o[s]}))},expandSection:s=>{t(o=>({...o,[s]:!1}))},expandAll:()=>{t({active:!1,planned:!1,completed:!1})},resetToDefaults:()=>{t({active:!1,planned:!1,completed:!0}),localStorage.setItem(na.active,"false"),localStorage.setItem(na.planned,"false"),localStorage.setItem(na.completed,"true")}}}const Ck=(e,t,r)=>{const n=e[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((a,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==r?". Note that variables only represent file names one level deep.":""))))})},G_=Ae.createContext(void 0),Dk=({children:e})=>{const[t,r]=Ae.useState(()=>{const o=localStorage.getItem("app-language");return o==="bg"||o==="en"?o:"en"}),[n,a]=Ae.useState({});Ae.useEffect(()=>{(async()=>{const l=await Ck(Object.assign({"../locales/bg.ts":()=>Ra(()=>import("./bg-K_eNxVim.js"),[]),"../locales/en.ts":()=>Ra(()=>import("./en-DvHDkFyh.js"),[])}),`../locales/${t}.ts`,3);a(l.default)})()},[t]);const i=o=>{r(o),localStorage.setItem("app-language",o)},s=(o,l)=>{let u=n[o]||o;return l&&Object.entries(l).forEach(([c,h])=>{u=u.replace(`{${c}}`,h)}),u};return f.jsx(G_.Provider,{value:{language:t,setLanguage:i,t:s},children:e})},qr=()=>{const e=Ae.useContext(G_);if(!e)throw new Error("useLanguage must be used within LanguageProvider");return e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kk=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),F2=e=>{const t=kk(e);return t.charAt(0).toUpperCase()+t.slice(1)},Y_=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Ok=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Fk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=Ae.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...o},l)=>Ae.createElement("svg",{ref:l,...Fk,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Y_("lucide",a),...!i&&!Ok(o)&&{"aria-hidden":"true"},...o},[...s.map(([u,c])=>Ae.createElement(u,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=(e,t)=>{const r=Ae.forwardRef(({className:n,...a},i)=>Ae.createElement(Pk,{ref:i,iconNode:t,className:Y_(`lucide-${Nk(F2(e))}`,`lucide-${e}`,n),...a}));return r.displayName=F2(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],X_=Qt("activity",Ik);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],W1=Qt("archive",Rk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],K_=Qt("calendar-clock",Lk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],P2=Qt("calendar",Mk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],I2=Qt("chevron-down",jk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],R2=Qt("chevron-right",Bk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],L2=Qt("circle-alert",Uk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Qs=Qt("circle-check-big",zk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],qk=Qt("circle-x",Wk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hk=Qt("clock",$k);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=[["path",{d:"M10 5a2 2 0 0 0-1.344.519l-6.328 5.74a1 1 0 0 0 0 1.481l6.328 5.741A2 2 0 0 0 10 19h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z",key:"1yo7s0"}],["path",{d:"m12 9 6 6",key:"anjzzh"}],["path",{d:"m18 9-6 6",key:"1fp51s"}]],Gk=Qt("delete",Vk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Xk=Qt("download",Yk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Zk=Qt("eye-off",Kk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xg=Qt("eye",Qk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],e5=Qt("file-spreadsheet",Jk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],r5=Qt("file-text",t5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],M2=Qt("graduation-cap",n5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],q1=Qt("info",a5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],j2=Qt("layers",i5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],gc=Qt("lock",s5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],l5=Qt("package",o5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],c5=Qt("rotate-ccw",u5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$1=Qt("settings",f5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],h5=Qt("shield-check",d5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],xc=Qt("triangle-alert",p5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],g5=Qt("upload",m5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],yl=Qt("users",x5);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],y5=Qt("x",v5),es=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="Confirm",cancelText:s="Cancel",variant:o="info"})=>{if(Ae.useEffect(()=>{const h=p=>{p.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e,t]),!e)return null;const l=()=>{switch(o){case"danger":return f.jsx(xc,{className:"w-6 h-6 text-red-600"});case"warning":return f.jsx(xc,{className:"w-6 h-6 text-amber-600"});case"success":return f.jsx(Qs,{className:"w-6 h-6 text-emerald-600"});default:return f.jsx(q1,{className:"w-6 h-6 text-blue-600"})}},u=()=>{switch(o){case"danger":return"bg-red-50 text-red-900 border-red-100";case"warning":return"bg-amber-50 text-amber-900 border-amber-100";case"success":return"bg-emerald-50 text-emerald-900 border-emerald-100";default:return"bg-blue-50 text-blue-900 border-blue-100"}},c=()=>{switch(o){case"danger":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"warning":return"bg-amber-600 hover:bg-amber-700 focus:ring-amber-500";case"success":return"bg-emerald-600 hover:bg-emerald-700 focus:ring-emerald-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 transition-opacity",onClick:t}),f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden animate-scale-up transform transition-all",children:[f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"flex items-start gap-4",children:[f.jsx("div",{className:`p-3 rounded-full flex-shrink-0 ${u()} bg-opacity-50`,children:l()}),f.jsxs("div",{className:"flex-1 pt-1",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2 leading-none",children:n}),f.jsx("p",{className:"text-slate-600 leading-relaxed text-sm",children:a})]})]})}),f.jsxs("div",{className:"p-4 bg-slate-50 flex gap-3 justify-end border-t border-slate-100",children:[f.jsx("button",{onClick:t,className:"px-5 py-2.5 bg-white text-slate-700 border border-slate-200 rounded-lg hover:bg-slate-50 hover:text-slate-900 font-medium transition-all duration-200 shadow-sm",children:s}),f.jsx("button",{onClick:()=>{r(),t()},className:`px-5 py-2.5 text-white rounded-lg font-medium shadow-md transition-all duration-200 transform hover:-translate-y-0.5 ${c()}`,children:i})]})]})})]})},w5={Egida:"bg-violet-50 text-violet-700 ring-1 ring-violet-200/50","D-Max":"bg-orange-50 text-orange-700 ring-1 ring-orange-200/50",Multiforce:"bg-cyan-50 text-cyan-700 ring-1 ring-cyan-200/50"},E5="bg-slate-50 text-slate-600 ring-1 ring-slate-200/50",Iu=({companyName:e,className:t=""})=>{const r=w5[e]||E5;return f.jsx("span",{className:`inline-flex items-center px-2 py-0.5 text-xs rounded-full 
        font-medium tracking-normal transition-all duration-150 
        hover:ring-2 hover:shadow-sm ${r} ${t}`,"aria-label":`Company: ${e||"Unknown"}`,children:e||" "})};function b5(){return{bulkSetFlag:async(r,n,a)=>{const i={success:0,failed:0,errors:[]},s=new Date().toISOString();for(const o of r)try{const l=await ke.participants.get(o);if(!l){i.failed++,i.errors.push(`Participant ${o} not found`);continue}const u=await ke.groups.where("courseStartDate").equals(l.courseStartDate).first();if(u&&u.status==="completed"&&u.isLocked){i.failed++,i.errors.push(`Participant ${l.personName} belongs to locked group (${u.courseStartDate})`);continue}const c={[n]:a,updatedAt:s},h=n==="sent"?a:l.sent,p=n==="documents"?a:l.documents,x=n==="handedOver"?a:l.handedOver,E=n==="paid"?a:l.paid,g=h&&p&&x&&E;c.completedComputed=g;const w=l.completedOverride!==null?l.completedOverride:l.completedComputed,v=l.completedOverride!==null?l.completedOverride:g;!w&&v&&(c.completedAt=s),await ke.participants.update(o,c),i.success++}catch(l){i.failed++,i.errors.push(`Failed to update ${o}: ${l.message}`)}return i},bulkSetCompleted:async r=>{const n={success:0,failed:0,errors:[]},a=new Date().toISOString();for(const i of r)try{const s=await ke.participants.get(i);if(!s){n.failed++,n.errors.push(`Participant ${i} not found`);continue}const o=await ke.groups.where("courseStartDate").equals(s.courseStartDate).first();if(o&&o.status==="completed"&&o.isLocked){n.failed++,n.errors.push(`Participant ${s.personName} belongs to locked group (${o.courseStartDate})`);continue}if(!s.sent||!s.documents||!s.handedOver||!s.paid){n.failed++,n.errors.push(`Participant ${s.personName} does not have all 4 flags set`);continue}const l={completedOverride:!0,updatedAt:a,completedAt:a};await ke.participants.update(i,l),n.success++}catch(s){n.failed++,n.errors.push(`Failed to update ${i}: ${s.message}`)}return n}}}const Z_=({selectedCount:e,selectedIds:t,onClearSelection:r,onActionComplete:n})=>{const{t:a}=qr(),{bulkSetFlag:i}=b5(),[s,o]=Ae.useState(!1),[l,u]=Ae.useState(!1),[c,h]=Ae.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}}),p=async(E,g)=>{o(!0);try{const w=await i(t,E,g);w.failed>0?alert(`${a("bulk.completed")}: ${w.success}
${a("bulk.failed")}: ${w.failed}
${w.errors.join(`
`)}`):alert(`${a("bulk.success")}: ${w.success} ${a("bulk.updated")}`),n()}catch(w){alert(`${a("bulk.error")}: ${w.message}`)}finally{o(!1)}},x=()=>{h({isOpen:!0,title:a("bulk.confirmPaidTitle"),message:a("bulk.confirmPaidMessage"),onConfirm:async()=>{h({...c,isOpen:!1}),await p("paid",!0)}})};return e===0?null:f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"hidden md:block sticky top-0 bg-blue-600 text-white shadow-lg z-20 mb-4 rounded-lg",children:f.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:r,className:"p-1 hover:bg-blue-700 rounded transition-colors","aria-label":"Clear selection",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),f.jsxs("span",{className:"font-semibold",children:[e," ",a("bulk.selected")]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:()=>p("sent",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setSent")}),f.jsx("button",{onClick:()=>p("documents",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setDocuments")}),f.jsx("button",{onClick:()=>p("handedOver",!0),disabled:s,className:"px-3 py-1.5 bg-white text-blue-600 rounded text-sm font-medium hover:bg-blue-50 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setHanded")}),f.jsx("button",{onClick:x,disabled:s,className:"px-3 py-1.5 bg-amber-100 text-amber-800 rounded text-sm font-medium hover:bg-amber-200 disabled:opacity-50 whitespace-nowrap",children:a("bulk.setPaid")}),f.jsx("div",{className:"w-px h-6 bg-blue-400"}),f.jsx("button",{onClick:()=>p("sent",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearSent")}),f.jsx("button",{onClick:()=>p("documents",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearDocuments")}),f.jsx("button",{onClick:()=>p("handedOver",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearHanded")}),f.jsx("button",{onClick:()=>p("paid",!1),disabled:s,className:"px-3 py-1.5 bg-blue-700 text-white rounded text-sm font-medium hover:bg-blue-800 disabled:opacity-50 whitespace-nowrap",children:a("bulk.clearPaid")})]})]})}),f.jsxs("div",{className:"md:hidden fixed bottom-16 left-0 right-0 bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-2xl z-20 rounded-t-2xl",style:{boxShadow:"0 -10px 25px -5px rgba(0, 0, 0, 0.3), 0 -8px 10px -6px rgba(0, 0, 0, 0.1)"},children:[f.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:r,className:"p-1.5 hover:bg-white/20 rounded-full transition-all active:scale-95","aria-label":"Clear selection",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})}),f.jsxs("div",{className:"flex items-baseline gap-1.5",children:[f.jsx("span",{className:"text-xl font-bold",children:e}),f.jsx("span",{className:"text-sm font-medium opacity-90",children:a("bulk.selected")})]})]}),f.jsxs("button",{onClick:()=>u(!l),className:"px-4 py-2.5 bg-white text-blue-700 rounded-full font-semibold text-sm hover:bg-blue-50 active:scale-95 transition-all shadow-md flex items-center gap-1.5",disabled:s,children:[a("bulk.actions"),f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),l&&f.jsxs("div",{className:"fixed inset-0 z-50 flex items-end pointer-events-auto",children:[f.jsx("div",{className:"absolute inset-0 bg-black/40 pointer-events-auto",onClick:()=>u(!1)}),f.jsxs("div",{className:"relative w-full bg-white rounded-t-3xl shadow-2xl max-h-[80vh] overflow-hidden animate-slide-up pointer-events-auto z-10",children:[f.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-3 flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-base font-bold text-slate-900",children:a("bulk.actionTitle")}),f.jsxs("p",{className:"text-xs text-slate-600 mt-0",children:[a("bulk.forSelected"),": ",f.jsx("span",{className:"font-semibold",children:e})]})]}),f.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-slate-100 rounded-full transition-colors active:scale-95","aria-label":"Close",children:f.jsx("svg",{className:"w-6 h-6 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"overflow-y-auto",children:[f.jsxs("div",{className:"px-6 pt-3 pb-1",children:[f.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:a("bulk.set")}),f.jsxs("div",{className:"space-y-0.5",children:[f.jsxs("button",{onClick:()=>{p("sent",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setSent")})]}),f.jsxs("button",{onClick:()=>{p("documents",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setDocuments")})]}),f.jsxs("button",{onClick:()=>{p("handedOver",!0),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-blue-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setHanded")})]}),f.jsxs("button",{onClick:()=>{x(),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-900 hover:bg-amber-50 active:bg-amber-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-amber-600 text-lg",children:""}),f.jsx("span",{className:"flex-1 font-medium",children:a("bulk.setPaid")})]})]})]}),f.jsx("div",{className:"my-2 mx-6 border-t border-slate-200"}),f.jsxs("div",{className:"px-6 pb-20",children:[f.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:a("bulk.clear")}),f.jsxs("div",{className:"space-y-0.5",children:[f.jsxs("button",{onClick:()=>{p("sent",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearSent")})]}),f.jsxs("button",{onClick:()=>{p("documents",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearDocuments")})]}),f.jsxs("button",{onClick:()=>{p("handedOver",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearHanded")})]}),f.jsxs("button",{onClick:()=>{p("paid",!1),u(!1)},disabled:s,className:"w-full flex items-center gap-3 px-4 py-2.5 text-left text-slate-700 hover:bg-slate-50 active:bg-slate-200 rounded-xl disabled:opacity-50 transition-all duration-150",children:[f.jsx("span",{className:"text-slate-500 text-lg",children:""}),f.jsx("span",{className:"flex-1",children:a("bulk.clearPaid")})]})]})]})]})]})]})]}),f.jsx(es,{isOpen:c.isOpen,onClose:()=>h({...c,isOpen:!1}),onConfirm:c.onConfirm,title:c.title,message:c.message,confirmText:a("common.confirm"),cancelText:a("common.cancel")})]})};function al({title:e,count:t,groupNumbers:r,dateRange:n,participantCount:a,isCollapsed:i,onToggle:s,children:o,variant:l="active",showCount:u=!0}){const h={active:{bg:"bg-blue-50",border:"border-blue-200",accent:"border-l-blue-400",text:"text-blue-900",countBg:"bg-blue-100",countText:"text-blue-700",icon:f.jsx(X_,{className:"w-5 h-5 text-blue-600",strokeWidth:2})},planned:{bg:"bg-amber-50",border:"border-amber-200",accent:"border-l-amber-400",text:"text-amber-900",countBg:"bg-amber-100",countText:"text-amber-700",icon:f.jsx(K_,{className:"w-5 h-5 text-amber-600",strokeWidth:2})},completed:{bg:"bg-slate-50",border:"border-slate-200",accent:"border-l-slate-400",text:"text-slate-700",countBg:"bg-slate-100",countText:"text-slate-600",icon:f.jsx(W1,{className:"w-5 h-5 text-slate-600",strokeWidth:2})}}[l];return f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:`rounded-lg border ${h.border} ${h.bg} border-l-4 ${h.accent} overflow-hidden shadow-sm transition-shadow duration-150`,children:[f.jsxs("button",{onClick:s,className:`w-full flex items-center justify-between px-4 py-3.5 transition-all duration-150 hover:brightness-95 active:scale-[0.99] ${h.text}`,children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"flex-shrink-0",children:h.icon}),f.jsx("span",{className:"font-bold text-base",children:e}),n&&f.jsx("span",{className:"text-sm font-medium opacity-75",children:n}),u&&(r&&r.length>0?f.jsx("span",{className:`px-2.5 py-0.5 ${h.countBg} ${h.countText} rounded-full text-xs font-semibold`,children:r.length===1?` ${r[0]}`:` ${r.join(", ")}`}):l!=="active"&&f.jsx("span",{className:`px-2.5 py-0.5 ${h.countBg} ${h.countText} rounded-full text-xs font-semibold`,children:t}))]}),f.jsxs("div",{className:"flex items-center gap-3",children:[a!==void 0&&f.jsxs("span",{className:`text-sm font-medium ${h.text}`,children:[a," ",a===1?"":""]}),f.jsx("svg",{className:`w-5 h-5 transition-transform duration-200 ease-out ${i?"":"rotate-180"}`,style:{transformOrigin:"center"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]})]}),f.jsx("div",{className:`grid transition-all duration-150 ease-in-out ${i?"grid-rows-[0fr] opacity-0":"grid-rows-[1fr] opacity-100"}`,style:{transitionProperty:"grid-template-rows, opacity",willChange:i?"auto":"grid-template-rows, opacity"},children:f.jsx("div",{className:"overflow-hidden",children:f.jsx("div",{className:`px-2 pb-2 transition-transform duration-150 ease-out ${i?"translate-y-[-8px]":"translate-y-0"}`,style:{willChange:i?"auto":"transform"},children:o})})})]}),f.jsx("style",{children:`
        @media (prefers-reduced-motion: reduce) {
          .grid, button, svg {
            transition: none !important;
          }
        }
        
        @media (max-width: 768px) {
          .grid {
            transition-duration: 120ms !important;
          }
        }
      `})]})}const Q_=({groupNumber:e,courseStartDate:t,courseEndDate:r,participants:n,renderParticipantRow:a,mode:i="table"})=>{const{t:s}=qr(),[o,l]=Ae.useState(!1),[u,c]=Ae.useState({key:"uniqueNumber",direction:"desc"}),h=x=>{let E="asc";u.key===x&&u.direction==="asc"&&(E="desc"),c({key:x,direction:E})},p=ks.useMemo(()=>u.key?[...n].sort((x,E)=>{if(u.key==="uniqueNumber"){const g=x.uniqueNumber||"",w=E.uniqueNumber||"";return u.direction==="asc"?g.localeCompare(w):w.localeCompare(g)}return 0}):n,[n,u]);return f.jsxs("div",{className:"border border-slate-300 rounded-lg mb-2 bg-white shadow-sm transition-shadow duration-150",children:[f.jsxs("button",{onClick:()=>l(!o),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-slate-50 transition-all duration-150 rounded-lg active:scale-[0.99]",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("svg",{className:`w-5 h-5 text-slate-600 transition-transform duration-200 ease-out ${o?"rotate-90":""}`,style:{transformOrigin:"center"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-semibold text-slate-900",children:[" ",e]}),f.jsxs("div",{className:"text-sm text-slate-600",children:[rt(t)," - ",rt(r)]})]})]}),f.jsxs("div",{className:"text-sm text-slate-600 font-medium",children:[n.length," ",n.length===1?"":""]})]}),f.jsx("div",{className:`grid transition-all ease-in-out border-t border-slate-200 ${o?"grid-rows-[1fr] opacity-100":"grid-rows-[0fr] opacity-0"}`,style:{transitionDuration:"180ms",transitionProperty:"grid-template-rows, opacity",willChange:o?"grid-template-rows, opacity":"auto"},children:f.jsx("div",{className:"overflow-hidden",children:f.jsx("div",{className:`transition-transform duration-180 ease-out ${o?"translate-y-0":"translate-y-[-8px]"}`,style:{willChange:o?"transform":"auto"},children:i==="table"?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.companyName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.personName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none",onClick:()=>h("uniqueNumber"),title:"Sort by Number",children:f.jsxs("div",{className:"flex items-center gap-1",children:[s("participant.uniqueNumber"),u.key==="uniqueNumber"&&f.jsx("span",{className:"text-slate-500",children:u.direction==="asc"?"":""})]})}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.sent")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.documents")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.handedOver")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.paid")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:s("participant.completed")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:p.map(a)})]})}):f.jsx("div",{className:"p-3 space-y-2",children:p.map(a)})})})}),f.jsx("style",{children:`
        @media (prefers-reduced-motion: reduce) {
          .grid, button, svg {
            transition: none !important;
          }
        }
      `})]})};var J_={exports:{}},Gc={},qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Gc.encode=function(e){for(var t="",r,n,a,i,s,o,l,u=0;u<e.length;)r=e.charCodeAt(u++),n=e.charCodeAt(u++),a=e.charCodeAt(u++),i=r>>2,s=(r&3)<<4|n>>4,o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t=t+qi.charAt(i)+qi.charAt(s)+qi.charAt(o)+qi.charAt(l);return t};Gc.decode=function(e){var t="",r,n,a,i,s,o,l,u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=qi.indexOf(e.charAt(u++)),s=qi.indexOf(e.charAt(u++)),o=qi.indexOf(e.charAt(u++)),l=qi.indexOf(e.charAt(u++)),r=i<<2|s>>4,n=(s&15)<<4|o>>2,a=(o&3)<<6|l,t+=String.fromCharCode(r),o!==64&&(t+=String.fromCharCode(n)),l!==64&&(t+=String.fromCharCode(a));return t};var fn={},Vf;fn.base64=!0;fn.array=!0;fn.string=!0;fn.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";fn.nodebuffer=typeof Buffer<"u";fn.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")Vf=fn.blob=!1;else{var B2=new ArrayBuffer(0);try{Vf=fn.blob=new Blob([B2],{type:"application/zip"}).size===0}catch{try{var _5=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,U2=new _5;U2.append(B2),Vf=fn.blob=U2.getBlob("application/zip").size===0}catch{Vf=fn.blob=!1}}}var pa={},Yc={},kl={},vg={exports:{}};/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */(function(e,t){(function(r,n){n(t)})(ko,function(r){function n(d){for(var C=d.length;--C>=0;)d[C]=0}var a=256,i=286,s=30,o=15,l=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),u=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),c=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=new Array(576);n(p);var x=new Array(60);n(x);var E=new Array(512);n(E);var g=new Array(256);n(g);var w=new Array(29);n(w);var v,y,b,T=new Array(s);function N(d,C,m,q,H){this.static_tree=d,this.extra_bits=C,this.extra_base=m,this.elems=q,this.max_length=H,this.has_stree=d&&d.length}function k(d,C){this.dyn_tree=d,this.max_code=0,this.stat_desc=C}n(T);var _=function(d){return d<256?E[d]:E[256+(d>>>7)]},S=function(d,C){d.pending_buf[d.pending++]=255&C,d.pending_buf[d.pending++]=C>>>8&255},A=function(d,C,m){d.bi_valid>16-m?(d.bi_buf|=C<<d.bi_valid&65535,S(d,d.bi_buf),d.bi_buf=C>>16-d.bi_valid,d.bi_valid+=m-16):(d.bi_buf|=C<<d.bi_valid&65535,d.bi_valid+=m)},P=function(d,C,m){A(d,m[2*C],m[2*C+1])},I=function(d,C){var m=0;do m|=1&d,d>>>=1,m<<=1;while(--C>0);return m>>>1},W=function(d,C,m){var q,H,Q=new Array(16),Ce=0;for(q=1;q<=o;q++)Ce=Ce+m[q-1]<<1,Q[q]=Ce;for(H=0;H<=C;H++){var ne=d[2*H+1];ne!==0&&(d[2*H]=I(Q[ne]++,ne))}},te=function(d){var C;for(C=0;C<i;C++)d.dyn_ltree[2*C]=0;for(C=0;C<s;C++)d.dyn_dtree[2*C]=0;for(C=0;C<19;C++)d.bl_tree[2*C]=0;d.dyn_ltree[512]=1,d.opt_len=d.static_len=0,d.sym_next=d.matches=0},oe=function(d){d.bi_valid>8?S(d,d.bi_buf):d.bi_valid>0&&(d.pending_buf[d.pending++]=d.bi_buf),d.bi_buf=0,d.bi_valid=0},ve=function(d,C,m,q){var H=2*C,Q=2*m;return d[H]<d[Q]||d[H]===d[Q]&&q[C]<=q[m]},ye=function(d,C,m){for(var q=d.heap[m],H=m<<1;H<=d.heap_len&&(H<d.heap_len&&ve(C,d.heap[H+1],d.heap[H],d.depth)&&H++,!ve(C,q,d.heap[H],d.depth));)d.heap[m]=d.heap[H],m=H,H<<=1;d.heap[m]=q},_e=function(d,C,m){var q,H,Q,Ce,ne=0;if(d.sym_next!==0)do q=255&d.pending_buf[d.sym_buf+ne++],q+=(255&d.pending_buf[d.sym_buf+ne++])<<8,H=d.pending_buf[d.sym_buf+ne++],q===0?P(d,H,C):(Q=g[H],P(d,Q+a+1,C),(Ce=l[Q])!==0&&(H-=w[Q],A(d,H,Ce)),q--,Q=_(q),P(d,Q,m),(Ce=u[Q])!==0&&(q-=T[Q],A(d,q,Ce)));while(ne<d.sym_next);P(d,256,C)},ue=function(d,C){var m,q,H,Q=C.dyn_tree,Ce=C.stat_desc.static_tree,ne=C.stat_desc.has_stree,je=C.stat_desc.elems,ae=-1;for(d.heap_len=0,d.heap_max=573,m=0;m<je;m++)Q[2*m]!==0?(d.heap[++d.heap_len]=ae=m,d.depth[m]=0):Q[2*m+1]=0;for(;d.heap_len<2;)Q[2*(H=d.heap[++d.heap_len]=ae<2?++ae:0)]=1,d.depth[H]=0,d.opt_len--,ne&&(d.static_len-=Ce[2*H+1]);for(C.max_code=ae,m=d.heap_len>>1;m>=1;m--)ye(d,Q,m);H=je;do m=d.heap[1],d.heap[1]=d.heap[d.heap_len--],ye(d,Q,1),q=d.heap[1],d.heap[--d.heap_max]=m,d.heap[--d.heap_max]=q,Q[2*H]=Q[2*m]+Q[2*q],d.depth[H]=(d.depth[m]>=d.depth[q]?d.depth[m]:d.depth[q])+1,Q[2*m+1]=Q[2*q+1]=H,d.heap[1]=H++,ye(d,Q,1);while(d.heap_len>=2);d.heap[--d.heap_max]=d.heap[1],function(le,At){var Qe,Oe,Ge,bt,vt,Dt,$e=At.dyn_tree,qe=At.max_code,ct=At.stat_desc.static_tree,Jt=At.stat_desc.has_stree,st=At.stat_desc.extra_bits,Ft=At.stat_desc.extra_base,Ot=At.stat_desc.max_length,dt=0;for(bt=0;bt<=o;bt++)le.bl_count[bt]=0;for($e[2*le.heap[le.heap_max]+1]=0,Qe=le.heap_max+1;Qe<573;Qe++)(bt=$e[2*$e[2*(Oe=le.heap[Qe])+1]+1]+1)>Ot&&(bt=Ot,dt++),$e[2*Oe+1]=bt,Oe>qe||(le.bl_count[bt]++,vt=0,Oe>=Ft&&(vt=st[Oe-Ft]),Dt=$e[2*Oe],le.opt_len+=Dt*(bt+vt),Jt&&(le.static_len+=Dt*(ct[2*Oe+1]+vt)));if(dt!==0){do{for(bt=Ot-1;le.bl_count[bt]===0;)bt--;le.bl_count[bt]--,le.bl_count[bt+1]+=2,le.bl_count[Ot]--,dt-=2}while(dt>0);for(bt=Ot;bt!==0;bt--)for(Oe=le.bl_count[bt];Oe!==0;)(Ge=le.heap[--Qe])>qe||($e[2*Ge+1]!==bt&&(le.opt_len+=(bt-$e[2*Ge+1])*$e[2*Ge],$e[2*Ge+1]=bt),Oe--)}}(d,C),W(Q,ae,d.bl_count)},ce=function(d,C,m){var q,H,Q=-1,Ce=C[1],ne=0,je=7,ae=4;for(Ce===0&&(je=138,ae=3),C[2*(m+1)+1]=65535,q=0;q<=m;q++)H=Ce,Ce=C[2*(q+1)+1],++ne<je&&H===Ce||(ne<ae?d.bl_tree[2*H]+=ne:H!==0?(H!==Q&&d.bl_tree[2*H]++,d.bl_tree[32]++):ne<=10?d.bl_tree[34]++:d.bl_tree[36]++,ne=0,Q=H,Ce===0?(je=138,ae=3):H===Ce?(je=6,ae=3):(je=7,ae=4))},De=function(d,C,m){var q,H,Q=-1,Ce=C[1],ne=0,je=7,ae=4;for(Ce===0&&(je=138,ae=3),q=0;q<=m;q++)if(H=Ce,Ce=C[2*(q+1)+1],!(++ne<je&&H===Ce)){if(ne<ae)do P(d,H,d.bl_tree);while(--ne!=0);else H!==0?(H!==Q&&(P(d,H,d.bl_tree),ne--),P(d,16,d.bl_tree),A(d,ne-3,2)):ne<=10?(P(d,17,d.bl_tree),A(d,ne-3,3)):(P(d,18,d.bl_tree),A(d,ne-11,7));ne=0,Q=H,Ce===0?(je=138,ae=3):H===Ce?(je=6,ae=3):(je=7,ae=4)}},Ve=!1,Y=function(d,C,m,q){A(d,0+(q?1:0),3),oe(d),S(d,m),S(d,~m),m&&d.pending_buf.set(d.window.subarray(C,C+m),d.pending),d.pending+=m},se=function(d,C,m,q){var H,Q,Ce=0;d.level>0?(d.strm.data_type===2&&(d.strm.data_type=function(ne){var je,ae=4093624447;for(je=0;je<=31;je++,ae>>>=1)if(1&ae&&ne.dyn_ltree[2*je]!==0)return 0;if(ne.dyn_ltree[18]!==0||ne.dyn_ltree[20]!==0||ne.dyn_ltree[26]!==0)return 1;for(je=32;je<a;je++)if(ne.dyn_ltree[2*je]!==0)return 1;return 0}(d)),ue(d,d.l_desc),ue(d,d.d_desc),Ce=function(ne){var je;for(ce(ne,ne.dyn_ltree,ne.l_desc.max_code),ce(ne,ne.dyn_dtree,ne.d_desc.max_code),ue(ne,ne.bl_desc),je=18;je>=3&&ne.bl_tree[2*h[je]+1]===0;je--);return ne.opt_len+=3*(je+1)+5+5+4,je}(d),H=d.opt_len+3+7>>>3,(Q=d.static_len+3+7>>>3)<=H&&(H=Q)):H=Q=m+5,m+4<=H&&C!==-1?Y(d,C,m,q):d.strategy===4||Q===H?(A(d,2+(q?1:0),3),_e(d,p,x)):(A(d,4+(q?1:0),3),function(ne,je,ae,le){var At;for(A(ne,je-257,5),A(ne,ae-1,5),A(ne,le-4,4),At=0;At<le;At++)A(ne,ne.bl_tree[2*h[At]+1],3);De(ne,ne.dyn_ltree,je-1),De(ne,ne.dyn_dtree,ae-1)}(d,d.l_desc.max_code+1,d.d_desc.max_code+1,Ce+1),_e(d,d.dyn_ltree,d.dyn_dtree)),te(d),q&&oe(d)},ee={_tr_init:function(d){Ve||(function(){var C,m,q,H,Q,Ce=new Array(16);for(q=0,H=0;H<28;H++)for(w[H]=q,C=0;C<1<<l[H];C++)g[q++]=H;for(g[q-1]=H,Q=0,H=0;H<16;H++)for(T[H]=Q,C=0;C<1<<u[H];C++)E[Q++]=H;for(Q>>=7;H<s;H++)for(T[H]=Q<<7,C=0;C<1<<u[H]-7;C++)E[256+Q++]=H;for(m=0;m<=o;m++)Ce[m]=0;for(C=0;C<=143;)p[2*C+1]=8,C++,Ce[8]++;for(;C<=255;)p[2*C+1]=9,C++,Ce[9]++;for(;C<=279;)p[2*C+1]=7,C++,Ce[7]++;for(;C<=287;)p[2*C+1]=8,C++,Ce[8]++;for(W(p,287,Ce),C=0;C<s;C++)x[2*C+1]=5,x[2*C]=I(C,5);v=new N(p,l,257,i,o),y=new N(x,u,0,s,o),b=new N(new Array(0),c,0,19,7)}(),Ve=!0),d.l_desc=new k(d.dyn_ltree,v),d.d_desc=new k(d.dyn_dtree,y),d.bl_desc=new k(d.bl_tree,b),d.bi_buf=0,d.bi_valid=0,te(d)},_tr_stored_block:Y,_tr_flush_block:se,_tr_tally:function(d,C,m){return d.pending_buf[d.sym_buf+d.sym_next++]=C,d.pending_buf[d.sym_buf+d.sym_next++]=C>>8,d.pending_buf[d.sym_buf+d.sym_next++]=m,C===0?d.dyn_ltree[2*m]++:(d.matches++,C--,d.dyn_ltree[2*(g[m]+a+1)]++,d.dyn_dtree[2*_(C)]++),d.sym_next===d.sym_end},_tr_align:function(d){A(d,2,3),P(d,256,p),function(C){C.bi_valid===16?(S(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):C.bi_valid>=8&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)}(d)}},D=function(d,C,m,q){for(var H=65535&d|0,Q=d>>>16&65535|0,Ce=0;m!==0;){m-=Ce=m>2e3?2e3:m;do Q=Q+(H=H+C[q++]|0)|0;while(--Ce);H%=65521,Q%=65521}return H|Q<<16|0},F=new Uint32Array(function(){for(var d,C=[],m=0;m<256;m++){d=m;for(var q=0;q<8;q++)d=1&d?3988292384^d>>>1:d>>>1;C[m]=d}return C}()),V=function(d,C,m,q){var H=F,Q=q+m;d^=-1;for(var Ce=q;Ce<Q;Ce++)d=d>>>8^H[255&(d^C[Ce])];return-1^d},R={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},j={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},re=ee._tr_init,xe=ee._tr_stored_block,Pe=ee._tr_flush_block,Z=ee._tr_tally,L=ee._tr_align,X=j.Z_NO_FLUSH,K=j.Z_PARTIAL_FLUSH,ie=j.Z_FULL_FLUSH,be=j.Z_FINISH,nt=j.Z_BLOCK,Xe=j.Z_OK,mt=j.Z_STREAM_END,et=j.Z_STREAM_ERROR,Mt=j.Z_DATA_ERROR,Ee=j.Z_BUF_ERROR,Ne=j.Z_DEFAULT_COMPRESSION,Re=j.Z_FILTERED,He=j.Z_HUFFMAN_ONLY,at=j.Z_RLE,Tt=j.Z_FIXED,Wt=j.Z_DEFAULT_STRATEGY,jt=j.Z_UNKNOWN,lt=j.Z_DEFLATED,we=258,he=262,J=42,me=113,Be=666,Ke=function(d,C){return d.msg=R[C],C},ft=function(d){return 2*d-(d>4?9:0)},it=function(d){for(var C=d.length;--C>=0;)d[C]=0},St=function(d){var C,m,q,H=d.w_size;q=C=d.hash_size;do m=d.head[--q],d.head[q]=m>=H?m-H:0;while(--C);q=C=H;do m=d.prev[--q],d.prev[q]=m>=H?m-H:0;while(--C)},Rt=function(d,C,m){return(C<<d.hash_shift^m)&d.hash_mask},Ct=function(d){var C=d.state,m=C.pending;m>d.avail_out&&(m=d.avail_out),m!==0&&(d.output.set(C.pending_buf.subarray(C.pending_out,C.pending_out+m),d.next_out),d.next_out+=m,C.pending_out+=m,d.total_out+=m,d.avail_out-=m,C.pending-=m,C.pending===0&&(C.pending_out=0))},Ut=function(d,C){Pe(d,d.block_start>=0?d.block_start:-1,d.strstart-d.block_start,C),d.block_start=d.strstart,Ct(d.strm)},xt=function(d,C){d.pending_buf[d.pending++]=C},an=function(d,C){d.pending_buf[d.pending++]=C>>>8&255,d.pending_buf[d.pending++]=255&C},ea=function(d,C,m,q){var H=d.avail_in;return H>q&&(H=q),H===0?0:(d.avail_in-=H,C.set(d.input.subarray(d.next_in,d.next_in+H),m),d.state.wrap===1?d.adler=D(d.adler,C,H,m):d.state.wrap===2&&(d.adler=V(d.adler,C,H,m)),d.next_in+=H,d.total_in+=H,H)},ja=function(d,C){var m,q,H=d.max_chain_length,Q=d.strstart,Ce=d.prev_length,ne=d.nice_match,je=d.strstart>d.w_size-he?d.strstart-(d.w_size-he):0,ae=d.window,le=d.w_mask,At=d.prev,Qe=d.strstart+we,Oe=ae[Q+Ce-1],Ge=ae[Q+Ce];d.prev_length>=d.good_match&&(H>>=2),ne>d.lookahead&&(ne=d.lookahead);do if(ae[(m=C)+Ce]===Ge&&ae[m+Ce-1]===Oe&&ae[m]===ae[Q]&&ae[++m]===ae[Q+1]){Q+=2,m++;do;while(ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&ae[++Q]===ae[++m]&&Q<Qe);if(q=we-(Qe-Q),Q=Qe-we,q>Ce){if(d.match_start=C,Ce=q,q>=ne)break;Oe=ae[Q+Ce-1],Ge=ae[Q+Ce]}}while((C=At[C&le])>je&&--H!=0);return Ce<=d.lookahead?Ce:d.lookahead},gn=function(d){var C,m,q,H=d.w_size;do{if(m=d.window_size-d.lookahead-d.strstart,d.strstart>=H+(H-he)&&(d.window.set(d.window.subarray(H,H+H-m),0),d.match_start-=H,d.strstart-=H,d.block_start-=H,d.insert>d.strstart&&(d.insert=d.strstart),St(d),m+=H),d.strm.avail_in===0)break;if(C=ea(d.strm,d.window,d.strstart+d.lookahead,m),d.lookahead+=C,d.lookahead+d.insert>=3)for(q=d.strstart-d.insert,d.ins_h=d.window[q],d.ins_h=Rt(d,d.ins_h,d.window[q+1]);d.insert&&(d.ins_h=Rt(d,d.ins_h,d.window[q+3-1]),d.prev[q&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=q,q++,d.insert--,!(d.lookahead+d.insert<3)););}while(d.lookahead<he&&d.strm.avail_in!==0)},Ba=function(d,C){var m,q,H,Q=d.pending_buf_size-5>d.w_size?d.w_size:d.pending_buf_size-5,Ce=0,ne=d.strm.avail_in;do{if(m=65535,H=d.bi_valid+42>>3,d.strm.avail_out<H||(H=d.strm.avail_out-H,m>(q=d.strstart-d.block_start)+d.strm.avail_in&&(m=q+d.strm.avail_in),m>H&&(m=H),m<Q&&(m===0&&C!==be||C===X||m!==q+d.strm.avail_in)))break;Ce=C===be&&m===q+d.strm.avail_in?1:0,xe(d,0,0,Ce),d.pending_buf[d.pending-4]=m,d.pending_buf[d.pending-3]=m>>8,d.pending_buf[d.pending-2]=~m,d.pending_buf[d.pending-1]=~m>>8,Ct(d.strm),q&&(q>m&&(q=m),d.strm.output.set(d.window.subarray(d.block_start,d.block_start+q),d.strm.next_out),d.strm.next_out+=q,d.strm.avail_out-=q,d.strm.total_out+=q,d.block_start+=q,m-=q),m&&(ea(d.strm,d.strm.output,d.strm.next_out,m),d.strm.next_out+=m,d.strm.avail_out-=m,d.strm.total_out+=m)}while(Ce===0);return(ne-=d.strm.avail_in)&&(ne>=d.w_size?(d.matches=2,d.window.set(d.strm.input.subarray(d.strm.next_in-d.w_size,d.strm.next_in),0),d.strstart=d.w_size,d.insert=d.strstart):(d.window_size-d.strstart<=ne&&(d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,d.insert>d.strstart&&(d.insert=d.strstart)),d.window.set(d.strm.input.subarray(d.strm.next_in-ne,d.strm.next_in),d.strstart),d.strstart+=ne,d.insert+=ne>d.w_size-d.insert?d.w_size-d.insert:ne),d.block_start=d.strstart),d.high_water<d.strstart&&(d.high_water=d.strstart),Ce?4:C!==X&&C!==be&&d.strm.avail_in===0&&d.strstart===d.block_start?2:(H=d.window_size-d.strstart,d.strm.avail_in>H&&d.block_start>=d.w_size&&(d.block_start-=d.w_size,d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,H+=d.w_size,d.insert>d.strstart&&(d.insert=d.strstart)),H>d.strm.avail_in&&(H=d.strm.avail_in),H&&(ea(d.strm,d.window,d.strstart,H),d.strstart+=H,d.insert+=H>d.w_size-d.insert?d.w_size-d.insert:H),d.high_water<d.strstart&&(d.high_water=d.strstart),H=d.bi_valid+42>>3,Q=(H=d.pending_buf_size-H>65535?65535:d.pending_buf_size-H)>d.w_size?d.w_size:H,((q=d.strstart-d.block_start)>=Q||(q||C===be)&&C!==X&&d.strm.avail_in===0&&q<=H)&&(m=q>H?H:q,Ce=C===be&&d.strm.avail_in===0&&m===q?1:0,xe(d,d.block_start,m,Ce),d.block_start+=m,Ct(d.strm)),Ce?3:1)},ta=function(d,C){for(var m,q;;){if(d.lookahead<he){if(gn(d),d.lookahead<he&&C===X)return 1;if(d.lookahead===0)break}if(m=0,d.lookahead>=3&&(d.ins_h=Rt(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),m!==0&&d.strstart-m<=d.w_size-he&&(d.match_length=ja(d,m)),d.match_length>=3)if(q=Z(d,d.strstart-d.match_start,d.match_length-3),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=3){d.match_length--;do d.strstart++,d.ins_h=Rt(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart;while(--d.match_length!=0);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=Rt(d,d.ins_h,d.window[d.strstart+1]);else q=Z(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(q&&(Ut(d,!1),d.strm.avail_out===0))return 1}return d.insert=d.strstart<2?d.strstart:2,C===be?(Ut(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(Ut(d,!1),d.strm.avail_out===0)?1:2},$r=function(d,C){for(var m,q,H;;){if(d.lookahead<he){if(gn(d),d.lookahead<he&&C===X)return 1;if(d.lookahead===0)break}if(m=0,d.lookahead>=3&&(d.ins_h=Rt(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=2,m!==0&&d.prev_length<d.max_lazy_match&&d.strstart-m<=d.w_size-he&&(d.match_length=ja(d,m),d.match_length<=5&&(d.strategy===Re||d.match_length===3&&d.strstart-d.match_start>4096)&&(d.match_length=2)),d.prev_length>=3&&d.match_length<=d.prev_length){H=d.strstart+d.lookahead-3,q=Z(d,d.strstart-1-d.prev_match,d.prev_length-3),d.lookahead-=d.prev_length-1,d.prev_length-=2;do++d.strstart<=H&&(d.ins_h=Rt(d,d.ins_h,d.window[d.strstart+3-1]),m=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart);while(--d.prev_length!=0);if(d.match_available=0,d.match_length=2,d.strstart++,q&&(Ut(d,!1),d.strm.avail_out===0))return 1}else if(d.match_available){if((q=Z(d,0,d.window[d.strstart-1]))&&Ut(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return 1}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(q=Z(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<2?d.strstart:2,C===be?(Ut(d,!0),d.strm.avail_out===0?3:4):d.sym_next&&(Ut(d,!1),d.strm.avail_out===0)?1:2};function Hr(d,C,m,q,H){this.good_length=d,this.max_lazy=C,this.nice_length=m,this.max_chain=q,this.func=H}var ra=[new Hr(0,0,0,0,Ba),new Hr(4,4,8,4,ta),new Hr(4,5,16,8,ta),new Hr(4,6,32,32,ta),new Hr(4,4,16,16,$r),new Hr(8,16,32,32,$r),new Hr(8,16,128,128,$r),new Hr(8,32,128,256,$r),new Hr(32,128,258,1024,$r),new Hr(32,258,258,4096,$r)];function zl(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=lt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),it(this.dyn_ltree),it(this.dyn_dtree),it(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),it(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),it(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var O=function(d){if(!d)return 1;var C=d.state;return!C||C.strm!==d||C.status!==J&&C.status!==57&&C.status!==69&&C.status!==73&&C.status!==91&&C.status!==103&&C.status!==me&&C.status!==Be?1:0},U=function(d){if(O(d))return Ke(d,et);d.total_in=d.total_out=0,d.data_type=jt;var C=d.state;return C.pending=0,C.pending_out=0,C.wrap<0&&(C.wrap=-C.wrap),C.status=C.wrap===2?57:C.wrap?J:me,d.adler=C.wrap===2?0:1,C.last_flush=-2,re(C),Xe},M=function(d){var C,m=U(d);return m===Xe&&((C=d.state).window_size=2*C.w_size,it(C.head),C.max_lazy_match=ra[C.level].max_lazy,C.good_match=ra[C.level].good_length,C.nice_match=ra[C.level].nice_length,C.max_chain_length=ra[C.level].max_chain,C.strstart=0,C.block_start=0,C.lookahead=0,C.insert=0,C.match_length=C.prev_length=2,C.match_available=0,C.ins_h=0),m},B=function(d,C,m,q,H,Q){if(!d)return et;var Ce=1;if(C===Ne&&(C=6),q<0?(Ce=0,q=-q):q>15&&(Ce=2,q-=16),H<1||H>9||m!==lt||q<8||q>15||C<0||C>9||Q<0||Q>Tt||q===8&&Ce!==1)return Ke(d,et);q===8&&(q=9);var ne=new zl;return d.state=ne,ne.strm=d,ne.status=J,ne.wrap=Ce,ne.gzhead=null,ne.w_bits=q,ne.w_size=1<<ne.w_bits,ne.w_mask=ne.w_size-1,ne.hash_bits=H+7,ne.hash_size=1<<ne.hash_bits,ne.hash_mask=ne.hash_size-1,ne.hash_shift=~~((ne.hash_bits+3-1)/3),ne.window=new Uint8Array(2*ne.w_size),ne.head=new Uint16Array(ne.hash_size),ne.prev=new Uint16Array(ne.w_size),ne.lit_bufsize=1<<H+6,ne.pending_buf_size=4*ne.lit_bufsize,ne.pending_buf=new Uint8Array(ne.pending_buf_size),ne.sym_buf=ne.lit_bufsize,ne.sym_end=3*(ne.lit_bufsize-1),ne.level=C,ne.strategy=Q,ne.method=m,M(d)},z={deflateInit:function(d,C){return B(d,C,lt,15,8,Wt)},deflateInit2:B,deflateReset:M,deflateResetKeep:U,deflateSetHeader:function(d,C){return O(d)||d.state.wrap!==2?et:(d.state.gzhead=C,Xe)},deflate:function(d,C){if(O(d)||C>nt||C<0)return d?Ke(d,et):et;var m=d.state;if(!d.output||d.avail_in!==0&&!d.input||m.status===Be&&C!==be)return Ke(d,d.avail_out===0?Ee:et);var q=m.last_flush;if(m.last_flush=C,m.pending!==0){if(Ct(d),d.avail_out===0)return m.last_flush=-1,Xe}else if(d.avail_in===0&&ft(C)<=ft(q)&&C!==be)return Ke(d,Ee);if(m.status===Be&&d.avail_in!==0)return Ke(d,Ee);if(m.status===J&&m.wrap===0&&(m.status=me),m.status===J){var H=lt+(m.w_bits-8<<4)<<8;if(H|=(m.strategy>=He||m.level<2?0:m.level<6?1:m.level===6?2:3)<<6,m.strstart!==0&&(H|=32),an(m,H+=31-H%31),m.strstart!==0&&(an(m,d.adler>>>16),an(m,65535&d.adler)),d.adler=1,m.status=me,Ct(d),m.pending!==0)return m.last_flush=-1,Xe}if(m.status===57){if(d.adler=0,xt(m,31),xt(m,139),xt(m,8),m.gzhead)xt(m,(m.gzhead.text?1:0)+(m.gzhead.hcrc?2:0)+(m.gzhead.extra?4:0)+(m.gzhead.name?8:0)+(m.gzhead.comment?16:0)),xt(m,255&m.gzhead.time),xt(m,m.gzhead.time>>8&255),xt(m,m.gzhead.time>>16&255),xt(m,m.gzhead.time>>24&255),xt(m,m.level===9?2:m.strategy>=He||m.level<2?4:0),xt(m,255&m.gzhead.os),m.gzhead.extra&&m.gzhead.extra.length&&(xt(m,255&m.gzhead.extra.length),xt(m,m.gzhead.extra.length>>8&255)),m.gzhead.hcrc&&(d.adler=V(d.adler,m.pending_buf,m.pending,0)),m.gzindex=0,m.status=69;else if(xt(m,0),xt(m,0),xt(m,0),xt(m,0),xt(m,0),xt(m,m.level===9?2:m.strategy>=He||m.level<2?4:0),xt(m,3),m.status=me,Ct(d),m.pending!==0)return m.last_flush=-1,Xe}if(m.status===69){if(m.gzhead.extra){for(var Q=m.pending,Ce=(65535&m.gzhead.extra.length)-m.gzindex;m.pending+Ce>m.pending_buf_size;){var ne=m.pending_buf_size-m.pending;if(m.pending_buf.set(m.gzhead.extra.subarray(m.gzindex,m.gzindex+ne),m.pending),m.pending=m.pending_buf_size,m.gzhead.hcrc&&m.pending>Q&&(d.adler=V(d.adler,m.pending_buf,m.pending-Q,Q)),m.gzindex+=ne,Ct(d),m.pending!==0)return m.last_flush=-1,Xe;Q=0,Ce-=ne}var je=new Uint8Array(m.gzhead.extra);m.pending_buf.set(je.subarray(m.gzindex,m.gzindex+Ce),m.pending),m.pending+=Ce,m.gzhead.hcrc&&m.pending>Q&&(d.adler=V(d.adler,m.pending_buf,m.pending-Q,Q)),m.gzindex=0}m.status=73}if(m.status===73){if(m.gzhead.name){var ae,le=m.pending;do{if(m.pending===m.pending_buf_size){if(m.gzhead.hcrc&&m.pending>le&&(d.adler=V(d.adler,m.pending_buf,m.pending-le,le)),Ct(d),m.pending!==0)return m.last_flush=-1,Xe;le=0}ae=m.gzindex<m.gzhead.name.length?255&m.gzhead.name.charCodeAt(m.gzindex++):0,xt(m,ae)}while(ae!==0);m.gzhead.hcrc&&m.pending>le&&(d.adler=V(d.adler,m.pending_buf,m.pending-le,le)),m.gzindex=0}m.status=91}if(m.status===91){if(m.gzhead.comment){var At,Qe=m.pending;do{if(m.pending===m.pending_buf_size){if(m.gzhead.hcrc&&m.pending>Qe&&(d.adler=V(d.adler,m.pending_buf,m.pending-Qe,Qe)),Ct(d),m.pending!==0)return m.last_flush=-1,Xe;Qe=0}At=m.gzindex<m.gzhead.comment.length?255&m.gzhead.comment.charCodeAt(m.gzindex++):0,xt(m,At)}while(At!==0);m.gzhead.hcrc&&m.pending>Qe&&(d.adler=V(d.adler,m.pending_buf,m.pending-Qe,Qe))}m.status=103}if(m.status===103){if(m.gzhead.hcrc){if(m.pending+2>m.pending_buf_size&&(Ct(d),m.pending!==0))return m.last_flush=-1,Xe;xt(m,255&d.adler),xt(m,d.adler>>8&255),d.adler=0}if(m.status=me,Ct(d),m.pending!==0)return m.last_flush=-1,Xe}if(d.avail_in!==0||m.lookahead!==0||C!==X&&m.status!==Be){var Oe=m.level===0?Ba(m,C):m.strategy===He?function(Ge,bt){for(var vt;;){if(Ge.lookahead===0&&(gn(Ge),Ge.lookahead===0)){if(bt===X)return 1;break}if(Ge.match_length=0,vt=Z(Ge,0,Ge.window[Ge.strstart]),Ge.lookahead--,Ge.strstart++,vt&&(Ut(Ge,!1),Ge.strm.avail_out===0))return 1}return Ge.insert=0,bt===be?(Ut(Ge,!0),Ge.strm.avail_out===0?3:4):Ge.sym_next&&(Ut(Ge,!1),Ge.strm.avail_out===0)?1:2}(m,C):m.strategy===at?function(Ge,bt){for(var vt,Dt,$e,qe,ct=Ge.window;;){if(Ge.lookahead<=we){if(gn(Ge),Ge.lookahead<=we&&bt===X)return 1;if(Ge.lookahead===0)break}if(Ge.match_length=0,Ge.lookahead>=3&&Ge.strstart>0&&(Dt=ct[$e=Ge.strstart-1])===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]){qe=Ge.strstart+we;do;while(Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&Dt===ct[++$e]&&$e<qe);Ge.match_length=we-(qe-$e),Ge.match_length>Ge.lookahead&&(Ge.match_length=Ge.lookahead)}if(Ge.match_length>=3?(vt=Z(Ge,1,Ge.match_length-3),Ge.lookahead-=Ge.match_length,Ge.strstart+=Ge.match_length,Ge.match_length=0):(vt=Z(Ge,0,Ge.window[Ge.strstart]),Ge.lookahead--,Ge.strstart++),vt&&(Ut(Ge,!1),Ge.strm.avail_out===0))return 1}return Ge.insert=0,bt===be?(Ut(Ge,!0),Ge.strm.avail_out===0?3:4):Ge.sym_next&&(Ut(Ge,!1),Ge.strm.avail_out===0)?1:2}(m,C):ra[m.level].func(m,C);if(Oe!==3&&Oe!==4||(m.status=Be),Oe===1||Oe===3)return d.avail_out===0&&(m.last_flush=-1),Xe;if(Oe===2&&(C===K?L(m):C!==nt&&(xe(m,0,0,!1),C===ie&&(it(m.head),m.lookahead===0&&(m.strstart=0,m.block_start=0,m.insert=0))),Ct(d),d.avail_out===0))return m.last_flush=-1,Xe}return C!==be?Xe:m.wrap<=0?mt:(m.wrap===2?(xt(m,255&d.adler),xt(m,d.adler>>8&255),xt(m,d.adler>>16&255),xt(m,d.adler>>24&255),xt(m,255&d.total_in),xt(m,d.total_in>>8&255),xt(m,d.total_in>>16&255),xt(m,d.total_in>>24&255)):(an(m,d.adler>>>16),an(m,65535&d.adler)),Ct(d),m.wrap>0&&(m.wrap=-m.wrap),m.pending!==0?Xe:mt)},deflateEnd:function(d){if(O(d))return et;var C=d.state.status;return d.state=null,C===me?Ke(d,Mt):Xe},deflateSetDictionary:function(d,C){var m=C.length;if(O(d))return et;var q=d.state,H=q.wrap;if(H===2||H===1&&q.status!==J||q.lookahead)return et;if(H===1&&(d.adler=D(d.adler,C,m,0)),q.wrap=0,m>=q.w_size){H===0&&(it(q.head),q.strstart=0,q.block_start=0,q.insert=0);var Q=new Uint8Array(q.w_size);Q.set(C.subarray(m-q.w_size,m),0),C=Q,m=q.w_size}var Ce=d.avail_in,ne=d.next_in,je=d.input;for(d.avail_in=m,d.next_in=0,d.input=C,gn(q);q.lookahead>=3;){var ae=q.strstart,le=q.lookahead-2;do q.ins_h=Rt(q,q.ins_h,q.window[ae+3-1]),q.prev[ae&q.w_mask]=q.head[q.ins_h],q.head[q.ins_h]=ae,ae++;while(--le);q.strstart=ae,q.lookahead=2,gn(q)}return q.strstart+=q.lookahead,q.block_start=q.strstart,q.insert=q.lookahead,q.lookahead=0,q.match_length=q.prev_length=2,q.match_available=0,d.next_in=ne,d.input=je,d.avail_in=Ce,q.wrap=H,Xe},deflateInfo:"pako deflate (from Nodeca project)"};function G(d){return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},G(d)}var de=function(d,C){return Object.prototype.hasOwnProperty.call(d,C)},Se=function(d){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var m=C.shift();if(m){if(G(m)!=="object")throw new TypeError(m+"must be non-object");for(var q in m)de(m,q)&&(d[q]=m[q])}}return d},fe=function(d){for(var C=0,m=0,q=d.length;m<q;m++)C+=d[m].length;for(var H=new Uint8Array(C),Q=0,Ce=0,ne=d.length;Q<ne;Q++){var je=d[Q];H.set(je,Ce),Ce+=je.length}return H},pe=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{pe=!1}for(var ge=new Uint8Array(256),Ie=0;Ie<256;Ie++)ge[Ie]=Ie>=252?6:Ie>=248?5:Ie>=240?4:Ie>=224?3:Ie>=192?2:1;ge[254]=ge[254]=1;var We=function(d){if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(d);var C,m,q,H,Q,Ce=d.length,ne=0;for(H=0;H<Ce;H++)(64512&(m=d.charCodeAt(H)))==55296&&H+1<Ce&&(64512&(q=d.charCodeAt(H+1)))==56320&&(m=65536+(m-55296<<10)+(q-56320),H++),ne+=m<128?1:m<2048?2:m<65536?3:4;for(C=new Uint8Array(ne),Q=0,H=0;Q<ne;H++)(64512&(m=d.charCodeAt(H)))==55296&&H+1<Ce&&(64512&(q=d.charCodeAt(H+1)))==56320&&(m=65536+(m-55296<<10)+(q-56320),H++),m<128?C[Q++]=m:m<2048?(C[Q++]=192|m>>>6,C[Q++]=128|63&m):m<65536?(C[Q++]=224|m>>>12,C[Q++]=128|m>>>6&63,C[Q++]=128|63&m):(C[Q++]=240|m>>>18,C[Q++]=128|m>>>12&63,C[Q++]=128|m>>>6&63,C[Q++]=128|63&m);return C},Ze=function(d,C){var m,q,H=C||d.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(d.subarray(0,C));var Q=new Array(2*H);for(q=0,m=0;m<H;){var Ce=d[m++];if(Ce<128)Q[q++]=Ce;else{var ne=ge[Ce];if(ne>4)Q[q++]=65533,m+=ne-1;else{for(Ce&=ne===2?31:ne===3?15:7;ne>1&&m<H;)Ce=Ce<<6|63&d[m++],ne--;ne>1?Q[q++]=65533:Ce<65536?Q[q++]=Ce:(Ce-=65536,Q[q++]=55296|Ce>>10&1023,Q[q++]=56320|1023&Ce)}}}return function(je,ae){if(ae<65534&&je.subarray&&pe)return String.fromCharCode.apply(null,je.length===ae?je:je.subarray(0,ae));for(var le="",At=0;At<ae;At++)le+=String.fromCharCode(je[At]);return le}(Q,q)},Me=function(d,C){(C=C||d.length)>d.length&&(C=d.length);for(var m=C-1;m>=0&&(192&d[m])==128;)m--;return m<0||m===0?C:m+ge[d[m]]>C?m:C},Ye=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},gt=Object.prototype.toString,nr=j.Z_NO_FLUSH,ar=j.Z_SYNC_FLUSH,Lr=j.Z_FULL_FLUSH,ws=j.Z_FINISH,Ua=j.Z_OK,Es=j.Z_STREAM_END,ei=j.Z_DEFAULT_COMPRESSION,Wl=j.Z_DEFAULT_STRATEGY,xa=j.Z_DEFLATED;function ql(d){this.options=Se({level:ei,method:xa,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wl},d||{});var C=this.options;C.raw&&C.windowBits>0?C.windowBits=-C.windowBits:C.gzip&&C.windowBits>0&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ye,this.strm.avail_out=0;var m=z.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(m!==Ua)throw new Error(R[m]);if(C.header&&z.deflateSetHeader(this.strm,C.header),C.dictionary){var q;if(q=typeof C.dictionary=="string"?We(C.dictionary):gt.call(C.dictionary)==="[object ArrayBuffer]"?new Uint8Array(C.dictionary):C.dictionary,(m=z.deflateSetDictionary(this.strm,q))!==Ua)throw new Error(R[m]);this._dict_set=!0}}function Eh(d,C){var m=new ql(C);if(m.push(d,!0),m.err)throw m.msg||R[m.err];return m.result}ql.prototype.push=function(d,C){var m,q,H=this.strm,Q=this.options.chunkSize;if(this.ended)return!1;for(q=C===~~C?C:C===!0?ws:nr,typeof d=="string"?H.input=We(d):gt.call(d)==="[object ArrayBuffer]"?H.input=new Uint8Array(d):H.input=d,H.next_in=0,H.avail_in=H.input.length;;)if(H.avail_out===0&&(H.output=new Uint8Array(Q),H.next_out=0,H.avail_out=Q),(q===ar||q===Lr)&&H.avail_out<=6)this.onData(H.output.subarray(0,H.next_out)),H.avail_out=0;else{if((m=z.deflate(H,q))===Es)return H.next_out>0&&this.onData(H.output.subarray(0,H.next_out)),m=z.deflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===Ua;if(H.avail_out!==0){if(q>0&&H.next_out>0)this.onData(H.output.subarray(0,H.next_out)),H.avail_out=0;else if(H.avail_in===0)break}else this.onData(H.output)}return!0},ql.prototype.onData=function(d){this.chunks.push(d)},ql.prototype.onEnd=function(d){d===Ua&&(this.result=fe(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};var uf={Deflate:ql,deflate:Eh,deflateRaw:function(d,C){return(C=C||{}).raw=!0,Eh(d,C)},gzip:function(d,C){return(C=C||{}).gzip=!0,Eh(d,C)}},cf=16209,iA=function(d,C){var m,q,H,Q,Ce,ne,je,ae,le,At,Qe,Oe,Ge,bt,vt,Dt,$e,qe,ct,Jt,st,Ft,Ot,dt,yt=d.state;m=d.next_in,Ot=d.input,q=m+(d.avail_in-5),H=d.next_out,dt=d.output,Q=H-(C-d.avail_out),Ce=H+(d.avail_out-257),ne=yt.dmax,je=yt.wsize,ae=yt.whave,le=yt.wnext,At=yt.window,Qe=yt.hold,Oe=yt.bits,Ge=yt.lencode,bt=yt.distcode,vt=(1<<yt.lenbits)-1,Dt=(1<<yt.distbits)-1;e:do{Oe<15&&(Qe+=Ot[m++]<<Oe,Oe+=8,Qe+=Ot[m++]<<Oe,Oe+=8),$e=Ge[Qe&vt];t:for(;;){if(Qe>>>=qe=$e>>>24,Oe-=qe,(qe=$e>>>16&255)===0)dt[H++]=65535&$e;else{if(!(16&qe)){if(!(64&qe)){$e=Ge[(65535&$e)+(Qe&(1<<qe)-1)];continue t}if(32&qe){yt.mode=16191;break e}d.msg="invalid literal/length code",yt.mode=cf;break e}ct=65535&$e,(qe&=15)&&(Oe<qe&&(Qe+=Ot[m++]<<Oe,Oe+=8),ct+=Qe&(1<<qe)-1,Qe>>>=qe,Oe-=qe),Oe<15&&(Qe+=Ot[m++]<<Oe,Oe+=8,Qe+=Ot[m++]<<Oe,Oe+=8),$e=bt[Qe&Dt];r:for(;;){if(Qe>>>=qe=$e>>>24,Oe-=qe,!(16&(qe=$e>>>16&255))){if(!(64&qe)){$e=bt[(65535&$e)+(Qe&(1<<qe)-1)];continue r}d.msg="invalid distance code",yt.mode=cf;break e}if(Jt=65535&$e,Oe<(qe&=15)&&(Qe+=Ot[m++]<<Oe,(Oe+=8)<qe&&(Qe+=Ot[m++]<<Oe,Oe+=8)),(Jt+=Qe&(1<<qe)-1)>ne){d.msg="invalid distance too far back",yt.mode=cf;break e}if(Qe>>>=qe,Oe-=qe,Jt>(qe=H-Q)){if((qe=Jt-qe)>ae&&yt.sane){d.msg="invalid distance too far back",yt.mode=cf;break e}if(st=0,Ft=At,le===0){if(st+=je-qe,qe<ct){ct-=qe;do dt[H++]=At[st++];while(--qe);st=H-Jt,Ft=dt}}else if(le<qe){if(st+=je+le-qe,(qe-=le)<ct){ct-=qe;do dt[H++]=At[st++];while(--qe);if(st=0,le<ct){ct-=qe=le;do dt[H++]=At[st++];while(--qe);st=H-Jt,Ft=dt}}}else if(st+=le-qe,qe<ct){ct-=qe;do dt[H++]=At[st++];while(--qe);st=H-Jt,Ft=dt}for(;ct>2;)dt[H++]=Ft[st++],dt[H++]=Ft[st++],dt[H++]=Ft[st++],ct-=3;ct&&(dt[H++]=Ft[st++],ct>1&&(dt[H++]=Ft[st++]))}else{st=H-Jt;do dt[H++]=dt[st++],dt[H++]=dt[st++],dt[H++]=dt[st++],ct-=3;while(ct>2);ct&&(dt[H++]=dt[st++],ct>1&&(dt[H++]=dt[st++]))}break}}break}}while(m<q&&H<Ce);m-=ct=Oe>>3,Qe&=(1<<(Oe-=ct<<3))-1,d.next_in=m,d.next_out=H,d.avail_in=m<q?q-m+5:5-(m-q),d.avail_out=H<Ce?Ce-H+257:257-(H-Ce),yt.hold=Qe,yt.bits=Oe},ff=15,sA=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lA=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),uA=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),$l=function(d,C,m,q,H,Q,Ce,ne){var je,ae,le,At,Qe,Oe,Ge,bt,vt,Dt=ne.bits,$e=0,qe=0,ct=0,Jt=0,st=0,Ft=0,Ot=0,dt=0,yt=0,Kt=0,Ts=null,Di=new Uint16Array(16),vf=new Uint16Array(16),yf=null;for($e=0;$e<=ff;$e++)Di[$e]=0;for(qe=0;qe<q;qe++)Di[C[m+qe]]++;for(st=Dt,Jt=ff;Jt>=1&&Di[Jt]===0;Jt--);if(st>Jt&&(st=Jt),Jt===0)return H[Q++]=20971520,H[Q++]=20971520,ne.bits=1,0;for(ct=1;ct<Jt&&Di[ct]===0;ct++);for(st<ct&&(st=ct),dt=1,$e=1;$e<=ff;$e++)if(dt<<=1,(dt-=Di[$e])<0)return-1;if(dt>0&&(d===0||Jt!==1))return-1;for(vf[1]=0,$e=1;$e<ff;$e++)vf[$e+1]=vf[$e]+Di[$e];for(qe=0;qe<q;qe++)C[m+qe]!==0&&(Ce[vf[C[m+qe]]++]=qe);if(d===0?(Ts=yf=Ce,Oe=20):d===1?(Ts=sA,yf=oA,Oe=257):(Ts=lA,yf=uA,Oe=0),Kt=0,qe=0,$e=ct,Qe=Q,Ft=st,Ot=0,le=-1,At=(yt=1<<st)-1,d===1&&yt>852||d===2&&yt>592)return 1;for(;;){Ge=$e-Ot,Ce[qe]+1<Oe?(bt=0,vt=Ce[qe]):Ce[qe]>=Oe?(bt=yf[Ce[qe]-Oe],vt=Ts[Ce[qe]-Oe]):(bt=96,vt=0),je=1<<$e-Ot,ct=ae=1<<Ft;do H[Qe+(Kt>>Ot)+(ae-=je)]=Ge<<24|bt<<16|vt|0;while(ae!==0);for(je=1<<$e-1;Kt&je;)je>>=1;if(je!==0?(Kt&=je-1,Kt+=je):Kt=0,qe++,--Di[$e]==0){if($e===Jt)break;$e=C[m+Ce[qe]]}if($e>st&&(Kt&At)!==le){for(Ot===0&&(Ot=st),Qe+=ct,dt=1<<(Ft=$e-Ot);Ft+Ot<Jt&&!((dt-=Di[Ft+Ot])<=0);)Ft++,dt<<=1;if(yt+=1<<Ft,d===1&&yt>852||d===2&&yt>592)return 1;H[le=Kt&At]=st<<24|Ft<<16|Qe-Q|0}}return Kt!==0&&(H[Qe+Kt]=$e-Ot<<24|64<<16|0),ne.bits=st,0},Ix=j.Z_FINISH,cA=j.Z_BLOCK,df=j.Z_TREES,bs=j.Z_OK,fA=j.Z_STREAM_END,dA=j.Z_NEED_DICT,va=j.Z_STREAM_ERROR,Rx=j.Z_DATA_ERROR,Lx=j.Z_MEM_ERROR,hA=j.Z_BUF_ERROR,Mx=j.Z_DEFLATED,hf=16180,pf=16190,ti=16191,bh=16192,_h=16194,mf=16199,gf=16200,Th=16206,ur=16209,jx=function(d){return(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24)};function pA(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Sh,Ah,_s=function(d){if(!d)return 1;var C=d.state;return!C||C.strm!==d||C.mode<hf||C.mode>16211?1:0},Bx=function(d){if(_s(d))return va;var C=d.state;return d.total_in=d.total_out=C.total=0,d.msg="",C.wrap&&(d.adler=1&C.wrap),C.mode=hf,C.last=0,C.havedict=0,C.flags=-1,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new Int32Array(852),C.distcode=C.distdyn=new Int32Array(592),C.sane=1,C.back=-1,bs},Ux=function(d){if(_s(d))return va;var C=d.state;return C.wsize=0,C.whave=0,C.wnext=0,Bx(d)},zx=function(d,C){var m;if(_s(d))return va;var q=d.state;return C<0?(m=0,C=-C):(m=5+(C>>4),C<48&&(C&=15)),C&&(C<8||C>15)?va:(q.window!==null&&q.wbits!==C&&(q.window=null),q.wrap=m,q.wbits=C,Ux(d))},Wx=function(d,C){if(!d)return va;var m=new pA;d.state=m,m.strm=d,m.window=null,m.mode=hf;var q=zx(d,C);return q!==bs&&(d.state=null),q},qx=!0,mA=function(d){if(qx){Sh=new Int32Array(512),Ah=new Int32Array(32);for(var C=0;C<144;)d.lens[C++]=8;for(;C<256;)d.lens[C++]=9;for(;C<280;)d.lens[C++]=7;for(;C<288;)d.lens[C++]=8;for($l(1,d.lens,0,288,Sh,0,d.work,{bits:9}),C=0;C<32;)d.lens[C++]=5;$l(2,d.lens,0,32,Ah,0,d.work,{bits:5}),qx=!1}d.lencode=Sh,d.lenbits=9,d.distcode=Ah,d.distbits=5},$x=function(d,C,m,q){var H,Q=d.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new Uint8Array(Q.wsize)),q>=Q.wsize?(Q.window.set(C.subarray(m-Q.wsize,m),0),Q.wnext=0,Q.whave=Q.wsize):((H=Q.wsize-Q.wnext)>q&&(H=q),Q.window.set(C.subarray(m-q,m-q+H),Q.wnext),(q-=H)?(Q.window.set(C.subarray(m-q,m),0),Q.wnext=q,Q.whave=Q.wsize):(Q.wnext+=H,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=H))),0},ri={inflateReset:Ux,inflateReset2:zx,inflateResetKeep:Bx,inflateInit:function(d){return Wx(d,15)},inflateInit2:Wx,inflate:function(d,C){var m,q,H,Q,Ce,ne,je,ae,le,At,Qe,Oe,Ge,bt,vt,Dt,$e,qe,ct,Jt,st,Ft,Ot,dt,yt=0,Kt=new Uint8Array(4),Ts=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(_s(d)||!d.output||!d.input&&d.avail_in!==0)return va;(m=d.state).mode===ti&&(m.mode=bh),Ce=d.next_out,H=d.output,je=d.avail_out,Q=d.next_in,q=d.input,ne=d.avail_in,ae=m.hold,le=m.bits,At=ne,Qe=je,Ft=bs;e:for(;;)switch(m.mode){case hf:if(m.wrap===0){m.mode=bh;break}for(;le<16;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(2&m.wrap&&ae===35615){m.wbits===0&&(m.wbits=15),m.check=0,Kt[0]=255&ae,Kt[1]=ae>>>8&255,m.check=V(m.check,Kt,2,0),ae=0,le=0,m.mode=16181;break}if(m.head&&(m.head.done=!1),!(1&m.wrap)||(((255&ae)<<8)+(ae>>8))%31){d.msg="incorrect header check",m.mode=ur;break}if((15&ae)!==Mx){d.msg="unknown compression method",m.mode=ur;break}if(le-=4,st=8+(15&(ae>>>=4)),m.wbits===0&&(m.wbits=st),st>15||st>m.wbits){d.msg="invalid window size",m.mode=ur;break}m.dmax=1<<m.wbits,m.flags=0,d.adler=m.check=1,m.mode=512&ae?16189:ti,ae=0,le=0;break;case 16181:for(;le<16;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(m.flags=ae,(255&m.flags)!==Mx){d.msg="unknown compression method",m.mode=ur;break}if(57344&m.flags){d.msg="unknown header flags set",m.mode=ur;break}m.head&&(m.head.text=ae>>8&1),512&m.flags&&4&m.wrap&&(Kt[0]=255&ae,Kt[1]=ae>>>8&255,m.check=V(m.check,Kt,2,0)),ae=0,le=0,m.mode=16182;case 16182:for(;le<32;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.head&&(m.head.time=ae),512&m.flags&&4&m.wrap&&(Kt[0]=255&ae,Kt[1]=ae>>>8&255,Kt[2]=ae>>>16&255,Kt[3]=ae>>>24&255,m.check=V(m.check,Kt,4,0)),ae=0,le=0,m.mode=16183;case 16183:for(;le<16;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.head&&(m.head.xflags=255&ae,m.head.os=ae>>8),512&m.flags&&4&m.wrap&&(Kt[0]=255&ae,Kt[1]=ae>>>8&255,m.check=V(m.check,Kt,2,0)),ae=0,le=0,m.mode=16184;case 16184:if(1024&m.flags){for(;le<16;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.length=ae,m.head&&(m.head.extra_len=ae),512&m.flags&&4&m.wrap&&(Kt[0]=255&ae,Kt[1]=ae>>>8&255,m.check=V(m.check,Kt,2,0)),ae=0,le=0}else m.head&&(m.head.extra=null);m.mode=16185;case 16185:if(1024&m.flags&&((Oe=m.length)>ne&&(Oe=ne),Oe&&(m.head&&(st=m.head.extra_len-m.length,m.head.extra||(m.head.extra=new Uint8Array(m.head.extra_len)),m.head.extra.set(q.subarray(Q,Q+Oe),st)),512&m.flags&&4&m.wrap&&(m.check=V(m.check,q,Oe,Q)),ne-=Oe,Q+=Oe,m.length-=Oe),m.length))break e;m.length=0,m.mode=16186;case 16186:if(2048&m.flags){if(ne===0)break e;Oe=0;do st=q[Q+Oe++],m.head&&st&&m.length<65536&&(m.head.name+=String.fromCharCode(st));while(st&&Oe<ne);if(512&m.flags&&4&m.wrap&&(m.check=V(m.check,q,Oe,Q)),ne-=Oe,Q+=Oe,st)break e}else m.head&&(m.head.name=null);m.length=0,m.mode=16187;case 16187:if(4096&m.flags){if(ne===0)break e;Oe=0;do st=q[Q+Oe++],m.head&&st&&m.length<65536&&(m.head.comment+=String.fromCharCode(st));while(st&&Oe<ne);if(512&m.flags&&4&m.wrap&&(m.check=V(m.check,q,Oe,Q)),ne-=Oe,Q+=Oe,st)break e}else m.head&&(m.head.comment=null);m.mode=16188;case 16188:if(512&m.flags){for(;le<16;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(4&m.wrap&&ae!==(65535&m.check)){d.msg="header crc mismatch",m.mode=ur;break}ae=0,le=0}m.head&&(m.head.hcrc=m.flags>>9&1,m.head.done=!0),d.adler=m.check=0,m.mode=ti;break;case 16189:for(;le<32;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}d.adler=m.check=jx(ae),ae=0,le=0,m.mode=pf;case pf:if(m.havedict===0)return d.next_out=Ce,d.avail_out=je,d.next_in=Q,d.avail_in=ne,m.hold=ae,m.bits=le,dA;d.adler=m.check=1,m.mode=ti;case ti:if(C===cA||C===df)break e;case bh:if(m.last){ae>>>=7&le,le-=7&le,m.mode=Th;break}for(;le<3;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}switch(m.last=1&ae,le-=1,3&(ae>>>=1)){case 0:m.mode=16193;break;case 1:if(mA(m),m.mode=mf,C===df){ae>>>=2,le-=2;break e}break;case 2:m.mode=16196;break;case 3:d.msg="invalid block type",m.mode=ur}ae>>>=2,le-=2;break;case 16193:for(ae>>>=7&le,le-=7&le;le<32;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if((65535&ae)!=(ae>>>16^65535)){d.msg="invalid stored block lengths",m.mode=ur;break}if(m.length=65535&ae,ae=0,le=0,m.mode=_h,C===df)break e;case _h:m.mode=16195;case 16195:if(Oe=m.length){if(Oe>ne&&(Oe=ne),Oe>je&&(Oe=je),Oe===0)break e;H.set(q.subarray(Q,Q+Oe),Ce),ne-=Oe,Q+=Oe,je-=Oe,Ce+=Oe,m.length-=Oe;break}m.mode=ti;break;case 16196:for(;le<14;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(m.nlen=257+(31&ae),ae>>>=5,le-=5,m.ndist=1+(31&ae),ae>>>=5,le-=5,m.ncode=4+(15&ae),ae>>>=4,le-=4,m.nlen>286||m.ndist>30){d.msg="too many length or distance symbols",m.mode=ur;break}m.have=0,m.mode=16197;case 16197:for(;m.have<m.ncode;){for(;le<3;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.lens[Ts[m.have++]]=7&ae,ae>>>=3,le-=3}for(;m.have<19;)m.lens[Ts[m.have++]]=0;if(m.lencode=m.lendyn,m.lenbits=7,Ot={bits:m.lenbits},Ft=$l(0,m.lens,0,19,m.lencode,0,m.work,Ot),m.lenbits=Ot.bits,Ft){d.msg="invalid code lengths set",m.mode=ur;break}m.have=0,m.mode=16198;case 16198:for(;m.have<m.nlen+m.ndist;){for(;Dt=(yt=m.lencode[ae&(1<<m.lenbits)-1])>>>16&255,$e=65535&yt,!((vt=yt>>>24)<=le);){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if($e<16)ae>>>=vt,le-=vt,m.lens[m.have++]=$e;else{if($e===16){for(dt=vt+2;le<dt;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(ae>>>=vt,le-=vt,m.have===0){d.msg="invalid bit length repeat",m.mode=ur;break}st=m.lens[m.have-1],Oe=3+(3&ae),ae>>>=2,le-=2}else if($e===17){for(dt=vt+3;le<dt;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}le-=vt,st=0,Oe=3+(7&(ae>>>=vt)),ae>>>=3,le-=3}else{for(dt=vt+7;le<dt;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}le-=vt,st=0,Oe=11+(127&(ae>>>=vt)),ae>>>=7,le-=7}if(m.have+Oe>m.nlen+m.ndist){d.msg="invalid bit length repeat",m.mode=ur;break}for(;Oe--;)m.lens[m.have++]=st}}if(m.mode===ur)break;if(m.lens[256]===0){d.msg="invalid code -- missing end-of-block",m.mode=ur;break}if(m.lenbits=9,Ot={bits:m.lenbits},Ft=$l(1,m.lens,0,m.nlen,m.lencode,0,m.work,Ot),m.lenbits=Ot.bits,Ft){d.msg="invalid literal/lengths set",m.mode=ur;break}if(m.distbits=6,m.distcode=m.distdyn,Ot={bits:m.distbits},Ft=$l(2,m.lens,m.nlen,m.ndist,m.distcode,0,m.work,Ot),m.distbits=Ot.bits,Ft){d.msg="invalid distances set",m.mode=ur;break}if(m.mode=mf,C===df)break e;case mf:m.mode=gf;case gf:if(ne>=6&&je>=258){d.next_out=Ce,d.avail_out=je,d.next_in=Q,d.avail_in=ne,m.hold=ae,m.bits=le,iA(d,Qe),Ce=d.next_out,H=d.output,je=d.avail_out,Q=d.next_in,q=d.input,ne=d.avail_in,ae=m.hold,le=m.bits,m.mode===ti&&(m.back=-1);break}for(m.back=0;Dt=(yt=m.lencode[ae&(1<<m.lenbits)-1])>>>16&255,$e=65535&yt,!((vt=yt>>>24)<=le);){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(Dt&&!(240&Dt)){for(qe=vt,ct=Dt,Jt=$e;Dt=(yt=m.lencode[Jt+((ae&(1<<qe+ct)-1)>>qe)])>>>16&255,$e=65535&yt,!(qe+(vt=yt>>>24)<=le);){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}ae>>>=qe,le-=qe,m.back+=qe}if(ae>>>=vt,le-=vt,m.back+=vt,m.length=$e,Dt===0){m.mode=16205;break}if(32&Dt){m.back=-1,m.mode=ti;break}if(64&Dt){d.msg="invalid literal/length code",m.mode=ur;break}m.extra=15&Dt,m.mode=16201;case 16201:if(m.extra){for(dt=m.extra;le<dt;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.length+=ae&(1<<m.extra)-1,ae>>>=m.extra,le-=m.extra,m.back+=m.extra}m.was=m.length,m.mode=16202;case 16202:for(;Dt=(yt=m.distcode[ae&(1<<m.distbits)-1])>>>16&255,$e=65535&yt,!((vt=yt>>>24)<=le);){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(!(240&Dt)){for(qe=vt,ct=Dt,Jt=$e;Dt=(yt=m.distcode[Jt+((ae&(1<<qe+ct)-1)>>qe)])>>>16&255,$e=65535&yt,!(qe+(vt=yt>>>24)<=le);){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}ae>>>=qe,le-=qe,m.back+=qe}if(ae>>>=vt,le-=vt,m.back+=vt,64&Dt){d.msg="invalid distance code",m.mode=ur;break}m.offset=$e,m.extra=15&Dt,m.mode=16203;case 16203:if(m.extra){for(dt=m.extra;le<dt;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}m.offset+=ae&(1<<m.extra)-1,ae>>>=m.extra,le-=m.extra,m.back+=m.extra}if(m.offset>m.dmax){d.msg="invalid distance too far back",m.mode=ur;break}m.mode=16204;case 16204:if(je===0)break e;if(Oe=Qe-je,m.offset>Oe){if((Oe=m.offset-Oe)>m.whave&&m.sane){d.msg="invalid distance too far back",m.mode=ur;break}Oe>m.wnext?(Oe-=m.wnext,Ge=m.wsize-Oe):Ge=m.wnext-Oe,Oe>m.length&&(Oe=m.length),bt=m.window}else bt=H,Ge=Ce-m.offset,Oe=m.length;Oe>je&&(Oe=je),je-=Oe,m.length-=Oe;do H[Ce++]=bt[Ge++];while(--Oe);m.length===0&&(m.mode=gf);break;case 16205:if(je===0)break e;H[Ce++]=m.length,je--,m.mode=gf;break;case Th:if(m.wrap){for(;le<32;){if(ne===0)break e;ne--,ae|=q[Q++]<<le,le+=8}if(Qe-=je,d.total_out+=Qe,m.total+=Qe,4&m.wrap&&Qe&&(d.adler=m.check=m.flags?V(m.check,H,Qe,Ce-Qe):D(m.check,H,Qe,Ce-Qe)),Qe=je,4&m.wrap&&(m.flags?ae:jx(ae))!==m.check){d.msg="incorrect data check",m.mode=ur;break}ae=0,le=0}m.mode=16207;case 16207:if(m.wrap&&m.flags){for(;le<32;){if(ne===0)break e;ne--,ae+=q[Q++]<<le,le+=8}if(4&m.wrap&&ae!==(4294967295&m.total)){d.msg="incorrect length check",m.mode=ur;break}ae=0,le=0}m.mode=16208;case 16208:Ft=fA;break e;case ur:Ft=Rx;break e;case 16210:return Lx;default:return va}return d.next_out=Ce,d.avail_out=je,d.next_in=Q,d.avail_in=ne,m.hold=ae,m.bits=le,(m.wsize||Qe!==d.avail_out&&m.mode<ur&&(m.mode<Th||C!==Ix))&&$x(d,d.output,d.next_out,Qe-d.avail_out),At-=d.avail_in,Qe-=d.avail_out,d.total_in+=At,d.total_out+=Qe,m.total+=Qe,4&m.wrap&&Qe&&(d.adler=m.check=m.flags?V(m.check,H,Qe,d.next_out-Qe):D(m.check,H,Qe,d.next_out-Qe)),d.data_type=m.bits+(m.last?64:0)+(m.mode===ti?128:0)+(m.mode===mf||m.mode===_h?256:0),(At===0&&Qe===0||C===Ix)&&Ft===bs&&(Ft=hA),Ft},inflateEnd:function(d){if(_s(d))return va;var C=d.state;return C.window&&(C.window=null),d.state=null,bs},inflateGetHeader:function(d,C){if(_s(d))return va;var m=d.state;return 2&m.wrap?(m.head=C,C.done=!1,bs):va},inflateSetDictionary:function(d,C){var m,q=C.length;return _s(d)||(m=d.state).wrap!==0&&m.mode!==pf?va:m.mode===pf&&D(1,C,q,0)!==m.check?Rx:$x(d,C,q,q)?(m.mode=16210,Lx):(m.havedict=1,bs)},inflateInfo:"pako inflate (from Nodeca project)"},gA=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Hx=Object.prototype.toString,xA=j.Z_NO_FLUSH,vA=j.Z_FINISH,Hl=j.Z_OK,Ch=j.Z_STREAM_END,Dh=j.Z_NEED_DICT,yA=j.Z_STREAM_ERROR,Vx=j.Z_DATA_ERROR,wA=j.Z_MEM_ERROR;function Vl(d){this.options=Se({chunkSize:65536,windowBits:15,to:""},d||{});var C=this.options;C.raw&&C.windowBits>=0&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),!(C.windowBits>=0&&C.windowBits<16)||d&&d.windowBits||(C.windowBits+=32),C.windowBits>15&&C.windowBits<48&&!(15&C.windowBits)&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ye,this.strm.avail_out=0;var m=ri.inflateInit2(this.strm,C.windowBits);if(m!==Hl)throw new Error(R[m]);if(this.header=new gA,ri.inflateGetHeader(this.strm,this.header),C.dictionary&&(typeof C.dictionary=="string"?C.dictionary=We(C.dictionary):Hx.call(C.dictionary)==="[object ArrayBuffer]"&&(C.dictionary=new Uint8Array(C.dictionary)),C.raw&&(m=ri.inflateSetDictionary(this.strm,C.dictionary))!==Hl))throw new Error(R[m])}function Nh(d,C){var m=new Vl(C);if(m.push(d),m.err)throw m.msg||R[m.err];return m.result}Vl.prototype.push=function(d,C){var m,q,H,Q=this.strm,Ce=this.options.chunkSize,ne=this.options.dictionary;if(this.ended)return!1;for(q=C===~~C?C:C===!0?vA:xA,Hx.call(d)==="[object ArrayBuffer]"?Q.input=new Uint8Array(d):Q.input=d,Q.next_in=0,Q.avail_in=Q.input.length;;){for(Q.avail_out===0&&(Q.output=new Uint8Array(Ce),Q.next_out=0,Q.avail_out=Ce),(m=ri.inflate(Q,q))===Dh&&ne&&((m=ri.inflateSetDictionary(Q,ne))===Hl?m=ri.inflate(Q,q):m===Vx&&(m=Dh));Q.avail_in>0&&m===Ch&&Q.state.wrap>0&&d[Q.next_in]!==0;)ri.inflateReset(Q),m=ri.inflate(Q,q);switch(m){case yA:case Vx:case Dh:case wA:return this.onEnd(m),this.ended=!0,!1}if(H=Q.avail_out,Q.next_out&&(Q.avail_out===0||m===Ch))if(this.options.to==="string"){var je=Me(Q.output,Q.next_out),ae=Q.next_out-je,le=Ze(Q.output,je);Q.next_out=ae,Q.avail_out=Ce-ae,ae&&Q.output.set(Q.output.subarray(je,je+ae),0),this.onData(le)}else this.onData(Q.output.length===Q.next_out?Q.output:Q.output.subarray(0,Q.next_out));if(m!==Hl||H!==0){if(m===Ch)return m=ri.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,!0;if(Q.avail_in===0)break}}return!0},Vl.prototype.onData=function(d){this.chunks.push(d)},Vl.prototype.onEnd=function(d){d===Hl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=fe(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};var xf={Inflate:Vl,inflate:Nh,inflateRaw:function(d,C){return(C=C||{}).raw=!0,Nh(d,C)},ungzip:Nh},Gx=uf.Deflate,Yx=uf.deflate,Xx=uf.deflateRaw,Kx=uf.gzip,Zx=xf.Inflate,Qx=xf.inflate,Jx=xf.inflateRaw,ev=xf.ungzip,tv=j,EA={Deflate:Gx,deflate:Yx,deflateRaw:Xx,gzip:Kx,Inflate:Zx,inflate:Qx,inflateRaw:Jx,ungzip:ev,constants:tv};r.Deflate=Gx,r.Inflate=Zx,r.constants=tv,r.default=EA,r.deflate=Yx,r.deflateRaw=Xx,r.gzip=Kx,r.inflate=Qx,r.inflateRaw=Jx,r.ungzip=ev,Object.defineProperty(r,"__esModule",{value:!0})})})(vg,vg.exports);var T5=vg.exports,eT=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",tT=T5;kl.uncompressInputType=eT?"uint8array":"array";kl.compressInputType=eT?"uint8array":"array";kl.magic="\b\0";kl.compress=function(e,t){return tT.deflateRaw(e,{level:t.level||-1})};kl.uncompress=function(e){return tT.inflateRaw(e)};Yc.STORE={magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null};Yc.DEFLATE=kl;var H1={exports:{}};H1.exports=function(e,t){return typeof e=="number"?Buffer.alloc(e):Buffer.from(e,t)};H1.exports.test=function(e){return Buffer.isBuffer(e)};var V1=H1.exports;(function(e){function t(c){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},t(c)}var r=fn,n=Yc,a=V1;e.string2binary=function(c){for(var h="",p=0;p<c.length;p++)h+=String.fromCharCode(c.charCodeAt(p)&255);return h},e.arrayBuffer2Blob=function(c,h){e.checkSupport("blob"),h=h||"application/zip";try{return new Blob([c],{type:h})}catch{try{var p=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,x=new p;return x.append(c),x.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}};function i(c){return c}function s(c,h){for(var p=0;p<c.length;++p)h[p]=c.charCodeAt(p)&255;return h}function o(c){var h=65536,p=[],x=c.length,E=e.getTypeOf(c),g=0,w=!0;try{switch(E){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0));break}}catch{w=!1}if(!w){for(var v="",y=0;y<c.length;y++)v+=String.fromCharCode(c[y]);return v}for(;g<x&&h>1;)try{E==="array"||E==="nodebuffer"?p.push(String.fromCharCode.apply(null,c.slice(g,Math.min(g+h,x)))):p.push(String.fromCharCode.apply(null,c.subarray(g,Math.min(g+h,x)))),g+=h}catch{h=Math.floor(h/2)}return p.join("")}e.applyFromCharCode=o;function l(c,h){for(var p=0;p<c.length;p++)h[p]=c[p];return h}var u={};u.string={string:i,array:function(h){return s(h,new Array(h.length))},arraybuffer:function(h){return u.string.uint8array(h).buffer},uint8array:function(h){return s(h,new Uint8Array(h.length))},nodebuffer:function(h){return s(h,a(h.length))}},u.array={string:o,array:i,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a(h)}},u.arraybuffer={string:function(h){return o(new Uint8Array(h))},array:function(h){return l(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:i,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return a(new Uint8Array(h))}},u.uint8array={string:o,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:i,nodebuffer:function(h){return a(h)}},u.nodebuffer={string:o,array:function(h){return l(h,new Array(h.length))},arraybuffer:function(h){return u.nodebuffer.uint8array(h).buffer},uint8array:function(h){return l(h,new Uint8Array(h.length))},nodebuffer:i},e.transformTo=function(c,h){if(h||(h=""),!c)return h;e.checkSupport(c);var p=e.getTypeOf(h),x=u[p][c](h);return x},e.getTypeOf=function(c){if(c!=null){if(typeof c=="string")return"string";var h=Object.prototype.toString.call(c);if(h==="[object Array]")return"array";if(r.nodebuffer&&a.test(c))return"nodebuffer";if(r.uint8array&&h==="[object Uint8Array]")return"uint8array";if(r.arraybuffer&&h==="[object ArrayBuffer]")return"arraybuffer";if(h==="[object Promise]")throw new Error("Cannot read data from a promise, you probably are running new PizZip(data) with a promise");if(t(c)==="object"&&typeof c.file=="function")throw new Error("Cannot read data from a pizzip instance, you probably are running new PizZip(zip) with a zipinstance");if(h==="[object Date]")throw new Error("Cannot read data from a Date, you probably are running new PizZip(data) with a date");if(t(c)==="object"&&c.crc32==null)throw new Error("Unsupported data given to new PizZip(data) (object given)")}},e.checkSupport=function(c){var h=r[c.toLowerCase()];if(!h)throw new Error(c+" is not supported by this browser")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(c){var h="",p,x;for(x=0;x<(c||"").length;x++)p=c.charCodeAt(x),h+="\\x"+(p<16?"0":"")+p.toString(16).toUpperCase();return h},e.findCompression=function(c){for(var h in n)if(n.hasOwnProperty(h)&&n[h].magic===c)return n[h];return null},e.isRegExp=function(c){return Object.prototype.toString.call(c)==="[object RegExp]"},e.extend=function(){var c={},h,p;for(h=0;h<arguments.length;h++)for(p in arguments[h])arguments[h].hasOwnProperty(p)&&typeof c[p]>"u"&&(c[p]=arguments[h][p]);return c}})(pa);var S5=pa,A5=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],C5=function(t,r){if(typeof t>"u"||!t.length)return 0;var n=S5.getTypeOf(t)!=="string";typeof r>"u"&&(r=0);var a=0,i=0,s=0;r^=-1;for(var o=0,l=t.length;o<l;o++)s=n?t[o]:t.charCodeAt(o),i=(r^s)&255,a=A5[i],r=r>>>8^a;return r^-1},gs={};gs.LOCAL_FILE_HEADER="PK";gs.CENTRAL_FILE_HEADER="PK";gs.CENTRAL_DIRECTORY_END="PK";gs.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";gs.ZIP64_CENTRAL_DIRECTORY_END="PK";gs.DATA_DESCRIPTOR="PK\x07\b";var ma={};ma.base64=!1;ma.binary=!1;ma.dir=!1;ma.createFolders=!1;ma.date=null;ma.compression=null;ma.compressionOptions=null;ma.comment=null;ma.unixPermissions=null;ma.dosPermissions=null;function rT(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}rT.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};var nT=rT,Zd={},yg=pa,Ru=fn,D5=V1,vc=new Array(256);for(var Oi=0;Oi<256;Oi++)vc[Oi]=Oi>=252?6:Oi>=248?5:Oi>=240?4:Oi>=224?3:Oi>=192?2:1;vc[254]=vc[254]=1;function N5(e){var t,r,n,a,i,s=0,o=e.length;for(a=0;a<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),s+=r<128?1:r<2048?2:r<65536?3:4;for(Ru.uint8array?t=new Uint8Array(s):t=new Array(s),i=0,a=0;i<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t}function k5(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+vc[e[r]]>t?r:t}function z2(e){var t,r,n,a,i=e.length,s=new Array(i*2);for(r=0,t=0;t<i;){if(n=e[t++],n<128){s[r++]=n;continue}if(a=vc[n],a>4){s[r++]=65533,t+=a-1;continue}for(n&=a===2?31:a===3?15:7;a>1&&t<i;)n=n<<6|e[t++]&63,a--;if(a>1){s[r++]=65533;continue}n<65536?s[r++]=n:(n-=65536,s[r++]=55296|n>>10&1023,s[r++]=56320|n&1023)}return s.length!==r&&(s.subarray?s=s.subarray(0,r):s.length=r),yg.applyFromCharCode(s)}Zd.utf8encode=function(t){return Ru.nodebuffer?D5(t,"utf-8"):N5(t)};Zd.utf8decode=function(t){if(Ru.nodebuffer)return yg.transformTo("nodebuffer",t).toString("utf-8");t=yg.transformTo(Ru.uint8array?"uint8array":"array",t);for(var r=[],n=t.length,a=65536,i=0;i<n;){var s=k5(t,Math.min(i+a,n));Ru.uint8array?r.push(z2(t.subarray(i,s))):r.push(z2(t.slice(i,s))),i=s}return r.join("")};var O5=pa;function aT(){this.data=[]}aT.prototype={append:function(t){t=O5.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}};var F5=aT,P5=pa;function iT(e){this.data=new Uint8Array(e),this.index=0}iT.prototype={append:function(t){t.length!==0&&(t=P5.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}};var I5=iT;function R5(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=L5(e))||t){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(u){throw u},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var u=r.next();return s=u.done,u},e:function(u){o=!0,i=u},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw i}}}}function L5(e,t){if(e){if(typeof e=="string")return W2(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W2(e,t):void 0}}function W2(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var M5=fn,tr=pa,G1=C5,wg=gs,j5=ma,sT=Gc,Eg=Yc,ud=nT,B5=V1,il=Zd,U5=F5,z5=I5;function oT(e){if(e._data instanceof ud&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,tr.getTypeOf(e._data)==="uint8array")){var t=e._data;e._data=new Uint8Array(t.length),t.length!==0&&e._data.set(t,0)}return e._data}function bg(e){var t=oT(e),r=tr.getTypeOf(t);return r==="string"?!e.options.binary&&M5.nodebuffer?B5(t,"utf-8"):e.asBinary():t}var _g={load:function(){throw new Error("Load method is not defined. Is the file pizzip-load.js included ?")},filter:function(t){var r=[],n,a,i,s;for(n in this.files)this.files.hasOwnProperty(n)&&(i=this.files[n],s=new Y1(i.name,i._data,tr.extend(i.options)),a=n.slice(this.root.length,n.length),n.slice(0,this.root.length)===this.root&&t(a,s)&&r.push(s));return r},file:function(t,r,n){if(arguments.length===1){if(tr.isRegExp(t)){var a=t;return this.filter(function(i,s){return!s.dir&&a.test(i)})}return this.filter(function(i,s){return!s.dir&&i===t})[0]||null}return t=this.root+t,lT.call(this,t,r,n),this},folder:function(t){if(!t)return this;if(tr.isRegExp(t))return this.filter(function(i,s){return s.dir&&t.test(i)});var r=this.root+t,n=cT.call(this,r),a=this.shallowClone();return a.root=n.name,a},remove:function(t){t=this.root+t;var r=this.files[t];if(r||(t.slice(-1)!=="/"&&(t+="/"),r=this.files[t]),r&&!r.dir)delete this.files[t];else for(var n=this.filter(function(i,s){return s.name.slice(0,t.length)===t}),a=0;a<n.length;a++)delete this.files[n[a].name];return this},generate:function(t){t=tr.extend(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:il.utf8encode}),tr.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var r=[],n=tr.transformTo("string",t.encodeFileName(t.comment||this.comment||"")),a=0,i=0,s,o,l=[];t.fileOrder instanceof Array&&(l=t.fileOrder);for(var u in this.files)l.indexOf(u)===-1&&l.push(u);typeof t.fileOrder=="function"&&(l=t.fileOrder(this.files));var c=R5(l),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;if(this.files.hasOwnProperty(p)){var x=this.files[p],E=x.options.compression||t.compression.toUpperCase(),g=Eg[E];if(!g)throw new Error(E+" is not a valid compression method !");var w=x.options.compressionOptions||t.compressionOptions||{},v=$5.call(this,x,g,w),y=G5.call(this,p,x,v,a,t.platform,t.encodeFileName);a+=y.fileRecord.length+v.compressedSize,i+=y.dirRecord.length,r.push(y)}}}catch(k){c.e(k)}finally{c.f()}var b="";b=wg.CENTRAL_DIRECTORY_END+"\0\0\0\0"+xr(r.length,2)+xr(r.length,2)+xr(i,4)+xr(a,4)+xr(n.length,2)+n;var T=t.type.toLowerCase();for(T==="uint8array"||T==="arraybuffer"||T==="blob"||T==="nodebuffer"?s=new z5(a+i+b.length):s=new U5(a+i+b.length),o=0;o<r.length;o++)s.append(r[o].fileRecord),s.append(r[o].compressedObject.compressedContent);for(o=0;o<r.length;o++)s.append(r[o].dirRecord);s.append(b);var N=s.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return tr.transformTo(t.type.toLowerCase(),N);case"blob":return tr.arrayBuffer2Blob(tr.transformTo("arraybuffer",N),t.mimeType);case"base64":return t.base64?sT.encode(N):N;default:return N}},crc32:function(t,r){return G1(t,r)},utf8encode:function(t){return tr.transformTo("string",il.utf8encode(t))},utf8decode:function(t){return il.utf8decode(t)}};function q2(e){var t=oT(this);return t===null||typeof t>"u"?"":(this.options.base64&&(t=sT.decode(t)),e&&this.options.binary?t=_g.utf8decode(t):t=tr.transformTo("string",t),!e&&!this.options.binary&&(t=tr.transformTo("string",_g.utf8encode(t))),t)}function Y1(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}}Y1.prototype={asText:function(){return q2.call(this,!0)},asBinary:function(){return q2.call(this,!1)},asNodeBuffer:function(){var t=bg(this);return tr.transformTo("nodebuffer",t)},asUint8Array:function(){var t=bg(this);return tr.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};function xr(e,t){var r="",n;for(n=0;n<t;n++)r+=String.fromCharCode(e&255),e>>>=8;return r}function W5(e){return e=e||{},e.base64===!0&&(e.binary===null||e.binary===void 0)&&(e.binary=!0),e=tr.extend(e,j5),e.date=e.date||new Date,e.compression!==null&&(e.compression=e.compression.toUpperCase()),e}function lT(e,t,r){var n=tr.getTypeOf(t),a;if(r=W5(r),typeof r.unixPermissions=="string"&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&r.unixPermissions&16384&&(r.dir=!0),r.dosPermissions&&r.dosPermissions&16&&(r.dir=!0),r.dir&&(e=uT(e)),r.createFolders&&(a=q5(e))&&cT.call(this,a,!0),r.dir||t===null||typeof t>"u")r.base64=!1,r.binary=!1,t=null,n=null;else if(n==="string")r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(t=tr.string2binary(t));else{if(r.base64=!1,r.binary=!0,!n&&!(t instanceof ud))throw new Error("The data of '"+e+"' is in an unsupported format !");n==="arraybuffer"&&(t=tr.transformTo("uint8array",t))}var i=new Y1(e,t,r);return this.files[e]=i,i}function q5(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""}function uT(e){return e.slice(-1)!=="/"&&(e+="/"),e}function cT(e,t){return t=typeof t<"u"?t:!1,e=uT(e),this.files[e]||lT.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}function $5(e,t,r){var n=new ud,a;return e._data instanceof ud?(n.uncompressedSize=e._data.uncompressedSize,n.crc32=e._data.crc32,n.uncompressedSize===0||e.dir?(t=Eg.STORE,n.compressedContent="",n.crc32=0):e._data.compressionMethod===t.magic?n.compressedContent=e._data.getCompressedContent():(a=e._data.getContent(),n.compressedContent=t.compress(tr.transformTo(t.compressInputType,a),r))):(a=bg(e),(!a||a.length===0||e.dir)&&(t=Eg.STORE,a=""),n.uncompressedSize=a.length,n.crc32=G1(a),n.compressedContent=t.compress(tr.transformTo(t.compressInputType,a),r)),n.compressedSize=n.compressedContent.length,n.compressionMethod=t.magic,n}function H5(e,t){var r=e;return e||(r=t?16893:33204),(r&65535)<<16}function V5(e){return(e||0)&63}function G5(e,t,r,n,a,i){var s=i!==il.utf8encode,o=tr.transformTo("string",i(t.name)),l=tr.transformTo("string",il.utf8encode(t.name)),u=t.comment||"",c=tr.transformTo("string",i(u)),h=tr.transformTo("string",il.utf8encode(u)),p=l.length!==t.name.length,x=h.length!==u.length,E=t.options,g,w,v="",y="",b="",T,N;t._initialMetadata.dir!==t.dir?T=t.dir:T=E.dir,t._initialMetadata.date!==t.date?N=t.date:N=E.date;var k=0,_=0;T&&(k|=16),a==="UNIX"?(_=798,k|=H5(t.unixPermissions,T)):(_=20,k|=V5(t.dosPermissions)),g=N.getHours(),g<<=6,g|=N.getMinutes(),g<<=5,g|=N.getSeconds()/2,w=N.getFullYear()-1980,w<<=4,w|=N.getMonth()+1,w<<=5,w|=N.getDate(),p&&(y=xr(1,1)+xr(G1(o),4)+l,v+="up"+xr(y.length,2)+y),x&&(b=xr(1,1)+xr(this.crc32(c),4)+h,v+="uc"+xr(b.length,2)+b);var S="";S+=`
\0`,S+=!s&&(p||x)?"\0\b":"\0\0",S+=r.compressionMethod,S+=xr(g,2),S+=xr(w,2),S+=xr(r.crc32,4),S+=xr(r.compressedSize,4),S+=xr(r.uncompressedSize,4),S+=xr(o.length,2),S+=xr(v.length,2);var A=wg.LOCAL_FILE_HEADER+S+o+v,P=wg.CENTRAL_FILE_HEADER+xr(_,2)+S+xr(c.length,2)+"\0\0\0\0"+xr(k,4)+xr(n,4)+o+v+c;return{fileRecord:A,dirRecord:P,compressedObject:r}}var fT=_g,Y5=pa;function dT(){this.data=null,this.length=0,this.index=0,this.zero=0}dT.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var r=0,n;for(this.checkOffset(t),n=this.index+t-1;n>=this.index;n--)r=(r<<8)+this.byteAt(n);return this.index+=t,r},readString:function(t){return Y5.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1)}};var hT=dT,X5=hT,K5=pa;function Xc(e,t){this.data=e,t||(this.data=K5.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}Xc.prototype=new X5;Xc.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};Xc.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};Xc.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var pT=Xc,Z5=hT;function Kc(e){if(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0;for(var t=0;t<this.data.length;t++)e[t]&=e[t]}}Kc.prototype=new Z5;Kc.prototype.byteAt=function(e){return this.data[this.zero+e]};Kc.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),i=this.length-4;i>=0;--i)if(this.data[i]===t&&this.data[i+1]===r&&this.data[i+2]===n&&this.data[i+3]===a)return i-this.zero;return-1};Kc.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var mT=Kc,Q5=mT;function X1(e){e&&(this.data=e,this.length=this.data.length,this.index=0,this.zero=0)}X1.prototype=new Q5;X1.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var gT=X1,J5=gT;function K1(e){this.data=e,this.length=this.data.length,this.index=0,this.zero=0}K1.prototype=new J5;K1.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};var e6=K1,fp=pT,wa=pa,t6=nT,As=fT,r6=fn,n6=0,a6=3;function xT(e,t){this.options=e,this.loadOptions=t}xT.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(t,r,n){return function(){var a=t.index;t.setIndex(r);var i=t.readData(n);return t.setIndex(a),i}},prepareContent:function(t,r,n,a,i){return function(){var s=wa.transformTo(a.uncompressInputType,this.getCompressedContent()),o=a.uncompress(s);if(o.length!==i)throw new Error("Bug : uncompressed data size mismatch");return o}},readLocalPart:function(t){t.skip(22),this.fileNameLength=t.readInt(2);var r=t.readInt(2);if(this.fileName=t.readData(this.fileNameLength),t.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");var n=wa.findCompression(this.compressionMethod);if(n===null)throw new Error("Corrupted zip : compression "+wa.pretty(this.compressionMethod)+" unknown (inner file : "+wa.transformTo("string",this.fileName)+")");if(this.decompressed=new t6,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,n),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,n,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=wa.transformTo("string",this.decompressed.getContent()),As.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readData(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),t===n6&&(this.dosPermissions=this.externalFileAttributes&63),t===a6&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=new fp(this.extraFields[1].value);this.uncompressedSize===wa.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===wa.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===wa.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===wa.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var r=t.index,n,a,i;for(this.extraFields=this.extraFields||{};t.index<r+this.extraFieldsLength;)n=t.readInt(2),a=t.readInt(2),i=t.readString(a),this.extraFields[n]={id:n,length:a,value:i}},handleUTF8:function(){var t=r6.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=As.utf8decode(this.fileName),this.fileCommentStr=As.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var n=wa.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var a=this.findExtraFieldUnicodeComment();if(a!==null)this.fileCommentStr=a;else{var i=wa.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var r=new fp(t.value);return r.readInt(1)!==1||As.crc32(this.fileName)!==r.readInt(4)?null:As.utf8decode(r.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var r=new fp(t.value);return r.readInt(1)!==1||As.crc32(this.fileComment)!==r.readInt(4)?null:As.utf8decode(r.readString(t.length-5))}return null}};var i6=xT,s6=pT,o6=e6,l6=gT,u6=mT,Un=pa,Ea=gs,c6=i6,Gf=fn;function vT(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}vT.prototype={checkSignature:function(t){var r=this.reader.readString(4);if(r!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+Un.pretty(r)+", expected "+Un.pretty(t)+")")},isSignature:function(t,r){var n=this.reader.index;this.reader.setIndex(t);var a=this.reader.readString(4),i=a===r;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),r=Gf.uint8array?"uint8array":"array",n=Un.transformTo(r,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t=this.zip64EndOfCentralSize-44,r=0,n,a,i;r<t;)n=this.reader.readInt(2),a=this.reader.readInt(4),i=this.reader.readString(a),this.zip64ExtensibleData[n]={id:n,length:a,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,r;for(t=0;t<this.files.length;t++)r=this.files[t],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(Ea.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===Ea.CENTRAL_FILE_HEADER;)t=new c6({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(Ea.CENTRAL_DIRECTORY_END);if(t<0){var r=!this.isSignature(0,Ea.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ?"):new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(t);var n=t;if(this.checkSignature(Ea.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===Un.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Un.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Un.MAX_VALUE_16BITS||this.centralDirRecords===Un.MAX_VALUE_16BITS||this.centralDirSize===Un.MAX_VALUE_32BITS||this.centralDirOffset===Un.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(Ea.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(Ea.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Ea.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Ea.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Ea.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);var i=n-a;if(i>0)this.isSignature(n,Ea.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){var r=Un.getTypeOf(t);if(Un.checkSupport(r),r==="string"&&!Gf.uint8array)this.reader=new s6(t,this.loadOptions.optimizedBinaryString);else if(r==="nodebuffer")this.reader=new o6(t);else if(Gf.uint8array)this.reader=new l6(Un.transformTo("uint8array",t));else if(Gf.array)this.reader=new u6(Un.transformTo("array",t));else throw new Error("Unexpected error: unsupported type '"+r+"'")},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var f6=vT,d6=Gc,h6=Zd,p6=pa,m6=f6,g6=function(e,t){var r,n;t=p6.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:h6.utf8decode}),t.base64&&(e=d6.decode(e));var a=new m6(e,t),i=a.files;for(r=0;r<i.length;r++)n=i[r],this.file(n.fileNameStr,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:t.createFolders});return a.zipComment.length&&(this.comment=a.zipComment),this},Ln={},Pn=pa;Ln.string2binary=function(e){return Pn.string2binary(e)};Ln.string2Uint8Array=function(e){return Pn.transformTo("uint8array",e)};Ln.uint8Array2String=function(e){return Pn.transformTo("string",e)};Ln.string2Blob=function(e){var t=Pn.transformTo("arraybuffer",e);return Pn.arrayBuffer2Blob(t)};Ln.arrayBuffer2Blob=function(e){return Pn.arrayBuffer2Blob(e)};Ln.transformTo=function(e,t){return Pn.transformTo(e,t)};Ln.getTypeOf=function(e){return Pn.getTypeOf(e)};Ln.checkSupport=function(e){return Pn.checkSupport(e)};Ln.MAX_VALUE_16BITS=Pn.MAX_VALUE_16BITS;Ln.MAX_VALUE_32BITS=Pn.MAX_VALUE_32BITS;Ln.pretty=function(e){return Pn.pretty(e)};Ln.findCompression=function(e){return Pn.findCompression(e)};Ln.isRegExp=function(e){return Pn.isRegExp(e)};(function(e){var t=Gc;function r(n,a){if(!(this instanceof r))return new r(n,a);this.files={},this.comment=null,this.root="",n&&this.load(n,a),this.clone=function(){var i=this,s=new r;return Object.keys(this.files).forEach(function(o){s.file(o,i.files[o].asUint8Array())}),s},this.shallowClone=function(){var i=new r;for(var s in this)typeof this[s]!="function"&&(i[s]=this[s]);return i}}r.prototype=fT,r.prototype.load=g6,r.support=fn,r.defaults=ma,r.utils=Ln,r.base64={encode:function(a){return t.encode(a)},decode:function(a){return t.decode(a)}},r.compressions=Yc,e.exports=r,e.exports.default=r})(J_);var x6=J_.exports;const v6=Pg(x6);var yT={exports:{}},It={},Er={};function y6(e,t,r){if(r===void 0&&(r=Array.prototype),e&&typeof r.find=="function")return r.find.call(e,t);for(var n=0;n<e.length;n++)if(lo(e,n)){var a=e[n];if(t.call(void 0,a,n,e))return a}}function Ol(e,t){return t===void 0&&(t=Object),t&&typeof t.getOwnPropertyDescriptors=="function"&&(e=t.create(null,t.getOwnPropertyDescriptors(e))),t&&typeof t.freeze=="function"?t.freeze(e):e}function lo(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function w6(e,t){if(e===null||typeof e!="object")throw new TypeError("target is not an object");for(var r in t)lo(t,r)&&(e[r]=t[r]);return e}var wT=Ol({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});function E6(e){return lo(wT,e.toLowerCase())}var ET=Ol({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function b6(e){return lo(ET,e.toLowerCase())}var yc=Ol({script:!1,style:!1,textarea:!0,title:!0});function _6(e){var t=e.toLowerCase();return lo(yc,t)&&!yc[t]}function T6(e){var t=e.toLowerCase();return lo(yc,t)&&yc[t]}function bT(e){return e===wc.HTML}function S6(e){return bT(e)||e===wc.XML_XHTML_APPLICATION}var wc=Ol({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),A6=Object.keys(wc).map(function(e){return wc[e]});function C6(e){return A6.indexOf(e)>-1}var D6=Ol({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Er.assign=w6;Er.find=y6;Er.freeze=Ol;Er.HTML_BOOLEAN_ATTRIBUTES=wT;Er.HTML_RAW_TEXT_ELEMENTS=yc;Er.HTML_VOID_ELEMENTS=ET;Er.hasDefaultHTMLNamespace=S6;Er.hasOwn=lo;Er.isHTMLBooleanAttribute=E6;Er.isHTMLRawTextElement=_6;Er.isHTMLEscapableRawTextElement=T6;Er.isHTMLMimeType=bT;Er.isHTMLVoidElement=b6;Er.isValidMimeType=C6;Er.MIME_TYPE=wc;Er.NAMESPACE=D6;var xs={},N6=Er;function _T(e,t){e.prototype=Object.create(Error.prototype,{constructor:{value:e},name:{value:e.name,enumerable:!0,writable:t}})}var Ec=N6.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),TT=Object.keys(Ec);function ST(e){return typeof e=="number"&&e>=1&&e<=25}function k6(e){return typeof e=="string"&&e.substring(e.length-Ec.Error.length)===Ec.Error}function Zc(e,t){ST(e)?(this.name=TT[e],this.message=t||""):(this.message=e,this.name=k6(t)?t:Ec.Error),Error.captureStackTrace&&Error.captureStackTrace(this,Zc)}_T(Zc,!0);Object.defineProperties(Zc.prototype,{code:{enumerable:!0,get:function(){var e=TT.indexOf(this.name);return ST(e)?e:0}}});var AT={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},dp=Object.entries(AT);for(var Yf=0;Yf<dp.length;Yf++){var O6=dp[Yf][0];Zc[O6]=dp[Yf][1]}function Z1(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,Z1)}_T(Z1);xs.DOMException=Zc;xs.DOMExceptionName=Ec;xs.ExceptionCode=AT;xs.ParseError=Z1;var br={},Et={};function CT(e){try{typeof e!="function"&&(e=RegExp);var t=new e("","u").exec("");return!!t&&t[0].length===2}catch{}return!1}var Qc=CT();function Js(e){if(e.source[0]!=="[")throw new Error(e+" can not be used with chars");return e.source.slice(1,e.source.lastIndexOf("]"))}function wl(e,t){if(e.source[0]!=="[")throw new Error("/"+e.source+"/ can not be used with chars_without");if(!t||typeof t!="string")throw new Error(JSON.stringify(t)+" is not a valid search");if(e.source.indexOf(t)===-1)throw new Error('"'+t+'" is not is /'+e.source+"/");if(t==="-"&&e.source.indexOf(t)!==1)throw new Error('"'+t+'" is not at the first postion of /'+e.source+"/");return new RegExp(e.source.replace(t,""),Qc?"u":"")}function Nt(e){var t=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(r){var n=typeof r=="string";if(n&&t===void 0&&r==="|")throw new Error("use regg instead of reg to wrap expressions with `|`!");return n?r:r.source}).join(""),Qc?"mu":"m")}function pt(e){if(arguments.length===0)throw new Error("no parameters provided");return Nt.apply(pt,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var F6="",eo=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;Qc&&(eo=Nt("[",Js(eo),"\\u{10000}-\\u{10FFFF}","]"));var Q1=/[\x20\x09\x0D\x0A]/,P6=Js(Q1),Yt=Nt(Q1,"+"),hr=Nt(Q1,"*"),bc=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;Qc&&(bc=Nt("[",Js(bc),"\\u{10000}-\\u{10FFFF}","]"));var I6=Js(bc),J1=Nt("[",I6,Js(/[-.0-9\xB7]/),Js(/[\u0300-\u036F\u203F-\u2040]/),"]"),ha=Nt(bc,J1,"*"),$2=Nt(J1,"+"),R6=Nt("&",ha,";"),L6=pt(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),_c=pt(R6,"|",L6),Tc=Nt("%",ha,";"),ex=pt(Nt('"',pt(/[^%&"]/,"|",Tc,"|",_c),"*",'"'),"|",Nt("'",pt(/[^%&']/,"|",Tc,"|",_c),"*","'")),M6=pt('"',pt(/[^<&"]/,"|",_c),"*",'"',"|","'",pt(/[^<&']/,"|",_c),"*","'"),j6=wl(bc,":"),B6=wl(J1,":"),H2=Nt(j6,B6,"*"),Jc=Nt(H2,pt(":",H2),"?"),U6=Nt("^",Jc,"$"),z6=Nt("(",Jc,")"),Sc=pt(/"[^"]*"|'[^']*'/),W6=Nt(/^<\?/,"(",ha,")",pt(Yt,"(",eo,"*?)"),"?",/\?>/),V2=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,Qd=pt('"',V2,'*"',"|","'",wl(V2,"'"),"*'"),DT="<!--",NT="-->",q6=Nt(DT,pt(wl(eo,"-"),"|",Nt("-",wl(eo,"-"))),"*",NT),G2="#PCDATA",$6=pt(Nt(/\(/,hr,G2,pt(hr,/\|/,hr,Jc),"*",hr,/\)\*/),"|",Nt(/\(/,hr,G2,hr,/\)/)),H6=/[?*+]?/,V6=Nt(/\([^>]+\)/,H6),G6=pt("EMPTY","|","ANY","|",$6,"|",V6),Y6="<!ELEMENT",X6=Nt(Y6,Yt,pt(Jc,"|",Tc),Yt,pt(G6,"|",Tc),hr,">"),K6=Nt("NOTATION",Yt,/\(/,hr,ha,pt(hr,/\|/,hr,ha),"*",hr,/\)/),Z6=Nt(/\(/,hr,$2,pt(hr,/\|/,hr,$2),"*",hr,/\)/),Q6=pt(K6,"|",Z6),J6=pt(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",Q6),e8=pt(/#REQUIRED|#IMPLIED/,"|",pt(pt("#FIXED",Yt),"?",M6)),t8=pt(Yt,ha,Yt,J6,Yt,e8),r8="<!ATTLIST",n8=Nt(r8,Yt,ha,t8,"*",hr,">"),Tg="about:legacy-compat",a8=pt('"'+Tg+'"',"|","'"+Tg+"'"),tx="SYSTEM",Jd="PUBLIC",eh=pt(pt(tx,Yt,Sc),"|",pt(Jd,Yt,Qd,Yt,Sc)),i8=Nt("^",pt(pt(tx,Yt,"(?<SystemLiteralOnly>",Sc,")"),"|",pt(Jd,Yt,"(?<PubidLiteral>",Qd,")",Yt,"(?<SystemLiteral>",Sc,")"))),s8=pt(Yt,"NDATA",Yt,ha),o8=pt(ex,"|",pt(eh,s8,"?")),kT="<!ENTITY",l8=Nt(kT,Yt,ha,Yt,o8,hr,">"),u8=pt(ex,"|",eh),c8=Nt(kT,Yt,"%",Yt,ha,Yt,u8,hr,">"),f8=pt(l8,"|",c8),d8=Nt(Jd,Yt,Qd),h8=Nt("<!NOTATION",Yt,ha,Yt,pt(eh,"|",d8),hr,">"),rx=Nt(hr,"=",hr),Y2=/1[.]\d+/,p8=Nt(Yt,"version",rx,pt("'",Y2,"'","|",'"',Y2,'"')),X2=/[A-Za-z][-A-Za-z0-9._]*/,m8=pt(Yt,"encoding",rx,pt('"',X2,'"',"|","'",X2,"'")),g8=pt(Yt,"standalone",rx,pt("'",pt("yes","|","no"),"'","|",'"',pt("yes","|","no"),'"')),x8=Nt(/^<\?xml/,p8,m8,"?",g8,"?",hr,/\?>/),v8="<!DOCTYPE",y8="<![CDATA[",w8="]]>",E8=/<!\[CDATA\[/,b8=/\]\]>/,_8=Nt(eo,"*?",b8),T8=Nt(E8,_8);Et.chars=Js;Et.chars_without=wl;Et.detectUnicodeSupport=CT;Et.reg=Nt;Et.regg=pt;Et.ABOUT_LEGACY_COMPAT=Tg;Et.ABOUT_LEGACY_COMPAT_SystemLiteral=a8;Et.AttlistDecl=n8;Et.CDATA_START=y8;Et.CDATA_END=w8;Et.CDSect=T8;Et.Char=eo;Et.Comment=q6;Et.COMMENT_START=DT;Et.COMMENT_END=NT;Et.DOCTYPE_DECL_START=v8;Et.elementdecl=X6;Et.EntityDecl=f8;Et.EntityValue=ex;Et.ExternalID=eh;Et.ExternalID_match=i8;Et.Name=ha;Et.NotationDecl=h8;Et.Reference=_c;Et.PEReference=Tc;Et.PI=W6;Et.PUBLIC=Jd;Et.PubidLiteral=Qd;Et.QName=Jc;Et.QName_exact=U6;Et.QName_group=z6;Et.S=Yt;Et.SChar_s=P6;Et.S_OPT=hr;Et.SYSTEM=tx;Et.SystemLiteral=Sc;Et.UNICODE_REPLACEMENT_CHARACTER=F6;Et.UNICODE_SUPPORT=Qc;Et.XMLDecl=x8;var ca=Er,Ka=ca.find,S8=ca.hasDefaultHTMLNamespace,El=ca.hasOwn,A8=ca.isHTMLMimeType,C8=ca.isHTMLRawTextElement,D8=ca.isHTMLVoidElement,gu=ca.MIME_TYPE,Za=ca.NAMESPACE,xn=Symbol(),OT=xs,ut=OT.DOMException,N8=OT.DOMExceptionName,Va=Et;function Mn(e){if(e!==xn)throw new TypeError("Illegal constructor")}function k8(e){return e!==""}function O8(e){return e?e.split(/[\t\n\f\r ]+/).filter(k8):[]}function F8(e,t){return El(e,t)||(e[t]=!0),e}function K2(e){if(!e)return[];var t=O8(e);return Object.keys(t.reduce(F8,{}))}function P8(e){return function(t){return e&&e.indexOf(t)!==-1}}function FT(e){if(!Va.QName_exact.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+e+'"')}function Sg(e,t){FT(t),e=e||null;var r=null,n=t;if(t.indexOf(":")>=0){var a=t.split(":");r=a[0],n=a[1]}if(r!==null&&e===null)throw new ut(ut.NAMESPACE_ERR,"prefix is non-null and namespace is null");if(r==="xml"&&e!==ca.NAMESPACE.XML)throw new ut(ut.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if((r==="xmlns"||t==="xmlns")&&e!==ca.NAMESPACE.XMLNS)throw new ut(ut.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(e===ca.NAMESPACE.XMLNS&&r!=="xmlns"&&t!=="xmlns")throw new ut(ut.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[e,r,n]}function Fl(e,t){for(var r in e)El(e,r)&&(t[r]=e[r])}function jn(e,t){var r=e.prototype;if(!(r instanceof t)){let a=function(){};var n=a;a.prototype=t.prototype,a=new a,Fl(r,a),e.prototype=r=a}r.constructor!=e&&(typeof e!="function"&&console.error("unknown Class:"+e),r.constructor=e)}var Bn={},Da=Bn.ELEMENT_NODE=1,bl=Bn.ATTRIBUTE_NODE=2,cd=Bn.TEXT_NODE=3,PT=Bn.CDATA_SECTION_NODE=4,IT=Bn.ENTITY_REFERENCE_NODE=5,I8=Bn.ENTITY_NODE=6,RT=Bn.PROCESSING_INSTRUCTION_NODE=7,LT=Bn.COMMENT_NODE=8,Ac=Bn.DOCUMENT_NODE=9,MT=Bn.DOCUMENT_TYPE_NODE=10,ss=Bn.DOCUMENT_FRAGMENT_NODE=11,R8=Bn.NOTATION_NODE=12,gr=ca.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function jT(e,t){if(t.length<e.length)return jT(t,e);var r=null;for(var n in e){if(e[n]!==t[n])return r;r=e[n]}return r}function Z2(e){return e.guid||(e.guid=Math.random()),e.guid}function kr(){}kr.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e){for(var t=[],r=0;r<this.length;r++)Vo(this[r],t,e);return t.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};kr.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function qs(e,t){this._node=e,this._refresh=t,th(this)}function th(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(KT(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)El(e,n)&&delete e[n];Fl(r,e),e._inc=t}}qs.prototype.item=function(e){return th(this),this[e]||null};jn(qs,kr);function _l(){}function BT(e,t){for(var r=0;r<e.length;){if(e[r]===t)return r;r++}}function L8(e,t,r,n){if(n?t[BT(t,n)]=r:(t[t.length]=r,t.length++),e){r.ownerElement=e;var a=e.ownerDocument;a&&(n&&WT(a,e,n),M8(a,e,r))}}function Q2(e,t,r){var n=BT(t,r);if(n>=0){for(var a=t.length-1;n<=a;)t[n]=t[++n];if(t.length=a,e){var i=e.ownerDocument;i&&WT(i,e,r),r.ownerElement=null}}}_l.prototype={length:0,item:kr.prototype.item,getNamedItem:function(e){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());for(var t=0;t<this.length;){var r=this[t];if(r.nodeName===e)return r;t++}return null},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!==this._ownerElement)throw new ut(ut.INUSE_ATTRIBUTE_ERR);var r=this.getNamedItemNS(e.namespaceURI,e.localName);return r===e?e:(L8(this._ownerElement,this,e,r),r)},setNamedItemNS:function(e){return this.setNamedItem(e)},removeNamedItem:function(e){var t=this.getNamedItem(e);if(!t)throw new ut(ut.NOT_FOUND_ERR,e);return Q2(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);if(!r)throw new ut(ut.NOT_FOUND_ERR,e?e+" : "+t:t);return Q2(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){e||(e=null);for(var r=0;r<this.length;){var n=this[r];if(n.localName===t&&n.namespaceURI===e)return n;r++}return null}};_l.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}};function UT(){}UT.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=gu.XML_APPLICATION;e===Za.HTML?n=gu.XML_XHTML_APPLICATION:e===Za.SVG&&(n=gu.XML_SVG_IMAGE);var a=new os(xn,{contentType:n});if(a.implementation=this,a.childNodes=new kr,a.doctype=r||null,r&&a.appendChild(r),t){var i=a.createElementNS(e,t);a.appendChild(i)}return a},createDocumentType:function(e,t,r,n){FT(e);var a=new ah(xn);return a.name=e,a.nodeName=e,a.publicId=t||"",a.systemId=r||"",a.internalSubset=n||"",a.childNodes=new kr,a},createHTMLDocument:function(e){var t=new os(xn,{contentType:gu.HTML});if(t.implementation=this,t.childNodes=new kr,e!==!1){t.doctype=this.createDocumentType("html"),t.doctype.ownerDocument=t,t.appendChild(t.doctype);var r=t.createElement("html");t.appendChild(r);var n=t.createElement("head");if(r.appendChild(n),typeof e=="string"){var a=t.createElement("title");a.appendChild(t.createTextNode(e)),n.appendChild(a)}r.appendChild(t.createElement("body"))}return t}};function Pt(e){Mn(e)}Pt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var e=this.getRootNode();return e&&e.nodeType===e.DOCUMENT_NODE},contains:function(e){if(!e)return!1;var t=e;do{if(this===t)return!0;t=e.parentNode}while(t);return!1},getRootNode:function(e){var t=this;do{if(!t.parentNode)return t;t=t.parentNode}while(t)},isEqualNode:function(e){if(!e||this.nodeType!==e.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==e.name||this.publicId!==e.publicId||this.systemId!==e.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==e.namespaceURI||this.prefix!==e.prefix||this.localName!==e.localName||this.attributes.length!==e.attributes.length)return!1;for(var t=0;t<this.attributes.length;t++){var r=this.attributes.item(t);if(!r.isEqualNode(e.getAttributeNodeNS(r.namespaceURI,r.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==e.namespaceURI||this.localName!==e.localName||this.value!==e.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==e.target||this.data!==e.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==e.data)return!1;break}if(this.childNodes.length!==e.childNodes.length)return!1;for(var t=0;t<this.childNodes.length;t++)if(!this.childNodes[t].isEqualNode(e.childNodes[t]))return!1;return!0},isSameNode:function(e){return this===e},insertBefore:function(e,t){return fd(this,e,t)},replaceChild:function(e,t){fd(this,e,t,VT),t&&this.removeChild(t)},removeChild:function(e){return $T(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return Ag(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==cd&&e.nodeType==cd?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r){for(var n in r)if(El(r,n)&&r[n]===e)return n}t=t.nodeType==bl?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&El(r,e))return r[e];t=t.nodeType==bl?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null},compareDocumentPosition:function(e){if(this===e)return 0;var t=e,r=this,n=null,a=null;if(t instanceof to&&(n=t,t=n.ownerElement),r instanceof to&&(a=r,r=a.ownerElement,n&&t&&r===t))for(var i=0,s;s=r.attributes[i];i++){if(s===n)return gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+gr.DOCUMENT_POSITION_PRECEDING;if(s===a)return gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+gr.DOCUMENT_POSITION_FOLLOWING}if(!t||!r||r.ownerDocument!==t.ownerDocument)return gr.DOCUMENT_POSITION_DISCONNECTED+gr.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(Z2(r.ownerDocument)>Z2(t.ownerDocument)?gr.DOCUMENT_POSITION_FOLLOWING:gr.DOCUMENT_POSITION_PRECEDING);if(a&&t===r)return gr.DOCUMENT_POSITION_CONTAINS+gr.DOCUMENT_POSITION_PRECEDING;if(n&&t===r)return gr.DOCUMENT_POSITION_CONTAINED_BY+gr.DOCUMENT_POSITION_FOLLOWING;for(var o=[],l=t.parentNode;l;){if(!a&&l===r)return gr.DOCUMENT_POSITION_CONTAINED_BY+gr.DOCUMENT_POSITION_FOLLOWING;o.push(l),l=l.parentNode}o.reverse();for(var u=[],c=r.parentNode;c;){if(!n&&c===t)return gr.DOCUMENT_POSITION_CONTAINS+gr.DOCUMENT_POSITION_PRECEDING;u.push(c),c=c.parentNode}u.reverse();var h=jT(o,u);for(var p in h.childNodes){var x=h.childNodes[p];if(x===r)return gr.DOCUMENT_POSITION_FOLLOWING;if(x===t)return gr.DOCUMENT_POSITION_PRECEDING;if(u.indexOf(x)>=0)return gr.DOCUMENT_POSITION_FOLLOWING;if(o.indexOf(x)>=0)return gr.DOCUMENT_POSITION_PRECEDING}return 0}};function zT(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}Fl(Bn,Pt);Fl(Bn,Pt.prototype);Fl(gr,Pt);Fl(gr,Pt.prototype);function Lu(e,t){if(t(e))return!0;if(e=e.firstChild)do if(Lu(e,t))return!0;while(e=e.nextSibling)}function os(e,t){Mn(e);var r=t||{};this.ownerDocument=this,this.contentType=r.contentType||gu.XML_APPLICATION,this.type=A8(this.contentType)?"html":"xml"}function M8(e,t,r){e&&e._inc++;var n=r.namespaceURI;n===Za.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}function WT(e,t,r,n){e&&e._inc++;var a=r.namespaceURI;a===Za.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function qT(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r&&!r.nextSibling)n[n.length++]=r;else{for(var a=t.firstChild,i=0;a;)n[i++]=a,a=a.nextSibling;n.length=i,delete n[n.length]}}}function $T(e,t){if(e!==t.parentNode)throw new ut(ut.NOT_FOUND_ERR,"child's parent is not parent");var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,qT(e.ownerDocument,e),t.parentNode=null,t.previousSibling=null,t.nextSibling=null,t}function j8(e){return e&&(e.nodeType===Pt.DOCUMENT_NODE||e.nodeType===Pt.DOCUMENT_FRAGMENT_NODE||e.nodeType===Pt.ELEMENT_NODE)}function B8(e){return e&&(e.nodeType===Pt.CDATA_SECTION_NODE||e.nodeType===Pt.COMMENT_NODE||e.nodeType===Pt.DOCUMENT_FRAGMENT_NODE||e.nodeType===Pt.DOCUMENT_TYPE_NODE||e.nodeType===Pt.ELEMENT_NODE||e.nodeType===Pt.PROCESSING_INSTRUCTION_NODE||e.nodeType===Pt.TEXT_NODE)}function ls(e){return e&&e.nodeType===Pt.DOCUMENT_TYPE_NODE}function pi(e){return e&&e.nodeType===Pt.ELEMENT_NODE}function HT(e){return e&&e.nodeType===Pt.TEXT_NODE}function J2(e,t){var r=e.childNodes||[];if(Ka(r,pi)||ls(t))return!1;var n=Ka(r,ls);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function ey(e,t){var r=e.childNodes||[];function n(i){return pi(i)&&i!==t}if(Ka(r,n))return!1;var a=Ka(r,ls);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function U8(e,t,r){if(!j8(e))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new ut(ut.NOT_FOUND_ERR,"child not in parent");if(!B8(t)||ls(t)&&e.nodeType!==Pt.DOCUMENT_NODE)throw new ut(ut.HIERARCHY_REQUEST_ERR,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)}function z8(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===Pt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(pi);if(i.length>1||Ka(a,HT))throw new ut(ut.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(i.length===1&&!J2(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(pi(t)&&!J2(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(ls(t)){if(Ka(n,ls))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=Ka(n,pi);if(r&&n.indexOf(s)<n.indexOf(r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!r&&s)throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function VT(e,t,r){var n=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===Pt.DOCUMENT_FRAGMENT_NODE){var i=a.filter(pi);if(i.length>1||Ka(a,HT))throw new ut(ut.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(i.length===1&&!ey(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(pi(t)&&!ey(e,r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(ls(t)){let l=function(u){return ls(u)&&u!==r};var o=l;if(Ka(n,l))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=Ka(n,pi);if(r&&n.indexOf(s)<n.indexOf(r))throw new ut(ut.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function fd(e,t,r,n){U8(e,t,r),e.nodeType===Pt.DOCUMENT_NODE&&(n||z8)(e,t,r);var a=t.parentNode;if(a&&a.removeChild(t),t.nodeType===ss){var i=t.firstChild;if(i==null)return t;var s=t.lastChild}else i=s=t;var o=r?r.previousSibling:e.lastChild;i.previousSibling=o,s.nextSibling=r,o?o.nextSibling=i:e.firstChild=i,r==null?e.lastChild=s:r.previousSibling=s;do i.parentNode=e;while(i!==s&&(i=i.nextSibling));return qT(e.ownerDocument||e,e,t),t.nodeType==ss&&(t.firstChild=t.lastChild=null),t}os.prototype={implementation:null,nodeName:"#document",nodeType:Ac,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType===ss){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return fd(this,e,t),e.ownerDocument=this,this.documentElement===null&&e.nodeType===Da&&(this.documentElement=e),e},removeChild:function(e){var t=$T(this,e);return t===this.documentElement&&(this.documentElement=null),t},replaceChild:function(e,t){fd(this,e,t,VT),e.ownerDocument=this,t&&this.removeChild(t),pi(e)&&(this.documentElement=e)},importNode:function(e,t){return XT(this,e,t)},getElementById:function(e){var t=null;return Lu(this.documentElement,function(r){if(r.nodeType==Da&&r.getAttribute("id")==e)return t=r,!0}),t},createElement:function(e){var t=new us(xn);t.ownerDocument=this,this.type==="html"&&(e=e.toLowerCase()),S8(this.contentType)&&(t.namespaceURI=Za.HTML),t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new kr;var r=t.attributes=new _l;return r._ownerElement=t,t},createDocumentFragment:function(){var e=new tf(xn);return e.ownerDocument=this,e.childNodes=new kr,e},createTextNode:function(e){var t=new ef(xn);return t.ownerDocument=this,t.childNodes=new kr,t.appendData(e),t},createComment:function(e){var t=new rh(xn);return t.ownerDocument=this,t.childNodes=new kr,t.appendData(e),t},createCDATASection:function(e){var t=new nh(xn);return t.ownerDocument=this,t.childNodes=new kr,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new sh(xn);return r.ownerDocument=this,r.childNodes=new kr,r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){if(!Va.QName_exact.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'invalid character in name "'+e+'"');return this.type==="html"&&(e=e.toLowerCase()),this._createAttribute(e)},_createAttribute:function(e){var t=new to(xn);return t.ownerDocument=this,t.childNodes=new kr,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){if(!Va.Name.test(e))throw new ut(ut.INVALID_CHARACTER_ERR,'not a valid xml name "'+e+'"');if(this.type==="html")throw new ut("document is an html document",N8.NotSupportedError);var t=new ih(xn);return t.ownerDocument=this,t.childNodes=new kr,t.nodeName=e,t},createElementNS:function(e,t){var r=Sg(e,t),n=new us(xn),a=n.attributes=new _l;return n.childNodes=new kr,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],a._ownerElement=n,n},createAttributeNS:function(e,t){var r=Sg(e,t),n=new to(xn);return n.ownerDocument=this,n.childNodes=new kr,n.nodeName=t,n.name=t,n.specified=!0,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],n}};jn(os,Pt);function us(e){Mn(e),this._nsMap=Object.create(null)}us.prototype={nodeType:Da,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return this.ownerDocument.type==="html"&&this.namespaceURI===Za.HTML},hasAttributes:function(){return!!(this.attributes&&this.attributes.length)},hasAttribute:function(e){return!!this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t?t.value:null},getAttributeNode:function(e){return this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase()),this.attributes.getNamedItem(e)},setAttribute:function(e,t){this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());var r=this.getAttributeNode(e);r?r.value=r.nodeValue=""+t:(r=this.ownerDocument._createAttribute(e),r.value=r.nodeValue=""+t,this.setAttributeNode(r))},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r?r.value:null},setAttributeNS:function(e,t,r){var n=Sg(e,t),a=n[2],i=this.getAttributeNodeNS(e,a);i?i.value=i.nodeValue=""+r:(i=this.ownerDocument.createAttributeNS(e,t),i.value=i.nodeValue=""+r,this.setAttributeNode(i))},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByClassName:function(e){var t=K2(e);return new qs(this,function(r){var n=[];return t.length>0&&Lu(r,function(a){if(a!==r&&a.nodeType===Da){var i=a.getAttribute("class");if(i){var s=e===i;if(!s){var o=K2(i);s=t.every(P8(o))}s&&n.push(a)}}}),n})},getElementsByTagName:function(e){var t=(this.nodeType===Ac?this:this.ownerDocument).type==="html",r=e.toLowerCase();return new qs(this,function(n){var a=[];return Lu(n,function(i){if(!(i===n||i.nodeType!==Da))if(e==="*")a.push(i);else{var s=i.getQualifiedName(),o=t&&i.namespaceURI===Za.HTML?r:e;s===o&&a.push(i)}}),a})},getElementsByTagNameNS:function(e,t){return new qs(this,function(r){var n=[];return Lu(r,function(a){a!==r&&a.nodeType===Da&&(e==="*"||a.namespaceURI===e)&&(t==="*"||a.localName==t)&&n.push(a)}),n})}};os.prototype.getElementsByClassName=us.prototype.getElementsByClassName;os.prototype.getElementsByTagName=us.prototype.getElementsByTagName;os.prototype.getElementsByTagNameNS=us.prototype.getElementsByTagNameNS;jn(us,Pt);function to(e){Mn(e),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}to.prototype.nodeType=bl;jn(to,Pt);function Pl(e){Mn(e)}Pl.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){var n=this.data.substring(0,e),a=this.data.substring(e+t);r=n+r+a,this.nodeValue=this.data=r,this.length=r.length}};jn(Pl,Pt);function ef(e){Mn(e)}ef.prototype={nodeName:"#text",nodeType:cd,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};jn(ef,Pl);function rh(e){Mn(e)}rh.prototype={nodeName:"#comment",nodeType:LT};jn(rh,Pl);function nh(e){Mn(e)}nh.prototype={nodeName:"#cdata-section",nodeType:PT};jn(nh,ef);function ah(e){Mn(e)}ah.prototype.nodeType=MT;jn(ah,Pt);function nx(e){Mn(e)}nx.prototype.nodeType=R8;jn(nx,Pt);function ax(e){Mn(e)}ax.prototype.nodeType=I8;jn(ax,Pt);function ih(e){Mn(e)}ih.prototype.nodeType=IT;jn(ih,Pt);function tf(e){Mn(e)}tf.prototype.nodeName="#document-fragment";tf.prototype.nodeType=ss;jn(tf,Pt);function sh(e){Mn(e)}sh.prototype.nodeType=RT;jn(sh,Pl);function GT(){}GT.prototype.serializeToString=function(e,t){return YT.call(e,t)};Pt.prototype.toString=YT;function YT(e){var t=[],r=this.nodeType===Ac&&this.documentElement||this,n=r.prefix,a=r.namespaceURI;if(a&&n==null){var n=r.lookupPrefix(a);if(n==null)var i=[{namespace:a,prefix:null}]}return Vo(this,t,e,i),t.join("")}function ty(e,t,r){var n=e.prefix||"",a=e.namespaceURI;if(!a||n==="xml"&&a===Za.XML||a===Za.XMLNS)return!1;for(var i=r.length;i--;){var s=r[i];if(s.prefix===n)return s.namespace!==a}return!0}function hp(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,zT),'"')}function Vo(e,t,r,n){n||(n=[]);var a=e.nodeType===Ac?e:e.ownerDocument,i=a.type==="html";if(r)if(e=r(e),e){if(typeof e=="string"){t.push(e);return}}else return;switch(e.nodeType){case Da:var s=e.attributes,o=s.length,b=e.firstChild,l=e.tagName,u=l;if(!i&&!e.prefix&&e.namespaceURI){for(var c,h=0;h<s.length;h++)if(s.item(h).name==="xmlns"){c=s.item(h).value;break}if(!c)for(var p=n.length-1;p>=0;p--){var x=n[p];if(x.prefix===""&&x.namespace===e.namespaceURI){c=x.namespace;break}}if(c!==e.namespaceURI)for(var p=n.length-1;p>=0;p--){var x=n[p];if(x.namespace===e.namespaceURI){x.prefix&&(u=x.prefix+":"+l);break}}}t.push("<",u);for(var E=0;E<o;E++){var g=s.item(E);g.prefix=="xmlns"?n.push({prefix:g.localName,namespace:g.value}):g.nodeName=="xmlns"&&n.push({prefix:"",namespace:g.value})}for(var E=0;E<o;E++){var g=s.item(E);if(ty(g,i,n)){var w=g.prefix||"",v=g.namespaceURI;hp(t,w?"xmlns:"+w:"xmlns",v),n.push({prefix:w,namespace:v})}Vo(g,t,r,n)}if(l===u&&ty(e,i,n)){var w=e.prefix||"",v=e.namespaceURI;hp(t,w?"xmlns:"+w:"xmlns",v),n.push({prefix:w,namespace:v})}var y=!b;if(y&&(i||e.namespaceURI===Za.HTML)&&(y=D8(l)),y)t.push("/>");else{if(t.push(">"),i&&C8(l))for(;b;)b.data?t.push(b.data):Vo(b,t,r,n.slice()),b=b.nextSibling;else for(;b;)Vo(b,t,r,n.slice()),b=b.nextSibling;t.push("</",u,">")}return;case Ac:case ss:for(var b=e.firstChild;b;)Vo(b,t,r,n.slice()),b=b.nextSibling;return;case bl:return hp(t,e.name,e.value);case cd:return t.push(e.data.replace(/[<&>]/g,zT));case PT:return t.push(Va.CDATA_START,e.data,Va.CDATA_END);case LT:return t.push(Va.COMMENT_START,e.data,Va.COMMENT_END);case MT:var T=e.publicId,N=e.systemId;t.push(Va.DOCTYPE_DECL_START," ",e.name),T?(t.push(" ",Va.PUBLIC," ",T),N&&N!=="."&&t.push(" ",N)):N&&N!=="."&&t.push(" ",Va.SYSTEM," ",N),e.internalSubset&&t.push(" [",e.internalSubset,"]"),t.push(">");return;case RT:return t.push("<?",e.target," ",e.data,"?>");case IT:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function XT(e,t,r){var n;switch(t.nodeType){case Da:n=t.cloneNode(!1),n.ownerDocument=e;case ss:break;case bl:r=!0;break}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var a=t.firstChild;a;)n.appendChild(XT(e,a,r)),a=a.nextSibling;return n}function Ag(e,t,r){var n=new t.constructor(xn);for(var a in t)if(El(t,a)){var i=t[a];typeof i!="object"&&i!=n[a]&&(n[a]=i)}switch(t.childNodes&&(n.childNodes=new kr),n.ownerDocument=e,n.nodeType){case Da:var s=t.attributes,o=n.attributes=new _l,l=s.length;o._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(Ag(e,s.item(u),!0));break;case bl:r=!0}if(r)for(var c=t.firstChild;c;)n.appendChild(Ag(e,c,r)),c=c.nextSibling;return n}function KT(e,t,r){e[t]=r}try{if(Object.defineProperty){let e=function(t){switch(t.nodeType){case Da:case ss:var r=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&r.push(e(t)),t=t.nextSibling;return r.join("");default:return t.nodeValue}};var qB=e;Object.defineProperty(qs.prototype,"length",{get:function(){return th(this),this.$$length}}),Object.defineProperty(Pt.prototype,"textContent",{get:function(){return e(this)},set:function(t){switch(this.nodeType){case Da:case ss:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),KT=function(t,r,n){t["$$"+r]=n}}}catch{}br._updateLiveList=th;br.Attr=to;br.CDATASection=nh;br.CharacterData=Pl;br.Comment=rh;br.Document=os;br.DocumentFragment=tf;br.DocumentType=ah;br.DOMImplementation=UT;br.Element=us;br.Entity=ax;br.EntityReference=ih;br.LiveNodeList=qs;br.NamedNodeMap=_l;br.Node=Pt;br.NodeList=kr;br.Notation=nx;br.Text=ef;br.ProcessingInstruction=sh;br.XMLSerializer=GT;var Il={},ZT={};(function(e){var t=Er.freeze;e.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),e.entityMap=e.HTML_ENTITIES})(ZT);var oh={},Rl=Er,wt=Et,QT=xs,W8=Rl.isHTMLEscapableRawTextElement,q8=Rl.isHTMLMimeType,$8=Rl.isHTMLRawTextElement,Cc=Rl.hasOwn,ry=Rl.NAMESPACE,ny=QT.ParseError,H8=QT.DOMException,iu=0,Fi=1,_o=2,su=3,To=4,So=5,ou=6,Xf=7;function JT(){}JT.prototype={parse:function(e,t,r){var n=this.domBuilder;n.startDocument(),eS(t,t=Object.create(null)),V8(e,t,r,n,this.errorHandler),n.endDocument()}};var ix=/&#?\w+;?/g;function V8(e,t,r,n,a){var i=q8(n.mimeType);e.indexOf(wt.UNICODE_REPLACEMENT_CHARACTER)>=0&&a.warning("Unicode replacement character detected, source encoding issues?");function s(ce){if(ce>65535){ce-=65536;var De=55296+(ce>>10),Ve=56320+(ce&1023);return String.fromCharCode(De,Ve)}else return String.fromCharCode(ce)}function o(ce){var De=ce[ce.length-1]===";"?ce:ce+";";if(!i&&De!==ce)return a.error("EntityRef: expecting ;"),ce;var Ve=wt.Reference.exec(De);if(!Ve||Ve[0].length!==De.length)return a.error("entity not matching Reference production: "+ce),ce;var Y=De.slice(1,-1);return Cc(r,Y)?r[Y]:Y.charAt(0)==="#"?s(parseInt(Y.substring(1).replace("x","0x"))):(a.error("entity not found:"+ce),ce)}function l(ce){if(ce>w){var De=e.substring(w,ce).replace(ix,o);p&&x(w),n.characters(De,0,ce-w),w=ce}}var u=0,c=0,h=/\r\n?|\n|$/g,p=n.locator;function x(ce,De){for(;ce>=c&&(De=h.exec(e));)u=c,c=De.index+De[0].length,p.lineNumber++;p.columnNumber=ce-u+1}for(var E=[{currentNSMap:t}],g=[],w=0;;){try{var v=e.indexOf("<",w);if(v<0){if(!i&&g.length>0)return a.fatalError("unclosed xml tag(s): "+g.join(", "));if(!e.substring(w).match(/^\s*$/)){var y=n.doc,b=y.createTextNode(e.substring(w));if(y.documentElement)return a.error("Extra content at the end of the document");y.appendChild(b),n.currentElement=b}return}if(v>w){var T=e.substring(w,v);!i&&g.length===0&&(T=T.replace(new RegExp(wt.S_OPT.source,"g"),""),T&&a.error("Unexpected content outside root element: '"+T+"'")),l(v)}switch(e.charAt(v+1)){case"/":var oe=e.indexOf(">",v+2),N=e.substring(v+2,oe>0?oe:void 0);if(!N)return a.fatalError("end tag name missing");var k=oe>0&&wt.reg("^",wt.QName_group,wt.S_OPT,"$").exec(N);if(!k)return a.fatalError('end tag name contains invalid characters: "'+N+'"');if(!n.currentElement&&!n.doc.documentElement)return;var _=g[g.length-1]||n.currentElement.tagName||n.doc.documentElement.tagName||"";if(_!==k[1]){var S=k[1].toLowerCase();if(!i||_.toLowerCase()!==S)return a.fatalError('Opening and ending tag mismatch: "'+_+'" != "'+N+'"')}var A=E.pop();g.pop();var P=A.localNSMap;if(n.endElement(A.uri,A.localName,_),P)for(var I in P)Cc(P,I)&&n.endPrefixMapping(I);oe++;break;case"?":p&&x(v),oe=K8(e,v,n,a);break;case"!":p&&x(v),oe=rS(e,v,n,a,i);break;default:p&&x(v);var W=new nS,te=E[E.length-1].currentNSMap,oe=G8(e,v,W,te,o,a,i),ve=W.length;if(W.closed||(i&&Rl.isHTMLVoidElement(W.tagName)?W.closed=!0:g.push(W.tagName)),p&&ve){for(var ye=ay(p,{}),_e=0;_e<ve;_e++){var ue=W[_e];x(ue.offset),ue.locator=ay(p,{})}n.locator=ye,iy(W,n,te)&&E.push(W),n.locator=p}else iy(W,n,te)&&E.push(W);i&&!W.closed?oe=Y8(e,oe,W.tagName,o,n):oe++}}catch(ce){if(ce instanceof ny)throw ce;if(ce instanceof H8)throw new ny(ce.name+": "+ce.message,n.locator,ce);a.error("element parse error: "+ce),oe=-1}oe>w?w=oe:l(Math.max(v,w)+1)}}function ay(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function G8(e,t,r,n,a,i,s){function o(x,E,g){if(Cc(r.attributeNames,x))return i.fatalError("Attribute "+x+" redefined");if(!s&&E.indexOf("<")>=0)return i.fatalError("Unescaped '<' not allowed in attributes values");r.addValue(x,E.replace(/[\t\n\r]/g," ").replace(ix,a),g)}for(var l,u,c=++t,h=iu;;){var p=e.charAt(c);switch(p){case"=":if(h===Fi)l=e.slice(t,c),h=su;else if(h===_o)h=su;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(h===su||h===Fi)if(h===Fi&&(i.warning('attribute value must after "="'),l=e.slice(t,c)),t=c+1,c=e.indexOf(p,t),c>0)u=e.slice(t,c),o(l,u,t-1),h=So;else throw new Error("attribute value no end '"+p+"' match");else if(h==To)u=e.slice(t,c),o(l,u,t),i.warning('attribute "'+l+'" missed start quot('+p+")!!"),t=c+1,h=So;else throw new Error('attribute value must after "="');break;case"/":switch(h){case iu:r.setTagName(e.slice(t,c));case So:case ou:case Xf:h=Xf,r.closed=!0;case To:case Fi:break;case _o:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),h==iu&&r.setTagName(e.slice(t,c)),c;case">":switch(h){case iu:r.setTagName(e.slice(t,c));case So:case ou:case Xf:break;case To:case Fi:u=e.slice(t,c),u.slice(-1)==="/"&&(r.closed=!0,u=u.slice(0,-1));case _o:h===_o&&(u=l),h==To?(i.warning('attribute "'+u+'" missed quot(")!'),o(l,u,t)):(s||i.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),o(u,u,t));break;case su:if(!s)return i.fatalError(`AttValue: ' or " expected`)}return c;case"":p=" ";default:if(p<=" ")switch(h){case iu:r.setTagName(e.slice(t,c)),h=ou;break;case Fi:l=e.slice(t,c),h=_o;break;case To:var u=e.slice(t,c);i.warning('attribute "'+u+'" missed quot(")!!'),o(l,u,t);case So:h=ou;break}else switch(h){case _o:s||i.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),o(l,l,t),t=c,h=Fi;break;case So:i.warning('attribute space is required"'+l+'"!!');case ou:h=Fi,t=c;break;case su:h=To,t=c;break;case Xf:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function iy(e,t,r){for(var n=e.tagName,a=null,h=e.length;h--;){var i=e[h],s=i.qName,o=i.value,p=s.indexOf(":");if(p>0)var l=i.prefix=s.slice(0,p),u=s.slice(p+1),c=l==="xmlns"&&u;else u=s,l=null,c=s==="xmlns"&&"";i.localName=u,c!==!1&&(a==null&&(a=Object.create(null),eS(r,r=Object.create(null))),r[c]=a[c]=o,i.uri=ry.XMLNS,t.startPrefixMapping(c,o))}for(var h=e.length;h--;)i=e[h],i.prefix&&(i.prefix==="xml"&&(i.uri=ry.XML),i.prefix!=="xmlns"&&(i.uri=r[i.prefix]));var p=n.indexOf(":");p>0?(l=e.prefix=n.slice(0,p),u=e.localName=n.slice(p+1)):(l=null,u=e.localName=n);var x=e.uri=r[l||""];if(t.startElement(x,u,n,e),e.closed){if(t.endElement(x,u,n),a)for(l in a)Cc(a,l)&&t.endPrefixMapping(l)}else return e.currentNSMap=r,e.localNSMap=a,!0}function Y8(e,t,r,n,a){var i=W8(r);if(i||$8(r)){var s=e.indexOf("</"+r+">",t),o=e.substring(t+1,s);return i&&(o=o.replace(ix,n)),a.characters(o,0,o.length),s}return t+1}function eS(e,t){for(var r in e)Cc(e,r)&&(t[r]=e[r])}function tS(e,t){var r=t;function n(c){return c=c||0,e.charAt(r+c)}function a(c){c=c||1,r+=c}function i(){for(var c=0;r<e.length;){var h=n();if(h!==" "&&h!==`
`&&h!=="	"&&h!=="\r")return c;c++,a()}return-1}function s(){return e.substring(r)}function o(c){return e.substring(r,r+c.length)===c}function l(c){return e.substring(r,r+c.length).toUpperCase()===c.toUpperCase()}function u(c){var h=wt.reg("^",c),p=h.exec(s());return p?(a(p[0].length),p[0]):null}return{char:n,getIndex:function(){return r},getMatch:u,getSource:function(){return e},skip:a,skipBlanks:i,substringFromIndex:s,substringStartsWith:o,substringStartsWithCaseInsensitive:l}}function X8(e,t){function r(o,l){var u=wt.PI.exec(o.substringFromIndex());return u?u[1].toLowerCase()==="xml"?l.fatalError("xml declaration is only allowed at the start of the document, but found at position "+o.getIndex()):(o.skip(u[0].length),u[0]):l.fatalError("processing instruction is not well-formed at position "+o.getIndex())}var n=e.getSource();if(e.char()==="["){e.skip(1);for(var a=e.getIndex();e.getIndex()<n.length;){if(e.skipBlanks(),e.char()==="]"){var i=n.substring(a,e.getIndex());return e.skip(1),i}var s=null;if(e.char()==="<"&&e.char(1)==="!")switch(e.char(2)){case"E":e.char(3)==="L"?s=e.getMatch(wt.elementdecl):e.char(3)==="N"&&(s=e.getMatch(wt.EntityDecl));break;case"A":s=e.getMatch(wt.AttlistDecl);break;case"N":s=e.getMatch(wt.NotationDecl);break;case"-":s=e.getMatch(wt.Comment);break}else if(e.char()==="<"&&e.char(1)==="?")s=r(e,t);else if(e.char()==="%")s=e.getMatch(wt.PEReference);else return t.fatalError("Error detected in Markup declaration");if(!s)return t.fatalError("Error in internal subset at position "+e.getIndex())}return t.fatalError("doctype internal subset is not well-formed, missing ]")}}function rS(e,t,r,n,a){var i=tS(e,t);switch(a?i.char(2).toUpperCase():i.char(2)){case"-":var s=i.getMatch(wt.Comment);return s?(r.comment(s,wt.COMMENT_START.length,s.length-wt.COMMENT_START.length-wt.COMMENT_END.length),i.getIndex()):n.fatalError("comment is not well-formed at position "+i.getIndex());case"[":var o=i.getMatch(wt.CDSect);return o?!a&&!r.currentElement?n.fatalError("CDATA outside of element"):(r.startCDATA(),r.characters(o,wt.CDATA_START.length,o.length-wt.CDATA_START.length-wt.CDATA_END.length),r.endCDATA(),i.getIndex()):n.fatalError("Invalid CDATA starting at position "+t);case"D":{if(r.doc&&r.doc.documentElement)return n.fatalError("Doctype not allowed inside or after documentElement at position "+i.getIndex());if(a?!i.substringStartsWithCaseInsensitive(wt.DOCTYPE_DECL_START):!i.substringStartsWith(wt.DOCTYPE_DECL_START))return n.fatalError("Expected "+wt.DOCTYPE_DECL_START+" at position "+i.getIndex());if(i.skip(wt.DOCTYPE_DECL_START.length),i.skipBlanks()<1)return n.fatalError("Expected whitespace after "+wt.DOCTYPE_DECL_START+" at position "+i.getIndex());var l={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(l.name=i.getMatch(wt.Name),!l.name)return n.fatalError("doctype name missing or contains unexpected characters at position "+i.getIndex());if(a&&l.name.toLowerCase()!=="html"&&n.warning("Unexpected DOCTYPE in HTML document at position "+i.getIndex()),i.skipBlanks(),i.substringStartsWith(wt.PUBLIC)||i.substringStartsWith(wt.SYSTEM)){var u=wt.ExternalID_match.exec(i.substringFromIndex());if(!u)return n.fatalError("doctype external id is not well-formed at position "+i.getIndex());u.groups.SystemLiteralOnly!==void 0?l.systemId=u.groups.SystemLiteralOnly:(l.systemId=u.groups.SystemLiteral,l.publicId=u.groups.PubidLiteral),i.skip(u[0].length)}else if(a&&i.substringStartsWithCaseInsensitive(wt.SYSTEM)){if(i.skip(wt.SYSTEM.length),i.skipBlanks()<1)return n.fatalError("Expected whitespace after "+wt.SYSTEM+" at position "+i.getIndex());if(l.systemId=i.getMatch(wt.ABOUT_LEGACY_COMPAT_SystemLiteral),!l.systemId)return n.fatalError("Expected "+wt.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+wt.SYSTEM+" at position "+i.getIndex())}return a&&l.systemId&&!wt.ABOUT_LEGACY_COMPAT_SystemLiteral.test(l.systemId)&&n.warning("Unexpected doctype.systemId in HTML document at position "+i.getIndex()),a||(i.skipBlanks(),l.internalSubset=X8(i,n)),i.skipBlanks(),i.char()!==">"?n.fatalError("doctype not terminated with > at position "+i.getIndex()):(i.skip(1),r.startDTD(l.name,l.publicId,l.systemId,l.internalSubset),r.endDTD(),i.getIndex())}default:return n.fatalError('Not well-formed XML starting with "<!" at position '+t)}}function K8(e,t,r,n){var a=e.substring(t).match(wt.PI);if(!a)return n.fatalError("Invalid processing instruction starting at position "+t);if(a[1].toLowerCase()==="xml"){if(t>0)return n.fatalError("processing instruction at position "+t+" is an xml declaration which is only at the start of the document");if(!wt.XMLDecl.test(e.substring(t)))return n.fatalError("xml declaration is not well-formed")}return r.processingInstruction(a[1],a[2]),t+a[0].length}function nS(){this.attributeNames=Object.create(null)}nS.prototype={setTagName:function(e){if(!wt.QName_exact.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!wt.QName_exact.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};oh.XMLReader=JT;oh.parseUtils=tS;oh.parseDoctypeCommentOrCData=rS;var uo=Er,Z8=br,Q8=xs,sy=ZT,J8=oh,eO=Z8.DOMImplementation,tO=uo.hasDefaultHTMLNamespace,rO=uo.isHTMLMimeType,nO=uo.isValidMimeType,aS=uo.MIME_TYPE,pp=uo.NAMESPACE,oy=Q8.ParseError,aO=J8.XMLReader;function iS(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028\u2029]/g,`
`)}function sS(e){if(e=e||{},e.locator===void 0&&(e.locator=!0),this.assign=e.assign||uo.assign,this.domHandler=e.domHandler||lh,this.onError=e.onError||e.errorHandler,e.errorHandler&&typeof e.errorHandler!="function")throw new TypeError("errorHandler object is no longer supported, switch to onError!");e.errorHandler&&e.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=e.normalizeLineEndings||iS,this.locator=!!e.locator,this.xmlns=this.assign(Object.create(null),e.xmlns)}sS.prototype.parseFromString=function(e,t){if(!nO(t))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+t+'" is not valid.');var r=this.assign(Object.create(null),this.xmlns),n=sy.XML_ENTITIES,a=r[""]||null;tO(t)?(n=sy.HTML_ENTITIES,a=pp.HTML):t===aS.XML_SVG_IMAGE&&(a=pp.SVG),r[""]=a,r.xml=r.xml||pp.XML;var i=new this.domHandler({mimeType:t,defaultNamespace:a,onError:this.onError}),s=this.locator?{}:void 0;this.locator&&i.setDocumentLocator(s);var o=new aO;o.errorHandler=i,o.domBuilder=i;var l=!uo.isHTMLMimeType(t);return l&&typeof e!="string"&&o.errorHandler.fatalError("source is not a string"),o.parse(this.normalizeLineEndings(String(e)),r,n),i.doc.documentElement||o.errorHandler.fatalError("missing root element"),i.doc};function lh(e){var t=e||{};this.mimeType=t.mimeType||aS.XML_APPLICATION,this.defaultNamespace=t.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=t.onError}function Ao(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}lh.prototype={startDocument:function(){var e=new eO;this.doc=rO(this.mimeType)?e.createHTMLDocument(!1):e.createDocument(this.defaultNamespace,"")},startElement:function(e,t,r,n){var a=this.doc,i=a.createElementNS(e,r||t),s=n.length;Kf(this,i),this.currentElement=i,this.locator&&Ao(this.locator,i);for(var o=0;o<s;o++){var e=n.getURI(o),l=n.getValue(o),r=n.getQName(o),u=a.createAttributeNS(e,r);this.locator&&Ao(n.getLocator(o),u),u.value=u.nodeValue=l,i.setAttributeNode(u)}},endElement:function(e,t,r){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&Ao(this.locator,r),Kf(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=ly.apply(this,arguments),e){if(this.cdata)var n=this.doc.createCDATASection(e);else var n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&Ao(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){e&&(e.lineNumber=0),this.locator=e},comment:function(e,t,r){e=ly.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&Ao(this.locator,n),Kf(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r,n){var a=this.doc.implementation;if(a&&a.createDocumentType){var i=a.createDocumentType(e,t,r,n);this.locator&&Ao(this.locator,i),Kf(this,i),this.doc.doctype=i}},reportError:function(e,t){if(typeof this.onError=="function")try{this.onError(e,t,this)}catch(r){throw new oy("Reporting "+e+' "'+t+'" caused '+r,this.locator)}else console.error("[xmldom "+e+"]	"+t,iO(this.locator))},warning:function(e){this.reportError("warning",e)},error:function(e){this.reportError("error",e)},fatalError:function(e){throw this.reportError("fatalError",e),new oy(e,this.locator)}};function iO(e){if(e)return`
@#[line:`+e.lineNumber+",col:"+e.columnNumber+"]"}function ly(e,t,r){return typeof e=="string"?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){lh.prototype[e]=function(){return null}});function Kf(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}function sO(e){if(e==="error")throw"onErrorStopParsing"}function oO(){throw"onWarningStopParsing"}Il.__DOMHandler=lh;Il.DOMParser=sS;Il.normalizeLineEndings=iS;Il.onErrorStopParsing=sO;Il.onWarningStopParsing=oO;var Ll=Er;It.assign=Ll.assign;It.hasDefaultHTMLNamespace=Ll.hasDefaultHTMLNamespace;It.isHTMLMimeType=Ll.isHTMLMimeType;It.isValidMimeType=Ll.isValidMimeType;It.MIME_TYPE=Ll.MIME_TYPE;It.NAMESPACE=Ll.NAMESPACE;var uh=xs;It.DOMException=uh.DOMException;It.DOMExceptionName=uh.DOMExceptionName;It.ExceptionCode=uh.ExceptionCode;It.ParseError=uh.ParseError;var Ir=br;It.Attr=Ir.Attr;It.CDATASection=Ir.CDATASection;It.CharacterData=Ir.CharacterData;It.Comment=Ir.Comment;It.Document=Ir.Document;It.DocumentFragment=Ir.DocumentFragment;It.DocumentType=Ir.DocumentType;It.DOMImplementation=Ir.DOMImplementation;It.Element=Ir.Element;It.Entity=Ir.Entity;It.EntityReference=Ir.EntityReference;It.LiveNodeList=Ir.LiveNodeList;It.NamedNodeMap=Ir.NamedNodeMap;It.Node=Ir.Node;It.NodeList=Ir.NodeList;It.Notation=Ir.Notation;It.ProcessingInstruction=Ir.ProcessingInstruction;It.Text=Ir.Text;It.XMLSerializer=Ir.XMLSerializer;var ch=Il;It.DOMParser=ch.DOMParser;It.normalizeLineEndings=ch.normalizeLineEndings;It.onErrorStopParsing=ch.onErrorStopParsing;It.onWarningStopParsing=ch.onWarningStopParsing;function lO(e){return e[e.length-1]}function uO(e){return e[0]}var sx={last:lO,first:uO};function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function uy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uy(Object(r),!0).forEach(function(n){fO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fO(e,t,r){return(t=dO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dO(e){var t=hO(e,"string");return Dc(t)=="symbol"?t:t+""}function hO(e,t){if(Dc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oS=sx,A0=oS.last,Ls=oS.first;function co(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}co.prototype=Error.prototype;function mn(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}mn.prototype=new co;function Nc(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}Nc.prototype=new co;function fh(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}fh.prototype=new co;function vs(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}vs.prototype=new co;function ox(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}ox.prototype=new co;function pO(e,t){var r=new ox(e);throw r.properties=cO({id:"api_version_error"},t),r}function mO(e){var t=new mn("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t}function gO(e){var t=new mn("Unopened tag");return t.properties={xtag:A0(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unopened')},t}function xO(e){var t=new mn("Duplicate open tag, expected one open tag");return t.properties={xtag:Ls(e.xtag.split(" ")),id:"duplicate_open_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" has duplicate open tags')},t}function vO(e){var t=new mn("Duplicate close tag, expected one close tag");return t.properties={xtag:Ls(e.xtag.split(" ")),id:"duplicate_close_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag ending with "'.concat(e.xtag.substr(0,10),'" has duplicate close tags')},t}function yO(e){var t=new mn("Unclosed tag");return t.properties={xtag:Ls(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'.concat(e.xtag.substr(0,10),'" is unclosed')},t}function wO(e){var t=new mn('No tag "'.concat(e.element,'" was found at the ').concat(e.position)),r=e.parsed[e.index];throw t.properties={id:"no_xml_tag_found_at_".concat(e.position),explanation:'No tag "'.concat(e.element,'" was found at the ').concat(e.position),offset:r.offset,part:r,parsed:e.parsed,index:e.index,element:e.element},t}function EO(e){var t=e.tag,r=e.value,n=e.offset,a=new Nc("There are some XML corrupt characters");return a.properties={id:"invalid_xml_characters",xtag:t,value:r,offset:n,explanation:"There are some corrupt characters for the field ".concat(t)},a}function bO(e){var t=e.tag,r=e.value,n=e.offset,a=new Nc("Non string values are not allowed for rawXML tags");return a.properties={id:"invalid_raw_xml_value",xtag:t,value:r,offset:n,explanation:"The value of the raw tag : '".concat(t,"' is not a string")},a}function _O(e){var t=e.part,r=t.value,n=t.offset,a=e.id,i=a===void 0?"raw_tag_outerxml_invalid":a,s=e.message,o=s===void 0?"Raw tag not in paragraph":s,l=e.part,u=e.explanation,c=u===void 0?'The tag "'.concat(r,'" is not inside a paragraph'):u;typeof c=="function"&&(c=c(l));var h=new mn(o);throw h.properties={id:i,explanation:c,rootError:e.rootError,xtag:r,offset:n,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},h}function TO(e){var t=new mn("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t}function SO(e){var t=e.location,r=e.offset,n=e.square,a=t==="start"?"unclosed":"unopened",i=t==="start"?"Unclosed":"Unopened",s=new mn("".concat(i," loop")),o=e.value;return s.properties={id:"".concat(a,"_loop"),explanation:'The loop with tag "'.concat(o,'" is ').concat(a),xtag:o,offset:r},n&&(s.properties.square=n),s}function AO(e,t){var r=new mn("Unbalanced loop tag"),n=t[0].part.value,a=t[1].part.value,i=e[0].part.value,s=e[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(a,"}{#").concat(i,"}{/").concat(s,"}"),offset:[t[0].part.offset,e[1].part.offset],lastPair:{left:t[0].part.value,right:t[1].part.value},pair:{left:e[0].part.value,right:e[1].part.value}},r}function CO(e){var t=e.tags,r=new mn("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(t[0].value,'" is closed by the tag "').concat(t[1].value,'"'),openingtag:Ls(t).value,offset:[Ls(t).offset,A0(t).offset],closingtag:A0(t).value},Ls(t).square&&(r.properties.square=[Ls(t).square,A0(t).square]),r}function DO(e){var t=e.tag,r=e.rootError,n=e.offset,a=new fh("Scope parser compilation failed");return a.properties={id:"scopeparser_compilation_failed",offset:n,xtag:t,explanation:'The scope parser for the tag "'.concat(t,'" failed to compile'),rootError:r},a}function NO(e){var t=e.tag,r=e.scope,n=e.error,a=e.offset,i=new fh("Scope parser execution failed");return i.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(t," failed to execute"),scope:r,offset:a,xtag:t,rootError:n},i}function kO(e){var t=e.tag,r=e.offset,n=new mn('The position of the loop tags "'.concat(t,'" would produce invalid XML'));return n.properties={xtag:t,id:"loop_position_invalid",explanation:'The tags "'.concat(t,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n}function OO(e,t){var r='Unimplemented tag type "'.concat(e.type,'"');e.module&&(r+=' "'.concat(e.module,'"'));var n=new mn(r);throw n.properties={part:e,index:t,id:"unimplemented_tag_type"},n}function FO(){var e=new vs("Malformed xml");throw e.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},e}function PO(){var e=new vs("You must run `.compile()` before running `.resolveData()`");throw e.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},e}function IO(){var e=new vs("You should not call .render on a document that had compilation errors");throw e.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},e}function RO(){var e=new vs("You should not call .render twice on the same docxtemplater instance");throw e.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},e}function LO(e){var t=Object.keys(e.files).slice(0,10),r="";t.length===0?r="Empty zip file":r="Zip file contains : ".concat(t.join(","));var n=new vs("The filetype for this file could not be identified, is this file corrupted ? ".concat(r));throw n.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(r)},n}function MO(e,t){var r=new mn("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r}function jO(e){var t=new vs('The filetype "'.concat(e,'" is not handled by docxtemplater'));throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(e,'", but only docx and pptx formats are handled'),fileType:e},t}var Ma={XTError:co,XTTemplateError:mn,XTInternalError:vs,XTScopeParserError:fh,XTAPIVersionError:ox,RenderingError:Nc,XTRenderingError:Nc,getClosingTagNotMatchOpeningTag:CO,getLoopPositionProducesInvalidXMLError:kO,getScopeCompilationError:DO,getScopeParserExecutionError:NO,getUnclosedTagException:yO,getUnopenedTagException:gO,getUnmatchedLoopException:SO,getDuplicateCloseTagException:vO,getDuplicateOpenTagException:xO,getCorruptCharactersException:EO,getInvalidRawXMLValueException:bO,getUnbalancedLoopException:AO,throwApiVersionError:pO,throwFileTypeNotHandled:jO,throwFileTypeNotIdentified:LO,throwMalformedXml:FO,throwMultiError:mO,throwExpandNotFound:_O,throwRawTagShouldBeOnlyTextInParagraph:TO,throwUnimplementedTagType:OO,throwXmlTagNotFound:wO,throwXmlInvalid:MO,throwResolveBeforeCompile:PO,throwRenderInvalidTemplate:IO,throwRenderTwice:RO};function BO(e,t){return qO(e)||WO(e,t)||zO(e,t)||UO()}function UO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zO(e,t){if(e){if(typeof e=="string")return cy(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cy(e,t):void 0}}function cy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function WO(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function qO(e){if(Array.isArray(e))return e}var lS=It,$O=lS.DOMParser,HO=lS.XMLSerializer,VO=Ma,uS=VO.throwXmlTagNotFound,cS=sx,GO=cS.last,YO=cS.first;function XO(e){return/^[ \n\r\t]+$/.test(e)}function KO(e){return{get:function(r){return e==="."?r:r&&r[e]}}}function ZO(e){for(var t=0;t<e.length;t++){var r=e[t];r.message&&console.warn("Warning : "+r.message)}}var mp={};function QO(e,t,r){var n;if(mp[t]?n=mp[t]:(n=new RegExp("(<.* ".concat(t,'=")([^"]*)(".*)$')),mp[t]=n),n.test(e))return e.replace(n,"$1".concat(r,"$3"));var a=e.lastIndexOf("/>");return a===-1&&(a=e.lastIndexOf(">")),e.substr(0,a)+" ".concat(t,'="').concat(r,'"')+e.substr(a)}function JO(e,t){var r=e.indexOf(" ".concat(t,'="'));if(r===-1)return null;var n=e.substr(r).search(/["']/)+r,a=e.substr(n+1).search(/["']/)+n;return e.substr(n+1,a-n)}function eF(e,t){return e.indexOf(t,e.length-t.length)!==-1}function tF(e,t){return e.substring(0,t.length)===t}function rF(e){for(var t=[],r={},n=[],a=0,i=e.length;a<i;++a)r[e[a]]?t.push(e[a]):(r[e[a]]=!0,n.push(e[a]));return t}function nF(e){for(var t={},r=[],n=0,a=e.length;n<a;++n)t[e[n]]||(t[e[n]]=!0,r.push(e[n]));return r}function aF(e,t){for(var r=[[]],n=0;n<e.length;n++){var a=e[n],i=r[r.length-1],s=t(a);s==="start"?r.push([a]):s==="end"?(i.push(a),r.push([])):i.push(a)}for(var o=[],l=0;l<r.length;l++){var u=r[l];u.length>0&&o.push(u)}return o}function iF(){return{errorLogging:"json",stripInvalidXMLChars:!1,paragraphLoop:!1,nullGetter:function(t){return t.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:KO,warnFn:ZO,linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}}function sF(e){return new HO().serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")}function oF(e){return e.charCodeAt(0)===65279&&(e=e.substr(1)),new $O().parseFromString(e,"text/xml")}var fS=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],kc=fS.map(function(e){var t=BO(e,2),r=t[0],n=t[1];return{rstart:new RegExp(n,"g"),rend:new RegExp(r,"g"),start:n,end:r}});function lF(e){for(var t=kc.length-1;t>=0;t--){var r=kc[t];e=e.replace(r.rstart,r.end)}return e}function uF(e){var t;(t=e)!==null&&t!==void 0&&t.toString?e=e.toString():e="";for(var r,n=0,a=kc.length;n<a;n++)r=kc[n],e=e.replace(r.rend,r.start);return e}function cF(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;a++){var i=n[a];t.push(i)}return t}function fF(e,t){if(!t)return e;for(var r=0,n=t.length;r<n;r++)e.push(t[r]);return e}var dF=new RegExp("","g");function hF(e){return e.replace(dF," ")}function pF(e,t){for(var r=[],n;(n=e.exec(t))!=null;)r.push({array:n,offset:n.index});return r}function lx(e,t){return e==="</"+t+">"}function ux(e,t){return e.indexOf("<"+t)===0&&[">"," ","/"].indexOf(e[t.length+1])!==-1}function mF(e,t,r){var n=dS(e,t,r);if(n!==null)return n;uS({position:"right",element:t,parsed:e,index:r})}function dS(e,t,r){typeof t=="string"&&(t=[t]);for(var n=1,a=r,i=e.length;a<i;a++)for(var s=e[a],o=0,l=t;o<l.length;o++){var u=l[o];if(lx(s.value,u)&&n--,ux(s.value,u)&&n++,n===0)return a}return null}function gF(e,t,r){var n=hS(e,t,r);if(n!==null)return n;uS({position:"left",element:t,parsed:e,index:r})}function hS(e,t,r){typeof t=="string"&&(t=[t]);for(var n=1,a=r;a>=0;a--)for(var i=e[a],s=0,o=t;s<o.length;s++){var l=o[s];if(ux(i.value,l)&&n--,lx(i.value,l)&&n++,n===0)return a}return null}function xF(e,t){var r=t.type,n=t.tag,a=t.position;return r==="tag"&&n===e&&(a==="start"||a==="selfclosing")}function vF(e,t){var r=t.type,n=t.tag,a=t.position;return r==="tag"&&n===e&&a==="end"}function yF(e){var t=e.type,r=e.tag,n=e.position;return["w:p","a:p","text:p"].indexOf(r)!==-1&&t==="tag"&&n==="start"}function wF(e){var t=e.type,r=e.tag,n=e.position;return["w:p","a:p","text:p"].indexOf(r)!==-1&&t==="tag"&&n==="end"}function EF(e){var t=e.type,r=e.position,n=e.text;return n&&t==="tag"&&r==="start"}function bF(e){var t=e.type,r=e.position,n=e.text;return n&&t==="tag"&&r==="end"}function _F(e){var t=e.type,r=e.position;return t==="placeholder"||t==="content"&&r==="insidetag"}function TF(e,t){var r=e.module,n=e.type;return t instanceof Array||(t=[t]),n==="placeholder"&&t.indexOf(r)!==-1}var Cg=/[\x00-\x08\x0B\x0C\x0E-\x1F]/g;function SF(e){return Cg.lastIndex=0,Cg.test(e)}function AF(e){return typeof e!="string"&&(e=String(e)),e.replace(Cg,"")}function CF(e){var t={};for(var r in e){var n=e[r];t[n]||(t[n]=[]),t[n].push(r)}return t}function DF(e,t){return e.map(function(r,n){return{item:r,index:n}}).sort(function(r,n){return t(r.item,n.item)||r.index-n.index}).map(function(r){var n=r.item;return n})}var Rr={endsWith:eF,startsWith:tF,isContent:_F,isParagraphStart:yF,isParagraphEnd:wF,isTagStart:xF,isTagEnd:vF,isTextStart:EF,isTextEnd:bF,isStarting:ux,isEnding:lx,isModule:TF,uniq:nF,getDuplicates:rF,chunkBy:aF,last:GO,first:YO,xml2str:sF,str2xml:oF,getRightOrNull:dS,getRight:mF,getLeftOrNull:hS,getLeft:gF,pregMatchAll:pF,convertSpaces:hF,charMapRegexes:kc,hasCorruptCharacters:SF,removeCorruptCharacters:AF,getDefaults:iF,wordToUtf8:lF,utf8ToWord:uF,concatArrays:cF,pushArray:fF,invertMap:CF,charMap:fS,getSingleAttribute:JO,setSingleAttribute:QO,isWhiteSpace:XO,stableSort:DF};function NF(e,t){return PF(e)||FF(e,t)||OF(e,t)||kF()}function kF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OF(e,t){if(e){if(typeof e=="string")return fy(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fy(e,t):void 0}}function fy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function FF(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function PF(e){if(Array.isArray(e))return e}function Xr(e){"@babel/helpers - typeof";return Xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(e)}function IF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MF(n.key),n)}}function LF(e,t,r){return r&&RF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MF(e){var t=jF(e,"string");return Xr(t)=="symbol"?t:t+""}function jF(e,t){if(Xr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xr(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var BF=function(){function e(){IF(this,e)}return LF(e,null,[{key:"createSchema",value:function(r){var n={validate:r,optional:function(){return e.createSchema(function(i){return i===void 0?{success:!0,value:i}:r(i)})},nullable:function(){return e.createSchema(function(i){return i==null?{success:!0,value:i}:r(i)})}};return n}},{key:"string",value:function(){return e.createSchema(function(r){return typeof r!="string"?{success:!1,error:"Expected string, received ".concat(Xr(r))}:{success:!0,value:r}})}},{key:"date",value:function(){return e.createSchema(function(r){return r instanceof Date?{success:!0,value:r}:{success:!1,error:"Expected date, received ".concat(Xr(r))}})}},{key:"boolean",value:function(){return e.createSchema(function(r){return typeof r!="boolean"?{success:!1,error:"Expected boolean, received ".concat(Xr(r))}:{success:!0,value:r}})}},{key:"number",value:function(){return e.createSchema(function(r){return typeof r!="number"?{success:!1,error:"Expected number, received ".concat(Xr(r))}:{success:!0,value:r}})}},{key:"function",value:function(){return e.createSchema(function(r){return typeof r!="function"?{success:!1,error:"Expected function, received ".concat(Xr(r))}:{success:!0,value:r}})}},{key:"array",value:function(r){return e.createSchema(function(n){if(!Array.isArray(n))return{success:!1,error:"Expected array, received ".concat(Xr(n))};for(var a=0;a<n.length;a++){var i=r.validate(n[a]);if(!i.success)return{success:!1,error:"".concat(i.error," at index ").concat(a)}}return{success:!0,value:n}})}},{key:"any",value:function(){return e.createSchema(function(r){return{success:!0,value:r}})}},{key:"isRegex",value:function(){return e.createSchema(function(r){return r instanceof RegExp?{success:!0,value:r}:{success:!1,error:"Expected RegExp, received ".concat(Xr(r))}})}},{key:"union",value:function(r){return e.createSchema(function(n){for(var a=0;a<r.length;a++){var i=r[a],s=i.validate(n);if(s.success)return s}return{success:!1,error:"Value ".concat(n," does not match any schema in union")}})}},{key:"object",value:function(r){var n=e.createSchema(function(a){if(a==null)return{success:!1,error:"Expected object, received ".concat(a)};if(Xr(a)!=="object")return{success:!1,error:"Expected object, received ".concat(Xr(a))};for(var i=0,s=Object.entries(r);i<s.length;i++){var o=NF(s[i],2),l=o[0],u=o[1],c=u.validate(a[l]);if(!c.success)return{success:!1,error:"".concat(c.error," at ").concat(l)}}return{success:!0,value:a}});return n.strict=function(){return e.createSchema(function(a){var i=n.validate(a);if(!i.success)return i;var s=Object.keys(a).filter(function(o){return!(o in r)});return s.length>0?{success:!1,error:"Unexpected properties: ".concat(s.join(", "))}:i})},n}},{key:"record",value:function(r){return e.createSchema(function(n){if(n===null)return{success:!1,error:"Expected object, received null"};if(Xr(n)!=="object")return{success:!1,error:"Expected object, received ".concat(Xr(n))};for(var a=0,i=Object.keys(n);a<i.length;a++){var s=i[a];if(typeof s!="string")return{success:!1,error:"Expected string key, received ".concat(Xr(s)," at ").concat(s)};var o=r.validate(n[s]);if(!o.success)return{success:!1,error:"".concat(o.error," at key ").concat(s)}}return{success:!0,value:n}})}}])}(),UF=BF,gp,dy;function zF(){if(dy)return gp;dy=1;var e=Rr,t=e.str2xml,r="_rels/.rels";function n(a){for(var i=a.files[r],s=i?t(i.asText()):null,o=s?s.getElementsByTagName("Relationship"):[],l={},u=0;u<o.length;u++){var c=o[u];l[c.getAttribute("Target")]=c.getAttribute("Type")}return l}return gp={getRelsTypes:n},gp}var xp,hy;function WF(){if(hy)return xp;hy=1;var e=Rr,t=e.str2xml,r="[Content_Types].xml";function n(i,s,o){for(var l={},u=0;u<i.length;u++){var c=i[u],h=c.getAttribute("ContentType"),p=c.getAttribute("PartName").substr(1);l[p]=h}return o.file(/./).map(function(x){for(var E=x.name,g=0;g<s.length;g++){var w=s[g],v=w.getAttribute("ContentType"),y=w.getAttribute("Extension");E.slice(E.length-y.length)===y&&!l[E]&&E!==r&&(l[E]=v)}l[E]||(l[E]="")}),l}function a(i){var s=i.files[r],o=s?t(s.asText()):null,l=o?o.getElementsByTagName("Override"):null,u=o?o.getElementsByTagName("Default"):null;return{overrides:l,defaults:u,contentTypes:s,contentTypeXml:o}}return xp={collectContentTypes:n,getContentTypes:a},xp}var vp,py;function fo(){if(py)return vp;py=1;var e=Ma,t=e.XTInternalError;function r(){}function n(a){return a}return vp=function(a){var i={on:r,set:r,getFileType:r,optionsTransformer:n,preparse:n,matchers:function(){return[]},parse:r,getTraits:r,postparse:n,errorsTransformer:n,preResolve:r,resolve:r,getRenderedMap:n,render:r,nullGetter:r,postrender:n};if(Object.keys(i).every(function(l){return!a[l]})){var s=new t("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw s.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},s}for(var o in i)a[o]||(a[o]=i[o]);return a},vp}var yp,my;function cx(){if(my)return yp;my=1;function e(D){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},e(D)}function t(D){return a(D)||n(D)||o(D)||r()}function r(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(D){if(typeof Symbol<"u"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}function a(D){if(Array.isArray(D))return l(D)}function i(D,F){return c(D)||u(D,F)||o(D,F)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(D,F){if(D){if(typeof D=="string")return l(D,F);var V={}.toString.call(D).slice(8,-1);return V==="Object"&&D.constructor&&(V=D.constructor.name),V==="Map"||V==="Set"?Array.from(D):V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V)?l(D,F):void 0}}function l(D,F){(F==null||F>D.length)&&(F=D.length);for(var V=0,R=Array(F);V<F;V++)R[V]=D[V];return R}function u(D,F){var V=D==null?null:typeof Symbol<"u"&&D[Symbol.iterator]||D["@@iterator"];if(V!=null){var R,j,re,xe,Pe=[],Z=!0,L=!1;try{if(re=(V=V.call(D)).next,F!==0)for(;!(Z=(R=re.call(V)).done)&&(Pe.push(R.value),Pe.length!==F);Z=!0);}catch(X){L=!0,j=X}finally{try{if(!Z&&V.return!=null&&(xe=V.return(),Object(xe)!==xe))return}finally{if(L)throw j}}return Pe}}function c(D){if(Array.isArray(D))return D}function h(D,F){var V=Object.keys(D);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(D);F&&(R=R.filter(function(j){return Object.getOwnPropertyDescriptor(D,j).enumerable})),V.push.apply(V,R)}return V}function p(D){for(var F=1;F<arguments.length;F++){var V=arguments[F]!=null?arguments[F]:{};F%2?h(Object(V),!0).forEach(function(R){x(D,R,V[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(V)):h(Object(V)).forEach(function(R){Object.defineProperty(D,R,Object.getOwnPropertyDescriptor(V,R))})}return D}function x(D,F,V){return(F=E(F))in D?Object.defineProperty(D,F,{value:V,enumerable:!0,configurable:!0,writable:!0}):D[F]=V,D}function E(D){var F=g(D,"string");return e(F)=="symbol"?F:F+""}function g(D,F){if(e(D)!="object"||!D)return D;var V=D[Symbol.toPrimitive];if(V!==void 0){var R=V.call(D,F);if(e(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(D)}var w=Rr,v=w.getRightOrNull,y=w.getRight,b=w.getLeft,T=w.getLeftOrNull,N=w.chunkBy,k=w.isTagStart,_=w.isTagEnd,S=w.isContent,A=w.last,P=w.first,I=Ma,W=I.XTTemplateError,te=I.throwExpandNotFound,oe=I.getLoopPositionProducesInvalidXMLError;function ve(D,F){if(D.length===0)return!1;var V=A(D).substr(1);return V.indexOf(F)===0}function ye(D){for(var F=[],V=0;V<D.length;V++){var R=D[V],j=R.position,re=R.value,xe=R.tag;xe&&(j==="end"?ve(F,xe)?F.pop():F.push(re):j==="start"&&F.push(re))}return F}function _e(D,F){for(var V=0;V<F.length;V++){var R=F[V];if(R.indexOf("<".concat(D))===0)return!0}return!1}function ue(D,F,V){for(var R=ye(D.slice(F[0].offset,F[1].offset)),j=function(){var Z=V[xe],L=Z.contains,X=Z.expand,K=Z.onlyTextInTag;if(_e(L,R)){if(K){var ie=T(D,L,F[0].offset),be=v(D,L,F[1].offset);if(ie===null||be===null)return 0;var nt=D.slice(ie,be),Xe=N(nt,function(jt){return k(L,jt)?"start":_(L,jt)?"end":null}),mt=P(Xe),et=A(Xe),Mt=mt.filter(S),Ee=et.filter(S);if(Mt.length!==1||Ee.length!==1)return 0}for(var Ne=ce(R),Re=0,He=0;He<Ne.length;He++){var at=Ne[He],Tt=at.tag,Wt=at.position;Tt===X&&(Wt==="start"&&Re++,Wt==="end"&&Re--)}return Re!==0?{v:{error:oe({tag:P(F).part.value,offset:[P(F).part.offset,A(F).part.offset]})}}:{v:{value:X}}}},re,xe=0;xe<V.length;xe++)if(re=j(),re!==0&&re)return re.v;return Ve(R)?{}:{error:oe({tag:P(F).part.value,offset:[P(F).part.offset,A(F).part.offset]})}}function ce(D){for(var F=[],V=0;V<D.length;V++){var R=D[V],j=De(R),re=/^\s*<\//.test(R)?"end":"start";F.push({tag:j,position:re})}return F}function De(D){return D.replace(/^\s*<\/?([a-zA-Z:]+).*/,"$1")}function Ve(D){if(D.length%2===1)return!1;for(var F=0,V=D.length/2;F<V;F++){var R=D[F],j=D[D.length-F-1],re=De(R),xe=De(j);if(re!==xe)return!1}return!0}function Y(D,F,V,R){var j=D.expandTo||R.expandTo;if(j){var re,xe;try{xe=b(V,j,F),re=y(V,j,F)}catch(L){var Pe=p({part:D,rootError:L,postparsed:V,expandTo:j,index:F},R.error);if(R.onError){var Z=R.onError(Pe);if(Z==="ignore")return}te(Pe)}return[xe,re]}}function se(D,F,V,R){var j=i(D,2),re=j[0],xe=j[1],Pe=V.indexOf(F),Z=V.slice(re,Pe),L=V.slice(Pe+1,xe+1),X=R.getInner({postparse:R.postparse,index:Pe,part:F,leftParts:Z,rightParts:L,left:re,right:xe,postparsed:V});return X.length||(X.expanded=[Z,L],X=[X]),{left:re,right:xe,inner:X}}function ee(D,F){var V=[];D.errors&&(V=D.errors,D=D.postparsed);for(var R=[],j=0,re=D.length;j<re;j++){var xe=D[j];if(xe.type==="placeholder"&&xe.module===F.moduleName&&!xe.subparsed&&!xe.expanded)try{var Pe=Y(xe,j,D,F);if(!Pe)continue;var Z=i(Pe,2),L=Z[0],X=Z[1];R.push({left:L,right:X,part:xe,i:j,leftPart:D[L],rightPart:D[X]})}catch(Ee){V.push(Ee)}}R.sort(function(Ee,Ne){return Ee.left===Ne.left?Ne.part.lIndex<Ee.part.lIndex?1:-1:Ne.left<Ee.left?1:-1});for(var K=-1,ie=0,be=0,nt=R.length;be<nt;be++){var Xe,mt=R[be];if(K=Math.max(K,be>0?R[be-1].right:0),!(mt.left<K)){var et=void 0;try{et=se([mt.left+ie,mt.right+ie],mt.part,D,F)}catch(Ee){if(F.onError){var Mt=F.onError(p({part:mt.part,rootError:Ee,postparsed:D,expandOne:se},F.errors));if(Mt==="ignore")continue}if(Ee instanceof W)V.push(Ee);else throw Ee}et&&(ie+=et.inner.length-(et.right+1-et.left),(Xe=D).splice.apply(Xe,[et.left,et.right+1-et.left].concat(t(et.inner))))}}return{postparsed:D,errors:V}}return yp={expandToOne:ee,getExpandToDefault:ue},yp}var wp,gy;function fx(){if(gy)return wp;gy=1;var e="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",t="application/vnd.ms-word.document.macroEnabled.main+xml",r="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",n="application/vnd.ms-word.template.macroEnabledTemplate.main+xml",a="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",i="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",s="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",o="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",l="application/vnd.openxmlformats-officedocument.presentationml.slide+xml",u="application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml",c="application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml",h="application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml",p="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",x="application/vnd.ms-excel.sheet.macroEnabled.main+xml",E="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",g=[e,t,r,n],w={main:g,docx:[a].concat(g,[o,i,s]),pptx:[l,u,c,h],xlsx:[p,x,E]};return wp=w,wp}var Ep,xy;function pS(){if(xy)return Ep;xy=1;var e="application/vnd.openxmlformats-package.core-properties+xml",t="application/vnd.openxmlformats-officedocument.extended-properties+xml",r="application/vnd.openxmlformats-officedocument.custom-properties+xml",n="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",a="application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",i="application/vnd.ms-office.drawingml.diagramDrawing+xml";return Ep={settingsContentType:n,coreContentType:e,appContentType:t,customContentType:r,diagramDataContentType:a,diagramDrawingContentType:i},Ep}var bp,vy;function qF(){if(vy)return bp;vy=1;function e(b){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},e(b)}function t(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}function r(b,T){for(var N=0;N<T.length;N++){var k=T[N];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(b,a(k.key),k)}}function n(b,T,N){return T&&r(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),b}function a(b){var T=i(b,"string");return e(T)=="symbol"?T:T+""}function i(b,T){if(e(b)!="object"||!b)return b;var N=b[Symbol.toPrimitive];if(N!==void 0){var k=N.call(b,T);if(e(k)!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(b)}var s=Rr,o=s.pushArray,l=fo(),u=fx(),c=pS(),h=c.settingsContentType,p=c.coreContentType,x=c.appContentType,E=c.customContentType,g=c.diagramDataContentType,w=c.diagramDrawingContentType,v=[h,p,x,E,g,w],y=function(){function b(){t(this,b),this.name="Common"}return n(b,[{key:"getFileType",value:function(N){var k=N.doc,_=k.invertedContentTypes;if(_){for(var S=0;S<v.length;S++){var A=v[S];_[A]&&o(k.targets,_[A])}for(var P=["docx","pptx","xlsx"],I,W=0;W<P.length;W++)for(var te=P[W],oe=u[te],ve=0;ve<oe.length;ve++){var ye=oe[ve];if(_[ye])for(var _e=0,ue=_[ye];_e<ue.length;_e++){var ce=ue[_e];k.relsTypes[ce]&&["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(k.relsTypes[ce])===-1||(I=te,(u.main.indexOf(ye)!==-1||ye===u.pptx[0])&&(k.textTarget||(k.textTarget=ce)),I!=="xlsx"&&k.targets.push(ce))}}return I}}}])}();return bp=function(){return l(new y)},bp}var _p,yy;function $F(){if(yy)return _p;yy=1;function e(w){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},e(w)}function t(w,v){if(!(w instanceof v))throw new TypeError("Cannot call a class as a function")}function r(w,v){for(var y=0;y<v.length;y++){var b=v[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(w,a(b.key),b)}}function n(w,v,y){return v&&r(w.prototype,v),Object.defineProperty(w,"prototype",{writable:!1}),w}function a(w){var v=i(w,"string");return e(v)=="symbol"?v:v+""}function i(w,v){if(e(w)!="object"||!w)return w;var y=w[Symbol.toPrimitive];if(y!==void 0){var b=y.call(w,v);if(e(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}var s=Ma,o=s.getScopeParserExecutionError,l=sx,u=l.last,c=Rr,h=c.concatArrays;function p(w,v){for(var y=w.length>>>0,b,T=0;T<y;T++)if(b=w[T],v.call(this,b,T,w))return b}function x(w,v,y){var b=this,T=this.scopeList[y];if(this.root.finishedResolving){for(var N=this.resolved,k=function(){var W=b.scopeLindex[_];N=p(N,function(te){return te.lIndex===W}),N=N.value[b.scopePathItem[_]]},_=this.resolveOffset,S=this.scopePath.length;_<S;_++)k();return p(N,function(I){return v.part.lIndex===I.lIndex}).value}var A,P;!this.cachedParsers||!v.part?P=this.parser(w,{tag:v.part,scopePath:this.scopePath}):this.cachedParsers[v.part.lIndex]?P=this.cachedParsers[v.part.lIndex]:P=this.cachedParsers[v.part.lIndex]=this.parser(w,{tag:v.part,scopePath:this.scopePath});try{A=P.get(T,this.getContext(v,y))}catch(I){throw o({tag:w,scope:T,error:I,offset:v.part.offset})}return A==null&&y>0?x.call(this,w,v,y-1):A}function E(w,v,y){var b=this,T=this.scopeList[y],N;return!this.cachedParsers||!v.part?N=this.parser(w,{tag:v.part,scopePath:this.scopePath}):this.cachedParsers[v.part.lIndex]?N=this.cachedParsers[v.part.lIndex]:N=this.cachedParsers[v.part.lIndex]=this.parser(w,{tag:v.part,scopePath:this.scopePath}),Promise.resolve().then(function(){return N.get(T,b.getContext(v,y))}).catch(function(k){throw o({tag:w,scope:T,error:k,offset:v.part.offset})}).then(function(k){return k==null&&y>0?E.call(b,w,v,y-1):k})}var g=function(){function w(v){t(this,w),this.root=v.root||this,this.resolveOffset=v.resolveOffset||0,this.scopePath=v.scopePath,this.scopePathItem=v.scopePathItem,this.scopePathLength=v.scopePathLength,this.scopeList=v.scopeList,this.scopeType="",this.scopeTypes=v.scopeTypes,this.scopeLindex=v.scopeLindex,this.parser=v.parser,this.resolved=v.resolved,this.cachedParsers=v.cachedParsers}return n(w,[{key:"loopOver",value:function(y,b,T,N){return this.loopOverValue(this.getValue(y,N),b,T)}},{key:"functorIfInverted",value:function(y,b,T,N,k){return y&&b(T,N,k),y}},{key:"isValueFalsy",value:function(y,b){return y==null||!y||b==="[object Array]"&&y.length===0}},{key:"loopOverValue",value:function(y,b,T){this.root.finishedResolving&&(T=!1);var N=Object.prototype.toString.call(y);if(this.isValueFalsy(y,N))return this.scopeType=!1,this.functorIfInverted(T,b,u(this.scopeList),0,1);if(N==="[object Array]"){this.scopeType="array";for(var k=0;k<y.length;k++)this.functorIfInverted(!T,b,y[k],k,y.length);return!0}return N==="[object Object]"?(this.scopeType="object",this.functorIfInverted(!T,b,y,0,1)):this.functorIfInverted(!T,b,u(this.scopeList),0,1)}},{key:"getValue",value:function(y,b){var T=x.call(this,y,b,this.scopeList.length-1);return typeof T=="function"?T(this.scopeList[this.scopeList.length-1],this):T}},{key:"getValueAsync",value:function(y,b){var T=this;return E.call(this,y,b,this.scopeList.length-1).then(function(N){return typeof N=="function"?N(T.scopeList[T.scopeList.length-1],T):N})}},{key:"getContext",value:function(y,b){return{num:b,meta:y,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(y,b,T,N,k){return new w({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:h([this.scopeTypes,[this.scopeType]]),scopeList:h([this.scopeList,[y]]),scopePath:h([this.scopePath,[b]]),scopePathItem:h([this.scopePathItem,[T]]),scopePathLength:h([this.scopePathLength,[k]]),scopeLindex:h([this.scopeLindex,[N.lIndex]])})}}])}();return _p=function(w){return w.scopePath=[],w.scopePathItem=[],w.scopePathLength=[],w.scopeTypes=[],w.scopeLindex=[],w.scopeList=[w.tags],new g(w)},_p}var Tp,wy;function mS(){if(wy)return Tp;wy=1;function e(D){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},e(D)}function t(D,F){return s(D)||i(D,F)||n(D,F)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(D,F){if(D){if(typeof D=="string")return a(D,F);var V={}.toString.call(D).slice(8,-1);return V==="Object"&&D.constructor&&(V=D.constructor.name),V==="Map"||V==="Set"?Array.from(D):V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V)?a(D,F):void 0}}function a(D,F){(F==null||F>D.length)&&(F=D.length);for(var V=0,R=Array(F);V<F;V++)R[V]=D[V];return R}function i(D,F){var V=D==null?null:typeof Symbol<"u"&&D[Symbol.iterator]||D["@@iterator"];if(V!=null){var R,j,re,xe,Pe=[],Z=!0,L=!1;try{if(re=(V=V.call(D)).next,F!==0)for(;!(Z=(R=re.call(V)).done)&&(Pe.push(R.value),Pe.length!==F);Z=!0);}catch(X){L=!0,j=X}finally{try{if(!Z&&V.return!=null&&(xe=V.return(),Object(xe)!==xe))return}finally{if(L)throw j}}return Pe}}function s(D){if(Array.isArray(D))return D}function o(D,F){var V=Object.keys(D);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(D);F&&(R=R.filter(function(j){return Object.getOwnPropertyDescriptor(D,j).enumerable})),V.push.apply(V,R)}return V}function l(D){for(var F=1;F<arguments.length;F++){var V=arguments[F]!=null?arguments[F]:{};F%2?o(Object(V),!0).forEach(function(R){u(D,R,V[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(V)):o(Object(V)).forEach(function(R){Object.defineProperty(D,R,Object.getOwnPropertyDescriptor(V,R))})}return D}function u(D,F,V){return(F=c(F))in D?Object.defineProperty(D,F,{value:V,enumerable:!0,configurable:!0,writable:!0}):D[F]=V,D}function c(D){var F=h(D,"string");return e(F)=="symbol"?F:F+""}function h(D,F){if(e(D)!="object"||!D)return D;var V=D[Symbol.toPrimitive];if(V!==void 0){var R=V.call(D,F);if(e(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(D)}var p=Ma,x=p.getUnclosedTagException,E=p.getUnopenedTagException,g=p.getDuplicateOpenTagException,w=p.getDuplicateCloseTagException,v=p.throwMalformedXml,y=p.throwXmlInvalid,b=p.XTTemplateError,T=Rr,N=T.isTextStart,k=T.isTextEnd,_=T.wordToUtf8,S=T.pushArray,A=0,P=1,I=2,W=3;function te(D,F){return D[0]<=F.offset&&F.offset<D[1]}function oe(D,F){return N(D)?(F&&v(),!0):k(D)?(F||v(),!1):F}function ve(D){var F="",V=1,R=D.indexOf(" ");return D[D.length-2]==="/"?(F="selfclosing",R===-1&&(R=D.length-2)):D[1]==="/"?(V=2,F="end",R===-1&&(R=D.length-1)):(F="start",R===-1&&(R=D.length-1)),{tag:D.slice(V,R),position:F}}function ye(D,F,V){for(var R=0,j=D.length,re={},xe=0;xe<F.length;xe++){var Pe=F[xe];re[Pe]=!0}for(var Z=0;Z<V.length;Z++){var L=V[Z];re[L]=!1}for(var X=[];R<j&&(R=D.indexOf("<",R),R!==-1);){var K=R,ie=D.indexOf("<",R+1);R=D.indexOf(">",R),(R===-1||ie!==-1&&R>ie)&&y(D,K);var be=D.slice(K,R+1),nt=ve(be),Xe=nt.tag,mt=nt.position,et=re[Xe];et!=null&&X.push({type:"tag",position:mt,text:et,offset:K,value:be,tag:Xe})}return X}function _e(D,F,V){var R=[],j=!1,re={offset:0},xe,Pe=D.reduce(function(L,X){var K=X.position,ie=X.offset,be=re.offset,nt=re.length;if(xe=F.substr(be,ie-be),j&&K==="start"){if(be+nt===ie&&(xe=F.substr(be,ie-be+nt+4),!V.allowUnclosedTag))return R.push(g({xtag:xe,offset:be})),re=X,L.push(l(l({},X),{},{error:!0})),L;if(!V.allowUnclosedTag)return R.push(x({xtag:_(xe),offset:be})),re=X,L.push(l(l({},X),{},{error:!0})),L;L.pop()}return!j&&K==="end"?V.allowUnopenedTag?L:be+nt===ie?(xe=F.substr(be-4,ie-be+nt+4),R.push(w({xtag:xe,offset:be})),re=X,L.push(l(l({},X),{},{error:!0})),L):(R.push(E({xtag:xe,offset:ie})),re=X,L.push(l(l({},X),{},{error:!0})),L):(j=K==="start",re=X,L.push(X),L)},[]);if(j){var Z=re.offset;xe=F.substr(Z,F.length-Z),V.allowUnclosedTag?Pe.pop():R.push(x({xtag:_(xe),offset:Z}))}return{delimiterWithErrors:Pe,errors:R}}function ue(D,F){return D===-1&&F===-1?A:D===F?P:D===-1||F===-1?F<D?I:W:D<F?I:W}function ce(D){var F=D.split(" ");if(F.length!==2){var V=new b("New Delimiters cannot be parsed");throw V.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},V}var R=t(F,2),j=R[0],re=R[1];if(j.length===0||re.length===0){var xe=new b("New Delimiters cannot be parsed");throw xe.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},xe}return[j,re]}function De(D,F,V){var R=[],j=F.start,re=F.end,xe=-1,Pe=!1;if(j==null&&re==null)return[];for(;;){var Z=D.indexOf(j,xe+1),L=D.indexOf(re,xe+1),X=null,K=void 0,ie=ue(Z,L);switch(ie===P&&(ie=Pe?W:I),ie){case A:return R;case W:Pe=!1,xe=L,X="end",K=re.length;break;case I:Pe=!0,xe=Z,X="start",K=j.length;break}if(V.changeDelimiterPrefix&&ie===I&&D[xe+j.length]===V.changeDelimiterPrefix){R.push({offset:Z,position:"start",length:j.length,changedelimiter:!0});var be=D.indexOf(V.changeDelimiterPrefix,xe+j.length+1),nt=D.indexOf(re,be+1);R.push({offset:nt,position:"end",length:re.length,changedelimiter:!0});var Xe=D.substr(xe+j.length+1,be-xe-j.length-1),mt=ce(Xe),et=t(mt,2);j=et[0],re=et[1],xe=nt;continue}R.push({offset:xe,position:X,length:K})}}function Ve(D,F,V){var R=D.map(function(be){return be.value}).join(""),j=De(R,F,V),re=0,xe=D.map(function(be){return re+=be.value.length,{offset:re-be.value.length,lIndex:be.lIndex}}),Pe=_e(j,R,V),Z=Pe.delimiterWithErrors,L=Pe.errors,X=0,K=0,ie=xe.map(function(be,nt){for(var Xe=be.offset,mt=[Xe,Xe+D[nt].value.length],et=D[nt].value,Mt=[];K<Z.length&&te(mt,Z[K]);)Mt.push(Z[K]),K++;var Ee=[],Ne=0;X>0&&(Ne=X,X=0);for(var Re=0;Re<Mt.length;Re++){var He=Mt[Re],at=et.substr(Ne,He.offset-Xe-Ne);if(He.changedelimiter){He.position==="start"?at.length>0&&Ee.push({type:"content",value:at}):Ne=He.offset-Xe+He.length;continue}at.length>0&&(Ee.push({type:"content",value:at}),Ne+=at.length);var Tt={type:"delimiter",position:He.position,offset:Ne+Xe};Ee.push(Tt),Ne=He.offset-Xe+He.length}X=Ne-et.length;var Wt=et.substr(Ne);return Wt.length>0&&Ee.push({type:"content",value:Wt}),Ee},this);return{parsed:ie,errors:L}}function Y(D){return D.type==="content"&&D.position==="insidetag"}function se(D){return D.filter(Y)}function ee(D,F){for(var V=!1,R=0;R<D.length;R++){var j=D[R];V=oe(j,V),j.type==="content"&&(j.position=V?"insidetag":"outsidetag"),F!=="text"&&Y(j)&&(j.value=j.value.replace(/>/g,"&gt;"))}}return Tp={parseDelimiters:Ve,parse:function(F,V,R,j){ee(F,j);for(var re=Ve(se(F),V,R),xe=re.parsed,Pe=re.errors,Z=[],L=0,X=0,K=0;K<F.length;K++){var ie=F[K];if(Y(ie)){for(var be=0,nt=xe[L];be<nt.length;be++){var Xe=nt[be];Xe.type==="content"&&(Xe.position="insidetag"),Xe.lIndex=X++}S(Z,xe[L]),L++}else ie.lIndex=X++,Z.push(ie)}return{errors:Pe,lexed:Z}},xmlparse:function(F,V){for(var R=ye(F,V.text,V.other),j=0,re=[],xe=0;xe<R.length;xe++){var Pe=R[xe];F.length>j&&Pe.offset-j>0&&re.push({type:"content",value:F.substr(j,Pe.offset-j)}),j=Pe.offset+Pe.value.length,delete Pe.offset,re.push(Pe)}return F.length>j&&re.push({type:"content",value:F.substr(j)}),re}},Tp}var Sp,Ey;function HF(){if(Ey)return Sp;Ey=1;function e(l){return a(l)||n(l)||r(l)||t()}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(l,u){if(l){if(typeof l=="string")return i(l,u);var c={}.toString.call(l).slice(8,-1);return c==="Object"&&l.constructor&&(c=l.constructor.name),c==="Map"||c==="Set"?Array.from(l):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i(l,u):void 0}}function n(l){if(typeof Symbol<"u"&&l[Symbol.iterator]!=null||l["@@iterator"]!=null)return Array.from(l)}function a(l){if(Array.isArray(l))return i(l)}function i(l,u){(u==null||u>l.length)&&(u=l.length);for(var c=0,h=Array(u);c<u;c++)h[c]=l[c];return h}function s(l){return l.type==="placeholder"}function o(l){var u={},c=[{items:l.filter(s),parents:[],path:[]}];function h(ye,_e,ue){ue.length&&c.push({items:ue,parents:[].concat(e(_e.parents),[ye]),path:ye.dataBound!==!1&&!ye.attrParsed&&ye.value&&!ye.attrParsed?[].concat(e(_e.path),[ye.value]):e(_e.path)})}function p(ye,_e){for(var ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_e.length,ce=ye,De=0;De<ue;De++)ce=ce[_e[De]];return ce}function x(ye,_e){for(var ue=_e.length,ce=0;ce<_e.length;ce++){var De=_e[ce],Ve=typeof De.lIndex=="number"?De.lIndex:parseInt(De.lIndex.split("-")[0],10);Ve>ye.lIndex&&ue--}return ue}for(;c.length>0;)for(var E=c.pop(),g=p(u,E.path),w=0,v=E.items;w<v.length;w++){var y,b,T=v[w];if(T.attrParsed){for(var N in T.attrParsed)h(T,E,T.attrParsed[N].filter(s));continue}if(T.subparsed){if(T.dataBound!==!1){var k,_;(k=g)[_=T.value]||(k[_]={})}h(T,E,T.subparsed.filter(s));continue}if(T.cellParsed){for(var S=0,A=T.cellPostParsed;S<A.length;S++){var P=A[S];if(P.type==="placeholder"){if(P.module==="pro-xml-templating/xls-module-loop")continue;if(P.subparsed){var I,W;(I=g)[W=P.value]||(I[W]={}),h(P,E,P.subparsed.filter(s))}else{var te,oe,ve=x(T,E.parents);g=p(u,E.path,ve),(te=g)[oe=P.value]||(te[oe]={})}}}continue}T.dataBound!==!1&&((y=g)[b=T.value]||(y[b]={}))}return u}return Sp={getTags:o,isPlaceholder:s},Sp}var Ap,by;function VF(){if(by)return Ap;by=1;var e=Rr,t=e.pushArray;function r(a,i){return i instanceof Error?t(Object.getOwnPropertyNames(i),["stack"]).reduce(function(s,o){return s[o]=i[o],o==="stack"&&(s[o]=i[o].toString()),s},{}):i}function n(a,i){if(console.log(JSON.stringify({error:a},r,i==="json"?2:null)),a.properties&&a.properties.errors instanceof Array){var s=a.properties.errors.map(function(o){return o.properties.explanation}).join(`
`);console.log("errorMessages",s)}}return Ap=n,Ap}var Cp,_y;function gS(){if(_y)return Cp;_y=1;var e=Rr,t=e.pregMatchAll;return Cp=function(n,a){var i={content:n},s=a.join("|"),o=new RegExp("(?:(<(?:".concat(s,")[^>]*>)([^<>]*)</(?:").concat(s,")>)|(<(?:").concat(s,")[^>]*/>)"),"g");return i.matches=t(o,i.content),i},Cp}var Dp,Ty;function GF(){if(Ty)return Dp;Ty=1;function e(s){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},e(s)}var t=new RegExp("","g");function r(s){return s.replace(t," ")}function n(s,o){var l=e(s);if(l==="string")return r(o.substr(0,s.length))===s;if(s instanceof RegExp)return s.test(r(o));if(l==="function")return!!s(o)}function a(s,o){var l=e(s);if(l==="string")return r(o).substr(s.length);if(s instanceof RegExp)return r(o).match(s)[1];if(l==="function")return s(o)}function i(s,o){var l=e(s);if(l==="string")return[o,r(o).substr(s.length)];if(s instanceof RegExp)return r(o).match(s);if(l==="function")return[o,s(o)]}return Dp={match:n,getValue:a,getValues:i},Dp}var Np,Sy;function YF(){if(Sy)return Np;Sy=1;function e(_){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},e(_)}function t(_,S){var A=Object.keys(_);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(_);S&&(P=P.filter(function(I){return Object.getOwnPropertyDescriptor(_,I).enumerable})),A.push.apply(A,P)}return A}function r(_){for(var S=1;S<arguments.length;S++){var A=arguments[S]!=null?arguments[S]:{};S%2?t(Object(A),!0).forEach(function(P){n(_,P,A[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(A)):t(Object(A)).forEach(function(P){Object.defineProperty(_,P,Object.getOwnPropertyDescriptor(A,P))})}return _}function n(_,S,A){return(S=a(S))in _?Object.defineProperty(_,S,{value:A,enumerable:!0,configurable:!0,writable:!0}):_[S]=A,_}function a(_){var S=i(_,"string");return e(S)=="symbol"?S:S+""}function i(_,S){if(e(_)!="object"||!_)return _;var A=_[Symbol.toPrimitive];if(A!==void 0){var P=A.call(_,S);if(e(P)!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(_)}function s(_,S){return h(_)||c(_,S)||l(_,S)||o()}function o(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l(_,S){if(_){if(typeof _=="string")return u(_,S);var A={}.toString.call(_).slice(8,-1);return A==="Object"&&_.constructor&&(A=_.constructor.name),A==="Map"||A==="Set"?Array.from(_):A==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(A)?u(_,S):void 0}}function u(_,S){(S==null||S>_.length)&&(S=_.length);for(var A=0,P=Array(S);A<S;A++)P[A]=_[A];return P}function c(_,S){var A=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(A!=null){var P,I,W,te,oe=[],ve=!0,ye=!1;try{if(W=(A=A.call(_)).next,S!==0)for(;!(ve=(P=W.call(A)).done)&&(oe.push(P.value),oe.length!==S);ve=!0);}catch(_e){ye=!0,I=_e}finally{try{if(!ve&&A.return!=null&&(te=A.return(),Object(te)!==te))return}finally{if(ye)throw I}}return oe}}function h(_){if(Array.isArray(_))return _}var p=Rr,x=p.wordToUtf8,E=p.pushArray,g=GF(),w=g.match,v=g.getValue,y=g.getValues;function b(_,S){for(var A=[],P=0;P<_.length;P++){var I=_[P];if(I.matchers){var W=I.matchers(S);if(!(W instanceof Array))throw new Error("module matcher returns a non array");E(A,W)}}return A}function T(_,S,A){for(var P=[],I=0;I<_.length;I++){var W=_[I],te=s(W,2),oe=te[0],ve=te[1],ye=W[2]||{};if(A.match(oe,S)){var _e=A.getValues(oe,S);if(typeof ye=="function"&&(ye=ye(_e)),!ye.value){var ue=s(_e,2);ye.value=ue[1]}P.push(r({type:"placeholder",prefix:oe,module:ve,onMatch:ye.onMatch,priority:ye.priority},ye))}}return P}function N(_,S){var A=S.modules,P=S.startOffset,I=S.lIndex,W;S.offset=P,S.match=w,S.getValue=v,S.getValues=y;var te=b(A,S),oe=T(te,_,S);if(oe.length>0){for(var ve=null,ye=0;ye<oe.length;ye++){var _e=oe[ye];_e.priority||(_e.priority=-_e.value.length),(!ve||_e.priority>ve.priority)&&(ve=_e)}return ve.offset=P,delete ve.priority,ve.endLindex=I,ve.lIndex=I,ve.raw=_,ve.onMatch&&ve.onMatch(ve),delete ve.onMatch,delete ve.prefix,ve}for(var ue=0;ue<A.length;ue++){var ce=A[ue];if(W=ce.parse(_,S),W)return W.offset=P,W.endLindex=I,W.lIndex=I,W.raw=_,W}return{type:"placeholder",value:_,offset:P,endLindex:I,lIndex:I}}var k={preparse:function(S,A,P){function I(W,te){for(var oe=0;oe<A.length;oe++){var ve=A[oe];W=ve.preparse(W,te)||W}return W}return I(S,P)},parse:function(S,A,P){var I=!1,W="",te,oe=[],ve=P.fileTypeConfig.droppedTagsInsidePlaceholder||[];return S.reduce(function(ye,_e){return _e.type==="delimiter"?(I=_e.position==="start",_e.position==="end"&&(P.parse=function(ue){return N(ue,r(r(r({},P),_e),{},{startOffset:te,modules:A}))},ye.push(P.parse(x(W))),E(ye,oe),oe=[]),_e.position==="start"&&(oe=[],te=_e.offset),W="",ye):I?_e.type!=="content"||_e.position!=="insidetag"?(ve.indexOf(_e.tag)!==-1||oe.push(_e),ye):(W+=_e.value,ye):(ye.push(_e),ye)},[])},postparse:function(S,A,P){function I(oe,ve,ye){for(var _e=[],ue=0;ue<A.length;ue++){var ce=A[ue];_e.push(ce.getTraits(oe,ve,ye))}return _e}var W=[];function te(oe,ve){for(var ye=oe,_e=0;_e<A.length;_e++){var ue=A[_e],ce=ue.postparse(ye,r(r({},ve),{},{postparse:function(Ve,Y){return te(Ve,r(r({},ve),Y))},getTraits:I}));if(ce!=null){if(ce.errors){E(W,ce.errors),ye=ce.postparsed;continue}ye=ce}}return ye}return{postparsed:te(S,P),errors:W}}};return Np=k,Np}var kp,Ay;function xS(){if(Ay)return kp;Ay=1;function e(t,r){if(t.lIndex==null)return null;var n=r.scopeManager.scopePathItem;t.parentPart&&(n=n.slice(0,n.length-1));var a=r.filePath+"@"+t.lIndex.toString()+"-"+n.join("-");return a}return kp=e,kp}var Op,Cy;function XF(){if(Cy)return Op;Cy=1;var e=Ma,t=e.throwUnimplementedTagType,r=e.XTScopeParserError,n=Rr,a=n.pushArray,i=xS();function s(l,u){for(var c=0,h=u.modules;c<h.length;c++){var p=h[c],x=p.render(l,u);if(x)return x}return!1}function o(l){var u=l.baseNullGetter,c=l.compiled,h=l.scopeManager;l.nullGetter=function(N,k){return u(N,k||h)};for(var p=[],x=[],E=0,g=c.length;E<g;E++){var w=c[E];l.index=E,l.resolvedId=i(w,l);var v=void 0;try{v=s(w,l)}catch(N){if(N instanceof r){p.push(N),x.push(w);continue}throw N}if(v){v.errors&&a(p,v.errors),x.push(v);continue}if(w.type==="content"||w.type==="tag"){x.push(w);continue}t(w,E)}for(var y=[],b=0;b<x.length;b++){var T=x[b].value;T instanceof Array?a(y,T):T&&y.push(T)}return{errors:p,parts:y}}return Op=o,Op}var Fp,Dy;function KF(){if(Dy)return Fp;Dy=1;function e(r){var n,a,i,s,o=0,l=r.length;for(i=0;i<l;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<l&&(a=r.charCodeAt(i+1),(a&64512)===56320&&(n=65536+(n-55296<<10)+(a-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;var u=new Uint8Array(o);for(s=0,i=0;s<o;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<l&&(a=r.charCodeAt(i+1),(a&64512)===56320&&(n=65536+(n-55296<<10)+(a-56320),i++)),n<128?u[s++]=n:n<2048?(u[s++]=192|n>>>6,u[s++]=128|n&63):n<65536?(u[s++]=224|n>>>12,u[s++]=128|n>>>6&63,u[s++]=128|n&63):(u[s++]=240|n>>>18,u[s++]=128|n>>>12&63,u[s++]=128|n>>>6&63,u[s++]=128|n&63);return u}function t(r,n){for(var a=0,i=n.modules;a<i.length;a++){var s=i[a];r=s.postrender(r,n)}for(var o=0,l=n.joinUncorrupt(r,n),u="",c=0,h=65536,p=[],x=0,E=l.length;x<E;x++){var g=l[x];if(g.length+c>h){var w=e(u);o+=w.length,p.push(w),u=""}u+=g,c+=g.length,delete l[x]}var v=e(u);o+=v.length,p.push(v);for(var y=new Uint8Array(o),b=0,T=0;T<p.length;T++){for(var N=p[T],k=0;k<N.length;++k)y[k+b]=N[k];b+=N.length}return y}return Fp=t,Fp}var Pp,Ny;function ZF(){if(Ny)return Pp;Ny=1;function e(E){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},e(E)}function t(E,g){var w=Object.keys(E);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(E);g&&(v=v.filter(function(y){return Object.getOwnPropertyDescriptor(E,y).enumerable})),w.push.apply(w,v)}return w}function r(E){for(var g=1;g<arguments.length;g++){var w=arguments[g]!=null?arguments[g]:{};g%2?t(Object(w),!0).forEach(function(v){n(E,v,w[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(w)):t(Object(w)).forEach(function(v){Object.defineProperty(E,v,Object.getOwnPropertyDescriptor(w,v))})}return E}function n(E,g,w){return(g=a(g))in E?Object.defineProperty(E,g,{value:w,enumerable:!0,configurable:!0,writable:!0}):E[g]=w,E}function a(E){var g=i(E,"string");return e(g)=="symbol"?g:g+""}function i(E,g){if(e(E)!="object"||!E)return E;var w=E[Symbol.toPrimitive];if(w!==void 0){var v=w.call(E,g);if(e(v)!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(E)}var s=Rr,o=s.pushArray,l=xS();function u(E,g){for(var w=0,v=g.modules;w<v.length;w++){var y=v[w],b=y.resolve(E,g);if(b)return b}return!1}function c(E,g,w,v){var y=u(E,r(r({},v),{},{resolvedId:l(E,v)}));if(y)return y.then(function(b){g.push({tag:E.value,lIndex:E.lIndex,value:b})}).catch(function(b){b instanceof Array?o(w,b):w.push(b)});if(E.type==="placeholder")return v.scopeManager.getValueAsync(E.value,{part:E}).then(function(b){return b??v.nullGetter(E)}).then(function(b){g.push({tag:E.value,lIndex:E.lIndex,value:b})}).catch(function(b){b instanceof Array?o(w,b):w.push(b)})}function h(E){var g=[],w=[],v=E.baseNullGetter,y=E.scopeManager;E.nullGetter=function(T,N){return v(T,N||y)},E.resolved=g;var b=p(E,w,g);return b?b.then(function(){return x(E,w,g)}):x(E,w,g)}function p(E,g,w){for(var v=null,y=function(){var k=T[b];if(["content","tag"].indexOf(k.type)!==-1)return 1;k.resolveFirst&&(v??(v=Promise.resolve(null)),v=v.then(function(){return c(k,w,g,E)}))},b=0,T=E.compiled;b<T.length;b++)y();return v}function x(E,g,w){for(var v=[],y=0,b=E.compiled;y<b.length;y++){var T=b[y];["content","tag"].indexOf(T.type)===-1&&(T.resolveFirst||v.push(c(T,w,g,E)))}return Promise.all(v).then(function(){return{errors:g,resolved:w}})}return Pp=h,Pp}var Ip,ky;function QF(){if(ky)return Ip;ky=1;var e=Rr,t=e.startsWith,r=e.endsWith,n=e.isStarting,a=e.isEnding,i=e.isWhiteSpace,s=fx();function o(u){for(var c="",h=0,p=u.length;h<p;h++){var x=u[h];i(x)||t(x,"<w:bookmarkEnd")||(r(c,"</w:tbl>")&&!t(x,"<w:p")&&!t(x,"<w:tbl")&&!t(x,"<w:sectPr")&&!t(x,"</w:ftr>")&&!t(x,"</w:hdr>")&&(x="<w:p/>".concat(x)),c=x,u[h]=x)}return u}function l(u,c){var h=c.fileTypeConfig.tagShouldContain||[],p="",x=-1;s.docx.indexOf(c.contentType)!==-1&&(u=o(u));for(var E=-1,g=0,w=h.length;g<w;g++)for(var v=h[g],y=v.tag,b=v.shouldContain,T=v.value,N=v.drop,k=v.dropParent,_=0,S=u.length;_<S;_++){var A=u[_];if(x===g){if(a(A,y))if(x=-1,k){for(var P=-1,I=E;I>0;I--)if(n(u[I],k)){P=I;break}for(var W=P;W<=u.length;W++){if(a(u[W],k)){u[W]="";break}u[W]=""}}else{for(var te=E;te<=_;te++)u[te]="";N||(u[_]=p+T+A)}p+=A;for(var oe=0,ve=b.length;oe<ve;oe++){var ye=b[oe];if(n(A,ye)){x=-1;break}}}x===-1&&n(A,y)&&A.substr(1).indexOf("<")===-1&&(A[A.length-2]==="/"?u[_]="":(E=_,x=g,p=A))}return u}return Ip=l,Ip}var Rp,Oy;function JF(){if(Oy)return Rp;Oy=1;function e(y){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},e(y)}function t(y,b){if(!(y instanceof b))throw new TypeError("Cannot call a class as a function")}function r(y,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(y,a(N.key),N)}}function n(y,b,T){return b&&r(y.prototype,b),Object.defineProperty(y,"prototype",{writable:!1}),y}function a(y){var b=i(y,"string");return e(b)=="symbol"?b:b+""}function i(y,b){if(e(y)!="object"||!y)return y;var T=y[Symbol.toPrimitive];if(T!==void 0){var N=T.call(y,b);if(e(N)!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(y)}var s=Rr,o=s.pushArray,l=s.wordToUtf8,u=s.convertSpaces,c=gS(),h=mS(),p=YF(),x=XF(),E=KF(),g=ZF(),w=QF();function v(y,b){var T=c(y,b),N=T.matches.map(function(k){return k.array[2]});return l(u(N.join("")))}return Rp=function(){function y(b,T){t(this,y),this.cachedParsers={},this.content=b;for(var N in T)this[N]=T[N];this.setModules({inspect:{filePath:T.filePath}})}return n(y,[{key:"resolveTags",value:function(T){var N=this;this.tags=T;var k=this.getOptions(),_=this.filePath;k.scopeManager=this.scopeManager,k.resolve=g;var S=[];return Promise.all(this.modules.map(function(A){return Promise.resolve(A.preResolve(k)).catch(function(P){S.push(P)})})).then(function(){if(S.length!==0)throw S;return g(k).then(function(A){var P=A.resolved,I=A.errors;if(I=I.map(function(W){var te;return W instanceof Error||(W=new Error(W)),(te=W).properties||(te.properties={}),W.properties.file=_,W}),I.length!==0)throw I;return Promise.all(P).then(function(W){return k.scopeManager.root.finishedResolving=!0,k.scopeManager.resolved=W,N.setModules({inspect:{resolved:W,filePath:_}}),W})}).catch(function(A){throw N.errorChecker(A),A})})}},{key:"getFullText",value:function(){return v(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(T){for(var N=0,k=this.modules;N<k.length;N++){var _=k[N];_.set(T)}}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=h.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var T=h.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),N=T.lexed,k=T.errors;o(this.allErrors,k),this.lexed=N,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var _=this.getOptions();this.lexed=p.preparse(this.lexed,this.modules,_)}},{key:"parse",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=T.noPostParse;this.setModules({inspect:{filePath:this.filePath}});var k=this.getOptions();return this.parsed=p.parse(this.lexed,this.modules,k),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}}),N?this:this.postparse()}},{key:"postparse",value:function(){var T=this.getOptions(),N=p.postparse(this.parsed,this.modules,T),k=N.postparsed,_=N.errors;return this.postparsed=k,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),o(this.allErrors,_),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(T){for(var N=0,k=T;N<k.length;N++){var _=k[N];_.properties||(_.properties={}),_.properties.file=this.filePath}for(var S=0,A=this.modules;S<A.length;S++){var P=A[S];T=P.errorsTransformer(T)}}},{key:"baseNullGetter",value:function(T,N){for(var k=null,_=0,S=this.modules;_<S.length;_++){var A=S[_];k==null&&(k=A.nullGetter(T,N,this))}return k??this.nullGetter(T,N)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function(T){this.filePath=T;var N=this.getOptions();N.resolved=this.scopeManager.resolved,N.scopeManager=this.scopeManager,N.render=x,N.joinUncorrupt=w;var k=x(N),_=k.errors,S=k.parts;return _.length>0?(this.allErrors=_,this.errorChecker(_),this):(this.content=E(S,N),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}])}(),Rp}var Lp,Fy;function eP(){if(Fy)return Lp;Fy=1;function e(L){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},e(L)}function t(L,X){var K=Object.keys(L);if(Object.getOwnPropertySymbols){var ie=Object.getOwnPropertySymbols(L);X&&(ie=ie.filter(function(be){return Object.getOwnPropertyDescriptor(L,be).enumerable})),K.push.apply(K,ie)}return K}function r(L){for(var X=1;X<arguments.length;X++){var K=arguments[X]!=null?arguments[X]:{};X%2?t(Object(K),!0).forEach(function(ie){n(L,ie,K[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(L,Object.getOwnPropertyDescriptors(K)):t(Object(K)).forEach(function(ie){Object.defineProperty(L,ie,Object.getOwnPropertyDescriptor(K,ie))})}return L}function n(L,X,K){return(X=x(X))in L?Object.defineProperty(L,X,{value:K,enumerable:!0,configurable:!0,writable:!0}):L[X]=K,L}function a(L,X){return u(L)||l(L,X)||s(L,X)||i()}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s(L,X){if(L){if(typeof L=="string")return o(L,X);var K={}.toString.call(L).slice(8,-1);return K==="Object"&&L.constructor&&(K=L.constructor.name),K==="Map"||K==="Set"?Array.from(L):K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K)?o(L,X):void 0}}function o(L,X){(X==null||X>L.length)&&(X=L.length);for(var K=0,ie=Array(X);K<X;K++)ie[K]=L[K];return ie}function l(L,X){var K=L==null?null:typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(K!=null){var ie,be,nt,Xe,mt=[],et=!0,Mt=!1;try{if(nt=(K=K.call(L)).next,X!==0)for(;!(et=(ie=nt.call(K)).done)&&(mt.push(ie.value),mt.length!==X);et=!0);}catch(Ee){Mt=!0,be=Ee}finally{try{if(!et&&K.return!=null&&(Xe=K.return(),Object(Xe)!==Xe))return}finally{if(Mt)throw be}}return mt}}function u(L){if(Array.isArray(L))return L}function c(L,X){if(!(L instanceof X))throw new TypeError("Cannot call a class as a function")}function h(L,X){for(var K=0;K<X.length;K++){var ie=X[K];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(L,x(ie.key),ie)}}function p(L,X,K){return X&&h(L.prototype,X),Object.defineProperty(L,"prototype",{writable:!1}),L}function x(L){var X=E(L,"string");return e(X)=="symbol"?X:X+""}function E(L,X){if(e(L)!="object"||!L)return L;var K=L[Symbol.toPrimitive];if(K!==void 0){var ie=K.call(L,X);if(e(ie)!="object")return ie;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}var g=Rr,w=g.chunkBy,v=g.last,y=g.isParagraphStart,b=g.isModule,T=g.pushArray,N=g.isParagraphEnd,k=g.isContent,_=g.startsWith,S=g.isTagEnd,A=g.isTagStart,P=g.getSingleAttribute,I=g.setSingleAttribute,W=fx(),te=fo(),oe="loop";function ve(L){for(var X=0;X<L.length;X++){var K=L[X];if(k(K))return!0}return!1}function ye(L){for(var X=0;X<L.length;X++){var K=L[X];if(K.type!=="content")return K}return null}function _e(L){var X=ye(L.subparsed);return X!=null&&X.tag!=="w:t"}function ue(L){return L.hasPageBreak&&_e(L)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function ce(L){return L.length&&y(L[0])&&N(v(L))}function De(L){return ve(L)?0:L.length}function Ve(L){var X=L.parts.length-1;L.parts[X]==="</w:p>"?L.parts.splice(X,0,'<w:r><w:br w:type="page"/></w:r>'):L.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function Y(L){L.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function se(L){for(var X=0;X<L.length;X++){var K=L[X];if(A("w:type",K)&&K.value.indexOf("continuous")!==-1)return!0}return!1}function ee(L){for(var X=0;X<L.length;X++){var K=L[X];if(A("w:type",K)&&K.value.indexOf('w:val="nextPage"')!==-1)return!0}return!1}function D(L,X){L.unshift("<w:p><w:pPr>".concat(X.map(function(K){var ie=K.value;return ie}).join(""),"</w:pPr></w:p>"))}function F(L){for(var X=!1,K=!1,ie=0;ie<L.length;ie++){var be=L[ie];!X&&_(be,"<w:sectPr")&&(K=!0),K&&(_(be,"<w:type")&&(X=!0),!X&&_(be,"</w:sectPr")&&(L.splice(ie,0,'<w:type w:val="continuous"/>'),ie++))}return L}function V(L){for(var X=0,K=0;K<L.length;K++)!_(L[K],"<w:headerReference")&&!_(L[K],"<w:footerReference")&&(L[X]=L[K],X++);return L.length=X,L}function R(L){for(var X=0;X<L.length;X++){var K=L[X];if(K.tag==="w:br"&&K.value.indexOf('w:type="page"')!==-1)return!0}return!1}function j(L){for(var X=0;X<L.length;X++){var K=L[X];if(K.tag==="w:drawing")return!0}return!1}function re(L){for(var X=[],K=null,ie=0;ie<L.length;ie++){var be=L[ie];A("w:sectPr",be)&&(K=[],X.push(K)),K!==null&&K.push(be),S("w:sectPr",be)&&(K=null)}return X}function xe(L){for(var X=!1,K=0,ie=0;ie<L.length;ie++){var be=L[ie];A("w:sectPr",be)&&(X=!0),X&&(be.tag==="w:headerReference"||be.tag==="w:footerReference")&&(K++,X=!1),S("w:sectPr",be)&&(X=!1)}return K}function Pe(L){for(var X=[],K=!1,ie=L.length-1;ie>=0;ie--){var be=L[ie];if(S("w:sectPr",be)&&(K=!0),A("w:sectPr",be)&&(X.unshift(be.value),K=!1),K&&X.unshift(be.value),y(be)){if(X.length>0)return X.join("");break}}return""}var Z=function(){function L(){c(this,L),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}}return p(L,[{key:"optionsTransformer",value:function(K,ie){return this.docxtemplater=ie,K}},{key:"preparse",value:function(K,ie){var be=ie.contentType;W.main.indexOf(be)!==-1&&(this.sects=re(K))}},{key:"matchers",value:function(){var K=oe;return[[this.prefix.start,K,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,K,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,K,{location:"end"}],[this.prefix.dash,K,function(ie){var be=a(ie,3),nt=be[1],Xe=be[2];return{location:"start",inverted:!1,expandTo:nt,value:Xe}}]]}},{key:"getTraits",value:function(K,ie){if(K==="expandPair"){for(var be=[],nt=0,Xe=ie.length;nt<Xe;nt++){var mt=ie[nt];b(mt,oe)&&mt.subparsed==null&&be.push({part:mt,offset:nt})}return be}}},{key:"postparse",value:function(K,ie){var be=ie.basePart;if(be&&this.docxtemplater.fileType==="docx"&&K.length>0){be.sectPrCount=xe(K),this.totalSectPr+=be.sectPrCount;for(var nt=this.sects,Xe=0,mt=nt.length;Xe<mt;Xe++){var et=nt[Xe];if(be.lIndex<et[0].lIndex){Xe+1<nt.length&&se(nt[Xe+1])&&(be.addContinuousType=!0);break}if(K[0].lIndex<et[0].lIndex&&et[0].lIndex<be.lIndex){ee(nt[Xe])&&(be.addNextPage={index:Xe});break}}be.lastParagrapSectPr=Pe(K)}if(!be||be.expandTo!=="auto"||be.module!==oe||!ce(K))return K;be.paragraphLoop=!0;var Mt=0,Ee=w(K,function(Tt){return y(Tt)&&(Mt++,Mt===1)?"start":N(Tt)&&(Mt--,Mt===0)?"end":null}),Ne=Ee[0],Re=v(Ee),He=De(Ne),at=De(Re);return be.hasPageBreakBeginning=R(Ne),be.hasPageBreak=R(Re),j(Ne)&&(He=0),j(Re)&&(at=0),K.slice(He,K.length-at)}},{key:"resolve",value:function(K,ie){var be=this;if(!b(K,oe))return null;var nt=ie.scopeManager,Xe=nt.getValueAsync(K.value,{part:K}),mt=[],et;be.resolveSerially&&(et=Promise.resolve(null));function Mt(Ne,Re,He){var at=nt.createSubScopeManager(Ne,K.value,Re,K,He);be.resolveSerially?(et=et.then(function(){return ie.resolve(r(r({},ie),{},{compiled:K.subparsed,tags:{},scopeManager:at}))}),mt.push(et)):mt.push(ie.resolve(r(r({},ie),{},{compiled:K.subparsed,tags:{},scopeManager:at})))}var Ee=[];return Xe.then(function(Ne){return Ne??(Ne=ie.nullGetter(K)),Ne instanceof Promise?Ne.then(function(Re){return Re instanceof Array?Promise.all(Re):Re}):Ne instanceof Array?Promise.all(Ne):Ne}).then(function(Ne){return nt.loopOverValue(Ne,Mt,K.inverted),Promise.all(mt).then(function(Re){return Re.map(function(He){var at=He.resolved,Tt=He.errors;return T(Ee,Tt),at})}).then(function(Re){if(Ee.length>0)throw Ee;return Re})})}},{key:"render",value:function(K,ie){var be=this;if(K.tag==="p:xfrm"&&(be.inXfrm=K.position==="start"),K.tag==="a:ext"&&be.inXfrm)return be.lastExt=K,K;if(!b(K,oe))return null;var nt=[],Xe=[],mt=0,et=K.subparsed[0],Mt=0;(et==null?void 0:et.tag)==="a:tr"&&(Mt=+P(et.value,"h")),mt-=Mt;var Ee=0,Ne=_e(K);function Re(Wt,jt,lt){mt+=Mt;for(var we=ie.scopeManager.createSubScopeManager(Wt,K.value,jt,K,lt),he=0,J=K.subparsed;he<J.length;he++){var me=J[he];if(A("a16:rowId",me)){var Be=+P(me.value,"val")+Ee;Ee=1,me.value=I(me.value,"val",Be)}}var Ke=ie.render(r(r({},ie),{},{compiled:K.subparsed,tags:{},scopeManager:we}));K.hasPageBreak&&jt===lt-1&&Ne&&Ve(Ke);var ft=we.scopePathItem.some(function(Ct){return Ct!==0});ft?(K.sectPrCount===1&&(Ke.parts=V(Ke.parts)),K.addContinuousType&&(Ke.parts=F(Ke.parts))):K.addNextPage&&D(Ke.parts,be.sects[K.addNextPage.index]),K.addNextPage&&Ve(Ke),K.hasPageBreakBeginning&&Ne&&Y(Ke);for(var it=0,St=Ke.parts;it<St.length;it++){var Rt=St[it];nt.push(Rt)}T(Xe,Ke.errors)}var He=ie.scopeManager.getValue(K.value,{part:K});He??(He=ie.nullGetter(K));var at=ie.scopeManager.loopOverValue(He,Re,K.inverted);if(at===!1)return K.lastParagrapSectPr?K.paragraphLoop?{value:"<w:p><w:pPr>".concat(K.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(K.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:ue(K)||"",errors:Xe};if(mt!==0){var Tt=+P(be.lastExt.value,"cy");be.lastExt.value=I(be.lastExt.value,"cy",Tt+mt)}return{value:ie.joinUncorrupt(nt,r(r({},ie),{},{basePart:K})),errors:Xe}}}])}();return Lp=function(){return te(new Z)},Lp}var Mp,Py;function tP(){if(Py)return Mp;Py=1;function e(N){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},e(N)}function t(N,k){if(!(N instanceof k))throw new TypeError("Cannot call a class as a function")}function r(N,k){for(var _=0;_<k.length;_++){var S=k[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(N,a(S.key),S)}}function n(N,k,_){return k&&r(N.prototype,k),Object.defineProperty(N,"prototype",{writable:!1}),N}function a(N){var k=i(N,"string");return e(k)=="symbol"?k:k+""}function i(N,k){if(e(N)!="object"||!N)return N;var _=N[Symbol.toPrimitive];if(_!==void 0){var S=_.call(N,k);if(e(S)!="object")return S;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}var s=fo(),o=Rr,l=o.isTextStart,u=o.isTextEnd,c=o.endsWith,h=o.startsWith,p=o.pushArray,x='<w:t xml:space="preserve">',E=x.length,g="</w:t>",w=g.length;function v(N){return l(N)&&N.tag==="w:t"}function y(N,k){var _=N[k].value;return N[k+1].value==="</w:t>"||_.indexOf('xml:space="preserve"')!==-1?_:_.substr(0,_.length-1)+' xml:space="preserve">'}function b(N,k){return N&&N.basePart&&k.length>1}var T=function(){function N(){t(this,N),this.name="SpacePreserveModule"}return n(N,[{key:"postparse",value:function(_,S){var A=[],P=!1,I=0,W=0;function te(ve,ye){return ve.type==="placeholder"&&ye.length>1}var oe=_.reduce(function(ve,ye){return v(ye)&&(P=!0,W=A.length),P?(A.push(ye),b(S,A)&&(I=S.basePart.endLindex,A[0].value=y(A,0)),te(ye,A)&&(A[W].value=y(A,W),I=ye.endLindex),u(ye)&&ye.lIndex>I&&(I!==0&&(A[W].value=y(A,W)),p(ve,A),A=[],P=!1,I=0,W=0),ve):(ve.push(ye),ve)},[]);return p(oe,A),oe}},{key:"postrender",value:function(_){for(var S="",A=0,P=0,I=_.length;P<I;P++){var W=_[P];W!==""&&(c(S,x)&&h(W,g)&&(_[A]=S.substr(0,S.length-E)+"<w:t/>",W=W.substr(w)),S=W,A=P,_[P]=W)}return _}}])}();return Mp=function(){return s(new T)},Mp}var jp,Iy;function rP(){if(Iy)return jp;Iy=1;function e(w){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},e(w)}function t(w,v){if(!(w instanceof v))throw new TypeError("Cannot call a class as a function")}function r(w,v){for(var y=0;y<v.length;y++){var b=v[y];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(w,a(b.key),b)}}function n(w,v,y){return v&&r(w.prototype,v),Object.defineProperty(w,"prototype",{writable:!1}),w}function a(w){var v=i(w,"string");return e(v)=="symbol"?v:v+""}function i(w,v){if(e(w)!="object"||!w)return w;var y=w[Symbol.toPrimitive];if(y!==void 0){var b=y.call(w,v);if(e(b)!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(w)}var s=cx(),o=Rr,l=o.isContent,u=Ma,c=u.throwRawTagShouldBeOnlyTextInParagraph,h=u.getInvalidRawXMLValueException,p=fo(),x="rawxml";function E(w){for(var v=w.part,y=w.left,b=w.right,T=w.postparsed,N=w.index,k=T.slice(y+1,b),_=0,S=k.length;_<S;_++)if(_!==N-y-1){var A=k[_];l(A)&&c({paragraphParts:k,part:v})}return v}var g=function(){function w(){t(this,w),this.name="RawXmlModule",this.prefix="@"}return n(w,[{key:"optionsTransformer",value:function(y,b){return this.fileTypeConfig=b.fileTypeConfig,y}},{key:"matchers",value:function(){return[[this.prefix,x]]}},{key:"postparse",value:function(y){return s.expandToOne(y,{moduleName:x,getInner:E,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(T){return'The tag "'.concat(T.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(y,b){if(y.module!==x)return null;var T,N=[];try{T=b.scopeManager.getValue(y.value,{part:y}),T??(T=b.nullGetter(y))}catch(k){return N.push(k),{errors:N}}return T=T||"",typeof T=="string"?{value:T}:{errors:[h({tag:y.value,value:T,offset:y.offset})]}}}])}();return jp=function(){return p(new g)},jp}var Bp,Ry;function nP(){if(Ry)return Bp;Ry=1;function e(t,r){for(var n=-1,a=0,i=t.length;a<i;a++)r[a]>=t[a].length||(n===-1||t[a][r[a]].offset<t[n][r[n]].offset)&&(n=a);return n}return Bp=function(t){for(var r=0,n=0,a=t;n<a.length;n++){var i=a[n];r+=i.length}t=t.filter(function(c){return c.length>0});for(var s=new Array(r),o=t.map(function(){return 0}),l=0;l<r;l++){var u=e(t,o);s[l]=t[u][o[u]],o[u]++}return s},Bp}var Up,Ly;function aP(){if(Ly)return Up;Ly=1;function e(S){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},e(S)}function t(S,A){if(!(S instanceof A))throw new TypeError("Cannot call a class as a function")}function r(S,A){for(var P=0;P<A.length;P++){var I=A[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,a(I.key),I)}}function n(S,A,P){return A&&r(S.prototype,A),Object.defineProperty(S,"prototype",{writable:!1}),S}function a(S){var A=i(S,"string");return e(A)=="symbol"?A:A+""}function i(S,A){if(e(S)!="object"||!S)return S;var P=S[Symbol.toPrimitive];if(P!==void 0){var I=P.call(S,A);if(e(I)!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(S)}var s="expandPair",o=nP(),l=Rr,u=l.getLeft,c=l.getRight,h=l.pushArray,p=fo(),x=cx(),E=x.getExpandToDefault,g=Ma,w=g.getUnmatchedLoopException,v=g.getClosingTagNotMatchOpeningTag,y=g.getUnbalancedLoopException;function b(S){switch(S.location){case"start":return 1;case"end":return-1}}function T(S,A){return S!=null&&A!=null&&(S.part.location==="start"&&A.part.location==="end"&&S.part.value===A.part.value||A.part.value==="")}function N(S){for(var A=0,P=[];A<S.length;){var I=S[A].part;if(I.location==="end"){if(A===0)return S.splice(0,1),P.push(w(I)),{traits:S,errors:P};var W=A,te=A-1,oe=1;if(T(S[te],S[W]))return S.splice(W,1),S.splice(te,1),{errors:P,traits:S};for(;oe<50;){var ve=S[te-oe],ye=S[W+oe];if(T(ve,S[W]))return S.splice(W,1),S.splice(te-oe,1),{errors:P,traits:S};if(T(S[te],ye))return S.splice(W+oe,1),S.splice(te,1),{errors:P,traits:S};oe++}return P.push(v({tags:[S[te].part,S[W].part]})),S.splice(W,1),S.splice(te,1),{traits:S,errors:P}}A++}for(var _e=0;_e<S.length;_e++){var ue=S[_e].part;P.push(w(ue))}return{traits:[],errors:P}}function k(S){var A={},P=[],I=[],W=[];for(h(W,S);W.length>0;){var te=N(W);h(P,te.errors),W=te.traits}if(P.length>0)return{pairs:I,errors:P};for(var oe=0,ve=0;ve<S.length;ve++){var ye=S[ve],_e=ye.part,ue=b(_e);if(oe+=ue,ue===1)A[oe]=ye;else{var ce=A[oe+1];oe===0&&I.push([ce,ye])}oe=oe>=0?oe:0}return{pairs:I,errors:P}}var _=function(){function S(){t(this,S),this.name="ExpandPairTrait"}return n(S,[{key:"optionsTransformer",value:function(P,I){return I.options.paragraphLoop&&h(I.fileTypeConfig.expandTags,I.fileTypeConfig.onParagraphLoop),this.expandTags=I.fileTypeConfig.expandTags,P}},{key:"postparse",value:function(P,I){var W=this,te=I.getTraits,oe=I.postparse,ve=I.fileType,ye=te(s,P,I);ye=ye.map(function(F){return F||[]}),ye=o(ye);var _e=k(ye),ue=_e.pairs,ce=_e.errors,De=0,Ve=null,Y=ue.map(function(F){var V=F[0].part.expandTo;if(V==="auto"&&ve!=="text"){var R=E(P,F,W.expandTags);R.error&&ce.push(R.error),V=R.value}if(!V||ve==="text"){var j=F[0].offset,re=F[1].offset;return j<De&&!W.docxtemplater.options.syntax.allowUnbalancedLoops&&ce.push(y(F,Ve)),Ve=F,De=re,[j,re]}var xe,Pe;try{xe=u(P,V,F[0].offset)}catch(Z){ce.push(Z)}try{Pe=c(P,V,F[1].offset)}catch(Z){ce.push(Z)}return xe<De&&!W.docxtemplater.options.syntax.allowUnbalancedLoops&&ce.push(y(F,Ve)),De=Pe,Ve=F,[xe,Pe]});if(ce.length>0)return{postparsed:P,errors:ce};var se=0,ee,D=P.reduce(function(F,V,R){var j=se<ue.length&&Y[se][0]<=R&&R<=Y[se][1],re=ue[se],xe=Y[se];if(!j)return F.push(V),F;if(xe[0]===R&&(ee=[]),re[0].offset!==R&&re[1].offset!==R&&ee.push(V),xe[1]===R){var Pe=P[re[0].offset];Pe.subparsed=oe(ee,{basePart:Pe}),Pe.endLindex=re[1].part.lIndex,delete Pe.location,delete Pe.expandTo,F.push(Pe),se++;for(var Z=Y[se];Z&&Z[0]<R;)se++,Z=Y[se]}return F},[]);return{postparsed:D,errors:ce}}}])}();return Up=function(){return p(new _)},Up}var zp,My;function iP(){if(My)return zp;My=1;function e(k){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},e(k)}function t(k,_){if(!(k instanceof _))throw new TypeError("Cannot call a class as a function")}function r(k,_){for(var S=0;S<_.length;S++){var A=_[S];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(k,a(A.key),A)}}function n(k,_,S){return _&&r(k.prototype,_),Object.defineProperty(k,"prototype",{writable:!1}),k}function a(k){var _=i(k,"string");return e(_)=="symbol"?_:_+""}function i(k,_){if(e(k)!="object"||!k)return k;var S=k[Symbol.toPrimitive];if(S!==void 0){var A=S.call(k,_);if(e(A)!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(k)}var s=fo(),o=Ma,l=o.getScopeCompilationError,u=o.getCorruptCharactersException,c=Rr,h=c.utf8ToWord,p=c.hasCorruptCharacters,x=c.removeCorruptCharacters,E=pS(),g=E.settingsContentType,w=E.coreContentType,v=E.appContentType,y=E.customContentType,b=[g,w,v,y],T={docx:"w",pptx:"a"},N=function(){function k(){t(this,k),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return n(k,[{key:"set",value:function(S){S.compiled&&(this.compiled=S.compiled),S.data!=null&&(this.data=S.data)}},{key:"optionsTransformer",value:function(S,A){return this.docxtemplater=A,this.brTag=A.fileType==="docx"?"<w:r><w:br/></w:r>":"<a:br/>",this.prefix=T[A.fileType],this.runStartTag="".concat(this.prefix,":r"),this.runPropsStartTag="".concat(this.prefix,":rPr"),S}},{key:"postparse",value:function(S,A){for(var P=[],I=0;I<S.length;I++){var W=S[I];if(W.type==="placeholder"){var te=W.value;try{A.cachedParsers[W.lIndex]=this.docxtemplater.parser(te,{tag:W})}catch(oe){P.push(l({tag:te,rootError:oe,offset:W.offset}))}}}return{postparsed:S,errors:P}}},{key:"getRenderedMap",value:function(S){for(var A in this.compiled)S[A]={from:A,data:this.data};return S}},{key:"render",value:function(S,A){var P=A.contentType,I=A.scopeManager,W=A.linebreaks,te=A.nullGetter,oe=A.fileType,ve=A.stripInvalidXMLChars;if(b.indexOf(P)!==-1&&(W=!1),W&&this.recordRuns(S),!(S.type!=="placeholder"||S.module)){var ye;try{ye=I.getValue(S.value,{part:S})}catch(_e){return{errors:[_e]}}if(ye??(ye=te(S)),typeof ye=="string"){if(ve)ye=x(ye);else if(["docx","pptx","xlsx"].indexOf(oe)!==-1&&p(ye))return{errors:[u({tag:S.value,value:ye,offset:S.offset})]}}return oe==="text"?{value:ye}:{value:W&&typeof ye=="string"?this.renderLineBreaks(ye):h(ye)}}}},{key:"recordRuns",value:function(S){S.tag===this.runStartTag?this.recordedRun="":S.tag===this.runPropsStartTag?(S.position==="start"&&(this.recordRun=!0,this.recordedRun+=S.value),(S.position==="end"||S.position==="selfclosing")&&(this.recordedRun+=S.value,this.recordRun=!1)):this.recordRun&&(this.recordedRun+=S.value)}},{key:"renderLineBreaks",value:function(S){for(var A=[],P=S.split(`
`),I=0,W=P.length;I<W;I++)A.push(h(P[I])),I<P.length-1&&A.push("</".concat(this.prefix,":t></").concat(this.prefix,":r>").concat(this.brTag,"<").concat(this.prefix,":r>").concat(this.recordedRun,"<").concat(this.prefix,":t").concat(this.docxtemplater.fileType==="docx"?' xml:space="preserve"':"",">"));return A}}])}();return zp=function(){return s(new N)},zp}var Wp,jy;function sP(){if(jy)return Wp;jy=1;var e=eP(),t=tP(),r=rP(),n=aP(),a=iP();function i(){return{getTemplatedFiles:function(){return[]},templatedNs:["http://schemas.microsoft.com/office/2006/coverPageProps"],textPath:function(l){return l.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","PublishDate","Abstract","CompanyAddress","CompanyPhone","CompanyFax","CompanyEmail","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:ftr","w:hdr","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[e,t,n,r,a],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:!0},{tag:"w:tbl",shouldContain:["w:tr"],drop:!0}]}}function s(){return{getTemplatedFiles:function(){return[]},textPath:function(l){return l.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[e,n,r,a],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}return Wp={docx:i,pptx:s},Wp}(function(e){var t=["modules"];function r(we,he){var J=Object.keys(we);if(Object.getOwnPropertySymbols){var me=Object.getOwnPropertySymbols(we);he&&(me=me.filter(function(Be){return Object.getOwnPropertyDescriptor(we,Be).enumerable})),J.push.apply(J,me)}return J}function n(we){for(var he=1;he<arguments.length;he++){var J=arguments[he]!=null?arguments[he]:{};he%2?r(Object(J),!0).forEach(function(me){a(we,me,J[me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(J)):r(Object(J)).forEach(function(me){Object.defineProperty(we,me,Object.getOwnPropertyDescriptor(J,me))})}return we}function a(we,he,J){return(he=v(he))in we?Object.defineProperty(we,he,{value:J,enumerable:!0,configurable:!0,writable:!0}):we[he]=J,we}function i(we,he){return c(we)||u(we,he)||o(we,he)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(we,he){if(we){if(typeof we=="string")return l(we,he);var J={}.toString.call(we).slice(8,-1);return J==="Object"&&we.constructor&&(J=we.constructor.name),J==="Map"||J==="Set"?Array.from(we):J==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(J)?l(we,he):void 0}}function l(we,he){(he==null||he>we.length)&&(he=we.length);for(var J=0,me=Array(he);J<he;J++)me[J]=we[J];return me}function u(we,he){var J=we==null?null:typeof Symbol<"u"&&we[Symbol.iterator]||we["@@iterator"];if(J!=null){var me,Be,Ke,ft,it=[],St=!0,Rt=!1;try{if(Ke=(J=J.call(we)).next,he===0){if(Object(J)!==J)return;St=!1}else for(;!(St=(me=Ke.call(J)).done)&&(it.push(me.value),it.length!==he);St=!0);}catch(Ct){Rt=!0,Be=Ct}finally{try{if(!St&&J.return!=null&&(ft=J.return(),Object(ft)!==ft))return}finally{if(Rt)throw Be}}return it}}function c(we){if(Array.isArray(we))return we}function h(we){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(he){return typeof he}:function(he){return he&&typeof Symbol=="function"&&he.constructor===Symbol&&he!==Symbol.prototype?"symbol":typeof he},h(we)}function p(we,he){if(we==null)return{};var J,me,Be=x(we,he);if(Object.getOwnPropertySymbols){var Ke=Object.getOwnPropertySymbols(we);for(me=0;me<Ke.length;me++)J=Ke[me],he.indexOf(J)===-1&&{}.propertyIsEnumerable.call(we,J)&&(Be[J]=we[J])}return Be}function x(we,he){if(we==null)return{};var J={};for(var me in we)if({}.hasOwnProperty.call(we,me)){if(he.indexOf(me)!==-1)continue;J[me]=we[me]}return J}function E(we,he){if(!(we instanceof he))throw new TypeError("Cannot call a class as a function")}function g(we,he){for(var J=0;J<he.length;J++){var me=he[J];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(we,v(me.key),me)}}function w(we,he,J){return he&&g(we.prototype,he),Object.defineProperty(we,"prototype",{writable:!1}),we}function v(we){var he=y(we,"string");return h(he)=="symbol"?he:he+""}function y(we,he){if(h(we)!="object"||!we)return we;var J=we[Symbol.toPrimitive];if(J!==void 0){var me=J.call(we,he);if(h(me)!="object")return me;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(we)}var b=Rr,T=UF,N=T.object({allowUnopenedTag:T.boolean().optional(),allowUnclosedTag:T.boolean().optional(),allowUnbalancedLoops:T.boolean().optional(),changeDelimiterPrefix:T.string().optional().nullable()}),k=T.object({delimiters:T.object({start:T.string().nullable(),end:T.string().nullable()}).strict().optional(),fileTypeConfig:T.object({}).optional(),paragraphLoop:T.boolean().optional(),parser:T.function().optional(),errorLogging:T.union([T.boolean(),T.string()]).optional(),linebreaks:T.boolean().optional(),nullGetter:T.function().optional(),syntax:N.optional(),stripInvalidXMLChars:T.boolean().optional(),warnFn:T.function().optional()}).strict(),_=zF(),S=_.getRelsTypes,A=WF(),P=A.collectContentTypes,I=A.getContentTypes,W=fo(),te=cx(),oe=qF(),ve=$F(),ye=mS(),_e=HF(),ue=_e.getTags,ce=VF(),De=Ma,Ve=De.throwMultiError,Y=De.throwResolveBeforeCompile,se=De.throwRenderInvalidTemplate,ee=De.throwRenderTwice,D=De.XTInternalError,F=De.XTTemplateError,V=De.throwFileTypeNotIdentified,R=De.throwFileTypeNotHandled,j=De.throwApiVersionError;b.getRelsTypes=S,b.traits=te,b.moduleWrapper=W,b.collectContentTypes=P,b.getContentTypes=I;var re=b.getDefaults,xe=b.str2xml,Pe=b.xml2str,Z=b.concatArrays,L=b.uniq,X=b.getDuplicates,K=b.stableSort,ie=b.pushArray,be=b.utf8ToWord,nt=b.invertMap,Xe="[Content_Types].xml",mt="_rels/.rels",et=[3,47,2];function Mt(we){var he=X(we.map(function(J){var me=J.name;return me}));if(he.length>0)throw new D('Detected duplicate module "'.concat(he[0],'"'))}function Ee(we){for(var he=0,J=we.modules;he<J.length;he++)for(var me=J[he],Be=0,Ke=me.xmlContentTypes||[];Be<Ke.length;Be++)for(var ft=Ke[Be],it=we.invertedContentTypes[ft]||[],St=0;St<it.length;St++){var Rt=it[St];we.zip.files[Rt]&&we.options.xmlFileNames.push(Rt)}}function Ne(we){return K(we,function(he,J){return(J.priority||0)-(he.priority||0)})}function Re(we){var he=[];for(var J in we)he.push(J);for(var me=[Xe,mt],Be=["word/","xl/","ppt/"],Ke=0;Ke<he.length;Ke++)for(var ft=he[Ke],it=0;it<Be.length;it++){var St=Be[it];ft.indexOf("".concat(St))===0&&me.push(ft)}for(var Rt=0;Rt<he.length;Rt++){var Ct=he[Rt];me.indexOf(Ct)===-1&&me.push(Ct)}return me}function He(we,he){we.hideDeprecations!==!0&&console.warn(he)}function at(we,he){if(we.hideDeprecations!==!0)return He(we,'Deprecated method ".'.concat(he,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat(new Error().stack))}function Tt(we){we.modules=we.modules.filter(function(he){if(!he.supportedFileTypes)return!0;if(!Array.isArray(he.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var J=he.supportedFileTypes.includes(we.fileType);return J||he.on("detached"),J})}function Wt(we){var he=we.compiled;we.errors=Z(Object.keys(he).map(function(J){return he[J].allErrors})),we.errors.length!==0&&(we.options.errorLogging&&ce(we.errors,we.options.errorLogging),Ve(we.errors))}function jt(we){return typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(we)}var lt=function(){function we(he){var J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},me=J.modules,Be=me===void 0?[]:me,Ke=p(J,t);if(E(this,we),this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[oe()],this.xmlDocuments={},arguments.length===0)He(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat(new Error().stack)),this.hideDeprecations=!0,this.setOptions(Ke);else{if(this.hideDeprecations=!0,this.setOptions(Ke),jt(he))throw new Error("You passed a Buffer to the Docxtemplater constructor. The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!he||!he.files||typeof he.file!="function")throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!Array.isArray(Be))throw new Error("The modules argument of docxtemplater's constructor must be an array");for(var ft=0;ft<Be.length;ft++){var it=Be[ft];this.attachModule(it)}this.loadZip(he),this.compile(),this.v4Constructor=!0}this.hideDeprecations=!1}return w(we,[{key:"verifyApiVersion",value:function(J){return J=J.split(".").map(function(me){return parseInt(me,10)}),J.length!==3&&j("neededVersion is not a valid version",{neededVersion:J,explanation:"the neededVersion must be an array of length 3"}),J[0]!==et[0]&&j("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:J,currentModuleApiVersion:et,explanation:"moduleAPIVersionMismatch : needed=".concat(J.join("."),", current=").concat(et.join("."))}),J[1]>et[1]&&j("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:J,currentModuleApiVersion:et,explanation:"moduleAPIVersionMismatch : needed=".concat(J.join("."),", current=").concat(et.join("."))}),J[1]===et[1]&&J[2]>et[2]&&j("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:J,currentModuleApiVersion:et,explanation:"moduleAPIVersionMismatch : needed=".concat(J.join("."),", current=").concat(et.join("."))}),!0}},{key:"setModules",value:function(J){for(var me=0,Be=this.modules;me<Be.length;me++){var Ke=Be[me];Ke.set(J)}}},{key:"sendEvent",value:function(J){for(var me=0,Be=this.modules;me<Be.length;me++){var Ke=Be[me];Ke.on(J)}}},{key:"attachModule",value:function(J){if(this.v4Constructor)throw new D("attachModule() should not be called manually when using the v4 constructor");at(this,"attachModule");var me=h(J);if(me==="function")throw new D("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!J||me!=="object")throw new D("Cannot attachModule with a falsy value");if(J.requiredAPIVersion&&this.verifyApiVersion(J.requiredAPIVersion),J.attached===!0)if(typeof J.clone=="function")J=J.clone();else throw new Error('Cannot attach a module that was already attached : "'.concat(J.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));J.attached=!0;var Be=W(J);return this.modules.push(Be),Be.on("attached"),this.fileType&&Tt(this),this}},{key:"findModule",value:function(J){for(var me=0,Be=this.modules;me<Be.length;me++){var Ke=Be[me];if(Ke.name===J)return Ke}}},{key:"setOptions",value:function(J){var me,Be;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!J)throw new Error("setOptions should be called with an object as first parameter");var Ke=k.validate(J);if(Ke.success===!1)throw new Error(Ke.error);at(this,"setOptions"),this.options={};var ft=re();for(var it in ft){var St=ft[it];this.options[it]=J[it]!=null?J[it]:this[it]||St,this[it]=this.options[it]}return(me=this.delimiters).start&&(me.start=be(this.delimiters.start)),(Be=this.delimiters).end&&(Be.end=be(this.delimiters.end)),this}},{key:"loadZip",value:function(J){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if(at(this,"loadZip"),J.loadAsync)throw new D("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");J.xtRendered&&this.options.warnFn([new Error("This zip file appears to be the outcome of a previous docxtemplater generation. This typically indicates that docxtemplater was integrated by reusing the same zip file. It is recommended to create a new Pizzip instance for each docxtemplater generation.")]),this.zip=J,this.updateFileTypeConfig(),this.modules=Z([this.fileTypeConfig.baseModules.map(function(ft){return ft()}),this.modules]);for(var me=0,Be=this.modules;me<Be.length;me++){var Ke=Be[me];Ke.zip=this.zip,Ke.docxtemplater=this,Ke.fileTypeConfig=this.fileTypeConfig,Ke.fileType=this.fileType,Ke.xtOptions=this.options,Ke.modules=this.modules}return Tt(this),this}},{key:"precompileFile",value:function(J){var me=this.createTemplateClass(J);me.preparse(),this.compiled[J]=me}},{key:"compileFile",value:function(J){this.compiled[J].parse()}},{key:"getScopeManager",value:function(J,me,Be){var Ke;return(Ke=this.scopeManagers)[J]||(Ke[J]=ve({tags:Be,parser:this.parser,cachedParsers:me.cachedParsers})),this.scopeManagers[J]}},{key:"resolveData",value:function(J){var me=this;at(this,"resolveData");var Be=[];return Object.keys(this.compiled).length||Y(),Promise.resolve(J).then(function(Ke){return me.data=Ke,me.setModules({data:me.data,Lexer:ye}),me.mapper=me.modules.reduce(function(ft,it){return it.getRenderedMap(ft)},{}),Promise.all(Object.keys(me.mapper).map(function(ft){var it=me.mapper[ft],St=it.from,Rt=it.data;return Promise.resolve(Rt).then(function(Ct){var Ut=me.compiled[St];return Ut.filePath=ft,Ut.scopeManager=me.getScopeManager(ft,Ut,Ct),Ut.resolveTags(Ct).then(function(xt){return Ut.scopeManager.finishedResolving=!0,xt},function(xt){ie(Be,xt)})})})).then(function(ft){return Be.length!==0&&(me.options.errorLogging&&ce(Be,me.options.errorLogging),Ve(Be)),Z(ft)})})}},{key:"compile",value:function(){if(at(this,"compile"),this.updateFileTypeConfig(),Mt(this.modules),this.modules=Ne(this.modules),Object.keys(this.compiled).length)return this;for(var J=this.options,me=0,Be=this.modules;me<Be.length;me++){var Ke=Be[me];J=Ke.optionsTransformer(J,this)}this.options=J,this.options.xmlFileNames=L(this.options.xmlFileNames);for(var ft=0,it=this.options.xmlFileNames;ft<it.length;ft++){var St=it[ft],Rt=this.zip.files[St].asText();this.xmlDocuments[St]=xe(Rt)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments});for(var Ct=0,Ut=this.modules;Ct<Ut.length;Ct++){var xt=Ut[Ct];xt.xmlDocuments=this.xmlDocuments}this.getTemplatedFiles(),this.sendEvent("before-preparse");for(var an=0,ea=this.templatedFiles;an<ea.length;an++){var ja=ea[an];this.zip.files[ja]!=null&&this.precompileFile(ja)}this.sendEvent("after-preparse");for(var gn=0,Ba=this.templatedFiles;gn<Ba.length;gn++){var ta=Ba[gn];this.zip.files[ta]!=null&&this.compiled[ta].parse({noPostParse:!0})}this.sendEvent("after-parse");for(var $r=0,Hr=this.templatedFiles;$r<Hr.length;$r++){var ra=Hr[$r];this.zip.files[ra]!=null&&this.compiled[ra].postparse()}return this.sendEvent("after-postparse"),this.setModules({compiled:this.compiled}),Wt(this),this}},{key:"updateFileTypeConfig",value:function(){this.relsTypes=S(this.zip);var J=I(this.zip),me=J.overrides,Be=J.defaults,Ke=J.contentTypes,ft=J.contentTypeXml;ft&&(this.filesContentTypes=P(me,Be,this.zip),this.invertedContentTypes=nt(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes}));var it;this.zip.files.mimetype&&(it="odt");for(var St=0,Rt=this.modules;St<Rt.length;St++){var Ct=Rt[St];it=Ct.getFileType({zip:this.zip,contentTypes:Ke,contentTypeXml:ft,overrides:me,defaults:Be,doc:this})||it}if(this.fileType=it,it==="odt"&&R(it),it||V(this.zip),Ee(this),Tt(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig,!this.fileTypeConfig)if(we.FileTypeConfig[this.fileType])this.fileTypeConfig=we.FileTypeConfig[this.fileType]();else{var Ut='Filetype "'.concat(this.fileType,'" is not supported'),xt="filetype_not_supported";this.fileType==="xlsx"&&(Ut='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule'),xt="xlsx_filetype_needs_xlsx_module");var an=new F(Ut);throw an.properties={id:xt,explanation:Ut},an}return this}},{key:"renderAsync",value:function(J){var me=this;this.hideDeprecations=!0;var Be=this.resolveData(J);return this.hideDeprecations=!1,this.zip.xtRendered=!0,Be.then(function(){return me.render()})}},{key:"render",value:function(J){this.zip.xtRendered=!0,this.rendered&&ee(),this.rendered=!0,Object.keys(this.compiled).length===0&&this.compile(),this.errors.length>0&&se(),arguments.length>0&&(this.data=J),this.setModules({data:this.data,Lexer:ye}),this.mapper||(this.mapper=this.modules.reduce(function(zl,O){return O.getRenderedMap(zl)},{}));var me=[];for(var Be in this.mapper){var Ke=this.mapper[Be],ft=Ke.from,it=Ke.data,St=this.compiled[ft];St.scopeManager=this.getScopeManager(Be,St,it),St.render(Be),me.push([Be,St.content,St]),delete St.content}for(var Rt=0;Rt<me.length;Rt++)for(var Ct=me[Rt],Ut=i(Ct,3),xt=Ut[1],an=Ut[2],ea=0,ja=this.modules;ea<ja.length;ea++){var gn=ja[ea];if(gn.preZip){var Ba=gn.preZip(xt,an);typeof Ba=="string"&&(Ct[1]=Ba)}}for(var ta=0;ta<me.length;ta++){var $r=i(me[ta],2),Hr=$r[0],ra=$r[1];this.zip.file(Hr,ra,{createFolders:!0})}return Wt(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){for(var J in this.xmlDocuments){this.zip.remove(J);var me=Pe(this.xmlDocuments[J]);this.zip.file(J,me,{createFolders:!0})}}},{key:"setData",value:function(J){return at(this,"setData"),this.data=J,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(J){var me=this.zip.files[J].asText();return this.createTemplateClassFromContent(me,J)}},{key:"createTemplateClassFromContent",value:function(J,me){for(var Be={filePath:me,contentType:this.filesContentTypes[me],relsType:this.relsTypes[me]},Ke=re(),ft=ie(Object.keys(Ke),["filesContentTypes","fileTypeConfig","fileType","modules"]),it=0;it<ft.length;it++){var St=ft[it];Be[St]=this[St]}return new we.XmlTemplater(J,Be)}},{key:"getFullText",value:function(J){return this.createTemplateClass(J||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),ie(this.templatedFiles,this.targets);var J=this.fileTypeConfig.templatedNs||[];if(J.length>0){for(var me in this.filesContentTypes)if(/^customXml\/item\d+\.xml$/.test(me))for(var Be=0;Be<J.length;Be++){var Ke=J[Be],ft=this.zip.file(me).asText();ft.indexOf('xmlns="'.concat(Ke,'"'))!==-1&&this.templatedFiles.push(me)}}return this.templatedFiles=L(this.templatedFiles),this.templatedFiles}},{key:"getTags",value:function(){var J={headers:[],footers:[]};for(var me in this.compiled){var Be=this.filesContentTypes[me];Be==="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"&&(J.document={target:me,tags:ue(this.compiled[me].postparsed)}),Be==="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"&&J.headers.push({target:me,tags:ue(this.compiled[me].postparsed)}),Be==="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"&&J.footers.push({target:me,tags:ue(this.compiled[me].postparsed)})}return J}},{key:"toBuffer",value:function(J){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Re},J),{},{type:"nodebuffer"}))}},{key:"toBlob",value:function(J){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Re},J),{},{type:"blob"}))}},{key:"toBase64",value:function(J){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Re},J),{},{type:"base64"}))}},{key:"toUint8Array",value:function(J){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Re},J),{},{type:"uint8array"}))}},{key:"toArrayBuffer",value:function(J){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Re},J),{},{type:"arraybuffer"}))}}])}();lt.DocUtils=b,lt.Errors=Ma,lt.XmlTemplater=JF(),lt.FileTypeConfig=sP(),lt.XmlMatcher=gS(),e.exports=lt,e.exports.default=lt})(yT);var oP=yT.exports;const lP=Pg(oP);var vS={exports:{}};(function(e,t){(function(r,n){n()})(ko,function(){function r(u,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function n(u,c,h){var p=new XMLHttpRequest;p.open("GET",u),p.responseType="blob",p.onload=function(){l(p.response,c,h)},p.onerror=function(){console.error("could not download file")},p.send()}function a(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ko=="object"&&ko.global===ko?ko:void 0,o=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(u,c,h){var p=s.URL||s.webkitURL,x=document.createElement("a");c=c||u.name||"download",x.download=c,x.rel="noopener",typeof u=="string"?(x.href=u,x.origin===location.origin?i(x):a(x.href)?n(u,c,h):i(x,x.target="_blank")):(x.href=p.createObjectURL(u),setTimeout(function(){p.revokeObjectURL(x.href)},4e4),setTimeout(function(){i(x)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,h){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(r(u,h),c);else if(a(u))n(u,c,h);else{var p=document.createElement("a");p.href=u,p.target="_blank",setTimeout(function(){i(p)})}}:function(u,c,h,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof u=="string")return n(u,c,h);var x=u.type==="application/octet-stream",E=/constructor/i.test(s.HTMLElement)||s.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||x&&E||o)&&typeof FileReader<"u"){var w=new FileReader;w.onloadend=function(){var b=w.result;b=g?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=b:location=b,p=null},w.readAsDataURL(u)}else{var v=s.URL||s.webkitURL,y=v.createObjectURL(u);p?p.location=y:location.href=y,p=null,setTimeout(function(){v.revokeObjectURL(y)},4e4)}});s.saveAs=l.saveAs=l,e.exports=l})})(vS);var uP=vS.exports;function cP(){return Math.random()<.5?{text:"",value:"6.00"}:{text:". ",value:"5.00"}}function By(e){return e.replace(/[/\\:*?"<>|]/g,"").replace(/\s+/g,"_").substring(0,200)}async function yS(e,t,r){console.log(" Starting certificate generation for:",e.personName);try{if(!e.personName||!e.uniqueNumber)throw new Error("Missing required participant fields: personName or uniqueNumber");if(!t)throw new Error("Group information is required for certificate generation");const n=(t.groupNumber||0)*5;console.log(` Group ${t.groupNumber||"planned"} => F08 = ${n}`),console.log(" Fetching template from /Certify-app/template.docx...");const i=await fetch("/Certify-app/template.docx");if(!i.ok)throw console.error(" Template fetch failed:",i.status,i.statusText),new Error(`Template not found: ${i.status} ${i.statusText}. Please ensure template.docx exists in /public/ folder.`);const s=await i.arrayBuffer();console.log(" Template loaded successfully, size:",s.byteLength,"bytes");const o=new v6(s),l=new lP(o,{paragraphLoop:!0,linebreaks:!0,delimiters:{start:"{{",end:"}}"}}),u=cP();console.log(" Random grade selected:",u.text,`(${u.value})`);const c=r||e.courseEndDate,h=rt(c),p=new Date(c).getFullYear().toString(),x={F01:String(e.uniqueNumber||""),F02:h,F03:String(e.personName||""),F04:String(e.egn||""),F05:String(e.birthPlace||""),F06:String(e.citizenship||""),F07:p,F08:String(n),F09:u.text,F10:u.value};console.log(" Certificate data prepared:",{uniqueNumber:x.F01,name:x.F03,egn:x.F04,birthPlace:x.F05,citizenship:x.F06,year:x.F07,protocol:x.F08,grade:`${x.F09} (${x.F10})`}),console.log(" Rendering document..."),l.render(x),console.log(" Document rendered successfully");const E=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),g=By(e.personName),v=`udostoverenie_${By(e.uniqueNumber)}_${g}.docx`;console.log(" Saving file:",v),uP.saveAs(E,v),console.log(" Certificate generated successfully!")}catch(n){throw console.error(" Certificate generation failed:",n),n instanceof Error&&(n.message.includes("Template not found")?console.error(" Make sure template.docx file exists in /public/ folder"):n.message.includes("render")&&console.error(" Check if all placeholders in template match {{F01}} to {{F10}}")),n}}const dx=({isOpen:e,onClose:t,title:r,message:n,buttonText:a="OK",variant:i="info"})=>{if(Ae.useEffect(()=>{const u=c=>{c.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[e,t]),!e)return null;const s=()=>{switch(i){case"danger":case"error":return f.jsx(qk,{className:"w-6 h-6 text-red-600"});case"warning":return f.jsx(xc,{className:"w-6 h-6 text-amber-600"});case"success":return f.jsx(Qs,{className:"w-6 h-6 text-emerald-600"});default:return f.jsx(q1,{className:"w-6 h-6 text-blue-600"})}},o=()=>{switch(i){case"danger":case"error":return"bg-red-50 text-red-900 border-red-100";case"warning":return"bg-amber-50 text-amber-900 border-amber-100";case"success":return"bg-emerald-50 text-emerald-900 border-emerald-100";default:return"bg-blue-50 text-blue-900 border-blue-100"}},l=()=>{switch(i){case"danger":case"error":return"bg-red-600 hover:bg-red-700 focus:ring-red-500";case"warning":return"bg-amber-600 hover:bg-amber-700 focus:ring-amber-500";case"success":return"bg-emerald-600 hover:bg-emerald-700 focus:ring-emerald-500";default:return"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 transition-opacity",onClick:t}),f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-sm w-full md:max-w-md lg:max-w-lg overflow-hidden animate-scale-up transform transition-all",children:[f.jsxs("div",{className:"p-6 md:p-8 text-center",children:[f.jsx("div",{className:`mx-auto mb-4 w-12 h-12 rounded-full flex items-center justify-center ${o()}`,children:s()}),f.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:r}),f.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:n})]}),f.jsx("div",{className:"p-4 bg-slate-50 border-t border-slate-100",children:f.jsx("button",{onClick:t,className:`w-full px-5 py-2.5 text-white rounded-lg font-medium shadow-md transition-all duration-200 transform hover:-translate-y-0.5 ${l()}`,children:a})})]})})]})},fP=({participants:e,onEdit:t,onDelete:r,collapsedSections:n,toggleSection:a,groupRefreshKey:i=0})=>{var Pe;const{updateParticipant:s}=Kd(),{t:o}=qr(),[l,u]=Ae.useState("uniqueNumber"),[c,h]=Ae.useState("asc"),[p,x]=Ae.useState(new Set),[E,g]=Ae.useState({isOpen:!1,participant:void 0}),[w,v]=Ae.useState(null),[y,b]=Ae.useState({isOpen:!1,title:"",message:"",variant:"info"}),T=(Z,L)=>{const X=Z.currentTarget.getBoundingClientRect();v({participant:L,x:X.left,y:X.top-8})},N=()=>{v(null)},k=Zr(()=>ke.groups.toArray(),[i]),_=Ae.useMemo(()=>k?new Map(k.map(Z=>[Z.courseStartDate,Z])):new Map,[k]),S=Ae.useMemo(()=>[...e].sort((L,X)=>{let K=0;return l==="courseStartDate"||l==="groupNumber"?K=L.courseStartDate.localeCompare(X.courseStartDate):l==="uniqueNumber"&&(K=L.uniqueNumber.localeCompare(X.uniqueNumber)),c==="asc"?K:-K}),[e,l,c]),A=Ae.useMemo(()=>{const Z=[],L=[],X=[];return S.forEach(K=>{const ie=_.get(K.courseStartDate);if(!ie){L.push(K);return}ie.status==="active"?Z.push(K):ie.status==="planned"?L.push(K):ie.status==="completed"&&X.push(K)}),{active:Z,planned:L,completed:X}},[S,_]),P=Ae.useMemo(()=>k==null?void 0:k.find(Z=>Z.status==="active"),[k]),I=P!=null&&P.groupNumber?[P.groupNumber]:[],W=P?`${rt(P.courseStartDate)} - ${rt(P.courseEndDate)}`:void 0,te=Ae.useMemo(()=>{const Z=new Map;return k==null||k.forEach(L=>{L.status==="active"&&Z.set(L.courseStartDate,{group:L,participants:[]})}),A.active.forEach(L=>{const X=Z.get(L.courseStartDate);if(X)X.participants.push(L);else{const K=_.get(L.courseStartDate)||{id:"virt-active-"+L.courseStartDate,courseStartDate:L.courseStartDate,courseEndDate:L.courseEndDate,status:"active",groupNumber:null,isLocked:!1,createdAt:"",updatedAt:""};Z.set(L.courseStartDate,{group:K,participants:[L]})}}),Array.from(Z.values()).sort((L,X)=>L.group.courseStartDate.localeCompare(X.group.courseStartDate))},[A.active,k,_]),oe=Ae.useMemo(()=>{const Z=new Map;return k&&k.forEach(L=>{L.status==="planned"&&Z.set(L.courseStartDate,{group:L,participants:[]})}),A.planned.forEach(L=>{if(!_.get(L.courseStartDate)&&!Z.has(L.courseStartDate)){const K={id:"virtual-planned-"+L.courseStartDate,groupNumber:null,courseStartDate:L.courseStartDate,courseEndDate:L.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""};Z.set(L.courseStartDate,{group:K,participants:[]})}Z.has(L.courseStartDate)&&Z.get(L.courseStartDate).participants.push(L)}),Array.from(Z.entries()).sort(([L],[X])=>L.localeCompare(X)).slice(0,2).map(([L,X])=>({courseStartDate:L,...X}))},[A.planned,_,k]),ve=Ae.useMemo(()=>{const Z=new Map;return A.completed.forEach(L=>{const X=_.get(L.courseStartDate);X&&(Z.has(L.courseStartDate)||Z.set(L.courseStartDate,{group:X,participants:[]}),Z.get(L.courseStartDate).participants.push(L))}),Array.from(Z.entries()).sort(([L],[X])=>X.localeCompare(L)).map(([L,X])=>({courseStartDate:L,...X}))},[A.completed,_]),ye=Ae.useMemo(()=>{const Z=new Set,L=new Set,X=new Set;return te.forEach(K=>Z.add(K.group.courseStartDate)),k&&k.forEach(K=>{K.status==="active"&&Z.add(K.courseStartDate),K.status==="planned"&&L.add(K.courseStartDate),K.status==="completed"&&X.add(K.courseStartDate)}),A.active.forEach(K=>Z.add(K.courseStartDate)),A.planned.forEach(K=>L.add(K.courseStartDate)),A.completed.forEach(K=>X.add(K.courseStartDate)),{active:{count:Z.size,numbers:[]},planned:{count:L.size,numbers:[]},completed:{count:X.size,numbers:[]}}},[A,k,te]);Ae.useEffect(()=>{(async()=>{const{syncGroups:L}=await Ra(async()=>{const{syncGroups:X}=await Promise.resolve().then(()=>M_);return{syncGroups:X}},void 0);await L()})()},[]);const _e=Z=>{l===Z?h(L=>L==="asc"?"desc":"asc"):(u(Z),h("asc"))},ue=async(Z,L)=>{const X=_.get(Z.courseStartDate);if(Ho(X)){b({isOpen:!0,title:o("common.info"),message:o("lock.lockedInfo"),variant:"info"});return}try{await s(Z.id,{[L]:!Z[L]})}catch(K){console.error("Error updating participant:",K),b({isOpen:!0,title:o("common.error"),message:"Failed to update participant",variant:"error"})}},ce=async Z=>{const L=_.get(Z.courseStartDate);if(Ho(L)){b({isOpen:!0,title:o("common.info"),message:o("lock.lockedInfo"),variant:"info"});return}const X=Z.completedOverride!==null?Z.completedOverride:Z.completedComputed;try{await s(Z.id,{completedOverride:!X})}catch(K){console.error("Error updating completed status:",K),b({isOpen:!0,title:o("common.error"),message:"Failed to update completed status",variant:"error"})}},De=async Z=>{const L=_.get(Z.courseStartDate);if(Ho(L)){b({isOpen:!0,title:o("common.info"),message:o("lock.lockedInfo"),variant:"info"});return}try{await s(Z.id,{completedOverride:null})}catch(X){console.error("Error resetting completed status:",X),b({isOpen:!0,title:o("common.error"),message:"Failed to reset completed status",variant:"error"})}},Ve=Z=>Z.completedOverride!==null?Z.completedOverride:Z.completedComputed,Y=Z=>Z.completedOverride!==null,se=async Z=>{try{let L=_.get(Z.courseStartDate);L||(L={id:"virtual-cert",groupNumber:null,courseStartDate:Z.courseStartDate,courseEndDate:Z.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""}),await yS(Z,L),b({isOpen:!0,title:o("common.success"),message:"   !",variant:"success"})}catch(L){b({isOpen:!0,title:o("common.error"),message:"    : "+L.message,variant:"error"})}},ee=()=>{E.participant&&r(E.participant.id),g({isOpen:!1,participant:void 0})},D=Z=>{const L=_.get(Z.courseStartDate),X=xe(Z),K=["hover:bg-slate-100 transition-colors duration-150",(L==null?void 0:L.status)==="active"?"bg-slate-50":"",(L==null?void 0:L.status)==="completed"?"opacity-90":""].filter(Boolean).join(" ");return f.jsxs("tr",{className:K,children:[f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:p.has(Z.id),onChange:()=>R(Z.id),disabled:X,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed","aria-label":`Select ${Z.personName}`})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Iu,{companyName:Z.companyName}),X&&f.jsx("span",{className:"text-xs text-slate-500",title:o("lock.lockedInfo"),children:""})]})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx("div",{className:"max-w-xs truncate cursor-help",onMouseEnter:ie=>T(ie,Z),onMouseLeave:N,children:Z.personName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.medicalDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.courseStartDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.courseEndDate)}),f.jsx("td",{className:"px-3 py-3 text-sm",children:f.jsx("span",{className:"font-mono text-xs bg-slate-100 px-2 py-0.5 rounded inline-block text-slate-700",title:"   ",children:Z.uniqueNumber||"---"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.sent,onChange:()=>ue(Z,"sent"),disabled:X,title:"    ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.documents,onChange:()=>ue(Z,"documents"),disabled:X,title:"   ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.handedOver,onChange:()=>ue(Z,"handedOver"),disabled:X,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.paid,onChange:()=>ue(Z,"paid"),disabled:X,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>ce(Z),disabled:X,className:`px-3 py-1 rounded-md text-xs font-medium transition-colors duration-150 ring-1 disabled:opacity-50 disabled:cursor-not-allowed ${Ve(Z)?"bg-emerald-50 text-emerald-800 ring-emerald-200 hover:bg-emerald-100":"bg-slate-100 text-slate-700 ring-slate-200 hover:bg-slate-200"}`,title:X?o("lock.lockedInfo"):"Click to toggle",children:Ve(Z)?o("completed.done"):o("completed.pending")}),Y(Z)&&!X&&f.jsx("button",{onClick:()=>De(Z),className:"text-blue-600 hover:text-blue-800 p-1 rounded hover:bg-blue-50 transition-colors duration-150",title:"Reset to auto","aria-label":"Reset completed to automatic",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}),f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>t(Z),disabled:X,className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:o(X?"lock.lockedInfo":"common.edit"),"aria-label":`Edit ${Z.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),f.jsx("button",{onClick:()=>se(Z),className:"p-2 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-lg transition-colors duration-150",title:" ","aria-label":`Generate certificate for ${Z.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),f.jsx("button",{onClick:()=>g({isOpen:!0,participant:Z}),disabled:X,className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:o(X?"lock.lockedInfo":"common.delete"),"aria-label":`Delete ${Z.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},Z.id)},F=Z=>{const L=xe(Z);return f.jsxs("tr",{className:"hover:bg-slate-100 transition-colors duration-150",children:[f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:p.has(Z.id),onChange:()=>R(Z.id),disabled:L,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed","aria-label":`Select ${Z.personName}`})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx(Iu,{companyName:Z.companyName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-900",children:f.jsx("div",{className:"max-w-xs truncate cursor-help",onMouseEnter:K=>T(K,Z),onMouseLeave:N,children:Z.personName})}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.medicalDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.courseStartDate)}),f.jsx("td",{className:"px-3 py-3 text-sm text-slate-600",children:rt(Z.courseEndDate)}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.documents,onChange:()=>ue(Z,"documents"),disabled:L,title:"   ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.paid,onChange:()=>ue(Z,"paid"),disabled:L,title:"  ",className:"w-5 h-5 text-emerald-600 rounded focus:ring-2 focus:ring-emerald-300 cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"})}),f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx("button",{onClick:()=>t(Z),disabled:L,className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:o(L?"lock.lockedInfo":"common.edit"),"aria-label":`Edit ${Z.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),f.jsx("button",{onClick:()=>g({isOpen:!0,participant:Z}),disabled:L,className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",title:o(L?"lock.lockedInfo":"common.delete"),"aria-label":`Delete ${Z.personName}`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},Z.id)},V=Z=>{const L=Z.completedOverride!==null?Z.completedOverride:Z.completedComputed;return f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f.jsx(Iu,{companyName:Z.companyName})}),f.jsx("td",{className:"px-3 py-2 text-sm text-slate-900",children:f.jsx("div",{className:"cursor-help",onMouseEnter:X=>T(X,Z),onMouseLeave:N,children:Z.personName})}),f.jsx("td",{className:"px-3 py-2 text-sm",children:f.jsx("span",{className:"font-mono text-xs bg-slate-100 px-2 py-0.5 rounded inline-block text-slate-700",title:"   ",children:Z.uniqueNumber})}),f.jsx("td",{className:"px-3 py-2 text-sm text-slate-600",children:rt(Z.medicalDate)}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.sent,disabled:!0,title:"    ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.documents,disabled:!0,title:"   ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.handedOver,disabled:!0,title:"  ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:Z.paid,disabled:!0,title:"  ",className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsx("input",{type:"checkbox",checked:L,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"})})]},Z.id)},R=Z=>{const L=new Set(p);L.has(Z)?L.delete(Z):L.add(Z),x(L)},j=()=>{x(new Set)},re=()=>{x(new Set)},xe=Z=>{const L=_.get(Z.courseStartDate);return Ho(L)};return S.length===0?f.jsx("div",{className:"text-center py-12 text-slate-500",children:o("participants.noResults")}):f.jsxs(f.Fragment,{children:[f.jsx(Z_,{selectedCount:p.size,selectedIds:Array.from(p),onClearSelection:j,onActionComplete:re}),f.jsx(dx,{isOpen:y.isOpen,onClose:()=>b(Z=>({...Z,isOpen:!1})),title:y.title,message:y.message,variant:y.variant}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(al,{title:o("groups.activeSection"),count:ye.active.count,groupNumbers:te.length<=1?I:[],dateRange:te.length<=1?W:void 0,participantCount:A.active.length,isCollapsed:n.active,onToggle:()=>a("active"),variant:"active",children:te.length===0?f.jsx("div",{className:"text-center py-8 text-slate-500 bg-slate-50 border border-dashed border-slate-200 rounded-lg",children:o("participants.noActive")}):f.jsx("div",{className:"space-y-8",children:te.map(Z=>f.jsxs("div",{className:"space-y-3",children:[te.length>1&&f.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-blue-100",children:[f.jsxs("span",{className:"font-bold text-blue-900",children:[rt(Z.group.courseStartDate)," - ",rt(Z.group.courseEndDate)]}),Z.group.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 rounded text-xs font-bold",children:[" ",Z.group.groupNumber]})]}),f.jsx("div",{className:"overflow-x-auto max-h-[400px] overflow-y-auto relative rounded-lg border border-slate-200",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-100 sticky top-0 z-10 shadow-sm",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 border-b border-slate-200 w-12",children:f.jsx("input",{type:"checkbox",checked:Z.participants.length>0&&Z.participants.every(L=>p.has(L.id)),onChange:L=>{const X=new Set(p);L.target.checked?Z.participants.filter(K=>!xe(K)).forEach(K=>X.add(K.id)):Z.participants.forEach(K=>X.delete(K.id)),x(X)},className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer"})}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.companyName")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.personName")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.courseStart")}),f.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.courseEnd")}),f.jsxs("th",{className:"px-3 py-3 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-200 transition-colors duration-150",onClick:()=>_e("uniqueNumber"),children:[o("participant.uniqueNumber")," ",l==="uniqueNumber"&&(c==="asc"?"":"")]}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.sent")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.documents")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.handedOver")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.paid")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.completed")}),f.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("common.delete")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:Z.participants.length>0?Z.participants.map(D):f.jsx("tr",{children:f.jsx("td",{colSpan:13,className:"text-center py-8 text-slate-400 italic",children:o("participants.noParticipantsInGroup")})})})]})})]},Z.group.courseStartDate))})}),oe.length>0&&f.jsx(al,{title:o("groups.plannedSection"),count:ye.planned.count,groupNumbers:[],isCollapsed:n.planned,onToggle:()=>a("planned"),variant:"planned",children:f.jsx("div",{className:"space-y-6",children:oe.map(({courseStartDate:Z,group:L,participants:X})=>f.jsxs("div",{className:"bg-white border border-amber-200 rounded-lg overflow-hidden",children:[f.jsx("div",{className:"bg-amber-50 px-4 py-2 border-b border-amber-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("span",{className:"font-semibold text-amber-900",children:[rt(L.courseStartDate)," - ",rt(L.courseEndDate)]})}),f.jsxs("span",{className:"text-sm text-amber-700 font-medium",children:[X.length," ",X.length===1?"":""]})]})}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white",children:[f.jsx("thead",{className:"bg-slate-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 border-b border-slate-200 w-12",children:f.jsx("input",{type:"checkbox",checked:X.length>0&&X.every(K=>p.has(K.id)),onChange:K=>{const ie=new Set(p);K.target.checked?X.forEach(be=>ie.add(be.id)):X.forEach(be=>ie.delete(be.id)),x(ie)},className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-300 cursor-pointer"})}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.companyName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.personName")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.medicalDate")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.courseStart")}),f.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.courseEnd")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.documents")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("participant.paid")}),f.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-slate-700 uppercase tracking-wider border-b border-slate-200",children:o("common.delete")})]})}),f.jsx("tbody",{className:"divide-y divide-slate-200",children:X.length>0?X.map(F):f.jsx("tr",{children:f.jsx("td",{colSpan:10,className:"text-center py-4 text-slate-400 italic",children:o("participants.noParticipantsInGroup")})})})]})})]},Z))})}),ve.length>0&&f.jsx(al,{title:o("groups.completedSection"),count:ye.completed.count,groupNumbers:ye.completed.numbers,isCollapsed:n.completed,onToggle:()=>a("completed"),variant:"completed",children:f.jsx("div",{className:"space-y-4",children:ve.map(({courseStartDate:Z,group:L,participants:X})=>f.jsx("div",{children:f.jsx(Q_,{groupNumber:L.groupNumber||0,courseStartDate:L.courseStartDate,courseEndDate:L.courseEndDate,participants:X,renderParticipantRow:V})},Z))})})]}),f.jsx(es,{isOpen:E.isOpen,onClose:()=>g({isOpen:!1,participant:void 0}),onConfirm:ee,title:o("modal.deleteTitle"),message:o("modal.deleteMessage",{name:((Pe=E.participant)==null?void 0:Pe.personName)||""}),confirmText:o("common.delete"),cancelText:o("common.cancel"),variant:"danger"}),w&&f.jsxs("div",{className:"fixed z-50 bg-slate-800 text-white text-xs p-3 rounded shadow-lg pointer-events-none transform -translate-y-full filter drop-shadow-md",style:{left:w.x,top:w.y,minWidth:"220px"},children:[f.jsx("div",{className:"font-bold mb-2 border-b border-slate-600 pb-1 text-slate-100",children:w.participant.personName}),f.jsxs("div",{className:"grid grid-cols-[auto_1fr] gap-x-3 gap-y-1.5",children:[f.jsxs("span",{className:"text-slate-400 text-right",children:[o("participant.egn"),":"]}),f.jsx("span",{className:"font-mono",children:w.participant.egn||"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[o("participant.birthPlace"),":"]}),f.jsx("span",{children:w.participant.birthPlace||"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[o("participant.added"),":"]}),f.jsx("span",{children:w.participant.createdAt?rt(w.participant.createdAt):"-"}),f.jsxs("span",{className:"text-slate-400 text-right",children:[o("participant.modified"),":"]}),f.jsx("span",{children:w.participant.updatedAt?rt(w.participant.updatedAt):"-"})]})]})]})},dP=({onEdit:e,onGenerate:t,onDelete:r})=>{const[n,a]=Ae.useState(!1),i=Ae.useRef(null);return Ae.useEffect(()=>{const s=l=>{i.current&&!i.current.contains(l.target)&&a(!1)},o=l=>{l.key==="Escape"&&a(!1)};if(n)return document.addEventListener("mousedown",s),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("keydown",o)}},[n]),f.jsxs("div",{className:"relative",ref:i,children:[f.jsx("button",{onClick:()=>a(!n),className:"p-2 hover:bg-slate-100 rounded-lg transition-colors duration-150 min-h-[44px] min-w-[44px] flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"More options","aria-expanded":n,children:f.jsxs("svg",{className:"w-5 h-5 text-slate-600",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("circle",{cx:"8",cy:"2",r:"1.5"}),f.jsx("circle",{cx:"8",cy:"8",r:"1.5"}),f.jsx("circle",{cx:"8",cy:"14",r:"1.5"})]})}),n&&f.jsxs("div",{className:"absolute right-0 top-12 bg-white rounded-lg shadow-lg border border-slate-200 py-1 min-w-[140px] z-10 animate-scale-up",children:[f.jsxs("button",{onClick:()=>{e(),a(!1)},className:"w-full px-4 py-2 text-left text-sm text-slate-700 hover:bg-slate-100 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),""]}),t&&f.jsxs("button",{onClick:()=>{t(),a(!1)},className:"w-full px-4 py-2 text-left text-sm text-green-700 hover:bg-green-50 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),""]}),f.jsxs("button",{onClick:()=>{r(),a(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors duration-150 min-h-[44px]",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),""]})]})]})},Zf=({label:e,isActive:t})=>f.jsxs("div",{className:`
        flex items-center justify-center gap-1 px-1.5 py-1 rounded text-xs font-medium
        transition-all duration-150 min-h-[32px] w-full
        ${t?"bg-emerald-700 border border-emerald-700 text-white":"bg-white border border-slate-300 text-slate-700"}
      `,children:[t&&f.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),f.jsx("span",{className:"text-[10px] whitespace-nowrap",children:e})]}),Uy=({label:e,variant:t,icon:r})=>{const n={success:"bg-emerald-50 text-emerald-800 ring-1 ring-emerald-200 border-0",neutral:"bg-slate-100 text-slate-700 ring-1 ring-slate-200 border-0",info:"bg-blue-50 text-blue-800 ring-1 ring-blue-200 border-0"};return f.jsxs("span",{className:`
        inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border
        ${n[t]}
      `,children:[r==="check"&&f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),r==="manual"&&f.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 16 16",children:[f.jsx("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"}),f.jsx("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319z"})]}),e]})},hP=({participants:e,onEdit:t,onDelete:r,onSelectionChange:n,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:o})=>{var V;const{t:l}=qr(),{updateParticipant:u}=Kd(),[c,h]=Ae.useState(new Set),[p,x]=Ae.useState(null),[E,g]=Ae.useState({isOpen:!1,participant:void 0}),w=Zr(()=>ke.groups.toArray(),[]),v=Ae.useMemo(()=>w?new Map(w.map(R=>[R.courseStartDate,R])):new Map,[w]),y=Ae.useMemo(()=>{const R=[],j=[],re=[];return e.forEach(xe=>{const Pe=v.get(xe.courseStartDate);if(!Pe){j.push(xe);return}Pe.status==="active"?R.push(xe):Pe.status==="planned"?j.push(xe):Pe.status==="completed"&&re.push(xe)}),{active:R,planned:j,completed:re}},[e,v]),b=Ae.useMemo(()=>{const R=new Map;return w&&w.forEach(j=>{j.status==="planned"&&R.set(j.courseStartDate,{group:j,participants:[]})}),y.planned.forEach(j=>{if(!v.get(j.courseStartDate)&&!R.has(j.courseStartDate)){const xe={id:"virtual-"+j.courseStartDate,groupNumber:null,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""};R.set(j.courseStartDate,{group:xe,participants:[]})}R.has(j.courseStartDate)&&R.get(j.courseStartDate).participants.push(j)}),Array.from(R.entries()).sort(([j],[re])=>j.localeCompare(re)).slice(0,2).map(([j,re])=>({courseStartDate:j,...re}))},[y.planned,v,w]),T=Ae.useMemo(()=>{const R=new Map;return y.completed.forEach(j=>{const re=v.get(j.courseStartDate);re&&(R.has(j.courseStartDate)||R.set(j.courseStartDate,{group:re,participants:[]}),R.get(j.courseStartDate).participants.push(j))}),Array.from(R.entries()).sort(([j],[re])=>re.localeCompare(j)).map(([j,re])=>({courseStartDate:j,...re}))},[y.completed,v]),N=Ae.useMemo(()=>w==null?void 0:w.find(R=>R.status==="active"),[w]),k=N!=null&&N.groupNumber?[N.groupNumber]:[],_=N?`${rt(N.courseStartDate)} - ${rt(N.courseEndDate)}`:void 0,S=Ae.useMemo(()=>{const R=new Map;return w==null||w.forEach(j=>{j.status==="active"&&R.set(j.courseStartDate,{group:j,participants:[]})}),y.active.forEach(j=>{const re=R.get(j.courseStartDate);if(re)re.participants.push(j);else{const xe=v.get(j.courseStartDate)||{id:"virt-active-"+j.courseStartDate,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,status:"active",groupNumber:null,isLocked:!1,createdAt:"",updatedAt:""};R.set(j.courseStartDate,{group:xe,participants:[j]})}}),Array.from(R.values()).sort((j,re)=>j.group.courseStartDate.localeCompare(re.group.courseStartDate))},[y.active,w,v]),A=Ae.useMemo(()=>{const R=new Set,j=new Set,re=new Set;return y.active.forEach(xe=>R.add(xe.courseStartDate)),y.planned.forEach(xe=>j.add(xe.courseStartDate)),y.completed.forEach(xe=>re.add(xe.courseStartDate)),{active:{count:R.size,periods:Array.from(R).sort()},planned:{count:j.size,periods:Array.from(j).sort()},completed:{count:re.size,periods:Array.from(re).sort()}}},[y]),P=Ae.useRef(e);Ae.useEffect(()=>{P.current!==e&&o&&(y.active.length>0&&a.active&&s("active"),y.planned.length>0&&a.planned&&s("planned"),y.completed.length>0&&a.completed&&s("completed"),P.current=e)},[e,y,a,s,o]),Ae.useEffect(()=>{n==null||n(c.size>0)},[c.size,n]);const I=async(R,j)=>{const re=v.get(R.courseStartDate);if(re&&re.status==="completed"&&re.isLocked){alert(l("lock.lockedInfo"));return}try{await u(R.id,{[j]:!R[j]})}catch(xe){console.error("Error updating participant:",xe)}},W=R=>R.completedOverride!==null?R.completedOverride:R.completedComputed,te=R=>R.completedOverride!==null,oe=R=>{const j=v.get(R.courseStartDate);return j?j.status==="completed"&&j.isLocked:!1},ve=(R,j)=>{if(oe(j))return;const re=setTimeout(()=>{h(new Set([R]))},500);x(re)},ye=()=>{p&&(clearTimeout(p),x(null))},_e=(R,j)=>{const re=oe(j);if(c.size>0){if(re)return;const xe=new Set(c);xe.has(R)?xe.delete(R):xe.add(R),h(xe)}},ue=()=>{h(new Set)},ce=()=>{h(new Set)},De=R=>{g({isOpen:!0,participant:R})},Ve=()=>{E.participant&&r(E.participant.id),g({isOpen:!1,participant:void 0})},[Y,se]=Ae.useState({isOpen:!1,title:"",message:"",variant:"info"}),ee=async R=>{try{let j=v.get(R.courseStartDate);j||(j={id:"virtual",groupNumber:null,courseStartDate:R.courseStartDate,courseEndDate:R.courseEndDate,status:"planned",isLocked:!1,createdAt:"",updatedAt:""}),await yS(R,j),se({isOpen:!0,title:l("common.success"),message:"   !",variant:"success"})}catch(j){se({isOpen:!0,title:l("common.error"),message:"    : "+j.message,variant:"error"})}},D=(R,j)=>{var Pe;const re=c.has(R.id),xe=oe(R);return f.jsxs("div",{onClick:()=>_e(R.id,R),onTouchStart:()=>ve(R.id,R),onTouchEnd:ye,onMouseDown:()=>ve(R.id,R),onMouseUp:ye,onMouseLeave:ye,className:`bg-white rounded-lg shadow-sm p-4 border transition-all duration-150 ${re?"border-blue-500 ring-2 ring-blue-200":"border-slate-200"} ${xe?"opacity-75":"cursor-pointer hover:shadow-md"}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"mb-1",children:f.jsx(Iu,{companyName:R.companyName})}),f.jsxs("div",{className:"flex items-center gap-2",children:[re&&f.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded flex items-center justify-center shrink-0",children:f.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),f.jsx("h3",{className:"font-bold text-lg text-slate-900 leading-tight truncate",children:R.personName}),xe&&f.jsx("span",{className:"text-xs text-slate-500 shrink-0",title:l("lock.lockedInfo"),children:""})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[R.uniqueNumber&&f.jsx("span",{className:"text-xs font-mono bg-slate-100 px-2 py-1 rounded text-slate-700",children:R.uniqueNumber}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(Uy,{label:W(R)?l("participant.completedBadge"):l("participant.notCompleted"),variant:W(R)?"success":"neutral",icon:W(R)?"check":void 0}),te(R)&&f.jsx(Uy,{label:l("participant.manual"),variant:"info",icon:"manual"})]})]}),!xe&&f.jsx(dP,{onEdit:()=>t(R),onGenerate:((Pe=v.get(R.courseStartDate))==null?void 0:Pe.status)==="active"?()=>ee(R):void 0,onDelete:()=>De(R)})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 text-sm",children:[f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-500",children:[l("participant.medical"),":"]}),f.jsx("span",{className:"ml-1 font-medium text-slate-900",children:rt(R.medicalDate)})]}),f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-500",children:[l("participant.period"),":"]}),f.jsx("span",{className:"ml-1 font-medium text-slate-900",children:rt(R.courseStartDate)})]}),f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-500",children:[l("participant.courseStart"),":"]}),f.jsx("span",{className:"ml-1 font-medium text-slate-900",children:rt(R.courseStartDate)})]}),f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-500",children:[l("participant.courseEnd"),":"]}),f.jsx("span",{className:"ml-1 font-medium text-slate-900",children:rt(R.courseEndDate)})]})]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:Z=>{Z.stopPropagation(),I(R,"sent")},disabled:xe,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(Zf,{label:l("participant.sent"),isActive:R.sent})}),f.jsx("button",{onClick:Z=>{Z.stopPropagation(),I(R,"documents")},disabled:xe,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(Zf,{label:l("participant.documents"),isActive:R.documents})}),f.jsx("button",{onClick:Z=>{Z.stopPropagation(),I(R,"handedOver")},disabled:xe,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(Zf,{label:l("participant.handed"),isActive:R.handedOver})}),f.jsx("button",{onClick:Z=>{Z.stopPropagation(),I(R,"paid")},disabled:xe,className:"active:scale-95 transition-transform duration-150 flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:f.jsx(Zf,{label:l("participant.paid"),isActive:R.paid})})]})]},R.id)},F=R=>{const j=R.completedOverride!==null?R.completedOverride:R.completedComputed;return f.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[f.jsx("div",{className:"mb-1",children:f.jsx(Iu,{companyName:R.companyName})}),f.jsx("h4",{className:"font-semibold text-slate-900 truncate",children:R.personName})]}),R.uniqueNumber&&f.jsx("span",{className:"text-xs font-mono bg-slate-100 px-2 py-1 rounded text-slate-700",children:R.uniqueNumber})]}),f.jsx("div",{className:"text-sm text-slate-600 mb-2",children:f.jsxs("div",{children:[l("participant.medical"),": ",rt(R.medicalDate)]})}),f.jsxs("div",{className:"flex gap-2 flex-wrap",children:[f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[f.jsx("input",{type:"checkbox",checked:R.sent,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),""]}),f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[f.jsx("input",{type:"checkbox",checked:R.documents,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),""]}),f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[f.jsx("input",{type:"checkbox",checked:R.handedOver,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),""]}),f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[f.jsx("input",{type:"checkbox",checked:R.paid,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),""]}),f.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[f.jsx("input",{type:"checkbox",checked:j,disabled:!0,className:"w-4 h-4 text-emerald-600 rounded opacity-60 cursor-not-allowed"}),""]})]})]},R.id)};return e.length===0?f.jsx("div",{className:"text-center py-12 text-slate-500",children:l("participants.noResults")}):f.jsxs(f.Fragment,{children:[f.jsx(Z_,{selectedCount:c.size,selectedIds:Array.from(c),onClearSelection:ue,onActionComplete:ce}),f.jsx(dx,{isOpen:Y.isOpen,onClose:()=>se(R=>({...R,isOpen:!1})),title:Y.title,message:Y.message,variant:Y.variant==="error"?"danger":Y.variant}),f.jsxs("div",{className:"space-y-4 pb-32",children:[f.jsx(al,{title:l("groups.activeSection"),count:A.active.count,groupNumbers:S.length<=1&&k.length>0?k:[],dateRange:S.length<=1?_:void 0,isCollapsed:a.active,onToggle:()=>i("active"),showCount:S.length<=1?Math.max(k.length,0)>0:!0,variant:"active",children:S.length===0?f.jsx("div",{className:"text-center py-8 text-slate-500 bg-slate-50/50 rounded-lg border border-dashed border-slate-200",children:f.jsx("p",{children:l("participants.noActive")})}):f.jsx("div",{className:"space-y-8",children:S.map(R=>f.jsxs("div",{className:"space-y-4",children:[S.length>1&&f.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-blue-100",children:[f.jsxs("span",{className:"font-semibold text-blue-900",children:[rt(R.group.courseStartDate)," - ",rt(R.group.courseEndDate)]}),R.group.groupNumber&&f.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-bold",children:[" ",R.group.groupNumber]})]}),R.participants.length>0?f.jsx("div",{className:"space-y-4",children:R.participants.map((j,re)=>D(j))}):f.jsx("div",{className:"text-center py-4 italic text-slate-400 bg-white/50 rounded border border-dashed border-slate-100",children:l("participants.noParticipantsInGroup")})]},R.group.courseStartDate))})}),f.jsx(al,{title:l("groups.plannedSection"),count:A.planned.count,groupNumbers:[],isCollapsed:a.planned,onToggle:()=>i("planned"),variant:"planned",children:b.length>0?f.jsx("div",{className:"space-y-3",children:b.map(({courseStartDate:R,group:j,participants:re})=>f.jsxs("div",{className:"bg-white border-2 border-amber-200 rounded-lg overflow-hidden",children:[f.jsxs("div",{className:"bg-amber-50 px-3 py-2 border-b border-amber-200",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"font-semibold text-amber-900",children:j.groupNumber?` ${j.groupNumber}`:" "}),f.jsxs("span",{className:"text-xs text-amber-700 font-medium",children:[re.length," ",re.length===1?"":""]})]}),f.jsxs("div",{className:"text-xs text-amber-700 mt-0.5",children:[rt(j.courseStartDate)," -"," ",rt(j.courseEndDate)]})]}),f.jsx("div",{className:"p-2 space-y-2",children:re.map((xe,Pe)=>D(xe))})]},R))}):f.jsx("div",{className:"text-center py-8 text-slate-500",children:"  "})}),f.jsx(al,{title:l("groups.completedSection"),count:A.completed.count,isCollapsed:a.completed,onToggle:()=>i("completed"),variant:"completed",children:T.length>0?f.jsx("div",{className:"space-y-2",children:T.map(({courseStartDate:R,group:j,participants:re})=>f.jsx(Q_,{groupNumber:j.groupNumber||0,courseStartDate:j.courseStartDate,courseEndDate:j.courseEndDate,participants:re,renderParticipantRow:F,mode:"cards"},R))}):f.jsx("div",{className:"text-center py-8 text-slate-500",children:"  "})})]}),f.jsx(es,{isOpen:E.isOpen,onClose:()=>g({isOpen:!1,participant:void 0}),onConfirm:Ve,title:l("modal.deleteTitle"),message:l("modal.deleteMessage",{name:((V=E.participant)==null?void 0:V.personName)||""}),confirmText:l("common.delete"),cancelText:l("common.cancel"),variant:"danger"})]})},pP=({isOpen:e,onClose:t,participant:r})=>{const{addParticipant:n,updateParticipant:a}=Kd(),{t:i}=qr(),[s,o]=Ae.useState({companyName:"",personName:"",egn:"",birthPlace:"",citizenship:"",medicalDate:"",groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:""}),[l,u]=Ae.useState({courseStartDate:"",courseEndDate:""}),[c,h]=Ae.useState({}),[p,x]=Ae.useState(!1),[E,g]=Ae.useState(""),[w,v]=Ae.useState(null),[y,b]=Ae.useState({isOpen:!1,message:"",onConfirm:()=>{}}),T=Zr(()=>Ai(),[]),N=Zr(()=>ke.groups.orderBy("groupNumber").toArray(),[]),[k,_]=Ae.useState(null);Ae.useEffect(()=>{if(!s.medicalDate){_(null);return}sd(s.medicalDate).then(I=>{if(I.group)_(I.group);else if(I.createsForDate){const W=new Date(I.createsForDate),te=new Date(W);te.setDate(W.getDate()+7),_({groupNumber:null,courseStartDate:I.createsForDate,courseEndDate:te.toISOString().split("T")[0],status:"planned"})}else _(null)})},[s.medicalDate]),Ae.useEffect(()=>{r?(o({companyName:r.companyName,personName:r.personName,egn:r.egn||"",birthPlace:r.birthPlace||"",citizenship:r.citizenship||"",medicalDate:r.medicalDate,groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:r.uniqueNumber}),u({courseStartDate:r.courseStartDate,courseEndDate:r.courseEndDate}),g("")):(o({companyName:"",personName:"",egn:"",birthPlace:"",citizenship:"",medicalDate:"",groupAssignmentMode:"auto",selectedGroupId:"",uniqueNumber:""}),u({courseStartDate:"",courseEndDate:""}),e&&Promise.all([U1(),C_()]).then(([I,W])=>{g(I),v(W)}).catch(I=>{console.error("Failed to generate next unique number:",I),g(""),v(null)})),h({})},[r,e]),Ae.useEffect(()=>{if(s.medicalDate)try{const I=id(s.medicalDate);u(I)}catch(I){console.error("Error computing dates:",I)}},[s.medicalDate]);const S=async()=>{const I={};if(s.companyName.trim()||(I.companyName=i("modal.companyNameRequired")),s.personName.trim()||(I.personName=i("modal.personNameRequired")),s.egn.trim()?/^\d{10}$/.test(s.egn)||(I.egn=i("modal.egnInvalid")):I.egn=i("modal.egnRequired"),s.birthPlace.trim()||(I.birthPlace=i("modal.birthPlaceRequired")),s.medicalDate?V_(s.medicalDate)||(I.medicalDate=Pu):I.medicalDate=i("modal.medicalDateRequired"),s.uniqueNumber){if(!D_(s.uniqueNumber))I.uniqueNumber="Invalid format. Use NNNN-NNN (e.g., 3532-001)";else if(!await hc(s.uniqueNumber,r==null?void 0:r.id))I.uniqueNumber="This unique number already exists";else if(w&&!r){const te=vl(s.uniqueNumber),oe=vl(w);te&&oe&&(te.prefix>oe.prefix||te.prefix===oe.prefix&&te.seq>oe.seq)&&(I.uniqueNumber=`Cannot skip gap! Must fill ${w} first or leave empty for auto-assign`)}}return h(I),Object.keys(I).length===0},A=async I=>{if(I.preventDefault(),!!await S()){if(s.groupAssignmentMode==="manual"&&s.selectedGroupId){const te=parseInt(s.selectedGroupId,10),oe=N==null?void 0:N.find(ve=>ve.groupNumber===te);if((oe==null?void 0:oe.status)==="completed"){h(ve=>({...ve,selectedGroupId:"       ."}));return}if(!nl(s.medicalDate,oe.courseStartDate)){h(ve=>({...ve,medicalDate:"             6 ."}));return}}else if(!nl(s.medicalDate,l.courseStartDate)){h(te=>({...te,medicalDate:"             6 ."}));return}if(s.groupAssignmentMode==="manual"&&s.selectedGroupId){const te=parseInt(s.selectedGroupId,10),oe=await sd(l.courseStartDate);if(oe.group&&oe.group.groupNumber!==te){const ve=N==null?void 0:N.find(ye=>ye.groupNumber===te);b({isOpen:!0,message:`:   ${te} (${rt(ve.courseStartDate)})      ${oe.group.groupNumber} (${rt(oe.group.courseStartDate)})    .`,onConfirm:()=>{b({isOpen:!1,message:"",onConfirm:()=>{}}),P()}});return}}await P()}},P=async()=>{x(!0);try{const I={companyName:s.companyName.trim(),personName:s.personName.trim(),egn:s.egn.trim(),birthPlace:s.birthPlace.trim(),citizenship:s.citizenship.trim()||"",medicalDate:s.medicalDate,uniqueNumber:s.uniqueNumber.trim()||void 0};r?await a(r.id,I):await n(I),t()}catch(I){console.error("Error saving participant:",I),alert(`Failed to save participant: ${I.message}`)}finally{x(!1)}};return e?f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:[f.jsxs("div",{className:"w-full max-w-2xl p-8 cursor-default",onClick:I=>I.stopPropagation(),children:[f.jsx("div",{className:"bg-white rounded-lg w-full max-h-[85vh] overflow-y-auto shadow-xl",children:f.jsxs("div",{className:"p-6",children:[f.jsx("h2",{className:"text-2xl font-bold mb-4",children:i(r?"modal.editParticipant":"modal.addParticipant")}),r&&f.jsx("div",{className:"mb-4 p-3 bg-slate-50 rounded-lg border border-slate-200",children:f.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[r.createdAt&&f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-600",children:[i("timestamp.createdAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-slate-900",children:[rt(r.createdAt.split("T")[0])," ",new Date(r.createdAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]}),r.updatedAt&&f.jsxs("div",{children:[f.jsxs("span",{className:"text-slate-600",children:[i("timestamp.updatedAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-slate-900",children:[rt(r.updatedAt.split("T")[0])," ",new Date(r.updatedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]}),r.completedAt&&f.jsxs("div",{className:"col-span-2",children:[f.jsxs("span",{className:"text-emerald-600",children:[i("timestamp.completedAt"),":"]}),f.jsxs("span",{className:"ml-2 font-medium text-emerald-800",children:[rt(r.completedAt.split("T")[0])," ",new Date(r.completedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]})]})}),f.jsxs("form",{onSubmit:A,children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.companyName")," *"]}),f.jsxs("select",{value:s.companyName,onChange:I=>o({...s,companyName:I.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:i("modal.selectCompany")}),f.jsx("option",{value:"Egida",children:"Egida"}),f.jsx("option",{value:"D-Max",children:"D-Max"}),f.jsx("option",{value:"Multiforce",children:"Multiforce"})]}),c.companyName&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.companyName})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.personName")," *"]}),f.jsx("input",{type:"text",value:s.personName,onChange:I=>o({...s,personName:I.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.personName&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.personName})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),f.jsx("input",{type:"text",value:s.egn,onChange:I=>o({...s,egn:I.target.value}),placeholder:"XXXXXXXXXX",maxLength:10,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.egn&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.egn})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),f.jsx("input",{type:"text",value:s.birthPlace,onChange:I=>o({...s,birthPlace:I.target.value}),placeholder:"./. ...",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.birthPlace&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.birthPlace})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),f.jsx("input",{type:"text",value:s.citizenship,onChange:I=>o({...s,citizenship:I.target.value}),placeholder:"",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[i("modal.medicalDate")," *"]}),f.jsx("input",{type:"date",value:s.medicalDate,onChange:I=>o({...s,medicalDate:I.target.value}),onClick:I=>{var W,te;return(te=(W=I.target).showPicker)==null?void 0:te.call(W)},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer ${c.medicalDate?"border-red-500":"border-slate-300"}`}),c.medicalDate&&f.jsx("p",{className:"text-red-600 text-sm mt-1 font-medium",children:c.medicalDate}),s.medicalDate&&!c.medicalDate&&f.jsxs("p",{className:"text-emerald-600 text-sm mt-1",children:[" ",i("modal.medicalValid"),": ",rt(s.medicalDate)]})]}),l.courseStartDate&&f.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-md",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:i("modal.courseDates")}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:i("modal.courseStart")}),f.jsx("div",{className:"text-lg font-semibold text-blue-900",children:rt(l.courseStartDate)})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-1",children:i("modal.courseEnd")}),f.jsx("div",{className:"text-lg font-semibold text-blue-900",children:rt(l.courseEndDate)})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:i("modal.groupAssignment")}),f.jsxs("div",{className:"flex gap-2 mb-3",children:[f.jsx("button",{type:"button",onClick:()=>o({...s,groupAssignmentMode:"auto",selectedGroupId:""}),className:`flex-1 px-3 py-2 rounded-md border ${s.groupAssignmentMode==="auto"?"bg-blue-700 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:i("modal.auto")}),f.jsx("button",{type:"button",onClick:()=>o({...s,groupAssignmentMode:"manual"}),className:`flex-1 px-3 py-2 rounded-md border ${s.groupAssignmentMode==="manual"?"bg-blue-700 text-white border-blue-700":"bg-white text-slate-700 border-slate-300 hover:bg-slate-50"}`,children:i("modal.manual")})]}),s.groupAssignmentMode==="auto"&&k&&f.jsx(f.Fragment,{children:k.status==="completed"?f.jsx("div",{className:"bg-red-50 border border-red-200 p-3 rounded-md",children:f.jsxs("p",{className:"text-sm text-red-800 font-medium",children:["     .",f.jsx("br",{}),f.jsxs("span",{className:"text-xs font-normal mt-1 block",children:["        (",rt(k.courseStartDate),").           ."]})]})}):f.jsx("div",{className:"bg-emerald-50 border border-emerald-200 p-3 rounded-md",children:f.jsxs("p",{className:"text-sm text-emerald-800",children:[" ",i("modal.willBeAssigned")," ",f.jsxs("span",{className:"font-semibold",children:[i("group.number")," ",k.groupNumber||"-"]})," ","(",rt(k.courseStartDate)," - ",rt(k.courseEndDate),")"," ",f.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-semibold ${k.status==="active"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-700"}`,children:k.status==="active"?i("modal.active"):i("modal.planned")})]})})}),s.groupAssignmentMode==="manual"&&f.jsxs("select",{value:s.selectedGroupId,onChange:I=>o({...s,selectedGroupId:I.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[f.jsx("option",{value:"",children:i("modal.selectGroup")}),T&&f.jsxs("option",{value:(T.groupNumber||"").toString(),children:[i("group.number")," ",T.groupNumber||"-"," - ",rt(T.courseStartDate)," (",i("modal.active"),")"]}),N==null?void 0:N.filter(I=>I.status==="planned").map(I=>f.jsxs("option",{value:(I.groupNumber||"").toString(),children:[i("group.number")," ",I.groupNumber||"-"," - ",rt(I.courseStartDate)," (",i("modal.planned"),")"]},I.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:i("modal.uniqueNumberAuto")}),w&&!r&&f.jsx("div",{className:"mb-2 p-2 bg-amber-50 border border-amber-300 rounded-md",children:f.jsxs("p",{className:"text-amber-800 text-sm font-medium",children:[" ",i("modal.gapWarning",{number:w})]})}),f.jsx("input",{type:"text",value:s.uniqueNumber,onChange:I=>o({...s,uniqueNumber:I.target.value}),placeholder:E?`${i("modal.uniqueNumberNext")}: ${E}`:"e.g., 3531-001",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono"}),c.uniqueNumber&&f.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.uniqueNumber})]})]}),f.jsxs("div",{className:"mt-6 flex gap-3 justify-end pb-2 md:pb-0",children:[f.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-slate-200 rounded-md text-slate-700 hover:bg-slate-50",disabled:p,children:i("common.cancel")}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-700 text-white rounded-md hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:p||s.groupAssignmentMode==="auto"&&(k==null?void 0:k.status)==="completed",children:i(p?"common.saving":r?"modal.update":"common.add")})]})]})]})})," "]})," ",f.jsx(es,{isOpen:y.isOpen,onClose:()=>b({isOpen:!1,message:"",onConfirm:()=>{}}),onConfirm:y.onConfirm,title:"  ",message:y.message,confirmText:"",cancelText:"",variant:"warning"})]}):null},mP=({isOpen:e,onClose:t,searchText:r,onSearchTextChange:n,selectedGroup:a,onSelectedGroupChange:i,statusFilters:s,onStatusFilterChange:o,dateRange:l,onDateRangeChange:u,groups:c,onResetToDefaults:h})=>{const{t:p}=qr(),x=g=>{g.key==="Enter"&&t()};Ae.useEffect(()=>{const g=w=>{w.key==="Escape"&&t()};if(e)return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[e,t]);const E=({label:g,value:w,onChange:v})=>f.jsxs("div",{className:"mb-3",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700 mb-1.5 block",children:g}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsx("button",{onClick:()=>v(null),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${w===null?"bg-slate-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:p("filters.all")}),f.jsx("button",{onClick:()=>v(!0),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${w===!0?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:p("filters.yes")}),f.jsx("button",{onClick:()=>v(!1),className:`px-2 py-1.5 text-sm rounded-lg min-h-[36px] font-medium transition-colors duration-150 ${w===!1?"bg-red-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:p("filters.no")})]})]});return e?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 bg-black/30 z-40 transition-opacity",onClick:t}),f.jsxs("div",{className:`fixed z-50 bg-white shadow-2xl transition-transform
          md:top-0 md:left-0 md:h-dvh md:w-[360px] lg:w-[420px] md:max-w-[480px] md:translate-x-0
          bottom-0 left-0 right-0 max-h-[90vh] rounded-t-3xl md:rounded-none flex flex-col
          ${e?"translate-y-0":"translate-y-full md:translate-y-0 md:-translate-x-full"}
        `,children:[f.jsx("div",{className:"md:hidden flex justify-center pt-3 pb-2",children:f.jsx("div",{className:"w-12 h-1.5 bg-slate-300 rounded-full"})}),f.jsxs("div",{className:"sticky top-0 bg-white flex items-center justify-between p-4 border-b border-slate-200 z-10",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900",children:p("filters.title")}),f.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-lg min-w-[44px] min-h-[44px] transition-colors duration-150",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"p-4 pb-4 flex-1 overflow-y-auto",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:p("filters.search")}),f.jsx("input",{type:"text",value:r,onChange:g=>n(g.target.value),onKeyDown:x,placeholder:p("filters.searchPlaceholder"),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150"})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:p("filters.group")}),f.jsxs("select",{value:a,onChange:g=>i(g.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150",children:[f.jsx("option",{value:"",children:p("filters.allGroups")}),c.map(g=>f.jsx("option",{value:g.groupNumber.toString(),children:p("filters.groupOption",{number:g.groupNumber.toString(),date:g.courseStartDate})},g.groupNumber))]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:p("filters.dateRange")}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("input",{type:"date",value:l.start,onChange:g=>u({...l,start:g.target.value}),onClick:g=>{var w,v;return(v=(w=g.target).showPicker)==null?void 0:v.call(w)},className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150 cursor-pointer"}),f.jsx("input",{type:"date",value:l.end,onChange:g=>u({...l,end:g.target.value}),onClick:g=>{var w,v;return(v=(w=g.target).showPicker)==null?void 0:v.call(w)},className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300 min-h-[44px] transition-colors duration-150 cursor-pointer"})]})]}),f.jsxs("div",{className:"border-t border-slate-200 pt-4 mt-4",children:[f.jsx("h4",{className:"font-medium text-slate-900 mb-4",children:p("filters.statusFilters")}),f.jsx(E,{label:p("participant.sent"),value:s.sent,onChange:g=>o("sent",g)}),f.jsx(E,{label:p("participant.documents"),value:s.documents,onChange:g=>o("documents",g)}),f.jsx(E,{label:p("participant.handed"),value:s.handedOver,onChange:g=>o("handedOver",g)}),f.jsx(E,{label:p("participant.paid"),value:s.paid,onChange:g=>o("paid",g)}),f.jsx(E,{label:p("participant.completed"),value:s.completed,onChange:g=>o("completed",g)})]})]}),f.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 flex gap-3 shadow-[0_-2px_8px_rgba(0,0,0,0.08)]",children:[f.jsx("button",{onClick:()=>{n(""),i(""),u({start:"",end:""}),o("sent",null),o("documents",null),o("handedOver",null),o("paid",null),o("completed",null),h()},className:"flex-1 px-4 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 font-medium min-h-[48px] transition-colors duration-150",children:p("filters.clearAll")}),f.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 font-medium min-h-[48px] transition-colors duration-150",children:p("filters.apply")})]})]})]}):null},gP=({activeFilters:e,onRemoveFilter:t})=>{var a,i;const{t:r}=qr(),n=[];return e.searchText&&n.push({label:`${r("filters.search")}: "${e.searchText}"`,type:"search"}),e.selectedGroup&&n.push({label:`${r("filters.group")}: ${e.selectedGroup}`,type:"group"}),(a=e.dateRange)!=null&&a.start&&n.push({label:`${r("filters.from")}: ${rt(e.dateRange.start)}`,type:"dateStart"}),(i=e.dateRange)!=null&&i.end&&n.push({label:`${r("filters.to")}: ${rt(e.dateRange.end)}`,type:"dateEnd"}),e.statusFilters&&Object.entries(e.statusFilters).forEach(([s,o])=>{if(o!==null){const l=`participant.${s}`;n.push({label:`${r(l)}: ${r(o?"filters.yes":"filters.no")}`,type:"status",value:s})}}),n.length===0?null:f.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.map((s,o)=>f.jsxs("button",{onClick:()=>t(s.type,s.value),className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200 transition-colors duration-150",children:[f.jsx("span",{children:s.label}),f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},o)),f.jsx("button",{onClick:()=>t("all"),className:"px-3 py-1.5 bg-slate-200 text-slate-700 rounded-full text-sm hover:bg-slate-300 transition-colors duration-150",children:"Clear All"})]})},xP=3e5,vP=16,yP="SHA-256",wP=256,dh="app_pin_config";function zy(e){const t=new Uint8Array(e);let r="";for(let n=0;n<t.byteLength;n++)r+=String.fromCharCode(t[n]);return window.btoa(r)}function EP(e){try{const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}catch{throw new Error("Invalid Base64 string")}}async function wS(e,t){let r;t?r=EP(t):r=window.crypto.getRandomValues(new Uint8Array(vP));const n=new TextEncoder,a=await window.crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),i=await window.crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:xP,hash:yP},a,wP);return{hash:zy(i),salt:zy(r.buffer)}}async function Wy(e,t){try{const{hash:r}=await wS(e,t.salt);return r===t.hash}catch(r){return console.error("PIN verification failed:",r),!1}}function bP(e){localStorage.setItem(dh,JSON.stringify(e))}function qy(){const e=localStorage.getItem(dh);if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Dg(){localStorage.removeItem(dh)}function Ms(){return!!localStorage.getItem(dh)}const ES=({mode:e,onSuccess:t,onCancel:r,onResetData:n})=>{const[a,i]=Ae.useState(""),[s,o]=Ae.useState(""),[l,u]=Ae.useState("enter"),[c,h]=Ae.useState(null),[p,x]=Ae.useState(!1),[E,g]=Ae.useState(!1);Ae.useEffect(()=>{i(""),o(""),u("enter"),h(null)},[e]);const w=_=>{if(p)return;h(null);const S=l==="enter"?a:s;if(S.length<4){const A=S+_.toString();l==="enter"?i(A):o(A),A.length===4&&y(A)}},v=()=>{p||(h(null),l==="enter"?i(_=>_.slice(0,-1)):o(_=>_.slice(0,-1)))},y=async _=>{x(!0),await new Promise(S=>setTimeout(S,100));try{if(e==="unlock"){const S=qy();if(!S){t();return}await Wy(_,S)?t():(h("Incorrect PIN"),i(""))}else if(e==="setup")if(l==="enter"){u("confirm"),x(!1);return}else if(_===a){const{hash:S,salt:A}=await wS(_);bP({version:1,hash:S,salt:A,algo:"PBKDF2-SHA-256",createdAt:new Date().toISOString()}),t()}else h("PINs do not match. Try again."),i(""),o(""),u("enter");else if(e==="disable"){const S=qy();S&&await Wy(_,S)?(Dg(),t()):(h("Incorrect PIN"),i(""))}}catch(S){console.error(S),h("An error occurred. Please try again.")}finally{x(!1)}},b=()=>f.jsxs("div",{className:"grid grid-cols-3 gap-4 max-w-[280px] mx-auto mt-8",children:[[1,2,3,4,5,6,7,8,9].map(_=>f.jsx("button",{onClick:()=>w(_),className:"w-16 h-16 rounded-full bg-slate-100 text-slate-700 text-2xl font-bold hover:bg-slate-200 active:bg-slate-300 transition-colors flex items-center justify-center shadow-sm",children:_},_)),f.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:e==="unlock"&&f.jsx("button",{onClick:()=>g(!0),className:"text-xs text-slate-400 font-medium hover:text-red-500 transition-colors",children:"Forgot?"})}),f.jsx("button",{onClick:()=>w(0),className:"w-16 h-16 rounded-full bg-slate-100 text-slate-700 text-2xl font-bold hover:bg-slate-200 active:bg-slate-300 transition-colors flex items-center justify-center shadow-sm",children:"0"}),f.jsx("button",{onClick:v,className:"w-16 h-16 rounded-full text-slate-500 hover:text-slate-700 hover:bg-slate-100 active:bg-slate-200 transition-colors flex items-center justify-center",children:f.jsx(Gk,{className:"w-6 h-6"})})]}),T=_=>f.jsx("div",{className:"flex gap-4 justify-center mb-6",children:[0,1,2,3].map(S=>f.jsx("div",{className:`w-4 h-4 rounded-full border-2 transition-all duration-200 ${S<_.length?"bg-blue-600 border-blue-600":"bg-transparent border-slate-300"} ${c?"border-red-400 bg-red-50":""}`},S))}),N=()=>e==="setup"?l==="enter"?"Set a PIN":"Confirm PIN":e==="disable"?"Enter PIN to Disable":"App Locked",k=()=>c||(e==="setup"?l==="enter"?"Enter a 4-digit PIN":"Re-enter to confirm":"Enter your PIN");return f.jsxs("div",{className:"fixed inset-0 bg-slate-50 z-[100] flex flex-col items-center justify-center p-4 animate-in fade-in duration-300",children:[f.jsxs("div",{className:"w-full max-w-sm text-center",children:[f.jsx("div",{className:"mb-6 flex justify-center",children:f.jsx("div",{className:`p-4 rounded-full ${c?"bg-red-100":"bg-blue-100"}`,children:e==="unlock"?f.jsx(gc,{className:`w-8 h-8 ${c?"text-red-600":"text-blue-600"}`}):f.jsx(h5,{className:"w-8 h-8 text-blue-600"})})}),f.jsx("h2",{className:`text-2xl font-bold mb-2 ${c?"text-red-600":"text-slate-800"}`,children:N()}),f.jsx("p",{className:`text-sm mb-8 font-medium ${c?"text-red-500":"text-slate-500"}`,children:k()}),T(l==="enter"?a:s),b(),r&&f.jsx("button",{onClick:r,className:"mt-8 text-slate-500 hover:text-slate-700 font-medium text-sm",children:"Cancel"})]}),E&&f.jsx(es,{isOpen:E,onClose:()=>g(!1),onConfirm:()=>{n&&(Dg(),n()),g(!1)},title:"Reset Data & PIN?",message:"If you forgot your PIN, the only way to access the app is to RESET all local data. This will delete all participants and groups. You can then restore from a backup file.",confirmText:"Yes, Reset Everything",variant:"danger"})]})},$y=10*60*1e3,_P=({children:e})=>{const[t,r]=Ae.useState(!1),[n,a]=Ae.useState(!1),i=Ae.useRef(Date.now()),s=Ae.useRef(null);Ae.useEffect(()=>{Ms()&&r(!0),a(!0)},[]);const o=Ae.useCallback(()=>{Ms()&&r(!0)},[]),l=Ae.useCallback(()=>{r(!1),i.current=Date.now()},[]);Ae.useEffect(()=>{if(t)return;const c=()=>{i.current=Date.now()},h=["mousedown","keydown","touchstart","scroll","mousemove"];let p=null;const x=()=>{p||(c(),p=setTimeout(()=>{p=null},1e3))};h.forEach(g=>window.addEventListener(g,x));const E=()=>{!document.hidden&&Ms()&&Date.now()-i.current>$y&&r(!0)};return document.addEventListener("visibilitychange",E),s.current=setInterval(()=>{if(document.hidden)return;Date.now()-i.current>$y&&Ms()&&r(!0)},5e3),()=>{h.forEach(g=>window.removeEventListener(g,x)),document.removeEventListener("visibilitychange",E),s.current&&clearInterval(s.current),p&&clearTimeout(p)}},[t]),Ae.useEffect(()=>{const c=()=>o();return window.addEventListener("app-lock-manual",c),()=>window.removeEventListener("app-lock-manual",c)},[o]);const u=async()=>{try{await ke.delete(),await ke.open(),Dg(),window.location.reload()}catch(c){console.error("Failed to reset data",c),alert("Failed to reset data. Please clear browser storage manually.")}};return n?t?f.jsx(ES,{mode:"unlock",onSuccess:l,onResetData:u}):f.jsx(f.Fragment,{children:e}):null},bS=()=>{window.dispatchEvent(new Event("app-lock-manual"))},TP=({activeTab:e,onTabChange:t,onBack:r})=>{const{t:n}=qr();return f.jsx("header",{className:"bg-blue-700 text-white shadow-sm sticky top-0 z-40",children:f.jsx("div",{className:"container mx-auto px-4 py-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[r&&f.jsx("button",{onClick:r,className:"md:hidden p-2 hover:bg-blue-700 rounded-lg",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),f.jsx("div",{className:"flex-shrink-0 w-14 h-14 md:w-16 md:h-16 bg-white rounded-md flex items-center justify-center overflow-hidden",children:f.jsx("img",{src:"./Logo.svg",alt:"Logo",className:"w-full h-full object-cover scale-[2.4]"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"CERTIFY"}),f.jsx("p",{className:"text-sm md:text-base text-blue-100",children:"    "})]}),f.jsxs("div",{className:"hidden md:flex gap-2",children:[f.jsxs("button",{onClick:()=>t("participants"),className:`px-6 py-2 rounded-lg font-medium transition-colors duration-150 flex items-center gap-2 ${e==="participants"?"bg-white text-blue-800":"bg-blue-700/30 text-white hover:bg-blue-700/50"}`,children:[f.jsx(yl,{className:"w-5 h-5",strokeWidth:2}),n("nav.participants")]}),f.jsxs("button",{onClick:()=>t("tools"),className:`px-6 py-2 rounded-lg font-medium transition-colors duration-150 flex items-center gap-2 ${e==="tools"?"bg-white text-blue-800":"bg-blue-700/30 text-white hover:bg-blue-700/50"}`,children:[f.jsx($1,{className:"w-5 h-5",strokeWidth:2}),n("nav.tools")]}),Ms()&&f.jsxs("button",{onClick:()=>bS(),className:"px-4 py-2 ml-2 rounded-lg font-medium bg-indigo-600 text-white hover:bg-indigo-500 border border-indigo-400/50 shadow-sm transition-all duration-150 flex items-center gap-2",title:n("nav.lock"),children:[f.jsx(gc,{className:"w-5 h-5",strokeWidth:2}),f.jsx("span",{className:"hidden lg:inline",children:n("nav.lock")})]})]})]})})})},SP=({totalParticipants:e,visibleParticipants:t,totalCourses:r,visibleCourses:n,completedCount:a})=>{const{t:i}=qr(),[s,o]=Ae.useState(!1);return f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"md:hidden",children:[f.jsxs("button",{onClick:()=>o(!s),className:"w-full bg-white rounded-lg px-2 py-2 shadow-sm border border-slate-200 flex items-center justify-between mb-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"text-[11px] font-medium text-slate-500",children:i("participants.showing")}),f.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[t,"/",e]})]}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"text-[11px] font-medium text-slate-500",children:i("participant.completed")}),f.jsx("div",{className:"text-lg font-bold text-emerald-700",children:a})]})]}),f.jsx("svg",{className:`w-4 h-4 text-slate-500 transition-transform duration-200 ${s?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-1",children:[f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-slate-400",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-900 font-semibold whitespace-nowrap",children:i("participants.total")}),f.jsx("div",{className:"text-[9px] text-transparent font-medium mt-0.5 select-none",children:""})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(yl,{className:"w-3.5 h-3.5 text-slate-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-slate-900",children:e})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-blue-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold whitespace-nowrap",children:i("participants.showing")}),f.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-0.5",children:i("participants.showingSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(xg,{className:"w-3.5 h-3.5 text-blue-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-blue-600",children:t})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-indigo-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-indigo-600 font-semibold whitespace-nowrap",children:i("participants.totalCourses")}),f.jsx("div",{className:"text-[9px] text-transparent font-medium mt-0.5 select-none",children:""})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(j2,{className:"w-3.5 h-3.5 text-indigo-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-indigo-600",children:r})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-cyan-500",children:[f.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-cyan-600 font-semibold whitespace-nowrap",children:i("participants.visibleCourses")}),f.jsx("div",{className:"text-[9px] text-slate-500 font-medium mt-0.5",children:i("participants.visibleCoursesSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(Qs,{className:"w-3.5 h-3.5 text-cyan-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-2xl font-semibold tracking-tight text-cyan-600",children:n})]}),f.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-slate-200 border-l-4 border-l-amber-500 col-span-2",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-amber-600 font-semibold whitespace-nowrap",children:i("participants.completed")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-1",children:f.jsx(M2,{className:"w-3.5 h-3.5 text-amber-600",strokeWidth:2})})]}),f.jsxs("div",{className:"flex items-baseline gap-1",children:[f.jsx("div",{className:"text-xl font-semibold tracking-tight text-amber-600",children:a}),f.jsxs("div",{className:"text-xs text-slate-500",children:["/ ",t," (",t>0?Math.round(a/t*100):0,"%)"]})]})]})]})]}),f.jsxs("div",{className:"hidden md:grid grid-cols-5 gap-4 mb-2",children:[f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-slate-400 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-slate-900 font-semibold whitespace-nowrap",children:i("participants.total")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(yl,{className:"w-[18px] h-[18px] text-slate-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-slate-900 mt-auto",children:e})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-blue-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-base uppercase tracking-wide text-blue-600 font-semibold whitespace-nowrap",children:i("participants.showing")}),f.jsx("div",{className:"text-[10px] text-slate-500 font-medium mt-0.5",children:i("participants.showingSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(xg,{className:"w-[18px] h-[18px] text-blue-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-4xl font-semibold tracking-tight text-blue-600 mt-auto",children:t})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-indigo-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-indigo-600 font-semibold whitespace-nowrap",children:i("participants.totalCourses")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(j2,{className:"w-[18px] h-[18px] text-indigo-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-indigo-600 mt-auto",children:r})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-cyan-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-base uppercase tracking-wide text-cyan-600 font-semibold whitespace-nowrap",children:i("participants.visibleCourses")}),f.jsx("div",{className:"text-[10px] text-slate-500 font-medium mt-0.5",children:i("participants.visibleCoursesSubtext")})]}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(Qs,{className:"w-[18px] h-[18px] text-cyan-600",strokeWidth:2})})]}),f.jsx("div",{className:"text-4xl font-semibold tracking-tight text-cyan-600 mt-auto",children:n})]}),f.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm border border-slate-200 border-l-4 border-l-amber-500 hover:shadow-md transition-shadow duration-200 min-h-[120px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-sm uppercase tracking-wide text-amber-600 font-semibold whitespace-nowrap",children:i("participants.completed")}),f.jsx("div",{className:"bg-slate-50 rounded-full p-2.5",children:f.jsx(M2,{className:"w-[18px] h-[18px] text-amber-600",strokeWidth:2})})]}),f.jsxs("div",{className:"flex items-baseline gap-2 mt-auto",children:[f.jsx("div",{className:"text-3xl font-semibold tracking-tight text-amber-600",children:a}),f.jsxs("div",{className:"text-sm text-slate-500",children:["/ ",t," (",t>0?Math.round(a/t*100):0,"%)"]})]})]})]})]})},AP=({activeTab:e,onTabChange:t})=>{const{t:r}=qr();return f.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-sm z-50",children:f.jsxs("div",{className:"flex",children:[f.jsxs("button",{onClick:()=>t("participants"),className:`flex-1 flex flex-col items-center justify-center py-3 transition-colors duration-150 ${e==="participants"?"text-blue-700":"text-slate-400"}`,children:[f.jsx(yl,{className:"w-6 h-6 mb-1",strokeWidth:2}),f.jsx("span",{className:`text-xs ${e==="participants"?"font-semibold":"font-medium"}`,children:r("nav.participants")})]}),f.jsxs("button",{onClick:()=>t("tools"),className:`flex-1 flex flex-col items-center justify-center py-3 transition-colors duration-150 ${e==="tools"?"text-blue-700":"text-slate-400"}`,children:[f.jsx($1,{className:"w-6 h-6 mb-1",strokeWidth:2}),f.jsx("span",{className:`text-xs ${e==="tools"?"font-semibold":"font-medium"}`,children:r("nav.tools")})]})]})})},CP=({onClick:e})=>{const{t}=qr();return f.jsx("button",{onClick:e,className:"md:hidden fixed bottom-24 right-6 w-14 h-14 bg-emerald-600 hover:bg-emerald-700 active:bg-emerald-800 text-white rounded-full shadow-lg flex items-center justify-center z-40 active:scale-95 transition-all duration-150",style:{minWidth:"56px",minHeight:"56px"},"aria-label":t("participants.add"),children:f.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var dd={};dd.version="0.18.5";var _S=1252,DP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],TS=function(e){DP.indexOf(e)!=-1&&(_S=e)};function NP(){TS(1252)}var Oc=function(e){TS(e)};function kP(){Oc(1200),NP()}var Qf=function(t){return String.fromCharCode(t)},Hy=function(t){return String.fromCharCode(t)},hd,$i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fc(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=$i.charAt(i)+$i.charAt(s)+$i.charAt(o)+$i.charAt(l);return t}function _i(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=$i.indexOf(e.charAt(u++)),s=$i.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=$i.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=$i.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var zt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ci=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ro(e){return zt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Vy(e){return zt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ca=function(t){return zt?Ci(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function hh(e){if(typeof ArrayBuffer>"u")return Ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function rf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function OP(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Qr=zt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ci(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function FP(e){for(var t=[],r=0,n=e.length+250,a=ro(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ro(65535),n=65530)}return t.push(a.slice(0,r)),Qr(t)}var Mu=/\u0000/g,Jf=/[\u0001-\u0006]/g;function sl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Na(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}function hx(e,t){var r=""+e;return r.length>=t?r:yr(" ",t-r.length)+r}function pd(e,t){var r=""+e;return r.length>=t?r:r+yr(" ",t-r.length)}function PP(e,t){var r=""+Math.round(e);return r.length>=t?r:yr("0",t-r.length)+r}function IP(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}var Gy=Math.pow(2,32);function Co(e,t){if(e>Gy||e<-Gy)return PP(e,t);var r=Math.round(e);return IP(r,t)}function md(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Yy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Xy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},LP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gd(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,u=0,c=0,h=Math.floor(a);u<t&&(h=Math.floor(a),o=h*s+i,c=h*u+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=u,u=c;if(c>t&&(u>t?(c=l,o=i):(c=u,o=s)),!r)return[0,n*o,c];var p=Math.floor(n*o/c);return[p,n*o-p*c,c]}function e0(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=qP(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var SS=new Date(1899,11,31,0,0,0),MP=SS.getTime(),jP=new Date(1900,2,1,0,0,0);function AS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jP&&(r+=24*60*60*1e3),(r-(MP+(e.getTimezoneOffset()-SS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function px(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function BP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function UP(e){var t=e<0?12:11,r=px(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function zP(e){var t=px(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function WP(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=UP(e):t===10?r=e.toFixed(10).substr(0,12):r=zP(e),px(BP(r.toUpperCase()))}function Ng(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):WP(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return cs(14,AS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function qP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $P(e,t,r,n){var a="",i=0,s=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return qp[r.m-1][1];case 5:return qp[r.m-1][0];default:return qp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Yy[r.q][0];default:return Yy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Na(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Na(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Na(l,u):"";return c}function Hi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var CS=/%/g;function HP(e,t,r){var n=t.replace(CS,""),a=t.length-n.length;return mi(e,n,r*Math.pow(10,2*a))+yr("%",a)}function VP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function DS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+DS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NS=/# (\?+)( ?)\/( ?)(\d+)/;function GP(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?yr(" ",e[1].length+1+e[4].length):hx(s,e[1].length)+e[2]+"/"+e[3]+Na(o,e[4].length))}function YP(e,t,r){return r+(t===0?"":""+t)+yr(" ",e[1].length+2+e[4].length)}var kS=/^#*0*\.([0#]+)/,OS=/\).*[0#]/,FS=/\(###\) ###\\?-####/;function yn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ky(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zy(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function XP(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function KP(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(OS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?aa("n",n,r):"("+aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return VP(e,t,r);if(t.indexOf("%")!==-1)return HP(e,t,r);if(t.indexOf("E")!==-1)return DS(t,r);if(t.charCodeAt(0)===36)return"$"+aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Co(l,t.length);if(t.match(/^[#?]+$/))return a=Co(r,0),a==="0"&&(a=""),a.length>t.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(NS))return GP(i,l,u);if(t.match(/^#+0+$/))return u+Co(l,t.length-t.indexOf("0"));if(i=t.match(kS))return a=Ky(r,i[1].length).replace(/^([^\.]+)$/,"$1."+yn(i[1])).replace(/\.$/,"."+yn(i[1])).replace(/\.(\d*)$/,function(E,g){return"."+g+yr("0",yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+Ky(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Hi(Co(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+aa(e,t,-r):Hi(""+(Math.floor(r)+XP(r,i[1].length)))+"."+Na(Zy(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return aa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=sl(aa(e,t.replace(/[\\-]/g,""),r)),s=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return s<a.length?a.charAt(s++):E==="0"?"0":""}));if(t.match(FS))return a=aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=gd(l,Math.pow(10,s)-1,!1),a=""+u,c=mi("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=pd(o[2],s),c.length<i[4].length&&(c=yn(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=gd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hx(o[1],s)+i[2]+"/"+i[3]+pd(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Co(r,0),t.length<=a.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return yn(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Zy(r,i[1].length),r<0?"-"+aa(e,t,-r):Hi(KP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Na(0,3-E.length):"")+E})+"."+Na(s,i[1].length);switch(t){case"###,##0.00":return aa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Hi(Co(l,0));return x!=="0"?u+x:"";case"###,###.00":return aa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return aa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ZP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function QP(e,t,r){var n=t.replace(CS,""),a=t.length-n.length;return mi(e,n,r*Math.pow(10,2*a))+yr("%",a)}function PS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+PS(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(a+i)%a)+"."+c.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(OS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ZP(e,t,r);if(t.indexOf("%")!==-1)return QP(e,t,r);if(t.indexOf("E")!==-1)return PS(t,r);if(t.charCodeAt(0)===36)return"$"+Wa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Na(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(NS))return YP(i,l,u);if(t.match(/^#+0+$/))return u+Na(l,t.length-t.indexOf("0"));if(i=t.match(kS))return a=(""+r).replace(/^([^\.]+)$/,"$1."+yn(i[1])).replace(/\.$/,"."+yn(i[1])),a=a.replace(/\.(\d*)$/,function(E,g){return"."+g+yr("0",yn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Hi(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Hi(""+r)+"."+yr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Wa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=sl(Wa(e,t.replace(/[\\-]/g,""),r)),s=0,sl(sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return s<a.length?a.charAt(s++):E==="0"?"0":""}));if(t.match(FS))return a=Wa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var c="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=gd(l,Math.pow(10,s)-1,!1),a=""+u,c=mi("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),a+=c+i[2]+"/"+i[3],c=pd(o[2],s),c.length<i[4].length&&(c=yn(i[4].substr(i[4].length-c.length))+c),a+=c,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=gd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?hx(o[1],s)+i[2]+"/"+i[3]+pd(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:yn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return yn(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):Hi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Na(0,3-E.length):"")+E})+"."+Na(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Hi(""+l);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return Wa(e,t.slice(0,t.lastIndexOf(".")),r)+yn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function mi(e,t,r){return(r|0)===r?Wa(e,t,r):aa(e,t,r)}function JP(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var IS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function RS(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":md(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(IS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function eI(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",u,c,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!md(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var x=e.charAt(++s),E=x==="("||x===")"?x:"t";a[a.length]={t:E,v:x},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=e0(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=e0(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=e0(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",s+=5,p="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(IS)){if(u==null&&(u=e0(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",RS(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var w=0,v=0,y;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",w<1&&(w=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",T;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=$P(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(T=s+1;a[T]!=null&&((o=a[T].t)==="?"||o==="D"||(o===" "||o==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[s].v+=a[T].v,a[T]={v:"",t:";"},++T;b+=a[s].v,s=T-1;break;case"G":a[s].t="t",a[s].v=Ng(t,r);break}var N="",k,_;if(b.length>0){b.charCodeAt(0)==40?(k=t<0&&b.charCodeAt(0)===45?-t:t,_=mi("n",b,k)):(k=t<0&&n>1?-t:t,_=mi("n",b,k),k<0&&a[0]&&a[0].t=="t"&&(_=_.substr(1),a[0].v="-"+a[0].v)),T=_.length-1;var S=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){S=s;break}var A=a.length;if(S===a.length&&_.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(T>=a[s].v.length-1?(T-=a[s].v.length,a[s].v=_.substr(T+1,a[s].v.length)):T<0?a[s].v="":(a[s].v=_.substr(0,T+1),T=-1),a[s].t="t",A=s);T>=0&&A<a.length&&(a[A].v=_.substr(0,T+1)+a[A].v)}else if(S!==a.length&&_.indexOf("E")===-1){for(T=_.indexOf(".")-1,s=S;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(c=a[s].v.indexOf(".")>-1&&s===S?a[s].v.indexOf(".")-1:a[s].v.length-1,N=a[s].v.substr(c+1);c>=0;--c)T>=0&&(a[s].v.charAt(c)==="0"||a[s].v.charAt(c)==="#")&&(N=_.charAt(T--)+N);a[s].v=N,a[s].t="t",A=s}for(T>=0&&A<a.length&&(a[A].v=_.substr(0,T+1)+a[A].v),T=_.indexOf(".")+1,s=S;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==S)){for(c=a[s].v.indexOf(".")>-1&&s===S?a[s].v.indexOf(".")+1:0,N=a[s].v.substr(0,c);c<a[s].v.length;++c)T<_.length&&(N+=_.charAt(T++));a[s].v=N,a[s].t="t",A=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(k=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=mi(a[s].t,a[s].v,k),a[s].t="t");var P="";for(s=0;s!==a.length;++s)a[s]!=null&&(P+=a[s].v);return P}var Qy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function tI(e,t){var r=JP(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Qy),o=r[1].match(Qy);return Jy(t,s)?[n,r[0]]:Jy(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function cs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:wr)[e],n==null&&(n=r.table&&r.table[Xy[e]]||wr[Xy[e]]),n==null&&(n=LP[e]||"General");break}if(md(n,0))return Ng(t,r);t instanceof Date&&(t=AS(t,r.date1904));var a=tI(n,t);if(md(a[1]))return Ng(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return eI(a[1],t,r,a[0])}function LS(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(wr[r]==null){t<0&&(t=r);continue}if(wr[r]==e){t=r;break}}t<0&&(t=391)}return wr[t]=e,t}function ph(e){for(var t=0;t!=392;++t)e[t]!==void 0&&LS(e[t],t)}function mh(){wr=RP()}var MS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function rI(e){var t=typeof e=="number"?wr[e]:e;return t=t.replace(MS,"(\\d+)"),new RegExp("^"+t+"$")}function nI(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(MS)||[]).forEach(function(h,p){var x=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=x;break;case"d":i=x;break;case"h":s=x;break;case"s":l=x;break;case"m":s>=0?o=x:a=x;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&i==-1?c:u+"T"+c}var aI=function(){var e={};e.version="1.2.0";function t(){for(var _=0,S=new Array(256),A=0;A!=256;++A)_=A,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,S[A]=_;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(_){var S=0,A=0,P=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)I[P]=_[P];for(P=0;P!=256;++P)for(A=_[P],S=256+P;S<4096;S+=256)A=I[S]=A>>>8^_[A&255];var W=[];for(P=1;P!=16;++P)W[P-1]=typeof Int32Array<"u"?I.subarray(P*256,P*256+256):I.slice(P*256,P*256+256);return W}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],u=a[4],c=a[5],h=a[6],p=a[7],x=a[8],E=a[9],g=a[10],w=a[11],v=a[12],y=a[13],b=a[14];function T(_,S){for(var A=S^-1,P=0,I=_.length;P<I;)A=A>>>8^r[(A^_.charCodeAt(P++))&255];return~A}function N(_,S){for(var A=S^-1,P=_.length-15,I=0;I<P;)A=b[_[I++]^A&255]^y[_[I++]^A>>8&255]^v[_[I++]^A>>16&255]^w[_[I++]^A>>>24]^g[_[I++]]^E[_[I++]]^x[_[I++]]^p[_[I++]]^h[_[I++]]^c[_[I++]]^u[_[I++]]^l[_[I++]]^o[_[I++]]^s[_[I++]]^i[_[I++]]^r[_[I++]];for(P+=15;I<P;)A=A>>>8^r[(A^_[I++])&255];return~A}function k(_,S){for(var A=S^-1,P=0,I=_.length,W=0,te=0;P<I;)W=_.charCodeAt(P++),W<128?A=A>>>8^r[(A^W)&255]:W<2048?(A=A>>>8^r[(A^(192|W>>6&31))&255],A=A>>>8^r[(A^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,te=_.charCodeAt(P++)&1023,A=A>>>8^r[(A^(240|W>>8&7))&255],A=A>>>8^r[(A^(128|W>>2&63))&255],A=A>>>8^r[(A^(128|te>>6&15|(W&3)<<4))&255],A=A>>>8^r[(A^(128|te&63))&255]):(A=A>>>8^r[(A^(224|W>>12&15))&255],A=A>>>8^r[(A^(128|W>>6&63))&255],A=A>>>8^r[(A^(128|W&63))&255]);return~A}return e.table=r,e.bstr=T,e.buf=N,e.str=k,e}(),Zt=function(){var t={};t.version="1.2.1";function r(O,U){for(var M=O.split("/"),B=U.split("/"),z=0,G=0,de=Math.min(M.length,B.length);z<de;++z){if(G=M[z].length-B[z].length)return G;if(M[z]!=B[z])return M[z]<B[z]?-1:1}return M.length-B.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(0,U+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(U+1)}function i(O,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,O.write_shift(2,M);var B=U.getFullYear()-1980;B=B<<4|U.getMonth()+1,B=B<<5|U.getDate(),O.write_shift(2,B)}function s(O){var U=O.read_shift(2)&65535,M=O.read_shift(2)&65535,B=new Date,z=M&31;M>>>=5;var G=M&15;M>>>=4,B.setMilliseconds(0),B.setFullYear(M+1980),B.setMonth(G-1),B.setDate(z);var de=U&31;U>>>=5;var Se=U&63;return U>>>=6,B.setHours(U),B.setMinutes(Se),B.setSeconds(de<<1),B}function o(O){$n(O,0);for(var U={},M=0;O.l<=O.length-4;){var B=O.read_shift(2),z=O.read_shift(2),G=O.l+z,de={};switch(B){case 21589:M=O.read_shift(1),M&1&&(de.mtime=O.read_shift(4)),z>5&&(M&2&&(de.atime=O.read_shift(4)),M&4&&(de.ctime=O.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}O.l=G,U[B]=de}return U}var l;function u(){return l||(l={})}function c(O,U){if(O[0]==80&&O[1]==75)return it(O,U);if((O[0]|32)==109&&(O[1]|32)==105)return gn(O,U);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var M=3,B=512,z=0,G=0,de=0,Se=0,fe=0,pe=[],ge=O.slice(0,512);$n(ge,0);var Ie=h(ge);switch(M=Ie[0],M){case 3:B=512;break;case 4:B=4096;break;case 0:if(Ie[1]==0)return it(O,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}B!==512&&(ge=O.slice(0,B),$n(ge,28));var We=O.slice(0,B);p(ge,M);var Ze=ge.read_shift(4,"i");if(M===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Se=ge.read_shift(4,"i"),z=ge.read_shift(4,"i"),fe=ge.read_shift(4,"i"),G=ge.read_shift(4,"i");for(var Me=-1,Ye=0;Ye<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++Ye)pe[Ye]=Me;var gt=x(O,B);w(fe,G,gt,B,pe);var nr=y(gt,de,pe,B);nr[de].name="!Directory",z>0&&Se!==te&&(nr[Se].name="!MiniFAT"),nr[pe[0]].name="!FAT",nr.fat_addrs=pe,nr.ssz=B;var ar={},Lr=[],ws=[],Ua=[];b(de,nr,gt,Lr,z,ar,ws,Se),E(ws,Ua,Lr),Lr.shift();var Es={FileIndex:ws,FullPaths:Ua};return U&&U.raw&&(Es.raw={header:We,sectors:gt}),Es}function h(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(oe,"Header Signature: "),O.l+=16;var U=O.read_shift(2,"u");return[O.read_shift(2,"u"),U]}function p(O,U){var M=9;switch(O.l+=2,M=O.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function x(O,U){for(var M=Math.ceil(O.length/U)-1,B=[],z=1;z<M;++z)B[z-1]=O.slice(z*U,(z+1)*U);return B[M-1]=O.slice(M*U),B}function E(O,U,M){for(var B=0,z=0,G=0,de=0,Se=0,fe=M.length,pe=[],ge=[];B<fe;++B)pe[B]=ge[B]=B,U[B]=M[B];for(;Se<ge.length;++Se)B=ge[Se],z=O[B].L,G=O[B].R,de=O[B].C,pe[B]===B&&(z!==-1&&pe[z]!==z&&(pe[B]=pe[z]),G!==-1&&pe[G]!==G&&(pe[B]=pe[G])),de!==-1&&(pe[de]=B),z!==-1&&B!=pe[B]&&(pe[z]=pe[B],ge.lastIndexOf(z)<Se&&ge.push(z)),G!==-1&&B!=pe[B]&&(pe[G]=pe[B],ge.lastIndexOf(G)<Se&&ge.push(G));for(B=1;B<fe;++B)pe[B]===B&&(G!==-1&&pe[G]!==G?pe[B]=pe[G]:z!==-1&&pe[z]!==z&&(pe[B]=pe[z]));for(B=1;B<fe;++B)if(O[B].type!==0){if(Se=B,Se!=pe[Se])do Se=pe[Se],U[B]=U[Se]+"/"+U[B];while(Se!==0&&pe[Se]!==-1&&Se!=pe[Se]);pe[B]=-1}for(U[0]+="/",B=1;B<fe;++B)O[B].type!==2&&(U[B]+="/")}function g(O,U,M){for(var B=O.start,z=O.size,G=[],de=B;M&&z>0&&de>=0;)G.push(U.slice(de*W,de*W+W)),z-=W,de=Os(M,de*4);return G.length===0?Te(0):Qr(G).slice(0,O.size)}function w(O,U,M,B,z){var G=te;if(O===te){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var de=M[O],Se=(B>>>2)-1;if(!de)return;for(var fe=0;fe<Se&&(G=Os(de,fe*4))!==te;++fe)z.push(G);w(Os(de,B-4),U-1,M,B,z)}}function v(O,U,M,B,z){var G=[],de=[];z||(z=[]);var Se=B-1,fe=0,pe=0;for(fe=U;fe>=0;){z[fe]=!0,G[G.length]=fe,de.push(O[fe]);var ge=M[Math.floor(fe*4/B)];if(pe=fe*4&Se,B<4+pe)throw new Error("FAT boundary crossed: "+fe+" 4 "+B);if(!O[ge])break;fe=Os(O[ge],pe)}return{nodes:G,data:ow([de])}}function y(O,U,M,B){var z=O.length,G=[],de=[],Se=[],fe=[],pe=B-1,ge=0,Ie=0,We=0,Ze=0;for(ge=0;ge<z;++ge)if(Se=[],We=ge+U,We>=z&&(We-=z),!de[We]){fe=[];var Me=[];for(Ie=We;Ie>=0;){Me[Ie]=!0,de[Ie]=!0,Se[Se.length]=Ie,fe.push(O[Ie]);var Ye=M[Math.floor(Ie*4/B)];if(Ze=Ie*4&pe,B<4+Ze)throw new Error("FAT boundary crossed: "+Ie+" 4 "+B);if(!O[Ye]||(Ie=Os(O[Ye],Ze),Me[Ie]))break}G[We]={nodes:Se,data:ow([fe])}}return G}function b(O,U,M,B,z,G,de,Se){for(var fe=0,pe=B.length?2:0,ge=U[O].data,Ie=0,We=0,Ze;Ie<ge.length;Ie+=128){var Me=ge.slice(Ie,Ie+128);$n(Me,64),We=Me.read_shift(2),Ze=yx(Me,0,We-pe),B.push(Ze);var Ye={name:Ze,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},gt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);gt!==0&&(Ye.ct=T(Me,Me.l-8));var nr=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);nr!==0&&(Ye.mt=T(Me,Me.l-8)),Ye.start=Me.read_shift(4,"i"),Ye.size=Me.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=te,Ye.name=""),Ye.type===5?(fe=Ye.start,z>0&&fe!==te&&(U[fe].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",U[Ye.start]===void 0&&(U[Ye.start]=v(M,Ye.start,U.fat_addrs,U.ssz)),U[Ye.start].name=Ye.name,Ye.content=U[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:fe!==te&&Ye.start!==te&&U[fe]&&(Ye.content=g(Ye,U[fe].data,(U[Se]||{}).data))),Ye.content&&$n(Ye.content,0),G[Ze]=Ye,de.push(Ye)}}function T(O,U){return new Date((Vn(O,U+4)/1e7*Math.pow(2,32)+Vn(O,U)/1e7-11644473600)*1e3)}function N(O,U){return u(),c(l.readFileSync(O),U)}function k(O,U){var M=U&&U.type;switch(M||zt&&Buffer.isBuffer(O)&&(M="buffer"),M||"base64"){case"file":return N(O,U);case"base64":return c(Ca(_i(O)),U);case"binary":return c(Ca(O),U)}return c(O,U)}function _(O,U){var M=U||{},B=M.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=B+"/",O.FileIndex[0]={name:B,type:5}),M.CLSID&&(O.FileIndex[0].clsid=M.CLSID),S(O)}function S(O){var U="Sh33tJ5";if(!Zt.find(O,"/"+U)){var M=Te(4);M[0]=55,M[1]=M[3]=50,M[2]=54,O.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+U),A(O)}}function A(O,U){_(O);for(var M=!1,B=!1,z=O.FullPaths.length-1;z>=0;--z){var G=O.FileIndex[z];switch(G.type){case 0:B?M=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(G.R*G.L*G.C)&&(M=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var de=new Date(1987,1,19),Se=0,fe=Object.create?Object.create(null):{},pe=[];for(z=0;z<O.FullPaths.length;++z)fe[O.FullPaths[z]]=!0,O.FileIndex[z].type!==0&&pe.push([O.FullPaths[z],O.FileIndex[z]]);for(z=0;z<pe.length;++z){var ge=n(pe[z][0]);B=fe[ge],B||(pe.push([ge,{name:a(ge).replace("/",""),type:1,clsid:ye,ct:de,mt:de,content:null}]),fe[ge]=!0)}for(pe.sort(function(Ze,Me){return r(Ze[0],Me[0])}),O.FullPaths=[],O.FileIndex=[],z=0;z<pe.length;++z)O.FullPaths[z]=pe[z][0],O.FileIndex[z]=pe[z][1];for(z=0;z<pe.length;++z){var Ie=O.FileIndex[z],We=O.FullPaths[z];if(Ie.name=a(We).replace("/",""),Ie.L=Ie.R=Ie.C=-(Ie.color=1),Ie.size=Ie.content?Ie.content.length:0,Ie.start=0,Ie.clsid=Ie.clsid||ye,z===0)Ie.C=pe.length>1?1:-1,Ie.size=0,Ie.type=5;else if(We.slice(-1)=="/"){for(Se=z+1;Se<pe.length&&n(O.FullPaths[Se])!=We;++Se);for(Ie.C=Se>=pe.length?-1:Se,Se=z+1;Se<pe.length&&n(O.FullPaths[Se])!=n(We);++Se);Ie.R=Se>=pe.length?-1:Se,Ie.type=1}else n(O.FullPaths[z+1]||"")==n(We)&&(Ie.R=z+1),Ie.type=2}}}function P(O,U){var M=U||{};if(M.fileType=="mad")return Ba(O,M);switch(A(O),M.fileType){case"zip":return Rt(O,M)}var B=function(Ze){for(var Me=0,Ye=0,gt=0;gt<Ze.FileIndex.length;++gt){var nr=Ze.FileIndex[gt];if(nr.content){var ar=nr.content.length;ar>0&&(ar<4096?Me+=ar+63>>6:Ye+=ar+511>>9)}}for(var Lr=Ze.FullPaths.length+3>>2,ws=Me+7>>3,Ua=Me+127>>7,Es=ws+Ye+Lr+Ua,ei=Es+127>>7,Wl=ei<=109?0:Math.ceil((ei-109)/127);Es+ei+Wl+127>>7>ei;)Wl=++ei<=109?0:Math.ceil((ei-109)/127);var xa=[1,Wl,ei,Ua,Lr,Ye,Me,0];return Ze.FileIndex[0].size=Me<<6,xa[7]=(Ze.FileIndex[0].start=xa[0]+xa[1]+xa[2]+xa[3]+xa[4]+xa[5])+(xa[6]+7>>3),xa}(O),z=Te(B[7]<<9),G=0,de=0;{for(G=0;G<8;++G)z.write_shift(1,ve[G]);for(G=0;G<8;++G)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),G=0;G<3;++G)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,B[2]),z.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:te),z.write_shift(4,B[3]),z.write_shift(-4,B[1]?B[0]-1:te),z.write_shift(4,B[1]),G=0;G<109;++G)z.write_shift(-4,G<B[2]?B[1]+G:-1)}if(B[1])for(de=0;de<B[1];++de){for(;G<236+de*127;++G)z.write_shift(-4,G<B[2]?B[1]+G:-1);z.write_shift(-4,de===B[1]-1?te:de+1)}var Se=function(Ze){for(de+=Ze;G<de-1;++G)z.write_shift(-4,G+1);Ze&&(++G,z.write_shift(-4,te))};for(de=G=0,de+=B[1];G<de;++G)z.write_shift(-4,_e.DIFSECT);for(de+=B[2];G<de;++G)z.write_shift(-4,_e.FATSECT);Se(B[3]),Se(B[4]);for(var fe=0,pe=0,ge=O.FileIndex[0];fe<O.FileIndex.length;++fe)ge=O.FileIndex[fe],ge.content&&(pe=ge.content.length,!(pe<4096)&&(ge.start=de,Se(pe+511>>9)));for(Se(B[6]+7>>3);z.l&511;)z.write_shift(-4,_e.ENDOFCHAIN);for(de=G=0,fe=0;fe<O.FileIndex.length;++fe)ge=O.FileIndex[fe],ge.content&&(pe=ge.content.length,!(!pe||pe>=4096)&&(ge.start=de,Se(pe+63>>6)));for(;z.l&511;)z.write_shift(-4,_e.ENDOFCHAIN);for(G=0;G<B[4]<<2;++G){var Ie=O.FullPaths[G];if(!Ie||Ie.length===0){for(fe=0;fe<17;++fe)z.write_shift(4,0);for(fe=0;fe<3;++fe)z.write_shift(4,-1);for(fe=0;fe<12;++fe)z.write_shift(4,0);continue}ge=O.FileIndex[G],G===0&&(ge.start=ge.size?ge.start-1:te);var We=G===0&&M.root||ge.name;if(pe=2*(We.length+1),z.write_shift(64,We,"utf16le"),z.write_shift(2,pe),z.write_shift(1,ge.type),z.write_shift(1,ge.color),z.write_shift(-4,ge.L),z.write_shift(-4,ge.R),z.write_shift(-4,ge.C),ge.clsid)z.write_shift(16,ge.clsid,"hex");else for(fe=0;fe<4;++fe)z.write_shift(4,0);z.write_shift(4,ge.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,ge.start),z.write_shift(4,ge.size),z.write_shift(4,0)}for(G=1;G<O.FileIndex.length;++G)if(ge=O.FileIndex[G],ge.size>=4096)if(z.l=ge.start+1<<9,zt&&Buffer.isBuffer(ge.content))ge.content.copy(z,z.l,0,ge.size),z.l+=ge.size+511&-512;else{for(fe=0;fe<ge.size;++fe)z.write_shift(1,ge.content[fe]);for(;fe&511;++fe)z.write_shift(1,0)}for(G=1;G<O.FileIndex.length;++G)if(ge=O.FileIndex[G],ge.size>0&&ge.size<4096)if(zt&&Buffer.isBuffer(ge.content))ge.content.copy(z,z.l,0,ge.size),z.l+=ge.size+63&-64;else{for(fe=0;fe<ge.size;++fe)z.write_shift(1,ge.content[fe]);for(;fe&63;++fe)z.write_shift(1,0)}if(zt)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function I(O,U){var M=O.FullPaths.map(function(fe){return fe.toUpperCase()}),B=M.map(function(fe){var pe=fe.split("/");return pe[pe.length-(fe.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=M[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var G=U.toUpperCase(),de=z===!0?M.indexOf(G):B.indexOf(G);if(de!==-1)return O.FileIndex[de];var Se=!G.match(Jf);for(G=G.replace(Mu,""),Se&&(G=G.replace(Jf,"!")),de=0;de<M.length;++de)if((Se?M[de].replace(Jf,"!"):M[de]).replace(Mu,"")==G||(Se?B[de].replace(Jf,"!"):B[de]).replace(Mu,"")==G)return O.FileIndex[de];return null}var W=64,te=-2,oe="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],ye="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ye,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(O,U,M){u();var B=P(O,M);l.writeFileSync(U,B)}function ce(O){for(var U=new Array(O.length),M=0;M<O.length;++M)U[M]=String.fromCharCode(O[M]);return U.join("")}function De(O,U){var M=P(O,U);switch(U&&U.type||"buffer"){case"file":return u(),l.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:ce(M);case"base64":return Fc(typeof M=="string"?M:ce(M));case"buffer":if(zt)return Buffer.isBuffer(M)?M:Ci(M);case"array":return typeof M=="string"?Ca(M):M}return M}var Ve;function Y(O){try{var U=O.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)Ve=O;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function se(O,U){if(!Ve)return Ke(O,U);var M=Ve.InflateRaw,B=new M,z=B._processChunk(O.slice(O.l),B._finishFlushFlag);return O.l+=B.bytesRead,z}function ee(O){return Ve?Ve.deflateRawSync(O):Wt(O)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function R(O){var U=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(U>>16|U>>8|U)&255}for(var j=typeof Uint8Array<"u",re=j?new Uint8Array(256):[],xe=0;xe<256;++xe)re[xe]=R(xe);function Pe(O,U){var M=re[O&255];return U<=8?M>>>8-U:(M=M<<8|re[O>>8&255],U<=16?M>>>16-U:(M=M<<8|re[O>>16&255],M>>>24-U))}function Z(O,U){var M=U&7,B=U>>>3;return(O[B]|(M<=6?0:O[B+1]<<8))>>>M&3}function L(O,U){var M=U&7,B=U>>>3;return(O[B]|(M<=5?0:O[B+1]<<8))>>>M&7}function X(O,U){var M=U&7,B=U>>>3;return(O[B]|(M<=4?0:O[B+1]<<8))>>>M&15}function K(O,U){var M=U&7,B=U>>>3;return(O[B]|(M<=3?0:O[B+1]<<8))>>>M&31}function ie(O,U){var M=U&7,B=U>>>3;return(O[B]|(M<=1?0:O[B+1]<<8))>>>M&127}function be(O,U,M){var B=U&7,z=U>>>3,G=(1<<M)-1,de=O[z]>>>B;return M<8-B||(de|=O[z+1]<<8-B,M<16-B)||(de|=O[z+2]<<16-B,M<24-B)||(de|=O[z+3]<<24-B),de&G}function nt(O,U,M){var B=U&7,z=U>>>3;return B<=5?O[z]|=(M&7)<<B:(O[z]|=M<<B&255,O[z+1]=(M&7)>>8-B),U+3}function Xe(O,U,M){var B=U&7,z=U>>>3;return M=(M&1)<<B,O[z]|=M,U+1}function mt(O,U,M){var B=U&7,z=U>>>3;return M<<=B,O[z]|=M&255,M>>>=8,O[z+1]=M,U+8}function et(O,U,M){var B=U&7,z=U>>>3;return M<<=B,O[z]|=M&255,M>>>=8,O[z+1]=M&255,O[z+2]=M>>>8,U+16}function Mt(O,U){var M=O.length,B=2*M>U?2*M:U+5,z=0;if(M>=U)return O;if(zt){var G=Vy(B);if(O.copy)O.copy(G);else for(;z<O.length;++z)G[z]=O[z];return G}else if(j){var de=new Uint8Array(B);if(de.set)de.set(O);else for(;z<M;++z)de[z]=O[z];return de}return O.length=B,O}function Ee(O){for(var U=new Array(O),M=0;M<O;++M)U[M]=0;return U}function Ne(O,U,M){var B=1,z=0,G=0,de=0,Se=0,fe=O.length,pe=j?new Uint16Array(32):Ee(32);for(G=0;G<32;++G)pe[G]=0;for(G=fe;G<M;++G)O[G]=0;fe=O.length;var ge=j?new Uint16Array(fe):Ee(fe);for(G=0;G<fe;++G)pe[z=O[G]]++,B<z&&(B=z),ge[G]=0;for(pe[0]=0,G=1;G<=B;++G)pe[G+16]=Se=Se+pe[G-1]<<1;for(G=0;G<fe;++G)Se=O[G],Se!=0&&(ge[G]=pe[Se+16]++);var Ie=0;for(G=0;G<fe;++G)if(Ie=O[G],Ie!=0)for(Se=Pe(ge[G],B)>>B-Ie,de=(1<<B+4-Ie)-1;de>=0;--de)U[Se|de<<Ie]=Ie&15|G<<4;return B}var Re=j?new Uint16Array(512):Ee(512),He=j?new Uint16Array(32):Ee(32);if(!j){for(var at=0;at<512;++at)Re[at]=0;for(at=0;at<32;++at)He[at]=0}(function(){for(var O=[],U=0;U<32;U++)O.push(5);Ne(O,He,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);Ne(M,Re,288)})();var Tt=function(){for(var U=j?new Uint8Array(32768):[],M=0,B=0;M<V.length-1;++M)for(;B<V[M+1];++B)U[B]=M;for(;B<32768;++B)U[B]=29;var z=j?new Uint8Array(259):[];for(M=0,B=0;M<F.length-1;++M)for(;B<F[M+1];++B)z[B]=M;function G(Se,fe){for(var pe=0;pe<Se.length;){var ge=Math.min(65535,Se.length-pe),Ie=pe+ge==Se.length;for(fe.write_shift(1,+Ie),fe.write_shift(2,ge),fe.write_shift(2,~ge&65535);ge-- >0;)fe[fe.l++]=Se[pe++]}return fe.l}function de(Se,fe){for(var pe=0,ge=0,Ie=j?new Uint16Array(32768):[];ge<Se.length;){var We=Math.min(65535,Se.length-ge);if(We<10){for(pe=nt(fe,pe,+(ge+We==Se.length)),pe&7&&(pe+=8-(pe&7)),fe.l=pe/8|0,fe.write_shift(2,We),fe.write_shift(2,~We&65535);We-- >0;)fe[fe.l++]=Se[ge++];pe=fe.l*8;continue}pe=nt(fe,pe,+(ge+We==Se.length)+2);for(var Ze=0;We-- >0;){var Me=Se[ge];Ze=(Ze<<5^Me)&32767;var Ye=-1,gt=0;if((Ye=Ie[Ze])&&(Ye|=ge&-32768,Ye>ge&&(Ye-=32768),Ye<ge))for(;Se[Ye+gt]==Se[ge+gt]&&gt<250;)++gt;if(gt>2){Me=z[gt],Me<=22?pe=mt(fe,pe,re[Me+1]>>1)-1:(mt(fe,pe,3),pe+=5,mt(fe,pe,re[Me-23]>>5),pe+=3);var nr=Me<8?0:Me-4>>2;nr>0&&(et(fe,pe,gt-F[Me]),pe+=nr),Me=U[ge-Ye],pe=mt(fe,pe,re[Me]>>3),pe-=3;var ar=Me<4?0:Me-2>>1;ar>0&&(et(fe,pe,ge-Ye-V[Me]),pe+=ar);for(var Lr=0;Lr<gt;++Lr)Ie[Ze]=ge&32767,Ze=(Ze<<5^Se[ge])&32767,++ge;We-=gt-1}else Me<=143?Me=Me+48:pe=Xe(fe,pe,1),pe=mt(fe,pe,re[Me]),Ie[Ze]=ge&32767,++ge}pe=mt(fe,pe,0)-1}return fe.l=(pe+7)/8|0,fe.l}return function(fe,pe){return fe.length<8?G(fe,pe):de(fe,pe)}}();function Wt(O){var U=Te(50+Math.floor(O.length*1.1)),M=Tt(O,U);return U.slice(0,M)}var jt=j?new Uint16Array(32768):Ee(32768),lt=j?new Uint16Array(32768):Ee(32768),we=j?new Uint16Array(128):Ee(128),he=1,J=1;function me(O,U){var M=K(O,U)+257;U+=5;var B=K(O,U)+1;U+=5;var z=X(O,U)+4;U+=4;for(var G=0,de=j?new Uint8Array(19):Ee(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,pe=j?new Uint8Array(8):Ee(8),ge=j?new Uint8Array(8):Ee(8),Ie=de.length,We=0;We<z;++We)de[D[We]]=G=L(O,U),fe<G&&(fe=G),pe[G]++,U+=3;var Ze=0;for(pe[0]=0,We=1;We<=fe;++We)ge[We]=Ze=Ze+pe[We-1]<<1;for(We=0;We<Ie;++We)(Ze=de[We])!=0&&(Se[We]=ge[Ze]++);var Me=0;for(We=0;We<Ie;++We)if(Me=de[We],Me!=0){Ze=re[Se[We]]>>8-Me;for(var Ye=(1<<7-Me)-1;Ye>=0;--Ye)we[Ze|Ye<<Me]=Me&7|We<<3}var gt=[];for(fe=1;gt.length<M+B;)switch(Ze=we[ie(O,U)],U+=Ze&7,Ze>>>=3){case 16:for(G=3+Z(O,U),U+=2,Ze=gt[gt.length-1];G-- >0;)gt.push(Ze);break;case 17:for(G=3+L(O,U),U+=3;G-- >0;)gt.push(0);break;case 18:for(G=11+ie(O,U),U+=7;G-- >0;)gt.push(0);break;default:gt.push(Ze),fe<Ze&&(fe=Ze);break}var nr=gt.slice(0,M),ar=gt.slice(M);for(We=M;We<286;++We)nr[We]=0;for(We=B;We<30;++We)ar[We]=0;return he=Ne(nr,jt,286),J=Ne(ar,lt,30),U}function Be(O,U){if(O[0]==3&&!(O[1]&3))return[ro(U),2];for(var M=0,B=0,z=Vy(U||1<<18),G=0,de=z.length>>>0,Se=0,fe=0;!(B&1);){if(B=L(O,M),M+=3,B>>>1)B>>1==1?(Se=9,fe=5):(M=me(O,M),Se=he,fe=J);else{M&7&&(M+=8-(M&7));var pe=O[M>>>3]|O[(M>>>3)+1]<<8;if(M+=32,pe>0)for(!U&&de<G+pe&&(z=Mt(z,G+pe),de=z.length);pe-- >0;)z[G++]=O[M>>>3],M+=8;continue}for(;;){!U&&de<G+32767&&(z=Mt(z,G+32767),de=z.length);var ge=be(O,M,Se),Ie=B>>>1==1?Re[ge]:jt[ge];if(M+=Ie&15,Ie>>>=4,!(Ie>>>8&255))z[G++]=Ie;else{if(Ie==256)break;Ie-=257;var We=Ie<8?0:Ie-4>>2;We>5&&(We=0);var Ze=G+F[Ie];We>0&&(Ze+=be(O,M,We),M+=We),ge=be(O,M,fe),Ie=B>>>1==1?He[ge]:lt[ge],M+=Ie&15,Ie>>>=4;var Me=Ie<4?0:Ie-2>>1,Ye=V[Ie];for(Me>0&&(Ye+=be(O,M,Me),M+=Me),!U&&de<Ze&&(z=Mt(z,Ze+100),de=z.length);G<Ze;)z[G]=z[G-Ye],++G}}}return U?[z,M+7>>>3]:[z.slice(0,G),M+7>>>3]}function Ke(O,U){var M=O.slice(O.l||0),B=Be(M,U);return O.l+=B[1],B[0]}function ft(O,U){if(O)typeof console<"u"&&console.error(U);else throw new Error(U)}function it(O,U){var M=O;$n(M,0);var B=[],z=[],G={FileIndex:B,FullPaths:z};_(G,{root:U.root});for(var de=M.length-4;(M[de]!=80||M[de+1]!=75||M[de+2]!=5||M[de+3]!=6)&&de>=0;)--de;M.l=de+4,M.l+=4;var Se=M.read_shift(2);M.l+=6;var fe=M.read_shift(4);for(M.l=fe,de=0;de<Se;++de){M.l+=20;var pe=M.read_shift(4),ge=M.read_shift(4),Ie=M.read_shift(2),We=M.read_shift(2),Ze=M.read_shift(2);M.l+=8;var Me=M.read_shift(4),Ye=o(M.slice(M.l+Ie,M.l+Ie+We));M.l+=Ie+We+Ze;var gt=M.l;M.l=Me+4,St(M,pe,ge,G,Ye),M.l=gt}return G}function St(O,U,M,B,z){O.l+=2;var G=O.read_shift(2),de=O.read_shift(2),Se=s(O);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var fe=O.read_shift(4),pe=O.read_shift(4),ge=O.read_shift(4),Ie=O.read_shift(2),We=O.read_shift(2),Ze="",Me=0;Me<Ie;++Me)Ze+=String.fromCharCode(O[O.l++]);if(We){var Ye=o(O.slice(O.l,O.l+We));(Ye[21589]||{}).mt&&(Se=Ye[21589].mt),((z||{})[21589]||{}).mt&&(Se=z[21589].mt)}O.l+=We;var gt=O.slice(O.l,O.l+pe);switch(de){case 8:gt=se(O,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var nr=!1;G&8&&(fe=O.read_shift(4),fe==134695760&&(fe=O.read_shift(4),nr=!0),pe=O.read_shift(4),ge=O.read_shift(4)),pe!=U&&ft(nr,"Bad compressed size: "+U+" != "+pe),ge!=M&&ft(nr,"Bad uncompressed size: "+M+" != "+ge),$r(B,Ze,gt,{unsafe:!0,mt:Se})}function Rt(O,U){var M=U||{},B=[],z=[],G=Te(1),de=M.compression?8:0,Se=0,fe=0,pe=0,ge=0,Ie=0,We=O.FullPaths[0],Ze=We,Me=O.FileIndex[0],Ye=[],gt=0;for(fe=1;fe<O.FullPaths.length;++fe)if(Ze=O.FullPaths[fe].slice(We.length),Me=O.FileIndex[fe],!(!Me.size||!Me.content||Ze=="Sh33tJ5")){var nr=ge,ar=Te(Ze.length);for(pe=0;pe<Ze.length;++pe)ar.write_shift(1,Ze.charCodeAt(pe)&127);ar=ar.slice(0,ar.l),Ye[Ie]=aI.buf(Me.content,0);var Lr=Me.content;de==8&&(Lr=ee(Lr)),G=Te(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,Se),G.write_shift(2,de),Me.mt?i(G,Me.mt):G.write_shift(4,0),G.write_shift(-4,Ye[Ie]),G.write_shift(4,Lr.length),G.write_shift(4,Me.content.length),G.write_shift(2,ar.length),G.write_shift(2,0),ge+=G.length,B.push(G),ge+=ar.length,B.push(ar),ge+=Lr.length,B.push(Lr),G=Te(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,Se),G.write_shift(2,de),G.write_shift(4,0),G.write_shift(-4,Ye[Ie]),G.write_shift(4,Lr.length),G.write_shift(4,Me.content.length),G.write_shift(2,ar.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,nr),gt+=G.l,z.push(G),gt+=ar.length,z.push(ar),++Ie}return G=Te(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,Ie),G.write_shift(2,Ie),G.write_shift(4,gt),G.write_shift(4,ge),G.write_shift(2,0),Qr([Qr(B),Qr(z),G])}var Ct={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(O,U){if(O.ctype)return O.ctype;var M=O.name||"",B=M.match(/\.([^\.]+)$/);return B&&Ct[B[1]]||U&&(B=(M=U).match(/[\.\\]([^\.\\])+$/),B&&Ct[B[1]])?Ct[B[1]]:"application/octet-stream"}function xt(O){for(var U=Fc(O),M=[],B=0;B<U.length;B+=76)M.push(U.slice(B,B+76));return M.join(`\r
`)+`\r
`}function an(O){var U=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ge=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],B=U.split(`\r
`),z=0;z<B.length;++z){var G=B[z];if(G.length==0){M.push("");continue}for(var de=0;de<G.length;){var Se=76,fe=G.slice(de,de+Se);fe.charAt(Se-1)=="="?Se--:fe.charAt(Se-2)=="="?Se-=2:fe.charAt(Se-3)=="="&&(Se-=3),fe=G.slice(de,de+Se),de+=Se,de<G.length&&(fe+="="),M.push(fe)}}return M.join(`\r
`)}function ea(O){for(var U=[],M=0;M<O.length;++M){for(var B=O[M];M<=O.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+O[++M];U.push(B)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return Ca(U.join(`\r
`))}function ja(O,U,M){for(var B="",z="",G="",de,Se=0;Se<10;++Se){var fe=U[Se];if(!fe||fe.match(/^\s*$/))break;var pe=fe.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":B=pe[2].trim();break;case"content-type":G=pe[2].trim();break;case"content-transfer-encoding":z=pe[2].trim();break}}switch(++Se,z.toLowerCase()){case"base64":de=Ca(_i(U.slice(Se).join("")));break;case"quoted-printable":de=ea(U.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var ge=$r(O,B.slice(M.length),de,{unsafe:!0});G&&(ge.ctype=G)}function gn(O,U){if(ce(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",B=(zt&&Buffer.isBuffer(O)?O.toString("binary"):ce(O)).split(`\r
`),z=0,G="";for(z=0;z<B.length;++z)if(G=B[z],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),M||(M=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),G.slice(0,M.length)!=M););var de=(B[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Se="--"+(de[1]||""),fe=[],pe=[],ge={FileIndex:fe,FullPaths:pe};_(ge);var Ie,We=0;for(z=0;z<B.length;++z){var Ze=B[z];Ze!==Se&&Ze!==Se+"--"||(We++&&ja(ge,B.slice(Ie,z),M),Ie=z)}return ge}function Ba(O,U){var M=U||{},B=M.boundary||"SheetJS";B="------="+B;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],G=O.FullPaths[0],de=G,Se=O.FileIndex[0],fe=1;fe<O.FullPaths.length;++fe)if(de=O.FullPaths[fe].slice(G.length),Se=O.FileIndex[fe],!(!Se.size||!Se.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var pe=Se.content,ge=zt&&Buffer.isBuffer(pe)?pe.toString("binary"):ce(pe),Ie=0,We=Math.min(1024,ge.length),Ze=0,Me=0;Me<=We;++Me)(Ze=ge.charCodeAt(Me))>=32&&Ze<128&&++Ie;var Ye=Ie>=We*4/5;z.push(B),z.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+de),z.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),z.push("Content-Type: "+Ut(Se,de)),z.push(""),z.push(Ye?an(ge):xt(ge))}return z.push(B+`--\r
`),z.join(`\r
`)}function ta(O){var U={};return _(U,O),U}function $r(O,U,M,B){var z=B&&B.unsafe;z||_(O);var G=!z&&Zt.find(O,U);if(!G){var de=O.FullPaths[0];U.slice(0,de.length)==de?de=U:(de.slice(-1)!="/"&&(de+="/"),de=(de+U).replace("//","/")),G={name:a(U),type:2},O.FileIndex.push(G),O.FullPaths.push(de),z||Zt.utils.cfb_gc(O)}return G.content=M,G.size=M?M.length:0,B&&(B.CLSID&&(G.clsid=B.CLSID),B.mt&&(G.mt=B.mt),B.ct&&(G.ct=B.ct)),G}function Hr(O,U){_(O);var M=Zt.find(O,U);if(M){for(var B=0;B<O.FileIndex.length;++B)if(O.FileIndex[B]==M)return O.FileIndex.splice(B,1),O.FullPaths.splice(B,1),!0}return!1}function ra(O,U,M){_(O);var B=Zt.find(O,U);if(B){for(var z=0;z<O.FileIndex.length;++z)if(O.FileIndex[z]==B)return O.FileIndex[z].name=a(M),O.FullPaths[z]=M,!0}return!1}function zl(O){A(O,!0)}return t.find=I,t.read=k,t.parse=c,t.write=De,t.writeFile=ue,t.utils={cfb_new:ta,cfb_add:$r,cfb_del:Hr,cfb_mov:ra,cfb_gc:zl,ReadShift:Bu,CheckField:t3,prep_blob:$n,bconcat:Qr,use_zlib:Y,_deflateRaw:Wt,_inflateRaw:Ke,consts:_e},t}();function iI(e){return typeof e=="string"?hh(e):Array.isArray(e)?OP(e):e}function nf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=hh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ic(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([iI(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=rf(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function nn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ew(e,t){for(var r=[],n=nn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function mx(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function gh(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function sI(e){for(var t=[],r=nn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var xd=new Date(1899,11,30,0,0,0);function In(e,t){var r=e.getTime(),n=xd.getTime()+(e.getTimezoneOffset()-xd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var jS=new Date,oI=xd.getTime()+(jS.getTimezoneOffset()-xd.getTimezoneOffset())*6e4,tw=jS.getTimezoneOffset();function BS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+oI),t.getTimezoneOffset()!==tw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-tw)*6e4),t}var rw=new Date("2017-02-19T19:06:09.000Z"),US=isNaN(rw.getFullYear())?new Date("2/19/17"):rw,lI=US.getFullYear()==2017;function _n(e,t){var r=new Date(e);if(lI)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(US.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function xh(e,t){if(zt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Rn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Rn(e[r]));return t}function yr(e,t){for(var r="";r.length<t;)r+=e;return r}function gi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var uI=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&uI.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function _t(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return zt?n=Ci(r):n=FP(r),Zt.utils.cfb_add(e,t,n)}Zt.utils.cfb_add(e,t,r)}else e.file(t,r)}function gx(){return Zt.utils.cfb_new()}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xx=mx(cI),vx=/[&<>'"]/g,fI=/[\u0000-\u0008\u000b-\u001f]/g;function Vt(e){var t=e+"";return t.replace(vx,function(r){return xx[r]}).replace(fI,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nw(e){return Vt(e).replace(/ /g,"_x0020_")}var zS=/[\u0000-\u001f]/g;function dI(e){var t=e+"";return t.replace(vx,function(r){return xx[r]}).replace(/\n/g,"<br/>").replace(zS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function hI(e){var t=e+"";return t.replace(vx,function(r){return xx[r]}).replace(zS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function pI(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function mI(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $p(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function aw(e){var t=ro(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function iw(e){return Ci(e,"binary").toString("utf8")}var t0="foo bar baz",ju=zt&&(iw(t0)==$p(t0)&&iw||aw(t0)==$p(t0)&&aw)||$p,Ic=zt?function(e){return Ci(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gI=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),WS=/(^\s|\s$|\n)/;function Jr(e,t){return"<"+e+(t.match(WS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Rc(e){return nn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?Rc(r):"")+(t!=null?(t.match(WS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function kg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function xI(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Vt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Vt(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",kg(e));throw new Error("Unable to serialize "+e)}var jr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ml=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function vI(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function yI(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var sw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},ow=zt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ci(t)})):sw(e)}:sw,lw=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(xu(e,a)));return n.join("").replace(Mu,"")},yx=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Mu,""):lw(e,t,r)}:lw,uw=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},qS=zt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):uw(e,t,r)}:uw,cw=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Fo(e,a)));return n.join("")},af=zt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):cw(t,r,n)}:cw,$S=function(e,t){var r=Vn(e,t);return r>0?af(e,t+4,t+4+r-1):""},HS=$S,VS=function(e,t){var r=Vn(e,t);return r>0?af(e,t+4,t+4+r-1):""},GS=VS,YS=function(e,t){var r=2*Vn(e,t);return r>0?af(e,t+4,t+4+r-1):""},XS=YS,KS=function(t,r){var n=Vn(t,r);return n>0?yx(t,r+4,r+4+n):""},ZS=KS,QS=function(e,t){var r=Vn(e,t);return r>0?af(e,t+4,t+4+r):""},JS=QS,e3=function(e,t){return vI(e,t)},vd=e3,wx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};zt&&(HS=function(t,r){if(!Buffer.isBuffer(t))return $S(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},GS=function(t,r){if(!Buffer.isBuffer(t))return VS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},XS=function(t,r){if(!Buffer.isBuffer(t))return YS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},ZS=function(t,r){if(!Buffer.isBuffer(t))return KS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},JS=function(t,r){if(!Buffer.isBuffer(t))return QS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):e3(t,r)},wx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fo=function(e,t){return e[t]},xu=function(e,t){return e[t+1]*256+e[t]},wI=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Vn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Os=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},EI=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bu(e,t){var r="",n,a,i=[],s,o,l,u;switch(t){case"dbcs":if(u=this.l,zt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(xu(this,u)),u+=2;e*=2;break;case"utf8":r=af(this,this.l,this.l+e);break;case"utf16le":e*=2,r=yx(this,this.l,this.l+e);break;case"wstr":return Bu.call(this,e,"dbcs");case"lpstr-ansi":r=HS(this,this.l),e=4+Vn(this,this.l);break;case"lpstr-cp":r=GS(this,this.l),e=4+Vn(this,this.l);break;case"lpwstr":r=XS(this,this.l),e=4+2*Vn(this,this.l);break;case"lpp4":e=4+Vn(this,this.l),r=ZS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vn(this,this.l),r=JS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Fo(this,this.l+e++))!==0;)i.push(Qf(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=xu(this,this.l+e))!==0;)i.push(Qf(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Fo(this,u),this.l=u+1,o=Bu.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Qf(xu(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Fo(this,u),this.l=u+1,o=Bu.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Qf(Fo(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Fo(this,this.l),this.l++,n;case 2:return n=(t==="i"?wI:xu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Os:EI)(this,this.l),this.l+=4,n):(a=Vn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=vd(this,this.l):a=vd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=qS(this,this.l,e);break}}return this.l+=e,r}var bI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_I=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},TI=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function SI(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)TI(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,bI(this,t,this.l);break;case 8:if(n=8,r==="f"){yI(this,t,this.l);break}case 16:break;case-4:n=4,_I(this,t,this.l);break}return this.l+=n,this}function t3(e,t){var r=qS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $n(e,t){e.l=t,e.read_shift=Bu,e.chk=t3,e.write_shift=SI}function Qa(e,t){e.l+=t}function Te(e){var t=ro(e);return $n(t,0),t}function Fn(){var e=[],t=zt?256:2048,r=function(u){var c=Te(u);return $n(c,0),c},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),Qr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function Fe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=v7[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&wx(r)&&e.push(r)}}function Uu(e,t,r){var n=Rn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function fw(e,t,r){var n=Rn(e);return n.s=Uu(n.s,t.s,r),n.e=Uu(n.e,t.s,r),n}function zu(e,t){if(e.cRel&&e.c<0)for(e=Rn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Rn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xt(e);return!e.cRel&&e.cRel!=null&&(r=DI(r)),!e.rRel&&e.rRel!=null&&(r=AI(r)),r}function Hp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dn(e.s.c)+":"+(e.e.cRel?"":"$")+dn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+tn(e.s.r)+":"+(e.e.rRel?"":"$")+tn(e.e.r):zu(e.s,t.biff)+":"+zu(e.e,t.biff)}function Ex(e){return parseInt(CI(e),10)-1}function tn(e){return""+(e+1)}function AI(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CI(e){return e.replace(/\$(\d+)$/,"$1")}function bx(e){for(var t=NI(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function dn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function DI(e){return e.replace(/^([A-Z])/,"$$$1")}function NI(e){return e.replace(/^\$([A-Z])/,"$1")}function kI(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Br(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Xt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zn(e){var t=e.indexOf(":");return t==-1?{s:Br(e),e:Br(e)}:{s:Br(e.slice(0,t)),e:Br(e.slice(t+1))}}function Cr(e,t){return typeof t>"u"||typeof t=="number"?Cr(e.s,e.e):(typeof e!="string"&&(e=Xt(e)),typeof t!="string"&&(t=Xt(t)),e==t?e:e+":"+t)}function lr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function dw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=cs(e.z,r?In(t):t)}catch{}try{return e.w=cs((e.XF||{}).numFmtId||(r?14:0),r?In(t):t)}catch{return""+t}}function Ti(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?sf[e.v]||e.v:t==null?dw(e,e.v):dw(e,t))}function ho(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function r3(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=lr(i["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),s==-1&&(u.e.r=s=c.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var x={v:t[h][p]},E=s+h,g=o+p;if(u.s.r>E&&(u.s.r=E),u.s.c>g&&(u.s.c=g),u.e.r<E&&(u.e.r=E),u.e.c<g&&(u.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))x=t[h][p];else if(Array.isArray(x.v)&&(x.f=t[h][p][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||wr[14],n.cellDates?(x.t="d",x.w=cs(x.z,In(x.v))):(x.t="n",x.v=In(x.v),x.w=cs(x.z,x.v))):x.t="s";if(a)i[E]||(i[E]=[]),i[E][g]&&i[E][g].z&&(x.z=i[E][g].z),i[E][g]=x;else{var w=Xt({c:g,r:E});i[w]&&i[w].z&&(x.z=i[w].z),i[w]=x}}}return u.s.c<1e7&&(i["!ref"]=Cr(u)),i}function jl(e,t){return r3(null,e,t)}function OI(e){return e.read_shift(4,"i")}function Pa(e,t){return t||(t=Te(4)),t.write_shift(4,e),t}function hn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ur(e,t){var r=!1;return t==null&&(r=!0,t=Te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function FI(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function PI(e,t){return t||(t=Te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function _x(e,t){var r=e.l,n=e.read_shift(1),a=hn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(FI(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function II(e,t){var r=!1;return t==null&&(r=!0,t=Te(15+4*e.t.length)),t.write_shift(1,0),Ur(e.t,t),r?t.slice(0,t.l):t}var RI=_x;function LI(e,t){var r=!1;return t==null&&(r=!0,t=Te(23+4*e.t.length)),t.write_shift(1,1),Ur(e.t,t),t.write_shift(4,1),PI({},t),r?t.slice(0,t.l):t}function ga(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function po(e,t){return t==null&&(t=Te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function mo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function go(e,t){return t==null&&(t=Te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var MI=hn,n3=Ur;function Tx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yd(e,t){var r=!1;return t==null&&(r=!0,t=Te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jI=hn,Og=Tx,Sx=yd;function a3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?vd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Os(t,0)>>2;return r?a/100:a}function i3(e,t){t==null&&(t=Te(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function s3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function BI(e,t){return t||(t=Te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var xo=s3,Bl=BI;function Ul(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function no(e,t){return(t||Te(8)).write_shift(8,e,"f")}function UI(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=XI[a];u&&(t.rgb=_w(u));break;case 2:t.rgb=_w([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function wd(e,t){if(t||(t=Te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function zI(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function WI(e,t){t||(t=Te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var o3=2,Wn=3,r0=11,Ed=19,n0=64,qI=65,$I=71,HI=4108,VI=4126,Kr=80,hw={1:{n:"CodePage",t:o3},2:{n:"Category",t:Kr},3:{n:"PresentationFormat",t:Kr},4:{n:"ByteCount",t:Wn},5:{n:"LineCount",t:Wn},6:{n:"ParagraphCount",t:Wn},7:{n:"SlideCount",t:Wn},8:{n:"NoteCount",t:Wn},9:{n:"HiddenCount",t:Wn},10:{n:"MultimediaClipCount",t:Wn},11:{n:"ScaleCrop",t:r0},12:{n:"HeadingPairs",t:HI},13:{n:"TitlesOfParts",t:VI},14:{n:"Manager",t:Kr},15:{n:"Company",t:Kr},16:{n:"LinksUpToDate",t:r0},17:{n:"CharacterCount",t:Wn},19:{n:"SharedDoc",t:r0},22:{n:"HyperlinksChanged",t:r0},23:{n:"AppVersion",t:Wn,p:"version"},24:{n:"DigSig",t:qI},26:{n:"ContentType",t:Kr},27:{n:"ContentStatus",t:Kr},28:{n:"Language",t:Kr},29:{n:"Version",t:Kr},255:{},2147483648:{n:"Locale",t:Ed},2147483651:{n:"Behavior",t:Ed},1919054434:{}},pw={1:{n:"CodePage",t:o3},2:{n:"Title",t:Kr},3:{n:"Subject",t:Kr},4:{n:"Author",t:Kr},5:{n:"Keywords",t:Kr},6:{n:"Comments",t:Kr},7:{n:"Template",t:Kr},8:{n:"LastAuthor",t:Kr},9:{n:"RevNumber",t:Kr},10:{n:"EditTime",t:n0},11:{n:"LastPrinted",t:n0},12:{n:"CreatedDate",t:n0},13:{n:"ModifiedDate",t:n0},14:{n:"PageCount",t:Wn},15:{n:"WordCount",t:Wn},16:{n:"CharCount",t:Wn},17:{n:"Thumbnail",t:$I},18:{n:"Application",t:Kr},19:{n:"DocSecurity",t:Wn},255:{},2147483648:{n:"Locale",t:Ed},2147483651:{n:"Behavior",t:Ed},1919054434:{}};function GI(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var YI=GI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XI=Rn(YI),sf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},KI={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},a0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function l3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function u3(e,t){var r=sI(KI),n=[],a;n[n.length]=Dr,n[n.length]=Ue("Types",null,{xmlns:jr.CT,"xmlns:xsd":jr.xsd,"xmlns:xsi":jr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ue("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:a0[l][t.bookType]||a0[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:a0[l][t.bookType]||a0[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function c3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ol(e){var t=[Dr,Ue("Relationships",null,{xmlns:jr.RELS})];return nn(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function ZI(e){var t=[Dr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function mw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function QI(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function JI(e){var t=[Dr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(mw(e[r][0],e[r][1])),t.push(QI("",e[r][0]));return t.push(mw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function f3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dd.version+"</meta:generator></office:meta></office:document-meta>"}var $s=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Vp(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Vt(t),n[n.length]=r?Ue(e,t,r):Jr(e,t))}function d3(e,t){var r=t||{},n=[Dr,Ue("cp:coreProperties",null,{"xmlns:cp":jr.CORE_PROPS,"xmlns:dc":jr.dc,"xmlns:dcterms":jr.dcterms,"xmlns:dcmitype":jr.dcmitype,"xmlns:xsi":jr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Vp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:kg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Vp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:kg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=$s.length;++i){var s=$s[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Vp(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ll=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],h3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function p3(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=Dr,t[t.length]=Ue("Properties",null,{xmlns:jr.EXT_PROPS,"xmlns:vt":jr.vt}),ll.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Vt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Vt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function m3(e){var t=[Dr,Ue("Properties",null,{xmlns:jr.CUST_PROPS,"xmlns:vt":jr.vt})];if(!e)return t.join("");var r=1;return nn(e).forEach(function(a){++r,t[t.length]=Ue("property",xI(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Vt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function eR(e,t){var r=[];return nn(gw).map(function(n){for(var a=0;a<$s.length;++a)if($s[a][1]==n)return $s[a];for(a=0;a<ll.length;++a)if(ll[a][1]==n)return ll[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Jr(gw[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Hn.o})}function tR(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&nn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<$s.length;++s)if(i==$s[s][1])return;for(s=0;s<ll.length;++s)if(i==ll[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Ue(nw(i),o,{"dt:dt":l}))}}),t&&nn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ue(nw(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Hn.o+'">'+a.join("")+"</"+n+">"}function rR(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Te(8);return s.write_shift(4,n),s.write_shift(4,a),s}function xw(e,t){var r=Te(4),n=Te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Te(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=rR(t);break;case 31:case 80:for(n=Te(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Qr([r,n])}var g3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nR(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function vw(e,t,r){var n=Te(8),a=[],i=[],s=8,o=0,l=Te(8),u=Te(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),a.push(u),s+=8+l.length,!t){u=Te(8),u.write_shift(4,0),a.unshift(u);var c=[Te(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=Te(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Qr(c),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(g3.indexOf(e[o][0])>-1||h3.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],x=0;if(t){x=+t[e[o][0]];var E=r[x];if(E.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=xw(E.t,p)}else{var w=nR(p);w==-1&&(w=31,p=String(p)),l=xw(w,p)}i.push(l),u=Te(8),u.write_shift(4,t?x:2+o),a.push(u),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Qr([n].concat(a).concat(i))}function yw(e,t,r,n,a,i){var s=Te(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=vw(e,r,n);if(o.push(l),a){var u=vw(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(u)}return Qr(o)}function aR(e,t){t||(t=Te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function iR(e,t){return e.read_shift(t)===1}function wn(e,t){return t||(t=Te(2)),t.write_shift(2,+!!e),t}function x3(e){return e.read_shift(2,"u")}function ia(e,t){return t||(t=Te(2)),t.write_shift(2,e),t}function v3(e,t,r){return r||(r=Te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function y3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function sR(e){var t=e.t||"",r=Te(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Te(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Qr(a)}function oR(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function lR(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):oR(e,n,r)}function uR(e,t,r){if(r.biff>5)return lR(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function w3(e,t,r){return r||(r=Te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ww(e,t){t||(t=Te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cR(e){var t=Te(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),ww(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&ww(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ao(e,t,r,n){return n||(n=Te(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function fR(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function dR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function E3(e,t){return t||(t=Te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Ax(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Te(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function hR(e,t){var r=!t||t.biff==8,n=Te(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function pR(e,t){var r=!t||t.biff>=8?2:1,n=Te(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function mR(e,t){var r=Te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=sR(e[a]);var i=Qr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function gR(){var e=Te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function xR(e){var t=Te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function vR(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Te(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function yR(e,t,r,n){var a=Te(10);return ao(e,t,n,a),a.write_shift(4,r),a}function wR(e,t,r,n,a){var i=!a||a.biff==8,s=Te(8+ +i+(1+i)*r.length);return ao(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function ER(e,t,r,n){var a=r&&r.biff==5;n||(n=Te(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function bR(e,t){var r=t.biff==8||!t.biff?4:2,n=Te(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Ew(e,t,r,n){var a=r&&r.biff==5;n||(n=Te(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function _R(e){var t=Te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function TR(e,t,r,n,a,i){var s=Te(8);return ao(e,t,n,s),v3(r,i,s),s}function SR(e,t,r,n){var a=Te(14);return ao(e,t,n,a),no(r,a),a}function AR(e,t,r){if(r.biff<8)return CR(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(fR(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function CR(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=y3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function DR(e){var t=Te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)E3(e[r],t);return t}function NR(e){var t=Te(24),r=Br(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Qr([t,cR(e[1])])}function kR(e){var t=e[1].Tooltip,r=Te(10+2*(t.length+1));r.write_shift(2,2048);var n=Br(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function OR(e){return e||(e=Te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function FR(e,t,r){if(!r.cellStyles)return Qa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function PR(e,t){var r=Te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function IR(e){for(var t=Te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function RR(e,t,r){var n=Te(15);return lf(n,e,t),n.write_shift(8,r,"f"),n}function LR(e,t,r){var n=Te(9);return lf(n,e,t),n.write_shift(2,r),n}var MR=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=mx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],c=ro(1);switch(l.type){case"base64":c=Ca(_i(o));break;case"binary":c=Ca(o);break;case"buffer":case"array":c=o;break}$n(c,0);var h=c.read_shift(1),p=!!(h&136),x=!1,E=!1;switch(h){case 2:break;case 3:break;case 48:x=!0,p=!0;break;case 49:x=!0,p=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=c.read_shift(2)),c.l+=3,h!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=c.read_shift(2));var v=c.read_shift(2),y=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(y=e[c[c.l]]),c.l+=1,c.l+=2),E&&(c.l+=36);for(var b=[],T={},N=Math.min(c.length,h==2?521:w-10-(x?264:0)),k=E?32:11;c.l<N&&c[c.l]!=13;)switch(T={},T.name=hd.utils.decode(y,c.slice(c.l,c.l+k)).replace(/[\u0000\r\n].*$/g,""),c.l+=k,T.type=String.fromCharCode(c.read_shift(1)),h!=2&&!E&&(T.offset=c.read_shift(4)),T.len=c.read_shift(1),h==2&&(T.offset=c.read_shift(2)),T.dec=c.read_shift(1),T.name.length&&b.push(T),h!=2&&(c.l+=E?13:14),T.type){case"B":(!x||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(c[c.l]!==13&&(c.l=w-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=w;var _=0,S=0;for(u[0]=[],S=0;S!=b.length;++S)u[0][S]=b[S].name;for(;g-- >0;){if(c[c.l]===42){c.l+=v;continue}for(++c.l,u[++_]=[],S=0,S=0;S!=b.length;++S){var A=c.slice(c.l,c.l+b[S].len);c.l+=b[S].len,$n(A,0);var P=hd.utils.decode(y,A);switch(b[S].type){case"C":P.trim().length&&(u[_][S]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[_][S]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[_][S]=P;break;case"F":u[_][S]=parseFloat(P.trim());break;case"+":case"I":u[_][S]=E?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[_][S]=!0;break;case"N":case"F":u[_][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[_][S]="##MEMO##"+(E?parseInt(P.trim(),10):A.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[_][S]=+P||0);break;case"@":u[_][S]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[_][S]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[_][S]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[_][S]=-A.read_shift(-8,"f");break;case"B":if(x&&b[S].len==8){u[_][S]=A.read_shift(8,"f");break}case"G":case"P":A.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=jl(r(o,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function a(o,l){try{return ho(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var u=l||{};if(+u.codepage>=0&&Oc(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Fn(),h=Ad(o,{header:1,raw:!0,cellDates:!0}),p=h[0],x=h.slice(1),E=o["!cols"]||[],g=0,w=0,v=0,y=1;for(g=0;g<p.length;++g){if(((E[g]||{}).DBF||{}).name){p[g]=E[g].DBF.name,++v;continue}if(p[g]!=null){if(++v,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(w=0;w<1024;++w)if(p.indexOf(p[g]+"_"+w)==-1){p[g]+="_"+w;break}}}}var b=lr(o["!ref"]),T=[],N=[],k=[];for(g=0;g<=b.e.c-b.s.c;++g){var _="",S="",A=0,P=[];for(w=0;w<x.length;++w)x[w][g]!=null&&P.push(x[w][g]);if(P.length==0||p[g]==null){T[g]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=P[w]instanceof Date?"D":"C";break;default:S="C"}A=Math.max(A,String(P[w]).length),_=_&&_!=S?"C":S}A>250&&(A=250),S=((E[g]||{}).DBF||{}).type,S=="C"&&E[g].DBF.len>A&&(A=E[g].DBF.len),_=="B"&&S=="N"&&(_="N",k[g]=E[g].DBF.dec,A=E[g].DBF.len),N[g]=_=="C"||S=="N"?A:i[_]||0,y+=N[g],T[g]=_}var I=c.next(32);for(I.write_shift(4,318902576),I.write_shift(4,x.length),I.write_shift(2,296+32*v),I.write_shift(2,y),g=0;g<4;++g)I.write_shift(4,0);for(I.write_shift(4,0|(+t[_S]||3)<<8),g=0,w=0;g<p.length;++g)if(p[g]!=null){var W=c.next(32),te=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,te,"sbcs"),W.write_shift(1,T[g]=="?"?"C":T[g],"sbcs"),W.write_shift(4,w),W.write_shift(1,N[g]||i[T[g]]||0),W.write_shift(1,k[g]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),w+=N[g]||i[T[g]]||0}var oe=c.next(264);for(oe.write_shift(4,13),g=0;g<65;++g)oe.write_shift(4,0);for(g=0;g<x.length;++g){var ve=c.next(y);for(ve.write_shift(1,0),w=0;w<p.length;++w)if(p[w]!=null)switch(T[w]){case"L":ve.write_shift(1,x[g][w]==null?63:x[g][w]?84:70);break;case"B":ve.write_shift(8,x[g][w]||0,"f");break;case"N":var ye="0";for(typeof x[g][w]=="number"&&(ye=x[g][w].toFixed(k[w]||0)),v=0;v<N[w]-ye.length;++v)ve.write_shift(1,32);ve.write_shift(1,ye,"sbcs");break;case"D":x[g][w]?(ve.write_shift(4,("0000"+x[g][w].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(x[g][w].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+x[g][w].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(x[g][w]!=null?x[g][w]:"").slice(0,N[w]);for(ve.write_shift(1,_e,"sbcs"),v=0;v<N[w]-_e.length;++v)ve.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),jR=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+nn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,x){var E=e[x];return typeof E=="number"?Hy(E):E},n=function(p,x,E){var g=x.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return g==59?p:Hy(g)};e["|"]=254;function a(p,x){switch(x.type){case"base64":return i(_i(p),x);case"binary":return i(p,x);case"buffer":return i(zt&&Buffer.isBuffer(p)?p.toString("binary"):rf(p),x);case"array":return i(xh(p),x)}throw new Error("Unrecognized type "+x.type)}function i(p,x){var E=p.split(/[\n\r]+/),g=-1,w=-1,v=0,y=0,b=[],T=[],N=null,k={},_=[],S=[],A=[],P=0,I;for(+x.codepage>=0&&Oc(+x.codepage);v!==E.length;++v){P=0;var W=E[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),te=W.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),oe=te[0],ve;if(W.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&T.push(W.slice(3).replace(/;;/g,";"));break;case"C":var ye=!1,_e=!1,ue=!1,ce=!1,De=-1,Ve=-1;for(y=1;y<te.length;++y)switch(te[y].charAt(0)){case"A":break;case"X":w=parseInt(te[y].slice(1))-1,_e=!0;break;case"Y":for(g=parseInt(te[y].slice(1))-1,_e||(w=0),I=b.length;I<=g;++I)b[I]=[];break;case"K":ve=te[y].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(gi(ve))?isNaN(Pc(ve).getDate())||(ve=_n(ve)):(ve=gi(ve),N!==null&&RS(N)&&(ve=BS(ve))),ye=!0;break;case"E":ce=!0;var Y=LL(te[y].slice(1),{r:g,c:w});b[g][w]=[b[g][w],Y];break;case"S":ue=!0,b[g][w]=[b[g][w],"S5S"];break;case"G":break;case"R":De=parseInt(te[y].slice(1))-1;break;case"C":Ve=parseInt(te[y].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}if(ye&&(b[g][w]&&b[g][w].length==2?b[g][w][0]=ve:b[g][w]=ve,N=null),ue){if(ce)throw new Error("SYLK shared formula cannot have own formula");var se=De>-1&&b[De][Ve];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");b[g][w][1]=ML(se[1],{r:g-De,c:w-Ve})}break;case"F":var ee=0;for(y=1;y<te.length;++y)switch(te[y].charAt(0)){case"X":w=parseInt(te[y].slice(1))-1,++ee;break;case"Y":for(g=parseInt(te[y].slice(1))-1,I=b.length;I<=g;++I)b[I]=[];break;case"M":P=parseInt(te[y].slice(1))/20;break;case"F":break;case"G":break;case"P":N=T[parseInt(te[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=te[y].slice(1).split(" "),I=parseInt(A[0],10);I<=parseInt(A[1],10);++I)P=parseInt(A[2],10),S[I-1]=P===0?{hidden:!0}:{wch:P},Cx(S[I-1]);break;case"C":w=parseInt(te[y].slice(1))-1,S[w]||(S[w]={});break;case"R":g=parseInt(te[y].slice(1))-1,_[g]||(_[g]={}),P>0?(_[g].hpt=P,_[g].hpx=A3(P)):P===0&&(_[g].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}ee<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}}return _.length>0&&(k["!rows"]=_),S.length>0&&(k["!cols"]=S),x&&x.sheetRows&&(b=b.slice(0,x.sheetRows)),[b,k]}function s(p,x){var E=a(p,x),g=E[0],w=E[1],v=jl(g,x);return nn(w).forEach(function(y){v[y]=w[y]}),v}function o(p,x){return ho(s(p,x),x)}function l(p,x,E,g){var w="C;Y"+(E+1)+";X"+(g+1)+";K";switch(p.t){case"n":w+=p.v||0,p.f&&!p.F&&(w+=";E"+Nx(p.f,{r:E,c:g}));break;case"b":w+=p.v?"TRUE":"FALSE";break;case"e":w+=p.w||p.v;break;case"d":w+='"'+(p.w||p.v)+'"';break;case"s":w+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(p,x){x.forEach(function(E,g){var w="F;W"+(g+1)+" "+(g+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=bd(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=_d(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&p.push(w)})}function c(p,x){x.forEach(function(E,g){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*Td(E.hpx)+";"),w.length>2&&p.push(w+"R"+(g+1))})}function h(p,x){var E=["ID;PWXL;N;E"],g=[],w=lr(p["!ref"]),v,y=Array.isArray(p),b=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),p["!cols"]&&u(E,p["!cols"]),p["!rows"]&&c(E,p["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var T=w.s.r;T<=w.e.r;++T)for(var N=w.s.c;N<=w.e.c;++N){var k=Xt({r:T,c:N});v=y?(p[T]||[])[N]:p[k],!(!v||v.v==null&&(!v.f||v.F))&&g.push(l(v,p,T,N))}return E.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),BR=function(){function e(i,s){switch(s.type){case"base64":return t(_i(i),s);case"binary":return t(i,s);case"buffer":return t(zt&&Buffer.isBuffer(i)?i.toString("binary"):rf(i),s);case"array":return t(xh(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,u=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var p=o[c].trim().split(","),x=p[0],E=p[1];++c;for(var g=o[c]||"";(g.match(/["]/g)||[]).length&1&&c<o.length-1;)g+=`
`+o[++c];switch(g=g.trim(),+x){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(gi(E))?isNaN(Pc(E).getDate())?h[l][u]=E:h[l][u]=_n(E):h[l][u]=gi(E),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return jl(e(i,s),s)}function n(i,s){return ho(r(i,s),s)}var a=function(){var i=function(l,u,c,h,p){l.push(u),l.push(c+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=lr(l["!ref"]),h,p=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,c.e.r-c.s.r+1,""),i(u,"TUPLES",0,c.e.c-c.s.c+1,""),i(u,"DATA",0,0,"");for(var x=c.s.r;x<=c.e.r;++x){s(u,-1,0,"BOT");for(var E=c.s.c;E<=c.e.c;++E){var g=Xt({r:x,c:E});if(h=p?(l[x]||[])[E]:l[g],!h){s(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?s(u,1,0,"="+h.f):s(u,1,0,""):s(u,0,w,"V");break;case"b":s(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=cs(h.z||wr[14],In(_n(h.v)))),s(u,0,h.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),b3=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var x=h.split(`
`),E=-1,g=-1,w=0,v=[];w!==x.length;++w){var y=x[w].trim().split(":");if(y[0]==="cell"){var b=Br(y[1]);if(v.length<=b.r)for(E=v.length;E<=b.r;++E)v[E]||(v[E]=[]);switch(E=b.r,g=b.c,y[2]){case"t":v[E][g]=e(y[3]);break;case"v":v[E][g]=+y[3];break;case"vtf":var T=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[E][g]=!!+y[4];break;default:v[E][g]=+y[4];break}y[2]=="vtf"&&(v[E][g]=[v[E][g],T])}}}return p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),v}function n(h,p){return jl(r(h,p),p)}function a(h,p){return ho(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],x=[],E,g="",w=Zn(h["!ref"]),v=Array.isArray(h),y=w.s.r;y<=w.e.r;++y)for(var b=w.s.c;b<=w.e.c;++b)if(g=Xt({r:y,c:b}),E=v?(h[y]||[])[b]:h[g],!(!E||E.v==null||E.t==="z")){switch(x=["cell",g,"t"],E.t){case"s":case"str":x.push(t(E.v));break;case"n":E.f?(x[2]="vtf",x[3]="n",x[4]=E.v,x[5]=t(E.f)):(x[2]="v",x[3]=E.v);break;case"b":x[2]="vt"+(E.f?"f":"c"),x[3]="nl",x[4]=E.v?"1":"0",x[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var T=In(_n(E.v));x[2]="vtc",x[3]="nd",x[4]=""+T,x[5]=E.w||cs(E.z||wr[14],T);break;case"e":continue}p.push(x.join(":"))}return p.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function c(h){return[i,s,o,s,u(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:c}}(),UR=function(){function e(c,h,p,x,E){E.raw?h[p][x]=c:c===""||(c==="TRUE"?h[p][x]=!0:c==="FALSE"?h[p][x]=!1:isNaN(gi(c))?isNaN(Pc(c).getDate())?h[p][x]=c:h[p][x]=_n(c):h[p][x]=gi(c))}function t(c,h){var p=h||{},x=[];if(!c||c.length===0)return x;for(var E=c.split(/[\r\n]/),g=E.length-1;g>=0&&E[g].length===0;)--g;for(var w=10,v=0,y=0;y<=g;++y)v=E[y].indexOf(" "),v==-1?v=E[y].length:v++,w=Math.max(w,v);for(y=0;y<=g;++y){x[y]=[];var b=0;for(e(E[y].slice(0,w).trim(),x,y,b,p),b=1;b<=(E[y].length-w)/10+1;++b)e(E[y].slice(w+(b-1)*10,w+b*10).trim(),x,y,b,p)}return p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(c){for(var h={},p=!1,x=0,E=0;x<c.length;++x)(E=c.charCodeAt(x))==34?p=!p:!p&&E in r&&(h[E]=(h[E]||0)+1);E=[];for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&E.push([h[x],x]);if(!E.length){h=n;for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&E.push([h[x],x])}return E.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[E.pop()[1]]||44}function i(c,h){var p=h||{},x="",E=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(x=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(x=c.charAt(4),c=c.slice(6)):x=a(c.slice(0,1024)):p&&p.FS?x=p.FS:x=a(c.slice(0,1024));var w=0,v=0,y=0,b=0,T=0,N=x.charCodeAt(0),k=!1,_=0,S=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var A=p.dateNF!=null?rI(p.dateNF):null;function P(){var I=c.slice(b,T),W={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)W.t="z";else if(p.raw)W.t="s",W.v=I;else if(I.trim().length===0)W.t="s",W.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(W.t="s",W.v=I.slice(2,-1).replace(/""/g,'"')):jL(I)?(W.t="n",W.f=I.slice(1)):(W.t="s",W.v=I);else if(I=="TRUE")W.t="b",W.v=!0;else if(I=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=gi(I)))W.t="n",p.cellText!==!1&&(W.w=I),W.v=y;else if(!isNaN(Pc(I).getDate())||A&&I.match(A)){W.z=p.dateNF||wr[14];var te=0;A&&I.match(A)&&(I=nI(I,p.dateNF,I.match(A)||[]),te=1),p.cellDates?(W.t="d",W.v=_n(I,te)):(W.t="n",W.v=In(_n(I,te))),p.cellText!==!1&&(W.w=cs(W.z,W.v instanceof Date?In(W.v):W.v)),p.cellNF||delete W.z}else W.t="s",W.v=I;if(W.t=="z"||(p.dense?(E[w]||(E[w]=[]),E[w][v]=W):E[Xt({c:v,r:w})]=W),b=T+1,S=c.charCodeAt(b),g.e.c<v&&(g.e.c=v),g.e.r<w&&(g.e.r=w),_==N)++v;else if(v=0,++w,p.sheetRows&&p.sheetRows<=w)return!0}e:for(;T<c.length;++T)switch(_=c.charCodeAt(T)){case 34:S===34&&(k=!k);break;case N:case 10:case 13:if(!k&&P())break e;break}return T-b>0&&P(),E["!ref"]=Cr(g),E}function s(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,h):jl(t(c,h),h)}function o(c,h){var p="",x=h.type=="string"?[0,0,0,0]:Q7(c,h);switch(h.type){case"base64":p=_i(c);break;case"binary":p=c;break;case"buffer":h.codepage==65001?p=c.toString("utf8"):h.codepage&&typeof hd<"u"||(p=zt&&Buffer.isBuffer(c)?c.toString("binary"):rf(c));break;case"array":p=xh(c);break;case"string":p=c;break;default:throw new Error("Unrecognized type "+h.type)}return x[0]==239&&x[1]==187&&x[2]==191?p=ju(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=ju(p):h.type=="binary"&&typeof hd<"u",p.slice(0,19)=="socialcalc:version:"?b3.to_sheet(h.type=="string"?p:ju(p),h):s(p,h)}function l(c,h){return ho(o(c,h),h)}function u(c){for(var h=[],p=lr(c["!ref"]),x,E=Array.isArray(c),g=p.s.r;g<=p.e.r;++g){for(var w=[],v=p.s.c;v<=p.e.c;++v){var y=Xt({r:g,c:v});if(x=E?(c[g]||[])[v]:c[y],!x||x.v==null){w.push("          ");continue}for(var b=(x.w||(Ti(x),x.w)||"").slice(0,10);b.length<10;)b+=" ";w.push(b+(v===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),bw=function(){function e(Y,se,ee){if(Y){$n(Y,Y.l||0);for(var D=ee.Enum||De;Y.l<Y.length;){var F=Y.read_shift(2),V=D[F]||D[65535],R=Y.read_shift(2),j=Y.l+R,re=V.f&&V.f(Y,R,ee);if(Y.l=j,se(re,V,F))return}}}function t(Y,se){switch(se.type){case"base64":return r(Ca(_i(Y)),se);case"binary":return r(Ca(Y),se);case"buffer":case"array":return r(Y,se)}throw"Unsupported type "+se.type}function r(Y,se){if(!Y)return Y;var ee=se||{},D=ee.dense?[]:{},F="Sheet1",V="",R=0,j={},re=[],xe=[],Pe={s:{r:0,c:0},e:{r:0,c:0}},Z=ee.sheetRows||0;if(Y[2]==0&&(Y[3]==8||Y[3]==9)&&Y.length>=16&&Y[14]==5&&Y[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Y[2]==2)ee.Enum=De,e(Y,function(ie,be,nt){switch(nt){case 0:ee.vers=ie,ie>=4096&&(ee.qpro=!0);break;case 6:Pe=ie;break;case 204:ie&&(V=ie);break;case 222:V=ie;break;case 15:case 51:ee.qpro||(ie[1].v=ie[1].v.slice(1));case 13:case 14:case 16:nt==14&&(ie[2]&112)==112&&(ie[2]&15)>1&&(ie[2]&15)<15&&(ie[1].z=ee.dateNF||wr[14],ee.cellDates&&(ie[1].t="d",ie[1].v=BS(ie[1].v))),ee.qpro&&ie[3]>R&&(D["!ref"]=Cr(Pe),j[F]=D,re.push(F),D=ee.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},R=ie[3],F=V||"Sheet"+(R+1),V="");var Xe=ee.dense?(D[ie[0].r]||[])[ie[0].c]:D[Xt(ie[0])];if(Xe){Xe.t=ie[1].t,Xe.v=ie[1].v,ie[1].z!=null&&(Xe.z=ie[1].z),ie[1].f!=null&&(Xe.f=ie[1].f);break}ee.dense?(D[ie[0].r]||(D[ie[0].r]=[]),D[ie[0].r][ie[0].c]=ie[1]):D[Xt(ie[0])]=ie[1];break}},ee);else if(Y[2]==26||Y[2]==14)ee.Enum=Ve,Y[2]==14&&(ee.qpro=!0,Y.l=0),e(Y,function(ie,be,nt){switch(nt){case 204:F=ie;break;case 22:ie[1].v=ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ie[3]>R&&(D["!ref"]=Cr(Pe),j[F]=D,re.push(F),D=ee.dense?[]:{},Pe={s:{r:0,c:0},e:{r:0,c:0}},R=ie[3],F="Sheet"+(R+1)),Z>0&&ie[0].r>=Z)break;ee.dense?(D[ie[0].r]||(D[ie[0].r]=[]),D[ie[0].r][ie[0].c]=ie[1]):D[Xt(ie[0])]=ie[1],Pe.e.c<ie[0].c&&(Pe.e.c=ie[0].c),Pe.e.r<ie[0].r&&(Pe.e.r=ie[0].r);break;case 27:ie[14e3]&&(xe[ie[14e3][0]]=ie[14e3][1]);break;case 1537:xe[ie[0]]=ie[1],ie[0]==R&&(F=ie[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+Y[2]);if(D["!ref"]=Cr(Pe),j[V||F]=D,re.push(V||F),!xe.length)return{SheetNames:re,Sheets:j};for(var L={},X=[],K=0;K<xe.length;++K)j[re[K]]?(X.push(xe[K]||re[K]),L[xe[K]]=j[xe[K]]||j[re[K]]):(X.push(xe[K]),L[xe[K]]={"!ref":"A1"});return{SheetNames:X,Sheets:L}}function n(Y,se){var ee=se||{};if(+ee.codepage>=0&&Oc(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Fn(),F=lr(Y["!ref"]),V=Array.isArray(Y),R=[];ze(D,0,i(1030)),ze(D,6,l(F));for(var j=Math.min(F.e.r,8191),re=F.s.r;re<=j;++re)for(var xe=tn(re),Pe=F.s.c;Pe<=F.e.c;++Pe){re===F.s.r&&(R[Pe]=dn(Pe));var Z=R[Pe]+xe,L=V?(Y[re]||[])[Pe]:Y[Z];if(!(!L||L.t=="z"))if(L.t=="n")(L.v|0)==L.v&&L.v>=-32768&&L.v<=32767?ze(D,13,x(re,Pe,L.v)):ze(D,14,g(re,Pe,L.v));else{var X=Ti(L);ze(D,15,h(re,Pe,X.slice(0,239)))}}return ze(D,1),D.end()}function a(Y,se){var ee=se||{};if(+ee.codepage>=0&&Oc(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Fn();ze(D,0,s(Y));for(var F=0,V=0;F<Y.SheetNames.length;++F)(Y.Sheets[Y.SheetNames[F]]||{})["!ref"]&&ze(D,27,ce(Y.SheetNames[F],V++));var R=0;for(F=0;F<Y.SheetNames.length;++F){var j=Y.Sheets[Y.SheetNames[F]];if(!(!j||!j["!ref"])){for(var re=lr(j["!ref"]),xe=Array.isArray(j),Pe=[],Z=Math.min(re.e.r,8191),L=re.s.r;L<=Z;++L)for(var X=tn(L),K=re.s.c;K<=re.e.c;++K){L===re.s.r&&(Pe[K]=dn(K));var ie=Pe[K]+X,be=xe?(j[L]||[])[K]:j[ie];if(!(!be||be.t=="z"))if(be.t=="n")ze(D,23,P(L,K,R,be.v));else{var nt=Ti(be);ze(D,22,_(L,K,R,nt.slice(0,239)))}}++R}}return ze(D,1),D.end()}function i(Y){var se=Te(2);return se.write_shift(2,Y),se}function s(Y){var se=Te(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var ee=0,D=0,F=0,V=0;V<Y.SheetNames.length;++V){var R=Y.SheetNames[V],j=Y.Sheets[R];if(!(!j||!j["!ref"])){++F;var re=Zn(j["!ref"]);ee<re.e.r&&(ee=re.e.r),D<re.e.c&&(D=re.e.c)}}return ee>8191&&(ee=8191),se.write_shift(2,ee),se.write_shift(1,F),se.write_shift(1,D),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}function o(Y,se,ee){var D={s:{c:0,r:0},e:{c:0,r:0}};return se==8&&ee.qpro?(D.s.c=Y.read_shift(1),Y.l++,D.s.r=Y.read_shift(2),D.e.c=Y.read_shift(1),Y.l++,D.e.r=Y.read_shift(2),D):(D.s.c=Y.read_shift(2),D.s.r=Y.read_shift(2),se==12&&ee.qpro&&(Y.l+=2),D.e.c=Y.read_shift(2),D.e.r=Y.read_shift(2),se==12&&ee.qpro&&(Y.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(Y){var se=Te(8);return se.write_shift(2,Y.s.c),se.write_shift(2,Y.s.r),se.write_shift(2,Y.e.c),se.write_shift(2,Y.e.r),se}function u(Y,se,ee){var D=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(D[0].c=Y.read_shift(1),D[3]=Y.read_shift(1),D[0].r=Y.read_shift(2),Y.l+=2):(D[2]=Y.read_shift(1),D[0].c=Y.read_shift(2),D[0].r=Y.read_shift(2)),D}function c(Y,se,ee){var D=Y.l+se,F=u(Y,se,ee);if(F[1].t="s",ee.vers==20768){Y.l++;var V=Y.read_shift(1);return F[1].v=Y.read_shift(V,"utf8"),F}return ee.qpro&&Y.l++,F[1].v=Y.read_shift(D-Y.l,"cstr"),F}function h(Y,se,ee){var D=Te(7+ee.length);D.write_shift(1,255),D.write_shift(2,se),D.write_shift(2,Y),D.write_shift(1,39);for(var F=0;F<D.length;++F){var V=ee.charCodeAt(F);D.write_shift(1,V>=128?95:V)}return D.write_shift(1,0),D}function p(Y,se,ee){var D=u(Y,se,ee);return D[1].v=Y.read_shift(2,"i"),D}function x(Y,se,ee){var D=Te(7);return D.write_shift(1,255),D.write_shift(2,se),D.write_shift(2,Y),D.write_shift(2,ee,"i"),D}function E(Y,se,ee){var D=u(Y,se,ee);return D[1].v=Y.read_shift(8,"f"),D}function g(Y,se,ee){var D=Te(13);return D.write_shift(1,255),D.write_shift(2,se),D.write_shift(2,Y),D.write_shift(8,ee,"f"),D}function w(Y,se,ee){var D=Y.l+se,F=u(Y,se,ee);if(F[1].v=Y.read_shift(8,"f"),ee.qpro)Y.l=D;else{var V=Y.read_shift(2);T(Y.slice(Y.l,Y.l+V),F),Y.l+=V}return F}function v(Y,se,ee){var D=se&32768;return se&=-32769,se=(D?Y:0)+(se>=8192?se-16384:se),(D?"":"$")+(ee?dn(se):tn(se))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(Y,se){$n(Y,0);for(var ee=[],D=0,F="",V="",R="",j="";Y.l<Y.length;){var re=Y[Y.l++];switch(re){case 0:ee.push(Y.read_shift(8,"f"));break;case 1:V=v(se[0].c,Y.read_shift(2),!0),F=v(se[0].r,Y.read_shift(2),!1),ee.push(V+F);break;case 2:{var xe=v(se[0].c,Y.read_shift(2),!0),Pe=v(se[0].r,Y.read_shift(2),!1);V=v(se[0].c,Y.read_shift(2),!0),F=v(se[0].r,Y.read_shift(2),!1),ee.push(xe+Pe+":"+V+F)}break;case 3:if(Y.l<Y.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(Y.read_shift(2));break;case 6:{for(var Z="";re=Y[Y.l++];)Z+=String.fromCharCode(re);ee.push('"'+Z.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:j=ee.pop(),R=ee.pop(),ee.push(["AND","OR"][re-20]+"("+R+","+j+")");break;default:if(re<32&&b[re])j=ee.pop(),R=ee.pop(),ee.push(R+b[re]+j);else if(y[re]){if(D=y[re][1],D==69&&(D=Y[Y.l++]),D>ee.length){console.error("WK1 bad formula parse 0x"+re.toString(16)+":|"+ee.join("|")+"|");return}var L=ee.slice(-D);ee.length-=D,ee.push(y[re][0]+"("+L.join(",")+")")}else return re<=7?console.error("WK1 invalid opcode "+re.toString(16)):re<=24?console.error("WK1 unsupported op "+re.toString(16)):re<=30?console.error("WK1 invalid opcode "+re.toString(16)):re<=115?console.error("WK1 unsupported function opcode "+re.toString(16)):console.error("WK1 unrecognized opcode "+re.toString(16))}}ee.length==1?se[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function N(Y){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=Y.read_shift(2),se[3]=Y[Y.l++],se[0].c=Y[Y.l++],se}function k(Y,se){var ee=N(Y);return ee[1].t="s",ee[1].v=Y.read_shift(se-4,"cstr"),ee}function _(Y,se,ee,D){var F=Te(6+D.length);F.write_shift(2,Y),F.write_shift(1,ee),F.write_shift(1,se),F.write_shift(1,39);for(var V=0;V<D.length;++V){var R=D.charCodeAt(V);F.write_shift(1,R>=128?95:R)}return F.write_shift(1,0),F}function S(Y,se){var ee=N(Y);ee[1].v=Y.read_shift(2);var D=ee[1].v>>1;if(ee[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return ee[1].v=D,ee}function A(Y,se){var ee=N(Y),D=Y.read_shift(4),F=Y.read_shift(4),V=Y.read_shift(2);if(V==65535)return D===0&&F===3221225472?(ee[1].t="e",ee[1].v=15):D===0&&F===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var R=V&32768;return V=(V&32767)-16446,ee[1].v=(1-R*2)*(F*Math.pow(2,V+32)+D*Math.pow(2,V)),ee}function P(Y,se,ee,D){var F=Te(14);if(F.write_shift(2,Y),F.write_shift(1,ee),F.write_shift(1,se),D==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var V=0,R=0,j=0,re=0;return D<0&&(V=1,D=-D),R=Math.log2(D)|0,D/=Math.pow(2,R-31),re=D>>>0,re&2147483648||(D/=2,++R,re=D>>>0),D-=re,re|=2147483648,re>>>=0,D*=Math.pow(2,32),j=D>>>0,F.write_shift(4,j),F.write_shift(4,re),R+=16383+(V?32768:0),F.write_shift(2,R),F}function I(Y,se){var ee=A(Y);return Y.l+=se-14,ee}function W(Y,se){var ee=N(Y),D=Y.read_shift(4);return ee[1].v=D>>6,ee}function te(Y,se){var ee=N(Y),D=Y.read_shift(8,"f");return ee[1].v=D,ee}function oe(Y,se){var ee=te(Y);return Y.l+=se-10,ee}function ve(Y,se){return Y[Y.l+se-1]==0?Y.read_shift(se,"cstr"):""}function ye(Y,se){var ee=Y[Y.l++];ee>se-1&&(ee=se-1);for(var D="";D.length<ee;)D+=String.fromCharCode(Y[Y.l++]);return D}function _e(Y,se,ee){if(!(!ee.qpro||se<21)){var D=Y.read_shift(1);Y.l+=17,Y.l+=1,Y.l+=2;var F=Y.read_shift(se-21,"cstr");return[D,F]}}function ue(Y,se){for(var ee={},D=Y.l+se;Y.l<D;){var F=Y.read_shift(2);if(F==14e3){for(ee[F]=[0,""],ee[F][0]=Y.read_shift(2);Y[Y.l];)ee[F][1]+=String.fromCharCode(Y[Y.l]),Y.l++;Y.l++}}return ee}function ce(Y,se){var ee=Te(5+Y.length);ee.write_shift(2,14e3),ee.write_shift(2,se);for(var D=0;D<Y.length;++D){var F=Y.charCodeAt(D);ee[ee.l++]=F>127?95:F}return ee[ee.l++]=0,ee}var De={0:{n:"BOF",f:x3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:ye},65535:{n:""}},Ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),zR=/^\s|\s$|[\t\n\r]/;function _3(e,t){if(!t.bookSST)return"";var r=[Dr];r[r.length]=Ue("sst",null,{xmlns:Ml[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(zR)&&(i+=' xml:space="preserve"'),i+=">"+Vt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function WR(e){return[e.read_shift(4),e.read_shift(4)]}function qR(e,t){return t||(t=Te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var $R=II;function HR(e){var t=Fn();Fe(t,159,qR(e));for(var r=0;r<e.length;++r)Fe(t,19,$R(e[r]));return Fe(t,160),t.end()}function VR(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function T3(e){var t=0,r,n=VR(e),a=n.length+1,i,s,o,l,u;for(r=ro(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^s;return t^52811}var GR=function(){function e(a,i){switch(i.type){case"base64":return t(_i(a),i);case"binary":return t(a,i);case"buffer":return t(zt&&Buffer.isBuffer(a)?a.toString("binary"):rf(a),i);case"array":return t(xh(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,x=0,E,g=-1;E=p.exec(c);){switch(E[0]){case"\\cell":var w=c.slice(x,p.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var v={v:w,t:"s"};Array.isArray(o)?o[h][g]=v:o[Xt({r:h,c:g})]=v}break}x=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Cr(u),o}function r(a,i){return ho(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=lr(a["!ref"]),o,l=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var c=s.s.c;c<=s.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=s.s.c;c<=s.e.c;++c){var h=Xt({r:u,c});o=l?(a[u]||[])[c]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ti(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function _w(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var YR=6,xi=YR;function bd(e){return Math.floor((e+Math.round(128/xi)/256)*xi)}function _d(e){return Math.floor((e-5)/xi*100+.5)/100}function Fg(e){return Math.round((e*xi+5)/xi*256)/256}function Cx(e){e.width?(e.wpx=bd(e.width),e.wch=_d(e.wpx),e.MDW=xi):e.wpx?(e.wch=_d(e.wpx),e.width=Fg(e.wch),e.MDW=xi):typeof e.wch=="number"&&(e.width=Fg(e.wch),e.wpx=bd(e.width),e.MDW=xi),e.customWidth&&delete e.customWidth}var XR=96,S3=XR;function Td(e){return e*96/S3}function A3(e){return e*S3/96}function KR(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:n,formatCode:Vt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function ZR(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function C3(e,t){var r=[Dr,Ue("styleSheet",null,{xmlns:Ml[0],"xmlns:vt":jr.vt})],n;return e.SSF&&(n=KR(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=ZR(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function QR(e,t){var r=e.read_shift(2),n=hn(e);return[r,n]}function JR(e,t,r){r||(r=Te(6+4*t.length)),r.write_shift(2,e),Ur(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function eL(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=zI(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=UI(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=hn(e),n}function tL(e,t){t||(t=Te(25+4*32)),t.write_shift(2,e.sz*20),WI(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wd(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ur(e.name,t),t.length>t.l?t.slice(0,t.l):t}var rL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gp,nL=Qa;function Tw(e,t){t||(t=Te(4*3+8*7+16*1)),Gp||(Gp=mx(rL));var r=Gp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(wd({auto:1},t),wd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function aL(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function D3(e,t,r){r||(r=Te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function lu(e,t){return t||(t=Te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var iL=Qa;function sL(e,t){return t||(t=Te(51)),t.write_shift(1,0),lu(null,t),lu(null,t),lu(null,t),lu(null,t),lu(null,t),t.length>t.l?t.slice(0,t.l):t}function oL(e,t){return t||(t=Te(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function lL(e,t,r){var n=Te(2052);return n.write_shift(4,e),yd(t,n),yd(r,n),n.length>n.l?n.slice(0,n.l):n}function uL(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Fe(e,615,Pa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Fe(e,44,JR(a,t[a]))}),Fe(e,616))}}function cL(e){var t=1;Fe(e,611,Pa(t)),Fe(e,43,tL({sz:12,color:{theme:1},name:"Calibri",family:2})),Fe(e,612)}function fL(e){var t=2;Fe(e,603,Pa(t)),Fe(e,45,Tw({patternType:"none"})),Fe(e,45,Tw({patternType:"gray125"})),Fe(e,604)}function dL(e){var t=1;Fe(e,613,Pa(t)),Fe(e,46,sL()),Fe(e,614)}function hL(e){var t=1;Fe(e,626,Pa(t)),Fe(e,47,D3({numFmtId:0},65535)),Fe(e,627)}function pL(e,t){Fe(e,617,Pa(t.length)),t.forEach(function(r){Fe(e,47,D3(r,0))}),Fe(e,618)}function mL(e){var t=1;Fe(e,619,Pa(t)),Fe(e,48,oL({xfId:0,name:"Normal"})),Fe(e,620)}function gL(e){var t=0;Fe(e,505,Pa(t)),Fe(e,506)}function xL(e){var t=0;Fe(e,508,lL(t,"TableStyleMedium9","PivotStyleMedium4")),Fe(e,509)}function vL(e,t){var r=Fn();return Fe(r,278),uL(r,e.SSF),cL(r),fL(r),dL(r),hL(r),pL(r,t.cellXfs),mL(r),gL(r),xL(r),Fe(r,279),r.end()}function N3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function yL(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hn(e)}}function wL(e){var t=Te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ur(e.name,t),t.slice(0,t.l)}function EL(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function bL(e){var t=Te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function _L(e,t){var r=Te(8+2*t.length);return r.write_shift(4,e),Ur(t,r),r.slice(0,r.l)}function TL(e){return e.l+=4,e.read_shift(4)!=0}function SL(e,t){var r=Te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AL(){var e=Fn();return Fe(e,332),Fe(e,334,Pa(1)),Fe(e,335,wL({name:"XLDAPR",version:12e4,flags:3496657072})),Fe(e,336),Fe(e,339,_L(1,"XLDAPR")),Fe(e,52),Fe(e,35,Pa(514)),Fe(e,4096,Pa(0)),Fe(e,4097,ia(1)),Fe(e,36),Fe(e,53),Fe(e,340),Fe(e,337,SL(1)),Fe(e,51,bL([[1,0]])),Fe(e,338),Fe(e,333),e.end()}function k3(){var e=[Dr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function CL(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Go=1024;function O3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Hn.v,"xmlns:o":Hn.o,"xmlns:x":Hn.x,"xmlns:mv":Hn.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Go<e*1e3;)Go+=1e3;return t.forEach(function(i){var s=Br(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ue("v:fill",l,o),c={on:"t",obscured:"t"};++Go,a=a.concat(["<v:shape"+Rc({id:"_x0000_s"+Go,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ue("v:shadow",null,c),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Jr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Jr("x:AutoFill","False"),Jr("x:Row",String(s.r)),Jr("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function F3(e){var t=[Dr,Ue("comments",null,{xmlns:Ml[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Vt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(Vt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Jr("t",Vt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Jr("t",Vt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function DL(e,t,r){var n=[Dr,Ue("ThreadedComments",null,{xmlns:jr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ue("threadedComment",Jr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function NL(e){var t=[Dr,Ue("personList",null,{xmlns:jr.TCMNT,"xmlns:x":Ml[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kL(e){var t={};t.iauthor=e.read_shift(4);var r=xo(e);return t.rfx=r.s,t.ref=Xt(r.s),e.l+=16,t}function OL(e,t){return t==null&&(t=Te(36)),t.write_shift(4,e[1].iauthor),Bl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var FL=hn;function PL(e){return Ur(e.slice(0,54))}function IL(e){var t=Fn(),r=[];return Fe(t,628),Fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Fe(t,632,PL(a.a)))})}),Fe(t,631),Fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Br(n[0]),e:Br(n[0])};Fe(t,635,OL([i,a])),a.t&&a.t.length>0&&Fe(t,637,LI(a)),Fe(t,636),delete a.iauthor})}),Fe(t,634),Fe(t,629),t.end()}function RL(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Zt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var P3=["xlsb","xlsm","xlam","biff8","xla"],LL=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,c=s.length>0?parseInt(s,10)|0:0;return o?c+=t.c:--c,l?u+=t.r:--u,a+(o?"":"$")+dn(c)+(l?"":"$")+tn(u)}return function(a,i){return t=i,a.replace(e,r)}}(),Dx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Nx=function(){return function(t,r){return t.replace(Dx,function(n,a,i,s,o,l){var u=bx(s)-(i?0:r.c),c=Ex(l)-(o?0:r.r),h=c==0?"":o?c+1:"["+c+"]",p=u==0?"":i?u+1:"["+u+"]";return a+"R"+h+"C"+p})}}();function ML(e,t){return e.replace(Dx,function(r,n,a,i,s,o){return n+(a=="$"?a+i:dn(bx(i)+t.c))+(s=="$"?s+o:tn(Ex(o)+t.r))})}function jL(e){return e.length!=1}function Tr(e){e.l+=1}function fs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function I3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return R3(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=fs(e),o=fs(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function R3(e){var t=fs(e),r=fs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function BL(e,t,r){if(r.biff<8)return R3(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=fs(e),s=fs(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function L3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return UL(e);var n=e.read_shift(r&&r.biff==12?4:2),a=fs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function UL(e){var t=fs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function zL(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function WL(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qL(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function qL(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function $L(e,t,r){var n=(e[e.l++]&96)>>5,a=I3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function HL(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=I3(e,i,r);return[n,a,s]}function VL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function GL(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function YL(e,t,r){var n=(e[e.l++]&96)>>5,a=BL(e,t-1,r);return[n,a]}function XL(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Sw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function KL(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function ZL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function QL(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function JL(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function eM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function M3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function tM(e){return e.read_shift(2),M3(e)}function rM(e){return e.read_shift(2),M3(e)}function nM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=L3(e,0,r);return[n,a]}function aM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=WL(e,0,r);return[n,a]}function iM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=L3(e,0,r);return[n,a,i]}function sM(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[sj[a],U3[a],n]}function oM(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:lM(e);return[a,(i[0]===0?U3:ij)[i[1]]]}function lM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uM(e,t,r){e.l+=r&&r.biff==2?3:4}function cM(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fM(e){return e.l++,sf[e.read_shift(1)]}function dM(e){return e.l++,e.read_shift(2)}function hM(e){return e.l++,e.read_shift(1)!==0}function pM(e){return e.l++,Ul(e)}function mM(e,t,r){return e.l++,y3(e,t-1,r)}function gM(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=iR(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=sf[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ul(e);break;case 2:r[1]=uR(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function xM(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?xo:dR)(e));return a}function vM(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=gM(e,r.biff);return s}function yM(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function wM(e,t,r){if(r.biff==5)return EM(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function EM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function bM(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _M(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function TM(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function SM(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var AM=Qa,CM=Qa,DM=Qa;function of(e,t,r){return e.l+=2,[zL(e)]}function kx(e){return e.l+=6,[]}var NM=of,kM=kx,OM=kx,FM=of;function j3(e){return e.l+=2,[x3(e),e.read_shift(2)&1]}var PM=of,IM=j3,RM=kx,LM=of,MM=of,jM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=jM[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function UM(e){return e.l+=2,[e.read_shift(4)]}function zM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function WM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function qM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $M(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function HM(e){return e.l+=4,[0,0]}var Aw={1:{n:"PtgExp",f:cM},2:{n:"PtgTbl",f:DM},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:mM},26:{n:"PtgSheet",f:zM},27:{n:"PtgEndSheet",f:WM},28:{n:"PtgErr",f:fM},29:{n:"PtgBool",f:hM},30:{n:"PtgInt",f:dM},31:{n:"PtgNum",f:pM},32:{n:"PtgArray",f:XL},33:{n:"PtgFunc",f:sM},34:{n:"PtgFuncVar",f:oM},35:{n:"PtgName",f:yM},36:{n:"PtgRef",f:nM},37:{n:"PtgArea",f:$L},38:{n:"PtgMemArea",f:bM},39:{n:"PtgMemErr",f:AM},40:{n:"PtgMemNoMem",f:CM},41:{n:"PtgMemFunc",f:_M},42:{n:"PtgRefErr",f:TM},43:{n:"PtgAreaErr",f:VL},44:{n:"PtgRefN",f:aM},45:{n:"PtgAreaN",f:YL},46:{n:"PtgMemAreaN",f:qM},47:{n:"PtgMemNoMemN",f:$M},57:{n:"PtgNameX",f:wM},58:{n:"PtgRef3d",f:iM},59:{n:"PtgArea3d",f:HL},60:{n:"PtgRefErr3d",f:SM},61:{n:"PtgAreaErr3d",f:GL},255:{}},VM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GM={1:{n:"PtgElfLel",f:j3},2:{n:"PtgElfRw",f:LM},3:{n:"PtgElfCol",f:NM},6:{n:"PtgElfRwV",f:MM},7:{n:"PtgElfColV",f:FM},10:{n:"PtgElfRadical",f:PM},11:{n:"PtgElfRadicalS",f:RM},13:{n:"PtgElfColS",f:kM},15:{n:"PtgElfColSV",f:OM},16:{n:"PtgElfRadicalLel",f:IM},25:{n:"PtgList",f:BM},29:{n:"PtgSxName",f:UM},255:{}},YM={0:{n:"PtgAttrNoop",f:HM},1:{n:"PtgAttrSemi",f:eM},2:{n:"PtgAttrIf",f:QL},4:{n:"PtgAttrChoose",f:KL},8:{n:"PtgAttrGoto",f:ZL},16:{n:"PtgAttrSum",f:uM},32:{n:"PtgAttrBaxcel",f:Sw},33:{n:"PtgAttrBaxcel",f:Sw},64:{n:"PtgAttrSpace",f:tM},65:{n:"PtgAttrSpaceSemi",f:rM},128:{n:"PtgAttrIfError",f:JL},255:{}};function XM(e,t,r,n){if(n.biff<8)return Qa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=vM(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=xM(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Qa(e,t)),i}function KM(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Aw[i]||Aw[VM[i]],(i===24||i===25)&&(a=(i===24?GM:YM)[e[e.l+1]]),!a||!a.f?Qa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function ZM(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var QM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function B3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Cw(e,t,r){var n=B3(e,t,r);return n=="#REF"?n:JM(n,r)}function Tl(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],l,u,c,h=0,p=0,x,E="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=yr(" ",e[0][g][1][1]);break;case 1:w=yr("\r",e[0][g][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+w,g=-1}o.push(u+QM[b[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Uu(b[1][1],s,a),o.push(zu(c,i));break;case"PtgRefN":c=r?Uu(b[1][1],r,a):b[1][1],o.push(zu(c,i));break;case"PtgRef3d":h=b[1][1],c=Uu(b[1][2],s,a),E=Cw(n,h,a),o.push(E+"!"+zu(c,i));break;case"PtgFunc":case"PtgFuncVar":var T=b[1][0],N=b[1][1];T||(T=0),T&=127;var k=T==0?[]:o.slice(-T);o.length-=T,N==="User"&&(N=k.shift()),o.push(N+"("+k.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":x=fw(b[1][1],r?{s:r}:s,a),o.push(Hp(x,a));break;case"PtgArea":x=fw(b[1][1],s,a),o.push(Hp(x,a));break;case"PtgArea3d":h=b[1][1],x=b[1][2],E=Cw(n,h,a),o.push(E+"!"+Hp(x,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=b[1][2];var _=(n.names||[])[p-1]||(n[0]||[])[p],S=_?_.Name:"SH33TJSNAME"+String(p);S&&S.slice(0,6)=="_xlfn."&&!a.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var A=b[1][1];p=b[1][2];var P;if(a.biff<=5)A<0&&(A=-A),n[A]&&(P=n[A][p]);else{var I="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][p]&&n[A][p].itab>0&&(I=n.SheetNames[n[A][p].itab-1]+"!"):I=n.SheetNames[p-1]+"!"),n[A]&&n[A][p])I+=n[A][p].Name;else if(n[0]&&n[0][p])I+=n[0][p].Name;else{var W=(B3(n,A,a)||"").split(";;");W[p-1]?I=W[p-1]:I+="SH33TJSERRX"}o.push(I);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var te="(",oe=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:te=yr(" ",e[0][g][1][1])+te;break;case 3:te=yr("\r",e[0][g][1][1])+te;break;case 4:oe=yr(" ",e[0][g][1][1])+oe;break;case 5:oe=yr("\r",e[0][g][1][1])+oe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(te+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:b[1][1],r:b[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[Xt(c)]){var ye=n.sharedf[Xt(c)];o.push(Tl(ye,s,ve,n,a))}else{var _e=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(Tl(u[1],s,ve,n,a)),_e=!0;break}_e||o.push(b[1])}break;case"PtgArray":o.push("{"+ZM(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&ue.indexOf(e[0][v][0])==-1){b=e[0][g];var ce=!0;switch(b[1][0]){case 4:ce=!1;case 0:w=yr(" ",b[1][1]);break;case 5:ce=!1;case 1:w=yr("\r",b[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((ce?w:"")+o.pop()+(ce?"":w)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function ej(e){if(e==null){var t=Te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return no(e);return no(0)}function tj(e,t,r,n,a){var i=ao(t,r,a),s=ej(e.v),o=Te(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Te(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var h=Qr([i,s,o,u]);return h}function vh(e,t,r){var n=e.read_shift(4),a=KM(e,n,r),i=e.read_shift(4),s=i>0?XM(e,i,a,r):null;return[a,s]}var rj=vh,yh=vh,nj=vh,aj=vh,ij={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},U3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oj(e){var t="of:="+e.replace(Dx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function lj(e){return e.replace(/\./,"!")}var Wu=typeof Map<"u";function Ox(e,t,r){var n=0,a=e.length;if(r){if(Wu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Wu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Wu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function wh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(xi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=_d(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Fg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function z3(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ys(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){LS(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function uj(e,t,r){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function cj(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Cr(e[r])+'"/>';return t+"</mergeCells>"}function fj(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Ic(Vt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ue("outlinePr",null,u)}!i&&!o||(a[a.length]=Ue("sheetPr",o,s))}var dj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pj(e){var t={sheet:1};return dj.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),hj.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=T3(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function mj(e){return z3(e),Ue("pageMargins",null,e)}function gj(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ue("col",null,wh(a,n)));return r[r.length]="</cols>",r.join("")}function xj(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Cr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Zn(a);s.s.r==s.e.r&&(s.e.r=Zn(t["!ref"]).e.r,a=Cr(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}function vj(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function yj(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=sf[e.v];break;case"d":n&&n.cellDates?a=_n(e.v,-1).toISOString():(e=Rn(e),e.t="n",a=""+(e.v=In(_n(e.v)))),typeof e.z>"u"&&(e.z=wr[14]);break;default:a=e.v;break}var o=Jr("v",Vt(a)),l={r:t},u=ys(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Jr("v",""+Ox(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ue("f",Vt(e.f),c)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ue("c",o,l)}function wj(e,t,r,n){var a=[],i=[],s=lr(e["!ref"]),o="",l,u="",c=[],h=0,p=0,x=e["!rows"],E=Array.isArray(e),g={r:u},w,v=-1;for(p=s.s.c;p<=s.e.c;++p)c[p]=dn(p);for(h=s.s.r;h<=s.e.r;++h){for(i=[],u=tn(h),p=s.s.c;p<=s.e.c;++p){l=c[p]+u;var y=E?(e[h]||[])[p]:e[l];y!==void 0&&(o=yj(y,l,e,t))!=null&&i.push(o)}(i.length>0||x&&x[h])&&(g={r:u},x&&x[h]&&(w=x[h],w.hidden&&(g.hidden=1),v=-1,w.hpx?v=Td(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(g.ht=v,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),a[a.length]=Ue("row",i.join(""),g))}if(x)for(;h<x.length;++h)x&&x[h]&&(g={r:h+1},w=x[h],w.hidden&&(g.hidden=1),v=-1,w.hpx?v=Td(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(g.ht=v,g.customHeight=1),w.level&&(g.outlineLevel=w.level),a[a.length]=Ue("row","",g));return a.join("")}function W3(e,t,r,n){var a=[Dr,Ue("worksheet",null,{xmlns:Ml[0],"xmlns:r":jr.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",c=lr(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=Cr(c)}n||(n={}),l["!comments"]=[];var h=[];fj(l,r,e,t,a),a[a.length]=Ue("dimension",null,{ref:u}),a[a.length]=vj(l,t,e,r),t.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=gj(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=wj(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=pj(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=xj(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=cj(l["!merges"]));var p=-1,x,E=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(x={ref:g[0]},g[1].Target.charAt(0)!="#"&&(E=Ht(n,-1,Vt(g[1].Target).replace(/#.*$/,""),Bt.HLINK),x["r:id"]="rId"+E),(p=g[1].Target.indexOf("#"))>-1&&(x.location=Vt(g[1].Target.slice(p+1))),g[1].Tooltip&&(x.tooltip=Vt(g[1].Tooltip)),a[a.length]=Ue("hyperlink",null,x))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=mj(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Jr("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(E=Ht(n,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+E}),l["!drawing"]=h),l["!comments"].length>0&&(E=Ht(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+E}),l["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Ej(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function bj(e,t,r){var n=Te(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Td(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var h=-1,p=-1,x=c<<10;x<c+1<<10;++x){u.c=x;var E=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Xt(u)];E&&(h<0&&(h=x),p=x)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function _j(e,t,r,n){var a=bj(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Fe(e,0,a)}var Tj=xo,Sj=Bl;function Aj(){}function Cj(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=MI(e),r}function Dj(e,t,r){r==null&&(r=Te(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return wd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),n3(e,r),r.slice(0,r.l)}function Nj(e){var t=ga(e);return[t]}function kj(e,t,r){return r==null&&(r=Te(8)),po(t,r)}function Oj(e){var t=mo(e);return[t]}function Fj(e,t,r){return r==null&&(r=Te(4)),go(t,r)}function Pj(e){var t=ga(e),r=e.read_shift(1);return[t,r,"b"]}function Ij(e,t,r){return r==null&&(r=Te(9)),po(t,r),r.write_shift(1,e.v?1:0),r}function Rj(e){var t=mo(e),r=e.read_shift(1);return[t,r,"b"]}function Lj(e,t,r){return r==null&&(r=Te(5)),go(t,r),r.write_shift(1,e.v?1:0),r}function Mj(e){var t=ga(e),r=e.read_shift(1);return[t,r,"e"]}function jj(e,t,r){return r==null&&(r=Te(9)),po(t,r),r.write_shift(1,e.v),r}function Bj(e){var t=mo(e),r=e.read_shift(1);return[t,r,"e"]}function Uj(e,t,r){return r==null&&(r=Te(8)),go(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function zj(e){var t=ga(e),r=e.read_shift(4);return[t,r,"s"]}function Wj(e,t,r){return r==null&&(r=Te(12)),po(t,r),r.write_shift(4,t.v),r}function qj(e){var t=mo(e),r=e.read_shift(4);return[t,r,"s"]}function $j(e,t,r){return r==null&&(r=Te(8)),go(t,r),r.write_shift(4,t.v),r}function Hj(e){var t=ga(e),r=Ul(e);return[t,r,"n"]}function Vj(e,t,r){return r==null&&(r=Te(16)),po(t,r),no(e.v,r),r}function Gj(e){var t=mo(e),r=Ul(e);return[t,r,"n"]}function Yj(e,t,r){return r==null&&(r=Te(12)),go(t,r),no(e.v,r),r}function Xj(e){var t=ga(e),r=a3(e);return[t,r,"n"]}function Kj(e,t,r){return r==null&&(r=Te(12)),po(t,r),i3(e.v,r),r}function Zj(e){var t=mo(e),r=a3(e);return[t,r,"n"]}function Qj(e,t,r){return r==null&&(r=Te(8)),go(t,r),i3(e.v,r),r}function Jj(e){var t=ga(e),r=_x(e);return[t,r,"is"]}function e9(e){var t=ga(e),r=hn(e);return[t,r,"str"]}function t9(e,t,r){return r==null&&(r=Te(12+4*e.v.length)),po(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function r9(e){var t=mo(e),r=hn(e);return[t,r,"str"]}function n9(e,t,r){return r==null&&(r=Te(8+4*e.v.length)),go(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function a9(e,t,r){var n=e.l+t,a=ga(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=yh(e,n-e.l,r);s[3]=Tl(o,null,a,r.supbooks,r)}else e.l=n;return s}function i9(e,t,r){var n=e.l+t,a=ga(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=yh(e,n-e.l,r);s[3]=Tl(o,null,a,r.supbooks,r)}else e.l=n;return s}function s9(e,t,r){var n=e.l+t,a=ga(e);a.r=r["!row"];var i=Ul(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=yh(e,n-e.l,r);s[3]=Tl(o,null,a,r.supbooks,r)}else e.l=n;return s}function o9(e,t,r){var n=e.l+t,a=ga(e);a.r=r["!row"];var i=hn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=yh(e,n-e.l,r);s[3]=Tl(o,null,a,r.supbooks,r)}else e.l=n;return s}var l9=xo,u9=Bl;function c9(e,t){return t==null&&(t=Te(4)),t.write_shift(4,e),t}function f9(e,t){var r=e.l+t,n=xo(e),a=Tx(e),i=hn(e),s=hn(e),o=hn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function d9(e,t){var r=Te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Bl({s:Br(e[0]),e:Br(e[0])},r),Sx("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Ur(a||"",r),Ur(e[1].Tooltip||"",r),Ur("",r),r.slice(0,r.l)}function h9(){}function p9(e,t,r){var n=e.l+t,a=s3(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=rj(e,n-e.l,r);s[1]=o}else e.l=n;return s}function m9(e,t,r){var n=e.l+t,a=xo(e),i=[a];if(r.cellFormula){var s=aj(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function g9(e,t,r){r==null&&(r=Te(18));var n=wh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var q3=["left","right","top","bottom","header","footer"];function x9(e){var t={};return q3.forEach(function(r){t[r]=Ul(e)}),t}function v9(e,t){return t==null&&(t=Te(6*8)),z3(e),q3.forEach(function(r){no(e[r],t)}),t}function y9(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function w9(e,t,r){r==null&&(r=Te(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function E9(e){var t=Te(24);return t.write_shift(4,4),t.write_shift(4,1),Bl(e,t),t}function b9(e,t){return t==null&&(t=Te(16*4+2)),t.write_shift(2,e.password?T3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function _9(){}function T9(){}function S9(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Rn(t),t.z=t.z||wr[14],t.v=In(_n(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ys(a.cellXfs,t,a),t.l&&i["!links"].push([Xt(l),t.l]),t.c&&i["!comments"].push([Xt(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Ox(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?Fe(e,18,$j(t,l)):Fe(e,7,Wj(t,l))):(l.t="str",s?Fe(e,17,n9(t,l)):Fe(e,6,t9(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Fe(e,13,Qj(t,l)):Fe(e,2,Kj(t,l)):s?Fe(e,16,Yj(t,l)):Fe(e,5,Vj(t,l)),!0;case"b":return l.t="b",s?Fe(e,15,Lj(t,l)):Fe(e,4,Ij(t,l)),!0;case"e":return l.t="e",s?Fe(e,14,Uj(t,l)):Fe(e,3,jj(t,l)),!0}return s?Fe(e,12,Fj(t,l)):Fe(e,1,kj(t,l)),!0}function A9(e,t,r,n){var a=lr(t["!ref"]||"A1"),i,s="",o=[];Fe(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var c=a.s.r;c<=u;++c){s=tn(c),_j(e,t,a,c);var h=!1;if(c<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){c===a.s.r&&(o[p]=dn(p)),i=o[p]+s;var x=l?(t[c]||[])[p]:t[i];if(!x){h=!1;continue}h=S9(e,x,c,p,n,t,h)}}Fe(e,146)}function C9(e,t){!t||!t["!merges"]||(Fe(e,177,c9(t["!merges"].length)),t["!merges"].forEach(function(r){Fe(e,176,u9(r))}),Fe(e,178))}function D9(e,t){!t||!t["!cols"]||(Fe(e,390),t["!cols"].forEach(function(r,n){r&&Fe(e,60,g9(n,r))}),Fe(e,391))}function N9(e,t){!t||!t["!ref"]||(Fe(e,648),Fe(e,649,E9(lr(t["!ref"]))),Fe(e,650))}function k9(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ht(r,-1,n[1].Target.replace(/#.*$/,""),Bt.HLINK);Fe(e,494,d9(n,a))}}),delete t["!links"]}function O9(e,t,r,n){if(t["!comments"].length>0){var a=Ht(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Bt.VML);Fe(e,551,Sx("rId"+a)),t["!legacy"]=a}}function F9(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Cr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Zn(i);o.s.r==o.e.r&&(o.e.r=Zn(t["!ref"]).e.r,i=Cr(o));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Fe(e,161,Bl(lr(i))),Fe(e,162)}}function P9(e,t,r){Fe(e,133),Fe(e,137,w9(t,r)),Fe(e,138),Fe(e,134)}function I9(e,t){t["!protect"]&&Fe(e,535,b9(t["!protect"]))}function R9(e,t,r,n){var a=Fn(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=lr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Fe(a,129),(r.vbaraw||s["!outline"])&&Fe(a,147,Dj(o,s["!outline"])),Fe(a,148,Sj(l)),P9(a,s,r.Workbook),D9(a,s),A9(a,s,e,t),I9(a,s),F9(a,s,r,e),C9(a,s),k9(a,s,n),s["!margins"]&&Fe(a,476,v9(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&N9(a,s),O9(a,s,e,n),Fe(a,130),a.end()}function L9(e,t){e.l+=10;var r=hn(e);return{name:r}}var M9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function j9(e){return!e.Workbook||!e.Workbook.WBProps?"false":mI(e.Workbook.WBProps.date1904)?"true":"false"}var B9="][*?/\\".split("");function $3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return B9.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function U9(e,t,r){e.forEach(function(n,a){$3(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function z9(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];U9(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)uj(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function H3(e){var t=[Dr];t[t.length]=Ue("workbook",null,{xmlns:Ml[0],"xmlns:r":jr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(M9.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ue("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Vt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ue("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ue("definedName",Vt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function W9(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Og(e),r.name=hn(e),r}function q9(e,t){return t||(t=Te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Sx(e.strRelID,t),Ur(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function $9(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?hn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function H9(e,t){t||(t=Te(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),n3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function V9(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=jI(e),s=nj(e,0,r),o=Tx(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function G9(e,t){Fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Fe(e,156,q9(a))}Fe(e,144)}function Y9(e,t){t||(t=Te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ur("SheetJS",t),Ur(dd.version,t),Ur(dd.version,t),Ur("7262",t),t.length>t.l?t.slice(0,t.l):t}function X9(e,t){t||(t=Te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function K9(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Fe(e,135),Fe(e,158,X9(a)),Fe(e,136))}}function Z9(e,t){var r=Fn();return Fe(r,131),Fe(r,128,Y9()),Fe(r,153,H9(e.Workbook&&e.Workbook.WBProps||null)),K9(r,e),G9(r,e),Fe(r,132),r.end()}function Q9(e,t,r){return(t.slice(-4)===".bin"?Z9:H3)(e)}function J9(e,t,r,n,a){return(t.slice(-4)===".bin"?R9:W3)(e,r,n,a)}function e7(e,t,r){return(t.slice(-4)===".bin"?vL:C3)(e,r)}function t7(e,t,r){return(t.slice(-4)===".bin"?HR:_3)(e,r)}function r7(e,t,r){return(t.slice(-4)===".bin"?IL:F3)(e)}function n7(e){return(e.slice(-4)===".bin"?AL:k3)()}function a7(e,t){var r=[];return e.Props&&r.push(eR(e.Props,t)),e.Custprops&&r.push(tR(e.Props,e.Custprops)),r.join("")}function i7(){return""}function s7(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":Vt(wr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),s))}),Ue("Styles",r.join(""))}function V3(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Nx(e.Ref,{r:0,c:0})})}function o7(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(V3(a)))}return Ue("Names",r.join(""))}function l7(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(V3(o)))}return i.join("")}function u7(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Jr("ProtectContents","True")),e["!protect"].objects&&a.push(Jr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Jr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Jr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Jr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Hn.x})}function c7(e){return e.map(function(t){var r=pI(t.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":t.a})}).join("")}function f7(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Vt(Nx(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Br(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Vt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Vt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=s.c||u[c].s.r!=s.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=sf[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||wr[14]);break;case"s":h="String",p=hI(e.v||"");break}var x=ys(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=s.c+1;var E=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+E+"</Data>";return(e.c||[]).length>0&&(g+=c7(e.c)),Ue("Cell",g,o)}function d7(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=A3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function h7(e,t,r,n){if(!e["!ref"])return"";var a=lr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,v){Cx(w);var y=!!w.width,b=wh(v,w),T={"ss:Index":v+1};y&&(T["ss:Width"]=bd(b.width)),w.hidden&&(T["ss:Hidden"]="1"),o.push(Ue("Column",null,T))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var c=[d7(u,(e["!rows"]||[])[u])],h=a.s.c;h<=a.e.c;++h){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>u)&&!(i[s].e.c<h)&&!(i[s].e.r<u)){(i[s].s.c!=h||i[s].s.r!=u)&&(p=!0);break}if(!p){var x={r:u,c:h},E=Xt(x),g=l?(e[u]||[])[h]:e[E];c.push(f7(g,E,e,t,r,n,x))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function p7(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?l7(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?h7(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(u7(i,t,e,r)),n.join("")}function m7(e,t){t||(t={}),e.SSF||(e.SSF=Rn(wr)),e.SSF&&(mh(),ph(e.SSF),t.revssf=gh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ys(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(a7(e,t)),r.push(i7()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ue("Worksheet",p7(n,t,e),{"ss:Name":Vt(e.SheetNames[n])}));return r[2]=s7(e,t),r[3]=o7(e),Dr+Ue("Workbook",r.join(""),{xmlns:Hn.ss,"xmlns:o":Hn.o,"xmlns:x":Hn.x,"xmlns:ss":Hn.ss,"xmlns:dt":Hn.dt,"xmlns:html":Hn.html})}var Yp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function g7(e,t){var r=[],n=[],a=[],i=0,s,o=ew(hw,"n"),l=ew(pw,"n");if(e.Props)for(s=nn(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=nn(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)g3.indexOf(a[i][0])>-1||h3.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Zt.utils.cfb_add(t,"/SummaryInformation",yw(n,Yp.SI,l,pw)),(r.length||u.length)&&Zt.utils.cfb_add(t,"/DocumentSummaryInformation",yw(r,Yp.DSI,o,hw,u.length?u:null,Yp.UDI))}function x7(e,t){var r=t||{},n=Zt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Zt.utils.cfb_add(n,a,G3(e,r)),r.biff==8&&(e.Props||e.Custprops)&&g7(e,n),r.biff==8&&e.vbaraw&&RL(n,Zt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var v7={0:{f:Ej},1:{f:Nj},2:{f:Xj},3:{f:Mj},4:{f:Pj},5:{f:Hj},6:{f:e9},7:{f:zj},8:{f:o9},9:{f:s9},10:{f:a9},11:{f:i9},12:{f:Oj},13:{f:Zj},14:{f:Bj},15:{f:Rj},16:{f:Gj},17:{f:r9},18:{f:qj},19:{f:_x},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:V9},40:{},42:{},43:{f:eL},44:{f:QR},45:{f:nL},46:{f:iL},47:{f:aL},48:{},49:{f:OI},50:{},51:{f:EL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FR},62:{f:Jj},63:{f:CL},64:{f:_9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:y9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Cj},148:{f:Tj,p:16},151:{f:h9},152:{},153:{f:$9},154:{},155:{},156:{f:W9},157:{},158:{},159:{T:1,f:WR},160:{T:-1},161:{T:1,f:xo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:l9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yL},336:{T:-1},337:{f:TL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Og},357:{},358:{},359:{},360:{T:1},361:{},362:{f:AR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:p9},427:{f:m9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:x9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Aj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:f9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Og},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FL},633:{T:1},634:{T:-1},635:{T:1,f:kL},636:{T:-1},637:{f:RI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:L9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:T9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ze(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&wx(r)&&e.push(r)}}function y7(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,i),c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;c.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function lf(e,t,r){return e||(e=Te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function w7(e,t,r,n){var a=Te(9);return lf(a,e,t),v3(r,n||"b",a),a}function E7(e,t,r){var n=Te(8+2*r.length);return lf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function b7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?In(_n(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ze(e,2,LR(r,n,a)):ze(e,3,RR(r,n,a));return;case"b":case"e":ze(e,5,w7(r,n,t.v,t.t));return;case"s":case"str":ze(e,4,E7(r,n,(t.v||"").slice(0,255)));return}ze(e,1,lf(null,r,n))}function _7(e,t,r,n){var a=Array.isArray(t),i=lr(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Cr(i)}for(var u=i.s.r;u<=i.e.r;++u){o=tn(u);for(var c=i.s.c;c<=i.e.c;++c){u===i.s.r&&(l[c]=dn(c)),s=l[c]+o;var h=a?(t[u]||[])[c]:t[s];h&&b7(e,h,u,c)}}}function T7(e,t){for(var r=t||{},n=Fn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,Ax(e,16,r)),_7(n,e.Sheets[e.SheetNames[a]],a,r),ze(n,10),n.end()}function S7(e,t,r){ze(e,49,vR({sz:12,name:"Arial"},r))}function A7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,1054,ER(a,t[a],r))})}function C7(e,t){var r=Te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=Te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),E3(lr(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function D7(e,t){for(var r=0;r<16;++r)ze(e,224,Ew({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ze(e,224,Ew(n,0,t))})}function N7(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ze(e,440,NR(n)),n[1].Tooltip&&ze(e,2048,kR(n))}delete t["!links"]}function k7(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ze(e,125,PR(wh(a,n),a))})}}function O7(e,t,r,n,a){var i=16+ys(a.cellXfs,t,a);if(t.v==null&&!t.bf){ze(e,513,ao(r,n,i));return}if(t.bf)ze(e,6,tj(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?In(_n(t.v)):t.v;ze(e,515,SR(r,n,s,i));break;case"b":case"e":ze(e,517,TR(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Ox(a.Strings,t.v,a.revStrings);ze(e,253,yR(r,n,o,i))}else ze(e,516,wR(r,n,(t.v||"").slice(0,255),i,a));break;default:ze(e,513,ao(r,n,i))}}function F7(e,t,r){var n=Fn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),u=t.biff==8,c,h="",p=[],x=lr(i["!ref"]||"A1"),E=u?65536:16384;if(x.e.c>255||x.e.r>=E){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,E-1)}ze(n,2057,Ax(r,16,t)),ze(n,13,ia(1)),ze(n,12,ia(100)),ze(n,15,wn(!0)),ze(n,17,wn(!1)),ze(n,16,no(.001)),ze(n,95,wn(!0)),ze(n,42,wn(!1)),ze(n,43,wn(!1)),ze(n,130,ia(1)),ze(n,128,_R()),ze(n,131,wn(!1)),ze(n,132,wn(!1)),u&&k7(n,i["!cols"]),ze(n,512,bR(x,t)),u&&(i["!links"]=[]);for(var g=x.s.r;g<=x.e.r;++g){h=tn(g);for(var w=x.s.c;w<=x.e.c;++w){g===x.s.r&&(p[w]=dn(w)),c=p[w]+h;var v=l?(i[g]||[])[w]:i[c];v&&(O7(n,v,g,w,t),u&&v.l&&i["!links"].push([c,v.l]))}}var y=o.CodeName||o.name||a;return u&&ze(n,574,xR((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&ze(n,229,DR(i["!merges"])),u&&N7(n,i),ze(n,442,w3(y)),u&&C7(n,i),ze(n,10),n.end()}function P7(e,t,r){var n=Fn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(ze(n,2057,Ax(e,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,o?ia(1200):null),ze(n,193,aR(2)),l&&ze(n,191),l&&ze(n,192),ze(n,226),ze(n,92,hR("SheetJS",r)),ze(n,66,ia(o?1200:1252)),o&&ze(n,353,ia(0)),o&&ze(n,448),ze(n,317,IR(e.SheetNames.length)),o&&e.vbaraw&&ze(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";ze(n,442,w3(u))}ze(n,156,ia(17)),ze(n,25,wn(!1)),ze(n,18,wn(!1)),ze(n,19,ia(0)),o&&ze(n,431,wn(!1)),o&&ze(n,444,ia(0)),ze(n,61,gR()),ze(n,64,wn(!1)),ze(n,141,ia(0)),ze(n,34,wn(j9(e)=="true")),ze(n,14,wn(!0)),o&&ze(n,439,wn(!1)),ze(n,218,ia(0)),S7(n,e,r),A7(n,e.SSF,r),D7(n,r),o&&ze(n,352,wn(!1));var c=n.end(),h=Fn();o&&ze(h,140,OR()),o&&r.Strings&&y7(h,252,mR(r.Strings)),ze(h,10);var p=h.end(),x=Fn(),E=0,g=0;for(g=0;g<e.SheetNames.length;++g)E+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var w=c.length+E+p.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};ze(x,133,pR({pos:w,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),w+=t[g].length}var y=x.end();if(E!=y.length)throw new Error("BS8 "+E+" != "+y.length);var b=[];return c.length&&b.push(c),y.length&&b.push(y),p.length&&b.push(p),Qr(b)}function I7(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Rn(wr)),e&&e.SSF&&(mh(),ph(e.SSF),r.revssf=gh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Fx(r),r.cellXfs=[],ys(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=F7(a,r,e);return n.unshift(P7(e,n,r)),Qr(n)}function G3(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Zn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return I7(e,t);case 4:case 3:case 2:return T7(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function R7(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var c=Xt({r,c:s}),h=n.dense?(e[r]||[])[s]:e[c],p=h&&h.v!=null&&(h.h||dI(h.w||(Ti(h),h.w)||""))||"",x={};o>1&&(x.rowspan=o),l>1&&(x.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(x["data-t"]=h&&h.t||"z",h.v!=null&&(x["data-v"]=h.v),h.z!=null&&(x["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),x.id=(n.id||"sjs")+"-"+c,i.push(Ue("td",p,x))}}var E="<tr>";return E+i.join("")+"</tr>"}var L7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',M7="</body></html>";function j7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Y3(e,t){var r=t||{},n=r.header!=null?r.header:L7,a=r.footer!=null?r.footer:M7,i=[n],s=Zn(e["!ref"]);r.dense=Array.isArray(e),i.push(j7(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(R7(e,s,o,r));return i.push("</table>"+a),i.join("")}function X3(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Br(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var c=Zn(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),a==-1&&(u.e.r=a=c.e.r+1)}var h=[],p=0,x=e["!rows"]||(e["!rows"]=[]),E=0,g=0,w=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);E<o.length&&g<l;++E){var T=o[E];if(Dw(T)){if(n.display)continue;x[g]={hidden:!0}}var N=T.children;for(w=v=0;w<N.length;++w){var k=N[w];if(!(n.display&&Dw(k))){var _=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):gI(k.innerHTML),S=k.getAttribute("data-z")||k.getAttribute("z");for(p=0;p<h.length;++p){var A=h[p];A.s.c==v+i&&A.s.r<g+a&&g+a<=A.e.r&&(v=A.e.c+1-i,p=-1)}b=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+a,c:v+i},e:{r:g+a+(y||1)-1,c:v+i+(b||1)-1}});var P={t:"s",v:_},I=k.getAttribute("data-t")||k.getAttribute("t")||"";_!=null&&(_.length==0?P.t=I||"z":n.raw||_.trim().length==0||I=="s"||(_==="TRUE"?P={t:"b",v:!0}:_==="FALSE"?P={t:"b",v:!1}:isNaN(gi(_))?isNaN(Pc(_).getDate())||(P={t:"d",v:_n(_)},n.cellDates||(P={t:"n",v:In(P.v)}),P.z=n.dateNF||wr[14]):P={t:"n",v:gi(_)})),P.z===void 0&&S!=null&&(P.z=S);var W="",te=k.getElementsByTagName("A");if(te&&te.length)for(var oe=0;oe<te.length&&!(te[oe].hasAttribute("href")&&(W=te[oe].getAttribute("href"),W.charAt(0)!="#"));++oe);W&&W.charAt(0)!="#"&&(P.l={Target:W}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=P):e[Xt({c:v+i,r:g+a})]=P,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=Cr(u),g>=l&&(e["!fullref"]=Cr((u.e.r=o.length-E+g-1+a,u))),e}function K3(e,t){var r=t||{},n=r.dense?[]:{};return X3(n,e,t)}function B7(e,t){return ho(K3(e,t),t)}function Dw(e){var t="",r=U7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function U7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var z7=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dr+t}}(),Nw=function(){var e=function(i){return Vt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+Vt(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,h=Zn(i["!ref"]||"A1"),p=i["!merges"]||[],x=0,E=Array.isArray(i);if(i["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",w=i["!rows"]||[];for(u=0;u<h.s.r;++u)g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),c=0;c<h.s.c;++c)l.push(t);for(;c<=h.e.c;++c){var v=!1,y={},b="";for(x=0;x!=p.length;++x)if(!(p[x].s.c>c)&&!(p[x].s.r>u)&&!(p[x].e.c<c)&&!(p[x].e.r<u)){(p[x].s.c!=c||p[x].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=p[x].e.c-p[x].s.c+1,y["table:number-rows-spanned"]=p[x].e.r-p[x].s.r+1;break}if(v){l.push(r);continue}var T=Xt({r:u,c}),N=E?(i[u]||[])[c]:i[T];if(N&&N.f&&(y["table:formula"]=Vt(oj(N.f)),N.F&&N.F.slice(0,T.length)==T)){var k=Zn(N.F);y["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,y["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!N){l.push(t);continue}switch(N.t){case"b":b=N.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=N.v?"true":"false";break;case"n":b=N.w||String(N.v||0),y["office:value-type"]="float",y["office:value"]=N.v||0;break;case"s":case"str":b=N.v==null?"":N.v,y["office:value-type"]="string";break;case"d":b=N.w||_n(N.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=_n(N.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var _=e(b);if(N.l&&N.l.Target){var S=N.l.Target;S=S.charAt(0)=="#"?"#"+lj(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),_=Ue("text:a",_,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+Ue("table:table-cell",Ue("text:p",_,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Cx(h),h.ods=o;var p=u["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Dr],u=Rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=Rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(f3().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Z3(e,t){if(t.bookType=="fods")return Nw(e,t);var r=gx(),n="",a=[],i=[];return n="mimetype",_t(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",_t(r,n,Nw(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",_t(r,n,z7(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",_t(r,n,Dr+f3()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",_t(r,n,JI(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",_t(r,n,ZI(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Sd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function W7(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ca(Ic(e))}function q7(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ds(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function $7(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Lc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ul(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Nr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Lc(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Lc(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Gr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(qt(n*8+a.type)),a.type==2&&t.push(qt(a.data.length)),t.push(a.data))})}),ds(t)}function ba(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Lc(e,n),i=Nr(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:ul(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Nr(o.data),u=ul(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=ul(i[3][0].data)>>>0>0),r.push(s)}return r}function Do(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:qt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:qt(s.data.length)}],n[2].push({data:Gr(s.meta),type:2})});var i=Gr(n);t.push(qt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ds(t)}function H7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Lc(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ds(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var c=ds(a);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function _a(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(H7(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ds(t)}function No(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=qt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ds(t)}function Xp(e,t){var r=new Uint8Array(32),n=Sd(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,$7(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Kp(e,t){var r=new Uint8Array(32),n=Sd(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Pi(e){var t=Nr(e);return Lc(t[1][0].data)}function V7(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&ul(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Sd(e[7][0].data),c=0,h=[],p=Sd(e[4][0].data),x=0,E=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,c,!0),p.setUint16(g*2,x,!0);var w,v;switch(typeof t[g]){case"string":w=Xp({t:"s",v:t[g]},r),v=Kp({t:"s",v:t[g]},r);break;case"number":w=Xp({t:"n",v:t[g]},r),v=Kp({t:"n",v:t[g]},r);break;case"boolean":w=Xp({t:"b",v:t[g]},r),v=Kp({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(w),c+=w.length,E.push(v),x+=v.length,++l}for(e[2][0].data=qt(l);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=ds(h),e[3][0].data=ds(E),l}function G7(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Cr(n)));var i=Ad(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(se){return se.forEach(function(ee){typeof ee=="string"&&s.push(ee)})});var o={},l=[],u=Zt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(se,ee){return[se,u.FullPaths[ee]]}).forEach(function(se){var ee=se[0],D=se[1];if(ee.type==2&&ee.name.match(/\.iwa/)){var F=ee.content,V=_a(F),R=ba(V);R.forEach(function(j){l.push(j.id),o[j.id]={deps:[],location:D,type:ul(j.messages[0].meta[1][0].data)}})}}),l.sort(function(se,ee){return se-ee});var c=l.filter(function(se){return se>1}).map(function(se){return[se,qt(se)]});u.FileIndex.map(function(se,ee){return[se,u.FullPaths[ee]]}).forEach(function(se){var ee=se[0];if(se[1],!!ee.name.match(/\.iwa/)){var D=ba(_a(ee.content));D.forEach(function(F){F.messages.forEach(function(V){c.forEach(function(R){F.messages.some(function(j){return ul(j.meta[1][0].data)!=11006&&q7(j.data,R[1])})&&o[R[0]].deps.push(F.id)})})})}});for(var h=Zt.find(u,o[1].location),p=ba(_a(h.content)),x,E=0;E<p.length;++E){var g=p[E];g.id==1&&(x=g)}var w=Pi(Nr(x.messages[0].data)[1][0].data);for(h=Zt.find(u,o[w].location),p=ba(_a(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(x=g);for(w=Pi(Nr(x.messages[0].data)[2][0].data),h=Zt.find(u,o[w].location),p=ba(_a(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(x=g);for(w=Pi(Nr(x.messages[0].data)[2][0].data),h=Zt.find(u,o[w].location),p=ba(_a(h.content)),E=0;E<p.length;++E)g=p[E],g.id==w&&(x=g);var v=Nr(x.messages[0].data);{v[6][0].data=qt(n.e.r+1),v[7][0].data=qt(n.e.c+1);var y=Pi(v[46][0].data),b=Zt.find(u,o[y].location),T=ba(_a(b.content));{for(var N=0;N<T.length&&T[N].id!=y;++N);if(T[N].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=Nr(T[N].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var _=0;_<=n.e.c;++_){var S=[];S[1]=S[2]=[{type:0,data:qt(_+420690)}],k[1].push({type:2,data:Gr(S)}),k[2].push({type:0,data:qt(_)}),k[3].push({type:0,data:qt(_)})}k[4]=[],k[5]=[],k[6]=[];for(var A=0;A<=n.e.r;++A)S=[],S[1]=S[2]=[{type:0,data:qt(A+726270)}],k[4].push({type:2,data:Gr(S)}),k[5].push({type:0,data:qt(A)}),k[6].push({type:0,data:qt(A)});T[N].messages[0].data=Gr(k)}b.content=No(Do(T)),b.size=b.content.length,delete v[46];var P=Nr(v[4][0].data);{P[7][0].data=qt(n.e.r+1);var I=Nr(P[1][0].data),W=Pi(I[2][0].data);b=Zt.find(u,o[W].location),T=ba(_a(b.content));{if(T[0].id!=W)throw"Bad HeaderStorageBucket";var te=Nr(T[0].messages[0].data);for(A=0;A<i.length;++A){var oe=Nr(te[2][0].data);oe[1][0].data=qt(A),oe[4][0].data=qt(i[A].length),te[2][A]={type:te[2][0].type,data:Gr(oe)}}T[0].messages[0].data=Gr(te)}b.content=No(Do(T)),b.size=b.content.length;var ve=Pi(P[2][0].data);b=Zt.find(u,o[ve].location),T=ba(_a(b.content));{if(T[0].id!=ve)throw"Bad HeaderStorageBucket";for(te=Nr(T[0].messages[0].data),_=0;_<=n.e.c;++_)oe=Nr(te[2][0].data),oe[1][0].data=qt(_),oe[4][0].data=qt(n.e.r+1),te[2][_]={type:te[2][0].type,data:Gr(oe)};T[0].messages[0].data=Gr(te)}b.content=No(Do(T)),b.size=b.content.length;var ye=Pi(P[4][0].data);(function(){for(var se=Zt.find(u,o[ye].location),ee=ba(_a(se.content)),D,F=0;F<ee.length;++F){var V=ee[F];V.id==ye&&(D=V)}var R=Nr(D.messages[0].data);{R[3]=[];var j=[];s.forEach(function(Pe,Z){j[1]=[{type:0,data:qt(Z)}],j[2]=[{type:0,data:qt(1)}],j[3]=[{type:2,data:W7(Pe)}],R[3].push({type:2,data:Gr(j)})})}D.messages[0].data=Gr(R);var re=Do(ee),xe=No(re);se.content=xe,se.size=se.content.length})();var _e=Nr(P[3][0].data);{var ue=_e[1][0];delete _e[2];var ce=Nr(ue.data);{var De=Pi(ce[2][0].data);(function(){for(var se=Zt.find(u,o[De].location),ee=ba(_a(se.content)),D,F=0;F<ee.length;++F){var V=ee[F];V.id==De&&(D=V)}var R=Nr(D.messages[0].data);{delete R[6],delete _e[7];var j=new Uint8Array(R[5][0].data);R[5]=[];for(var re=0,xe=0;xe<=n.e.r;++xe){var Pe=Nr(j);re+=V7(Pe,i[xe],s),Pe[1][0].data=qt(xe),R[5].push({data:Gr(Pe),type:2})}R[1]=[{type:0,data:qt(n.e.c+1)}],R[2]=[{type:0,data:qt(n.e.r+1)}],R[3]=[{type:0,data:qt(re)}],R[4]=[{type:0,data:qt(n.e.r+1)}]}D.messages[0].data=Gr(R);var Z=Do(ee),L=No(Z);se.content=L,se.size=se.content.length})()}ue.data=Gr(ce)}P[3][0].data=Gr(_e)}v[4][0].data=Gr(P)}x.messages[0].data=Gr(v);var Ve=Do(p),Y=No(Ve);return h.content=Y,h.size=h.content.length,u}function Y7(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Fx(e){Y7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function X7(e,t){return t.bookType=="ods"?Z3(e,t):t.bookType=="numbers"?G7(e,t):t.bookType=="xlsb"?K7(e,t):Z7(e,t)}function K7(e,t){Go=1024,e&&!e.SSF&&(e.SSF=Rn(wr)),e&&e.SSF&&(mh(),ph(e.SSF),t.revssf=gh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=P3.indexOf(t.bookType)>-1,a=l3();Fx(t=t||{});var i=gx(),s="",o=0;if(t.cellXfs=[],ys(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",_t(i,s,d3(e.Props,t)),a.coreprops.push(s),Ht(t.rels,2,s,Bt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,_t(i,s,p3(e.Props)),a.extprops.push(s),Ht(t.rels,3,s,Bt.EXT_PROPS),e.Custprops!==e.Props&&nn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",_t(i,s,m3(e.Custprops)),a.custprops.push(s),Ht(t.rels,4,s,Bt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,_t(i,s,J9(o-1,s,t,e,c)),a.sheets.push(s),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Bt.WS[0])}if(h){var x=h["!comments"],E=!1,g="";x&&x.length>0&&(g="xl/comments"+o+"."+r,_t(i,g,r7(x,g)),a.comments.push(g),Ht(c,-1,"../comments"+o+"."+r,Bt.CMNT),E=!0),h["!legacy"]&&E&&_t(i,"xl/drawings/vmlDrawing"+o+".vml",O3(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&_t(i,c3(s),ol(c))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,_t(i,s,t7(t.Strings,s,t)),a.strs.push(s),Ht(t.wbrels,-1,"sharedStrings."+r,Bt.SST)),s="xl/workbook."+r,_t(i,s,Q9(e,s)),a.workbooks.push(s),Ht(t.rels,1,s,Bt.WB),s="xl/theme/theme1.xml",_t(i,s,N3(e.Themes,t)),a.themes.push(s),Ht(t.wbrels,-1,"theme/theme1.xml",Bt.THEME),s="xl/styles."+r,_t(i,s,e7(e,s,t)),a.styles.push(s),Ht(t.wbrels,-1,"styles."+r,Bt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",_t(i,s,e.vbaraw),a.vba.push(s),Ht(t.wbrels,-1,"vbaProject.bin",Bt.VBA)),s="xl/metadata."+r,_t(i,s,n7(s)),a.metadata.push(s),Ht(t.wbrels,-1,"metadata."+r,Bt.XLMETA),_t(i,"[Content_Types].xml",u3(a,t)),_t(i,"_rels/.rels",ol(t.rels)),_t(i,"xl/_rels/workbook."+r+".rels",ol(t.wbrels)),delete t.revssf,delete t.ssf,i}function Z7(e,t){Go=1024,e&&!e.SSF&&(e.SSF=Rn(wr)),e&&e.SSF&&(mh(),ph(e.SSF),t.revssf=gh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=P3.indexOf(t.bookType)>-1,a=l3();Fx(t=t||{});var i=gx(),s="",o=0;if(t.cellXfs=[],ys(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",_t(i,s,d3(e.Props,t)),a.coreprops.push(s),Ht(t.rels,2,s,Bt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,_t(i,s,p3(e.Props)),a.extprops.push(s),Ht(t.rels,3,s,Bt.EXT_PROPS),e.Custprops!==e.Props&&nn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",_t(i,s,m3(e.Custprops)),a.custprops.push(s),Ht(t.rels,4,s,Bt.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],x=(p||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,_t(i,s,W3(o-1,t,e,h)),a.sheets.push(s),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Bt.WS[0])}if(p){var E=p["!comments"],g=!1,w="";if(E&&E.length>0){var v=!1;E.forEach(function(y){y[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(w="xl/threadedComments/threadedComment"+o+"."+r,_t(i,w,DL(E,c,t)),a.threadedcomments.push(w),Ht(h,-1,"../threadedComments/threadedComment"+o+"."+r,Bt.TCMNT)),w="xl/comments"+o+"."+r,_t(i,w,F3(E)),a.comments.push(w),Ht(h,-1,"../comments"+o+"."+r,Bt.CMNT),g=!0}p["!legacy"]&&g&&_t(i,"xl/drawings/vmlDrawing"+o+".vml",O3(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&_t(i,c3(s),ol(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,_t(i,s,_3(t.Strings,t)),a.strs.push(s),Ht(t.wbrels,-1,"sharedStrings."+r,Bt.SST)),s="xl/workbook."+r,_t(i,s,H3(e)),a.workbooks.push(s),Ht(t.rels,1,s,Bt.WB),s="xl/theme/theme1.xml",_t(i,s,N3(e.Themes,t)),a.themes.push(s),Ht(t.wbrels,-1,"theme/theme1.xml",Bt.THEME),s="xl/styles."+r,_t(i,s,C3(e,t)),a.styles.push(s),Ht(t.wbrels,-1,"styles."+r,Bt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",_t(i,s,e.vbaraw),a.vba.push(s),Ht(t.wbrels,-1,"vbaProject.bin",Bt.VBA)),s="xl/metadata."+r,_t(i,s,k3()),a.metadata.push(s),Ht(t.wbrels,-1,"metadata."+r,Bt.XLMETA),c.length>1&&(s="xl/persons/person.xml",_t(i,s,NL(c)),a.people.push(s),Ht(t.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),_t(i,"[Content_Types].xml",u3(a,t)),_t(i,"_rels/.rels",ol(t.rels)),_t(i,"xl/_rels/workbook."+r+".rels",ol(t.wbrels)),delete t.revssf,delete t.ssf,i}function Q7(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_i(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Q3(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return nf(t.file,Zt.write(e,{type:zt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Zt.write(e,t)}function J7(e,t){var r=Rn(t||{}),n=X7(e,r);return eB(n,r)}function eB(e,t){var r={},n=zt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Zt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(hh(a))}return t.password&&typeof encrypt_agile<"u"?Q3(encrypt_agile(a,t.password),t):t.type==="file"?nf(t.file,a):t.type=="string"?ju(a):a}function tB(e,t){var r=t||{},n=x7(e,r);return Q3(n,r)}function qa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Fc(Ic(n));case"binary":return Ic(n);case"string":return e;case"file":return nf(t.file,n,"utf8");case"buffer":return zt?Ci(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):qa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function rB(e,t){switch(t.type){case"base64":return Fc(e);case"binary":return e;case"string":return e;case"file":return nf(t.file,e,"binary");case"buffer":return zt?Ci(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Fc(r):t.type=="string"?ju(r):r;case"file":return nf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function J3(e,t){kP(),z9(e);var r=Rn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=J3(e,r);return r.type="array",hh(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return qa(m7(e,r),r);case"slk":case"sylk":return qa(jR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return qa(Y3(e.Sheets[e.SheetNames[a]],r),r);case"txt":return rB(eA(e.Sheets[e.SheetNames[a]],r),r);case"csv":return qa(Px(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return qa(BR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return i0(MR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return qa(UR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return qa(GR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return qa(b3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return qa(Z3(e,r),r);case"wk1":return i0(bw.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return i0(bw.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),i0(G3(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),tB(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return J7(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function nB(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function aB(e,t,r){var n={};return n.type="file",n.file=t,nB(n),J3(e,n)}function iB(e,t,r,n,a,i,s,o){var l=tn(r),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var x=t.s.c;x<=t.e.c;++x){var E=s?e[r][x]:e[n[x]+l];if(E===void 0||E.t===void 0){if(u===void 0)continue;i[x]!=null&&(p[i[x]]=u);continue}var g=E.v;switch(E.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[x]!=null){if(g==null)if(E.t=="e"&&g===null)p[i[x]]=null;else if(u!==void 0)p[i[x]]=u;else if(c&&g===null)p[i[x]]=null;else continue;else p[i[x]]=c&&(E.t!=="n"||E.t==="n"&&o.rawNumbers!==!1)?g:Ti(E,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function Ad(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=lr(c);break;case"number":l=lr(e["!ref"]),l.s.r=c;break;default:l=c}n>0&&(a=0);var h=tn(l.s.r),p=[],x=[],E=0,g=0,w=Array.isArray(e),v=l.s.r,y=0,b={};w&&!e[v]&&(e[v]=[]);var T=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(T[y]||{}).hidden)switch(p[y]=dn(y),r=w?e[v][y]:e[p[y]+h],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=p[y];break;case 3:i[y]=u.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Ti(r,null,u),g=b[s]||0,!g)b[s]=1;else{do o=s+"_"+g++;while(b[o]);b[s]=g,b[o]=1}i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(N[v]||{}).hidden){var k=iB(e,l,v,p,n,i,w,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(x[E++]=k.row)}return x.length=E,x}var kw=/"/g;function sB(e,t,r,n,a,i,s,o){for(var l=!0,u=[],c="",h=tn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var x=o.dense?(e[r]||[])[p]:e[n[p]+h];if(x==null)c="";else if(x.v!=null){l=!1,c=""+(o.rawNumbers&&x.t=="n"?x.v:Ti(x,null,o));for(var E=0,g=0;E!==c.length;++E)if((g=c.charCodeAt(E))===a||g===i||g===34||o.forceQuotes){c='"'+c.replace(kw,'""')+'"';break}c=="ID"&&(c='"ID"')}else x.f!=null&&!x.F?(l=!1,c="="+x.f,c.indexOf(",")>=0&&(c='"'+c.replace(kw,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(s)}function Px(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=lr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),c="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(p[E]||{}).hidden||(h[E]=dn(E));for(var g=0,w=a.s.r;w<=a.e.r;++w)(x[w]||{}).hidden||(c=sB(e,a,w,h,s,l,i,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((g++?o:"")+c)));return delete n.dense,r.join("")}function eA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Px(e,t);return r}function oB(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=lr(e["!ref"]),i="",s=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=dn(o);for(var c=a.s.r;c<=a.e.r;++c)for(i=tn(c),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[c]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function tA(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;s=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var h=lr(i["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),s==-1&&(s=h.e.r+1,c.e.r=s+t.length-1+a)}else s==-1&&(s=0,c.e.r=t.length-1+a);var p=n.header||[],x=0;t.forEach(function(g,w){nn(g).forEach(function(v){(x=p.indexOf(v))==-1&&(p[x=p.length]=v);var y=g[v],b="z",T="",N=Xt({c:o+x,r:s+w+a});u=Mc(i,N),y&&typeof y=="object"&&!(y instanceof Date)?i[N]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=In(y)),T=n.dateNF||wr[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,T&&(u.z=T)):i[N]=u={t:b,v:y},T&&(u.z=T))})}),c.e.c=Math.max(c.e.c,o+p.length-1);var E=tn(s);if(a)for(x=0;x<p.length;++x)i[dn(x+o)+E]={t:"s",v:p[x]};return i["!ref"]=Cr(c),i}function lB(e,t){return tA(null,e,t)}function Mc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Br(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Mc(e,Xt(t)):Mc(e,Xt({r:t,c:r||0}))}function uB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function cB(){return{SheetNames:[],Sheets:{}}}function fB(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if($3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=uB(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function hB(e,t){return e.z=t,e}function rA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function pB(e,t,r){return rA(e,"#"+t,r)}function mB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function gB(e,t,r,n){for(var a=typeof t!="string"?t:lr(t),i=typeof t=="string"?t:Cr(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=Mc(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var uu={encode_col:dn,encode_row:tn,encode_cell:Xt,encode_range:Cr,decode_col:bx,decode_row:Ex,split_cell:kI,decode_cell:Br,decode_range:Zn,format_cell:Ti,sheet_add_aoa:r3,sheet_add_json:tA,sheet_add_dom:X3,aoa_to_sheet:jl,json_to_sheet:lB,table_to_sheet:K3,table_to_book:B7,sheet_to_csv:Px,sheet_to_txt:eA,sheet_to_json:Ad,sheet_to_html:Y3,sheet_to_formulae:oB,sheet_to_row_object_array:Ad,sheet_get_cell:Mc,book_new:cB,book_append_sheet:fB,book_set_sheet_visibility:dB,cell_set_number_format:hB,cell_set_hyperlink:rA,cell_set_internal_link:pB,cell_add_comment:mB,sheet_set_array_formula:gB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function nA(){return{settings:Zr(()=>ke.settings.get(1)),updateSettings:async n=>{await ke.settings.update(1,n)},resetYearlySequence:async()=>{await A_()}}}const Cd=1e5,Ow=5e4,Fw=2e6,xB=16,vB=12,yB=256;function wB(e){if(e==null)return Cd;if(typeof e!="number"||!Number.isFinite(e)||!Number.isInteger(e))throw new Error("Invalid backup format: iterations must be a valid integer.");if(e<Ow||e>Fw)throw new Error(`Invalid backup format: iterations must be between ${Ow} and ${Fw}.`);return e}function EB(e){return new TextEncoder().encode(e)}function bB(e){return new TextDecoder().decode(e)}function Zp(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);let r="";for(let n=0;n<t.byteLength;n++)r+=String.fromCharCode(t[n]);return window.btoa(r)}function Qp(e){const t=window.atob(e),r=t.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=t.charCodeAt(a);return n}async function aA(e,t,r=Cd){const n=new TextEncoder,a=await window.crypto.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:r,hash:"SHA-256"},a,{name:"AES-GCM",length:yB},!1,["encrypt","decrypt"])}async function _B(e,t){const r=JSON.stringify(e),n=EB(r),a=window.crypto.getRandomValues(new Uint8Array(xB)),i=window.crypto.getRandomValues(new Uint8Array(vB)),s=await aA(t,a,Cd),o=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},s,n);return{version:1,kdf:"PBKDF2-SHA256",salt:Zp(a),iv:Zp(i),ciphertext:Zp(o),iterations:Cd}}async function TB(e,t){try{const r=Qp(e.salt),n=Qp(e.iv),a=Qp(e.ciphertext),i=wB(e.iterations),s=await aA(t,r,i),o=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:n},s,a),l=bB(o);return JSON.parse(l)}catch(r){throw console.error("Decryption failed:",r),new Error("Decryption failed. Wrong password or corrupted file.")}}function SB(e){return typeof e=="object"&&e!==null&&"ciphertext"in e&&"salt"in e&&"iv"in e&&"version"in e}const vu=2;function AB(e){console.log("Migrating Backup: v1 -> v2");const t=e.participants.map(n=>{const a={...n};return delete a.groupNumber,delete a.autoGroup,delete a.manualGroup,a}),r=e.groups.map(n=>{const a={...n};return a.status==="planned"&&(a.groupNumber=null),a});return{...e,version:2,participants:t,groups:r}}function CB(e){let t=e.version||1,r=e;if(console.log(`Starting Import. Backup Version: ${t}. Current App Version: ${vu}`),!r||typeof r!="object")throw new Error("Invalid backup file: data is not an object.");if(t>vu)throw new Error(`Backup version ${t} is newer than this app version (${vu}). Please update the app to import this file.`);for(;t<vu;)try{switch(t){case 1:r=AB(r),t=2;break;default:throw new Error(`No migration strategy found for version ${t}`)}}catch(n){throw console.error(`Migration failed at step v${t}:`,n),new Error(`Migration failed: Could not upgrade backup from v${t} to v${t+1}`)}if(!Array.isArray(r.participants)||!Array.isArray(r.groups))throw new Error("Migration finished but result is malformed (missing arrays).");return r}const DB=({isOpen:e,mode:t,onConfirm:r,onCancel:n,error:a,isProcessing:i=!1})=>{const{t:s}=qr(),[o,l]=Ae.useState(""),[u,c]=Ae.useState(!1);return e?f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:f.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full overflow-hidden animate-in fade-in zoom-in duration-200",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4 text-slate-800",children:[f.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:f.jsx(gc,{className:"w-6 h-6 text-blue-600"})}),f.jsx("h3",{className:"text-xl font-bold",children:s(t==="export"?"crypto.exportTitle":"crypto.importTitle")})]}),f.jsx("p",{className:"text-slate-600 mb-6",children:s(t==="export"?"crypto.exportDescription":"crypto.importDescription")}),f.jsxs("form",{onSubmit:h=>{h.preventDefault(),o&&r(o)},className:"space-y-4",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:u?"text":"password",value:o,onChange:h=>l(h.target.value),placeholder:s("crypto.passwordPlaceholder"),className:"w-full px-4 py-3 pr-12 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0,disabled:i}),f.jsx("button",{type:"button",onClick:()=>c(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",tabIndex:-1,children:u?f.jsx(Zk,{size:20}):f.jsx(xg,{size:20})})]}),a&&f.jsxs("div",{className:"p-3 bg-red-50 text-red-600 text-sm rounded-lg flex items-center gap-2 animate-pulse",children:[f.jsx("span",{children:""})," ",a]}),f.jsxs("div",{className:"flex gap-3 pt-2",children:[f.jsx("button",{type:"button",onClick:n,disabled:i,className:"flex-1 px-4 py-2 text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg font-medium transition-colors",children:s("common.cancel")}),f.jsxs("button",{type:"submit",disabled:!o||i,className:"flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg font-bold shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2",children:[i&&f.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),s(t==="export"?"crypto.encryptAndExport":"crypto.decryptAndImport")]})]})]})]})})}):null};function Dd(){return Dd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dd.apply(this,arguments)}function NB(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var kB=["cdnSuffix","cdnUrl","countryCode","style","svg"],OB="https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/",FB="svg",PB=127397,Pw=function(t){var r=t.cdnSuffix,n=r===void 0?FB:r,a=t.cdnUrl,i=a===void 0?OB:a,s=t.countryCode,o=t.style,l=t.svg,u=l===void 0?!1:l,c=NB(t,kB);if(typeof s!="string")return null;if(u){var h=""+i+s.toLowerCase()+"."+n;return Ae.createElement("img",Object.assign({},c,{src:h,style:Dd({display:"inline-block",width:"1em",height:"1em",verticalAlign:"middle"},o)}))}var p=s.toUpperCase().replace(/./g,function(x){return String.fromCodePoint(x.charCodeAt(0)+PB)});return Ae.createElement("span",Object.assign({role:"img"},c,{style:Dd({display:"inline-block",fontSize:"1em",lineHeight:"1em",verticalAlign:"middle"},o)}),p)};const IB=({filteredParticipants:e})=>{var Mt;const{settings:t}=nA(),{language:r,setLanguage:n,t:a}=qr(),[i,s]=Ae.useState(!1),[o,l]=Ae.useState(!1),[u,c]=Ae.useState(null),[h,p]=Ae.useState(null),x=(Ee,Ne,Re="info")=>{c({isOpen:!0,title:Ee,message:Ne,variant:Re})},E=(Ee,Ne,Re,He="info",at)=>{p({isOpen:!0,title:Ee,message:Ne,onConfirm:Re,variant:He,confirmText:a("common.confirm")})},[g,w]=Ae.useState(!1),[v,y]=Ae.useState(""),[b,T]=Ae.useState(0),[N,k]=Ae.useState(null),[_,S]=Ae.useState(!1),[A,P]=Ae.useState(!1),[I,W]=Ae.useState(""),[te,oe]=Ae.useState(!1),[ve,ye]=Ae.useState(null),[_e,ue]=Ae.useState({isOpen:!1,mode:"export",isProcessing:!1}),[ce,De]=Ae.useState(null),[Ve,Y]=Ae.useState(Ms()),se=()=>{De(null),Y(Ms()),ce==="setup"?x(a("common.success"),"App Lock enabled successfully!","success"):ce==="disable"&&x(a("common.success"),"App Lock disabled.","info")},ee=Zr(()=>Ai(),[]),D=Zr(()=>k_(),[b]),F=Zr(()=>F_(),[b]),V=Zr(()=>ke.participants.toArray(),[]),R=Zr(()=>ke.yearlyArchives.toArray(),[]),j=Ee=>r==="bg"?Ee===1?"":"":Ee===1?"participant":"participants",re=async(Ee,Ne)=>{try{console.log("Validating and migrating backup...");const Re=CB(Ee);if(!Re.groups||!Re.participants||!Array.isArray(Re.groups)||!Array.isArray(Re.participants))throw new Error("Invalid backup format after migration: missing groups or participants arrays");if(Ne==="replace"){await ke.participants.clear(),await ke.groups.clear();for(const He of Re.groups)await ke.groups.add(He);for(const He of Re.participants)await ke.participants.add(He);Re.settings&&await ke.settings.update(1,Re.settings)}else{for(const He of Re.groups)await ke.groups.get(He.id)?await ke.groups.update(He.id,He):await ke.groups.add(He);for(const He of Re.participants)if(await ke.participants.get(He.id))await ke.participants.update(He.id,He);else{let Tt=He.uniqueNumber,Wt=0;for(;!await hc(Tt)&&Wt<1e3;){const jt=await ke.settings.get(1);if(jt){const lt=jt.lastUniquePrefix+1,we=jt.lastUniqueSeq+1;Tt=`${lt.toString().padStart(4,"0")}-${we.toString().padStart(3,"0")}`,await ke.settings.update(1,{lastUniquePrefix:lt,lastUniqueSeq:we})}Wt++}await ke.participants.add({...He,uniqueNumber:Tt})}}x(a("common.success"),`Import successful! Imported ${Re.participants.length} participants and ${Re.groups.length} groups.`,"success")}catch(Re){console.error("Import processing failed:",Re),x(a("common.error"),`Failed to import: ${Re.message}`,"error")}finally{s(!1),ue(Re=>({...Re,isOpen:!1,isProcessing:!1,pendingEncryptedData:null,pendingFile:null}))}},xe=()=>{ue({isOpen:!0,mode:"export",isProcessing:!1})},Pe=async Ee=>{ue(Ne=>({...Ne,isProcessing:!0,error:void 0}));try{const Ne=await ke.participants.toArray(),Re=await ke.groups.toArray(),He=await ke.settings.get(1),at={version:vu.toString(),timestamp:new Date().toISOString(),participants:Ne,groups:Re,settings:He},Tt=await _B(at,Ee),Wt=new Blob([JSON.stringify(Tt,null,2)],{type:"application/json"}),jt=URL.createObjectURL(Wt),lt=document.createElement("a");lt.href=jt,lt.download=`course-backup-secure-${new Date().toISOString().split("T")[0]}.json`,lt.click(),URL.revokeObjectURL(jt),ue(we=>({...we,isOpen:!1}))}catch(Ne){console.error("Secure export failed:",Ne),ue(Re=>({...Re,error:"Encryption failed. Please try again."}))}finally{ue(Ne=>({...Ne,isProcessing:!1}))}},Z=async(Ee,Ne)=>{const Re=async()=>{s(!0);try{const He=await Ee.text(),at=JSON.parse(He);SB(at)||at&&typeof at=="object"&&"ciphertext"in at&&"salt"in at?(ue({isOpen:!0,mode:"import",isProcessing:!1,pendingEncryptedData:at,importMode:Ne,pendingFile:Ee}),s(!1)):await re(at,Ne)}catch(He){console.error("File parsing failed:",He),x(a("common.error"),"Invalid file format. Please upload a valid backup JSON.","error"),s(!1)}};Ne==="replace"?E("WARNING","WARNING: This will DELETE ALL existing data and replace it with the imported data. Are you sure?",Re,"danger"):Re()},L=async Ee=>{if(!(!_e.pendingEncryptedData||!_e.importMode)){ue(Ne=>({...Ne,isProcessing:!0,error:void 0})),s(!0);try{const Ne=await TB(_e.pendingEncryptedData,Ee);await re(Ne,_e.importMode)}catch(Ne){console.error("Decryption failed:",Ne),ue(Re=>({...Re,isProcessing:!1,error:a("crypto.invalidPassword")})),s(!1)}}},X=async()=>{try{const Ee=await ke.groups.toArray(),Ne=e.length>0?e:await ke.participants.toArray(),Re=new Map,He=new Map;Ee.forEach(J=>{Re.set(J.courseStartDate,J.status),He.set(J.courseStartDate,J.groupNumber)});const at=[],Tt=[],Wt=[],jt=[],lt=J=>({"Company Name":J.companyName,"Person Name":J.personName,"Medical Date":rt(J.medicalDate),"Course Start":rt(J.courseStartDate),"Course End":rt(J.courseEndDate),"Group No":He.get(J.courseStartDate)||"","Unique Number":J.uniqueNumber,Sent:J.sent?"Yes":"No",Documents:J.documents?"Yes":"No","Handed Over":J.handedOver?"Yes":"No",Paid:J.paid?"Yes":"No",Completed:(J.completedOverride!==null?J.completedOverride:J.completedComputed)?"Yes":"No"});Ne.forEach(J=>{const me=Re.get(J.courseStartDate),Be=lt(J);me==="active"?at.push(Be):me==="planned"?Tt.push(Be):me==="completed"?Wt.push(Be):jt.push(Be)});const we=uu.book_new(),he=(J,me,Be)=>{if(J.length===0)return;Be&&J.sort(Be);const Ke=uu.json_to_sheet(J),ft=Object.keys(J[0]||{}).map(it=>({wch:Math.max(it.length,15)}));Ke["!cols"]=ft,uu.book_append_sheet(we,Ke,me)};if(he(at,"Active Groups",(J,me)=>(J["Unique Number"]||"").localeCompare(me["Unique Number"]||"")),he(Tt,"Planned Groups",(J,me)=>J["Course Start"].localeCompare(me["Course Start"])),he(Wt,"Archived Groups",(J,me)=>(me["Group No"]||0)-(J["Group No"]||0)),he(jt,"Other"),we.SheetNames.length===0){const J=uu.json_to_sheet([{Info:"No data found to export"}]);uu.book_append_sheet(we,J,"Empty")}aB(we,`course-export-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(Ee){console.error("Excel export failed:",Ee),x(a("common.error"),"Failed to export Excel file","error")}},K=async()=>{try{const Ee=["Company Name","Person Name","Medical Date","Course Start Date","Course End Date","Group Number","Unique Number","Sent","Documents","Handed Over","Paid","Completed"],Ne=e.length>0?await ke.groups.toArray():[],Re=new Map(Ne.map(lt=>[lt.courseStartDate,lt.groupNumber])),He=e.map(lt=>[lt.companyName,lt.personName,rt(lt.medicalDate),rt(lt.courseStartDate),rt(lt.courseEndDate),Re.get(lt.courseStartDate)||"",lt.uniqueNumber,lt.sent?"Yes":"No",lt.documents?"Yes":"No",lt.handedOver?"Yes":"No",lt.paid?"Yes":"No",(lt.completedOverride!==null?lt.completedOverride:lt.completedComputed)?"Yes":"No"]),at=[Ee.join(","),...He.map(lt=>lt.map(we=>`"${we}"`).join(","))].join(`
`),Tt=new Blob([at],{type:"text/csv"}),Wt=URL.createObjectURL(Tt),jt=document.createElement("a");jt.href=Wt,jt.download=`course-export-${new Date().toISOString().split("T")[0]}.csv`,jt.click(),URL.revokeObjectURL(Wt)}catch(Ee){console.error("CSV export failed:",Ee),x(a("common.error"),"Failed to export CSV file","error")}},ie=async(Ee,Ne)=>{try{const Re=`archive-${Ee}`,He=await ke.yearlyArchives.get(Re);if(!He){x(a("common.error"),a("tools.restoreGroupNotFound"),"error");return}const at=He.groups.find(we=>we.groupNumber===Ne);if(!at){x(a("common.error"),a("tools.restoreGroupGroupNotFound"),"error");return}const Tt=He.participants.filter(we=>we.courseStartDate===at.courseStartDate);if(await ke.groups.where("groupNumber").equals(Ne).first()){x(a("common.error"),a("tools.restoreGroupExists",{number:Ne.toString()}),"error");return}await ke.groups.add({...at,updatedAt:new Date().toISOString()});for(const we of Tt)await ke.participants.add(we);const jt=He.groups.filter(we=>we.groupNumber!==Ne),lt=He.participants.filter(we=>we.courseStartDate!==at.courseStartDate);jt.length===0?await ke.yearlyArchives.delete(Re):await ke.yearlyArchives.update(Re,{groups:jt,participants:lt}),x(a("common.success"),a("tools.restoreGroupSuccess",{number:Ne.toString()}),"success"),ye(null)}catch(Re){console.error("Restore failed:",Re),x(a("common.error"),a("tools.restoreGroupError",{error:Re.message}),"error")}},be=async()=>{try{const Ee=new Date().getFullYear(),Ne=await ke.groups.toArray(),Re=await ke.participants.toArray(),He=Ne.some(he=>he.status==="active"),at=Ne.some(he=>he.status==="planned");if(He||at){x(a("common.warning"),a("tools.archiveGuardFail"),"warning"),P(!1),W("");return}const Tt=Ne.filter(he=>he.status!=="completed"?!1:new Date(he.courseStartDate).getFullYear()===Ee);if(Tt.length===0){x(a("common.info"),a("archive.noGroupsToArchive"),"info"),P(!1),W("");return}const Wt=new Set(Tt.map(he=>he.courseStartDate)),jt=Re.filter(he=>Wt.has(he.courseStartDate)),lt=`archive-${Ee}`;await ke.yearlyArchives.put({id:lt,year:Ee,groups:Tt,participants:jt,archivedAt:new Date().toISOString()}),await ke.groups.bulkDelete(Tt.map(he=>he.id)),await ke.participants.bulkDelete(jt.map(he=>he.id));const we=await ke.settings.get(1);we&&await ke.settings.update(1,{lastUniquePrefix:we.lastUniquePrefix+1,lastUniqueSeq:0,lastResetYear:Ee}),x(a("common.success"),a("tools.archiveYearSuccess",{count:Tt.length.toString()}),"success"),P(!1),W("")}catch(Ee){console.error("Archive failed:",Ee),x(a("common.error"),a("archive.error"),"error")}},nt=async Ee=>{try{const Ne=await P_(Ee);if(Ne.needsConfirm&&Ne.currentActive){const Re=await ke.groups.get(Ee);Re&&k({type:"makeActive",groupId:Ee,groupNumber:Re.groupNumber,currentActive:Ne.currentActive})}else if(Ne.success){T(He=>He+1);const Re=await ke.groups.get(Ee);Re&&x(a("common.success"),a("tools.makeActiveSuccess",{number:Re.groupNumber?Re.groupNumber.toString():"Active"}),"success")}}catch(Ne){x(a("common.error"),`${a("common.error")}: ${Ne.message}`,"error")}},Xe=async Ee=>{try{const Ne=await R_(Ee);if(Ne.needsConfirm&&Ne.currentActive){const Re=await ke.groups.get(Ee);Re&&k({type:"reopen",groupId:Ee,groupNumber:Re.groupNumber,currentActive:Ne.currentActive})}else Ne.success&&(T(Re=>Re+1),x(a("common.success"),a("tools.reopenSuccess"),"success"))}catch(Ne){x(a("common.error"),`${a("common.error")}: ${Ne.message}`,"error")}},mt=async()=>{if(N)try{const Ee=N.currentActive.groupNumber,Ne=N.groupNumber;await Yd(N.groupId,!0),k(null),T(Re=>Re+1),x(a("common.success"),a("tools.makeActiveWithSwapSuccess",{new:(Ne==null?void 0:Ne.toString())||"Active",old:(Ee==null?void 0:Ee.toString())||"Active"}),"success")}catch(Ee){x(a("common.error"),`${a("common.error")}: ${Ee.message}`,"error")}},et=async()=>{E(a("tools.returnToPlanned"),a("tools.returnToPlannedConfirm"),async()=>{try{await I_(),T(Ee=>Ee+1),x(a("common.success"),a("tools.returnToPlannedSuccess"),"success")}catch(Ee){x(a("common.error"),`${a("common.error")}: ${Ee.message}`,"error")}},"warning")};return f.jsxs("div",{className:"space-y-6 pb-24 md:pb-6",children:[f.jsx(DB,{isOpen:_e.isOpen,mode:_e.mode,isProcessing:_e.isProcessing,error:_e.error,onCancel:()=>ue(Ee=>({...Ee,isOpen:!1})),onConfirm:Ee=>{_e.mode==="export"?Pe(Ee):L(Ee)}}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:a("tools.language")}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{onClick:()=>n("en"),className:`flex-1 px-6 py-3 rounded-lg font-medium min-h-[48px] transition-colors duration-150 flex items-center justify-center gap-3 ${r==="en"?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx(Pw,{countryCode:"GB",svg:!0,style:{width:"2em",height:"1.5em",borderRadius:"4px"}}),"English"]}),f.jsxs("button",{onClick:()=>n("bg"),className:`flex-1 px-6 py-3 rounded-lg font-medium min-h-[48px] transition-colors duration-150 flex items-center justify-center gap-3 ${r==="bg"?"bg-blue-600 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[f.jsx(Pw,{countryCode:"BG",svg:!0,style:{width:"2em",height:"1.5em",borderRadius:"4px"}}),""]})]})]}),ee&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-blue-400",children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(X_,{className:"w-5 h-5 text-blue-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-blue-700",children:a("tools.activeGroup")})]}),f.jsx("p",{className:"text-sm text-blue-600 mt-0.5",children:a("tools.activeGroupSubtitle")})]}),f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:f.jsxs("div",{className:"space-y-2 text-sm text-slate-700",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.groupNumber"),":"]})," ",ee.groupNumber||f.jsx("span",{className:"italic text-slate-500",children:a("tools.pendingAssignedOnClose")})]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.courseStart"),":"]})," ",rt(ee.courseStartDate)]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.courseEnd"),":"]})," ",rt(ee.courseEndDate)]})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("label",{className:"flex items-start gap-3 cursor-pointer min-h-[44px]",children:[f.jsx("input",{type:"checkbox",checked:g,onChange:Ee=>w(Ee.target.checked),className:"mt-1 w-5 h-5 text-blue-600 rounded border-slate-300 focus:ring-blue-500"}),f.jsx("span",{className:"text-sm text-slate-700 flex-1",children:a("tools.closeGroupDescription")})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Type ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:ee.groupNumber?`CLOSE-${ee.groupNumber}`:"CLOSE"})," to confirm:"]}),f.jsx("input",{type:"text",value:v,onChange:Ee=>y(Ee.target.value),placeholder:ee.groupNumber?`CLOSE-${ee.groupNumber}`:"CLOSE",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-h-[44px]",disabled:!g})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("button",{onClick:et,className:"px-6 py-4 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-bold min-h-[48px] transition-colors duration-150",children:[" ",a("tools.returnToPlanned")]}),f.jsxs("button",{onClick:async()=>{try{await O_(),w(!1),y(""),T(Ee=>Ee+1),x(a("common.success"),a("tools.closeActiveSuccess"),"success")}catch(Ee){console.error("Failed to close active group:",Ee),x(a("common.error"),`${a("common.error")}: ${Ee.message}`,"error")}},disabled:!g||v!==(ee.groupNumber?`CLOSE-${ee.groupNumber}`:"CLOSE"),className:"px-6 py-4 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold min-h-[48px] transition-colors duration-150",children:[" ",a("tools.archiveGroup")]})]})]})]}),N&&f.jsx(es,{isOpen:!0,title:a("tools.changeActiveGroup"),message:a("tools.changeActiveGroupMessage",{current:(N.currentActive.groupNumber||"Active").toString(),new:(N.groupNumber||"Active").toString()}),confirmText:a("tools.changeActiveGroupConfirm"),cancelText:a("common.cancel"),onConfirm:mt,onClose:()=>k(null)}),D&&D.length>0&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-amber-300",children:[f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(K_,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-amber-700",children:a("tools.plannedGroups")})]}),f.jsx("p",{className:"text-sm text-amber-600 mt-0.5 ml-7",children:a("tools.plannedGroupsSubtitle")})]}),f.jsx("div",{className:"space-y-3",children:D.map(Ee=>{const Ne=(V==null?void 0:V.filter(Re=>Re.courseStartDate===Ee.courseStartDate).length)||0;return f.jsx("div",{className:"border border-amber-200 rounded-lg p-4 bg-amber-50 hover:shadow-md hover:border-amber-300 transition-all duration-200",children:f.jsxs("div",{className:"flex items-start justify-between gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsxs("h4",{className:"font-semibold text-amber-900",children:[a("group.number")," ",Ee.groupNumber]}),f.jsx("span",{className:"px-2 py-0.5 bg-amber-200 text-amber-800 text-xs font-medium rounded-full",children:a("group.planned")})]}),f.jsxs("div",{className:"text-sm text-amber-800 space-y-1",children:[f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(P2,{className:"w-4 h-4",strokeWidth:2}),rt(Ee.courseStartDate)," - ",rt(Ee.courseEndDate)]}),f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(yl,{className:"w-4 h-4",strokeWidth:2}),Ne," ",j(Ne)]})]})]}),f.jsx("div",{className:"flex flex-col gap-2",children:f.jsxs("button",{onClick:()=>nt(Ee.id),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 hover:shadow-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 whitespace-nowrap",children:[f.jsx(Qs,{className:"w-4 h-4",strokeWidth:2}),a("tools.makeActive")]})})]})},Ee.id)})})]}),F&&F.length>0&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border-2 border-slate-300",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(W1,{className:"w-5 h-5 text-slate-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-slate-700",children:a("tools.archiveCompleted")}),f.jsxs("span",{className:"text-sm text-slate-500",children:["(",F.length,")"]})]}),f.jsx("p",{className:"text-sm text-slate-600 mt-0.5 ml-7",children:a("tools.completedCourses")})]}),F.length>2&&f.jsxs("button",{onClick:()=>S(!_),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",children:[a(_?"tools.hide":"tools.showAll"),f.jsx(I2,{className:`w-4 h-4 transition-transform ${_?"rotate-180":""}`,strokeWidth:2})]})]}),f.jsx("div",{className:"space-y-3",children:(_?F:F.slice(0,2)).map(Ee=>{const Ne=(V==null?void 0:V.filter(Re=>Re.courseStartDate===Ee.courseStartDate).length)||0;return f.jsx("div",{className:"border border-slate-300 rounded-lg p-4 bg-slate-50 hover:shadow-md hover:border-slate-400 transition-all duration-200",children:f.jsxs("div",{className:"flex items-start justify-between gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsxs("h4",{className:"font-semibold text-slate-800",children:[a("group.number")," ",Ee.groupNumber]}),f.jsx("span",{className:"px-2 py-0.5 bg-slate-200 text-slate-700 text-xs font-medium rounded-full",children:a("group.completed")})]}),f.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(P2,{className:"w-4 h-4",strokeWidth:2}),rt(Ee.courseStartDate)," - ",rt(Ee.courseEndDate)]}),f.jsxs("p",{className:"flex items-center gap-1",children:[f.jsx(yl,{className:"w-4 h-4",strokeWidth:2}),Ne," ",j(Ne)]}),Ee.closedAt&&f.jsxs("p",{className:"flex items-center gap-1 text-xs text-slate-500",children:[f.jsx(Hk,{className:"w-3.5 h-3.5",strokeWidth:2}),a("tools.completedOn"),": ",rt(Ee.closedAt.split("T")[0])," ",new Date(Ee.closedAt).toLocaleTimeString("bg-BG",{hour:"2-digit",minute:"2-digit"})]})]})]}),f.jsx("div",{className:"flex flex-col gap-2",children:f.jsxs("button",{onClick:()=>Xe(Ee.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 hover:shadow-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 whitespace-nowrap",children:[f.jsx(c5,{className:"w-4 h-4",strokeWidth:2}),a("tools.reopenForEdits")]})})]})},Ee.id)})})]}),t&&f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:a("tools.currentSequence")}),f.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.prefix"),":"]})," ",t.lastUniquePrefix]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.sequence"),":"]})," ",t.lastUniqueSeq]}),t.lastResetYear&&f.jsxs("p",{children:[f.jsxs("strong",{children:[a("tools.lastReset"),":"]})," ",t.lastResetYear]})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900",children:a("tools.exportData")}),f.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-medium border border-blue-200 flex items-center gap-1",children:[f.jsx(gc,{size:12})," Secure"]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("button",{onClick:xe,className:"w-full px-6 py-4 bg-blue-100 text-blue-800 border border-blue-300 rounded-lg hover:bg-blue-200 hover:border-blue-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(l5,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportFullBackup")]}),f.jsxs("button",{onClick:X,className:"w-full px-6 py-4 bg-emerald-100 text-emerald-800 border border-emerald-300 rounded-lg hover:bg-emerald-200 hover:border-emerald-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(e5,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportExcel")]}),f.jsxs("button",{onClick:K,className:"w-full px-6 py-4 bg-slate-100 text-slate-800 border border-slate-300 rounded-lg hover:bg-slate-200 hover:border-slate-400 font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(r5,{className:"w-5 h-5",strokeWidth:2}),a("tools.exportCSV")]})]}),f.jsx("p",{className:"text-xs text-slate-500 mt-3",children:a("tools.exportNote")})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[f.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:a("tools.importData")}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"w-full px-6 py-4 bg-blue-100 text-blue-800 border border-blue-300 rounded-lg hover:bg-blue-200 hover:border-blue-400 cursor-pointer text-center font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(Xk,{className:"w-5 h-5",strokeWidth:2}),a("tools.importMerge"),f.jsx("input",{type:"file",accept:".json",onChange:Ee=>{var Ne;(Ne=Ee.target.files)!=null&&Ne[0]&&(Z(Ee.target.files[0],"merge"),Ee.target.value="")},className:"hidden",disabled:i})]}),f.jsxs("label",{className:"w-full px-6 py-4 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg hover:bg-amber-200 hover:border-amber-400 cursor-pointer text-center font-medium min-h-[48px] transition-all duration-150 flex items-center justify-center gap-2",children:[f.jsx(xc,{className:"w-5 h-5",strokeWidth:2}),a("tools.importReplace"),f.jsx("input",{type:"file",accept:".json",onChange:Ee=>{var Ne;(Ne=Ee.target.files)!=null&&Ne[0]&&(Z(Ee.target.files[0],"replace"),Ee.target.value="")},className:"hidden",disabled:i})]})]}),f.jsxs("p",{className:"text-xs text-slate-500 mt-3",children:[a("tools.importMergeNote")," ",f.jsx("br",{}),f.jsx("span",{className:"text-amber-600 font-semibold",children:a("tools.importReplaceWarning")})]}),i&&!_e.isOpen&&f.jsx("div",{className:"text-center mt-4 text-blue-600 font-medium animate-pulse",children:"Processing..."})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(gc,{className:"w-5 h-5 text-slate-900"}),f.jsx("h3",{className:"text-lg font-bold text-slate-900",children:a("security.title")})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("h4",{className:"font-semibold text-slate-700",children:a(Ve?"security.enabled":"security.disabled")}),Ve?f.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded font-medium",children:a("security.active")}):f.jsx("span",{className:"text-xs bg-slate-100 text-slate-500 px-2 py-0.5 rounded font-medium",children:a("security.inactive")})]}),f.jsx("p",{className:"text-sm text-slate-500 max-w-md",children:a(Ve?"security.descriptionEnabled":"security.descriptionDisabled")})]}),f.jsx("div",{className:"flex flex-col gap-2",children:Ve?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>bS(),className:"px-4 py-2 bg-slate-800 text-white hover:bg-slate-900 rounded-lg text-sm font-medium transition-colors shadow-sm",children:a("security.lockNow")}),f.jsx("button",{onClick:()=>De("disable"),className:"px-4 py-2 text-red-600 hover:bg-red-50 border border-red-200 rounded-lg text-sm font-medium transition-colors",children:a("security.disable")})]}):f.jsx("button",{onClick:()=>De("setup"),className:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors shadow-sm",children:a("security.setPin")})})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border-2 border-orange-200",children:[f.jsxs("button",{onClick:()=>l(!o),className:"w-full flex items-center justify-between py-2 min-h-[44px]",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx($1,{className:"w-5 h-5 text-orange-600",strokeWidth:2}),f.jsx("h3",{className:"text-lg font-bold text-orange-600",children:a("tools.advancedSettings")})]}),f.jsx(I2,{className:`w-6 h-6 transition-transform ${o?"rotate-180":""}`,strokeWidth:2})]}),o&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-orange-200 space-y-6",children:[f.jsx(RB,{onArchive:()=>P(!0),onViewArchives:()=>oe(!0)}),f.jsx(jB,{showAlert:x})]})]}),A&&f.jsx(LB,{isOpen:A,onClose:()=>{P(!1),W("")},onConfirm:be,confirmText:I,onConfirmTextChange:W}),te&&f.jsx(MB,{isOpen:te,onClose:()=>oe(!1),archives:R||[],onRestoreGroup:(Ee,Ne)=>ye({year:Ee,groupNumber:Ne})}),f.jsx(es,{isOpen:ve!==null,onClose:()=>ye(null),onConfirm:()=>{ve&&ie(ve.year,ve.groupNumber)},title:a("tools.restoreGroupTitle"),message:a("tools.restoreGroupMessage",{number:((Mt=ve==null?void 0:ve.groupNumber)==null?void 0:Mt.toString())||""}),confirmText:a("tools.restoreGroupConfirm"),cancelText:a("common.cancel"),variant:"warning"}),u&&f.jsx(dx,{isOpen:u.isOpen,onClose:()=>c(null),title:u.title,message:u.message,variant:u.variant}),h&&f.jsx(es,{isOpen:h.isOpen,onClose:()=>p(null),onConfirm:h.onConfirm,title:h.title,message:h.message,confirmText:h.confirmText,cancelText:a("common.cancel"),variant:h.variant}),ce&&f.jsx(ES,{mode:ce,onSuccess:se,onCancel:()=>De(null)})]})},RB=({onArchive:e,onViewArchives:t})=>{const{t:r}=qr(),n=new Date().getFullYear(),a=Zr(()=>ke.groups.toArray(),[]),i=Zr(()=>ke.participants.toArray(),[]),s=(a==null?void 0:a.filter(p=>p.status==="active").length)||0,o=(a==null?void 0:a.filter(p=>p.status==="planned").length)||0,l=s>0||o>0,u=!l,c=(a==null?void 0:a.filter(p=>p.status!=="completed"?!1:new Date(p.courseStartDate).getFullYear()===n))||[],h=(i==null?void 0:i.filter(p=>c.some(x=>x.courseStartDate===p.courseStartDate)).length)||0;return f.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border-2 border-purple-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(W1,{className:"w-5 h-5 text-purple-600",strokeWidth:2}),f.jsx("h4",{className:"text-lg font-bold text-purple-600",children:r("archive.title")})]}),f.jsx("p",{className:"text-sm text-slate-700 mb-4",children:r("archive.description")}),f.jsxs("div",{className:"bg-white border border-slate-300 rounded-lg p-3 mb-4",children:[f.jsx("h5",{className:"text-sm font-semibold text-slate-800 mb-2",children:r("tools.archiveReadinessTitle")}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[s===0?f.jsx(Qs,{className:"w-5 h-5 text-emerald-600",strokeWidth:2}):f.jsx(L2,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("span",{className:"text-slate-700",children:r("tools.archiveActiveGroups")})]}),f.jsx("span",{className:`font-semibold ${s===0?"text-emerald-700":"text-amber-700"}`,children:s})]}),f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[o===0?f.jsx(Qs,{className:"w-5 h-5 text-emerald-600",strokeWidth:2}):f.jsx(L2,{className:"w-5 h-5 text-amber-600",strokeWidth:2}),f.jsx("span",{className:"text-slate-700",children:r("tools.archivePlannedGroups")})]}),f.jsx("span",{className:`font-semibold ${o===0?"text-emerald-700":"text-amber-700"}`,children:o})]})]}),f.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:u?f.jsxs("p",{className:"text-xs text-emerald-700 flex items-start gap-1.5",children:[f.jsx("span",{className:"text-emerald-600 mt-0.5",children:""}),f.jsx("span",{children:r("tools.archiveReady")})]}):f.jsxs("p",{className:"text-xs text-amber-800 flex items-start gap-1.5",children:[f.jsx(q1,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0",strokeWidth:2}),f.jsx("span",{children:r("tools.archiveNotReady")})]})})]}),c.length>0?f.jsxs("div",{className:"bg-white p-3 rounded mb-4 text-sm space-y-1",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.currentYear"),":"]})," ",n]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.groupsToArchive"),":"]})," ",c.length]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[r("archive.participantsToArchive"),":"]})," ",h]})]}):f.jsx("div",{className:"bg-white p-3 rounded mb-4 text-sm text-slate-600",children:r("archive.noGroupsToArchive")}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("button",{onClick:e,disabled:c.length===0||l,className:"w-full px-6 py-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-slate-400 disabled:cursor-not-allowed font-bold min-h-[48px] transition-colors",title:l?"     ":"    ",children:r("archive.button")}),f.jsxs("button",{onClick:t,className:"w-full px-6 py-4 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-medium min-h-[48px] transition-colors",children:[" ",r("archive.viewArchives")]})]})]})},LB=({isOpen:e,onClose:t,onConfirm:r,confirmText:n,onConfirmTextChange:a})=>{const{t:i}=qr(),s=new Date().getFullYear(),o=Zr(()=>ke.groups.toArray(),[]),l=Zr(()=>ke.participants.toArray(),[]),u=(o==null?void 0:o.some(w=>w.status==="active"))||!1,c=(o==null?void 0:o.some(w=>w.status==="planned"))||!1,h=u||c,p=(o==null?void 0:o.filter(w=>w.status!=="completed"?!1:new Date(w.courseStartDate).getFullYear()===s))||[],x=(l==null?void 0:l.filter(w=>p.some(v=>v.courseStartDate===w.courseStartDate)).length)||0,E=`ARCHIVE-${s}`,g=n===E&&!h;return e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[f.jsx("h3",{className:"text-xl font-bold text-purple-600 mb-4",children:i("archive.confirmTitle")}),h?f.jsxs("div",{className:"bg-red-50 border-2 border-red-400 p-4 rounded mb-4",children:[f.jsx("p",{className:"text-sm text-red-900 font-semibold mb-2",children:i("tools.archiveCannotArchive")}),f.jsx("p",{className:"text-sm text-red-800 mb-3",children:i("tools.archiveCannotArchiveMessage")}),u&&f.jsx("p",{className:"text-xs text-red-700",children:i("tools.archiveHasActiveGroups")}),c&&f.jsx("p",{className:"text-xs text-red-700",children:i("tools.archiveHasPlannedGroups")})]}):f.jsx("p",{className:"text-slate-700 mb-4",children:i("tools.archiveConfirmMessage",{groups:p.length.toString(),participants:x.toString(),year:s.toString()})}),!h&&f.jsxs("div",{className:"mb-6",children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:[i("archive.typeToConfirm")," ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:E})," ",i("archive.toConfirm"),":"]}),f.jsx("input",{type:"text",value:n,onChange:w=>a(w.target.value),placeholder:E,className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 border border-slate-200 rounded-lg hover:bg-slate-50",children:i(h?"tools.archiveCloseButton":"common.cancel")}),!h&&f.jsx("button",{onClick:r,disabled:!g,className:"flex-1 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold",children:i("archive.button")})]})]})}):null},MB=({isOpen:e,onClose:t,archives:r,onRestoreGroup:n})=>{const{t:a}=qr(),[i,s]=Ae.useState(null),[o,l]=Ae.useState(null);return e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-900",children:a("archive.yearlyArchives")}),f.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:f.jsx(y5,{className:"w-6 h-6",strokeWidth:2})})]}),r.length===0?f.jsx("p",{className:"text-slate-600 text-center py-8",children:a("archive.noArchives")}):f.jsx("div",{className:"space-y-4",children:r.sort((u,c)=>c.year-u.year).map(u=>f.jsxs("div",{className:"border border-slate-300 rounded-lg",children:[f.jsxs("button",{onClick:()=>s(i===u.year?null:u.year),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-slate-50 transition-colors rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(R2,{className:`w-5 h-5 text-slate-600 transition-transform ${i===u.year?"rotate-90":""}`,strokeWidth:2}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-bold text-slate-900",children:[a("archive.year")," ",u.year]}),f.jsxs("div",{className:"text-sm text-slate-600",children:[u.groups.length," ",a("archive.groups"),", ",u.participants.length," ",a("archive.participants")]})]})]}),f.jsxs("div",{className:"text-xs text-slate-500",children:[a("archive.archived"),": ",rt(u.archivedAt.split("T")[0])]})]}),i===u.year&&f.jsx("div",{className:"border-t border-slate-200 p-4 space-y-2",children:u.groups.sort((c,h)=>h.groupNumber-c.groupNumber).map(c=>{const h=u.participants.filter(p=>p.groupNumber===c.groupNumber);return f.jsxs("div",{className:"border border-slate-200 rounded-lg",children:[f.jsxs("button",{onClick:()=>l(o===c.groupNumber?null:c.groupNumber),className:"w-full px-3 py-2 flex items-center justify-between hover:bg-slate-50 transition-colors rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(R2,{className:`w-4 h-4 text-slate-600 transition-transform ${o===c.groupNumber?"rotate-90":""}`,strokeWidth:2}),f.jsxs("div",{className:"text-left",children:[f.jsxs("div",{className:"font-semibold text-slate-900",children:[a("group.number")," ",c.groupNumber]}),f.jsxs("div",{className:"text-xs text-slate-600",children:[rt(c.courseStartDate)," - ",rt(c.courseEndDate)]})]})]}),f.jsxs("div",{className:"text-xs text-slate-600",children:[h.length," ",a("archive.participants")]})]}),o===c.groupNumber&&f.jsxs("div",{className:"border-t border-slate-200 p-3",children:[f.jsxs("div",{className:"mb-3",children:[f.jsxs("button",{onClick:()=>n(u.year,c.groupNumber),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition-colors flex items-center justify-center gap-2",children:[f.jsx(g5,{className:"w-5 h-5",strokeWidth:2}),a("tools.restoreGroupConfirm")]}),f.jsx("p",{className:"text-xs text-slate-600 mt-2 text-center",children:a("tools.restoreGroupWillRestore")})]}),f.jsx("div",{className:"space-y-2",children:h.map(p=>f.jsxs("div",{className:"bg-slate-50 p-2 rounded text-sm",children:[f.jsx("div",{className:"font-semibold text-slate-900",children:p.personName}),f.jsx("div",{className:"text-slate-600",children:p.companyName}),f.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[a("participant.uniqueNumber"),": ",p.uniqueNumber]})]},p.id))})]})]},c.id)})})]},u.id))}),f.jsx("div",{className:"mt-6",children:f.jsx("button",{onClick:t,className:"w-full px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 font-medium",children:a("common.close")})})]})}):null},jB=({showAlert:e})=>{const{settings:t,resetYearlySequence:r}=nA(),{t:n}=qr(),[a,i]=Ae.useState(!1),[s,o]=Ae.useState(""),[l,u]=Ae.useState(!1),c=Zr(()=>ke.participants.toArray(),[]),h=(c==null?void 0:c.reduce((v,y)=>{const b=parseInt(y.uniqueNumber.split("-")[0],10);return b>v?b:v},0))||0,x=`RESET-${new Date().getFullYear()}`,E=a&&s===x,g=()=>{u(!0)},w=async()=>{try{await r(),e(n("common.success"),n("tools.resetSequenceSuccess"),"success"),i(!1),o(""),u(!1)}catch(v){console.error("Failed to reset sequence:",v),e(n("common.error"),n("tools.resetSequenceFailed"),"error")}};return f.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border-2 border-red-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx(xc,{className:"w-5 h-5 text-red-600",strokeWidth:2}),f.jsx("h4",{className:"text-lg font-bold text-red-600",children:n("tools.dangerZone")})]}),f.jsx("p",{className:"text-sm text-slate-700 mb-4",children:n("tools.resetSequenceDescription2")}),t&&f.jsxs("div",{className:"bg-white p-3 rounded mb-4 text-sm",children:[f.jsxs("p",{children:[f.jsxs("strong",{children:[n("tools.current"),":"]})," ",t.lastUniquePrefix.toString().padStart(4,"0"),"-",t.lastUniqueSeq.toString().padStart(3,"0")]}),f.jsxs("p",{children:[f.jsxs("strong",{children:[n("tools.nextAfterReset"),":"]})," ",(h+1).toString().padStart(4,"0"),"-001"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("label",{className:"flex items-start gap-3 cursor-pointer min-h-[44px]",children:[f.jsx("input",{type:"checkbox",checked:a,onChange:v=>i(v.target.checked),className:"mt-1 w-5 h-5 text-red-600 rounded border-slate-300 focus:ring-red-500"}),f.jsx("span",{className:"text-sm text-slate-700 flex-1",children:n("tools.resetSequenceCheckbox")})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Type ",f.jsx("code",{className:"bg-slate-200 px-2 py-1 rounded",children:x})," to confirm:"]}),f.jsx("input",{type:"text",value:s,onChange:v=>o(v.target.value),placeholder:x,className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 min-h-[44px]",disabled:!a})]}),f.jsx("button",{onClick:g,disabled:!E,className:"w-full px-6 py-4 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold min-h-[48px]",children:n("tools.resetButton")})]}),l&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[f.jsx("h3",{className:"text-xl font-bold text-red-600 mb-4",children:n("modal.finalConfirmation")}),f.jsx("p",{className:"text-slate-700 mb-6",children:n("tools.resetSequenceFinalConfirm")}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-3 border border-slate-200 rounded-lg hover:bg-slate-50 min-h-[48px]",children:n("tools.resetSequenceCancel")}),f.jsx("button",{onClick:w,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 font-bold min-h-[48px]",children:n("tools.resetSequenceConfirmButton")})]})]})})]})};function BB(){const{t:e}=qr(),{participants:t,deleteParticipant:r}=Kd(),{groups:n}=Sk(),{collapsedSections:a,toggleSection:i,expandSection:s,resetToDefaults:o}=Ak(),[l,u]=Ae.useState("participants"),[c,h]=Ae.useState(!1),[p,x]=Ae.useState(),[E,g]=Ae.useState(!1),[w,v]=Ae.useState(!1),[y,b]=Ae.useState(0);Ae.useEffect(()=>{setTimeout(async()=>{try{console.log("App initializing..."),await L_();const{syncGroups:F}=await Ra(async()=>{const{syncGroups:V}=await Promise.resolve().then(()=>M_);return{syncGroups:V}},void 0);await F(),console.log("App initialization complete.")}catch(F){console.error("CRITICAL: Failed to initialize groups:",F)}},100)},[]);const[T,N]=Ae.useState(""),[k,_]=Ae.useState(""),[S,A]=Ae.useState({sent:null,documents:null,handedOver:null,paid:null,completed:null}),[P,I]=Ae.useState({start:"",end:""}),W=Ae.useMemo(()=>T!==""||k!==""||S.sent!==null||S.documents!==null||S.handedOver!==null||S.paid!==null||S.completed!==null||P.start!==""||P.end!=="",[T,k,S,P]),te=Ae.useMemo(()=>{if(!t)return[];const D=new Date().getFullYear();return t.filter(F=>{const V=n==null?void 0:n.find(j=>j.courseStartDate===F.courseStartDate);if((F.completedOverride!==null?F.completedOverride:F.completedComputed)&&(V==null?void 0:V.status)==="completed"&&new Date(F.courseStartDate).getFullYear()!==D)return!1;if(T){const j=T.toLowerCase();if(!(F.companyName.toLowerCase().includes(j)||F.personName.toLowerCase().includes(j)||F.uniqueNumber.toLowerCase().includes(j)))return!1}if(k){const j=parseInt(k,10);if(V&&V.groupNumber!==j||!V)return!1}return!(P.start&&F.courseStartDate<P.start||P.end&&F.courseStartDate>=P.end||S.sent!==null&&F.sent!==S.sent||S.documents!==null&&F.documents!==S.documents||S.handedOver!==null&&F.handedOver!==S.handedOver||S.paid!==null&&F.paid!==S.paid||S.completed!==null&&(F.completedOverride!==null?F.completedOverride:F.completedComputed)!==S.completed)})},[t,n,T,k,S,P]),oe=(t==null?void 0:t.length)||0,ve=te.length,ye=(n==null?void 0:n.length)||0,_e=Ae.useMemo(()=>new Set(te.map(F=>F.courseStartDate)).size,[te]),ue=Ae.useMemo(()=>te.filter(D=>D.completedOverride!==null?D.completedOverride:D.completedComputed).length,[te]),ce=()=>{x(void 0),h(!0)},De=D=>{x(D),h(!0)},Ve=()=>{h(!1),x(void 0)},Y=(D,F)=>{A(V=>({...V,[D]:F}))},se=()=>{N(""),_(""),A({sent:null,documents:null,handedOver:null,paid:null,completed:null}),I({start:"",end:""})},ee=(D,F)=>{switch(D){case"search":N("");break;case"group":_("");break;case"dateStart":I(V=>({...V,start:""}));break;case"dateEnd":I(V=>({...V,end:""}));break;case"status":F&&A(V=>({...V,[F]:null}));break;case"all":se();break}};return f.jsx("div",{className:"min-h-screen bg-slate-50",children:f.jsxs(_P,{children:[f.jsx(TP,{activeTab:l,onTabChange:u}),l==="participants"?f.jsxs("main",{className:"container mx-auto px-4 py-6 pb-24 md:pb-6",children:[f.jsx(SP,{totalParticipants:oe,visibleParticipants:ve,totalCourses:ye,visibleCourses:_e,completedCount:ue}),f.jsx(gP,{activeFilters:{searchText:T,selectedGroup:k,dateRange:P,statusFilters:S},onRemoveFilter:ee,groups:(n==null?void 0:n.filter(D=>D.groupNumber!==null&&D.groupNumber!==void 0).map(D=>({...D,groupNumber:D.groupNumber})))||[]}),f.jsxs("div",{className:"hidden md:flex flex-wrap gap-3 mb-6",children:[f.jsxs("button",{onClick:ce,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 shadow font-medium",children:["+ ",e("participants.add")]}),f.jsx("button",{onClick:()=>g(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow font-medium",children:e("filters.title")})]}),f.jsx("div",{className:"md:hidden mb-4",children:f.jsxs("button",{onClick:()=>g(!0),className:"w-full px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow font-medium min-h-[48px]",children:[" ",e("filters.title")]})}),f.jsxs("div",{className:"md:bg-white md:rounded-lg md:shadow",children:[f.jsxs("div",{className:"hidden md:block",children:[f.jsx("div",{className:"p-4 border-b",children:f.jsxs("h2",{className:"text-xl font-semibold text-slate-900",children:[e("participants.title")," ",ve<oe&&`(${ve} ${e("participants.of")} ${oe})`]})}),f.jsx("div",{className:"p-4",children:f.jsx(fP,{participants:te,onEdit:De,onDelete:r,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:W,groupRefreshKey:y})})]}),f.jsx("div",{className:"md:hidden",children:f.jsx(hP,{participants:te,onEdit:De,onDelete:r,onSelectionChange:v,collapsedSections:a,toggleSection:i,expandSection:s,hasActiveFilters:W})})]})]}):f.jsx("main",{className:"container mx-auto px-4 py-6",children:f.jsx(IB,{filteredParticipants:te,onNavigateHome:()=>{b(D=>D+1),u("participants")}})}),f.jsx(mP,{isOpen:E,onClose:()=>g(!1),searchText:T,onSearchTextChange:N,selectedGroup:k,onSelectedGroupChange:_,statusFilters:S,onStatusFilterChange:Y,dateRange:P,onDateRangeChange:I,groups:(n==null?void 0:n.filter(D=>D.groupNumber!==null&&D.groupNumber!==void 0).map(D=>({...D,groupNumber:D.groupNumber})))||[],onResetToDefaults:o}),f.jsx(pP,{isOpen:c,onClose:Ve,participant:p}),l==="participants"&&!w&&f.jsx(CP,{onClick:ce}),f.jsx(AP,{activeTab:l,onTabChange:u})]})})}function UB(){return f.jsx(Dk,{children:f.jsx(BB,{})})}class zB extends Ae.Component{constructor(){super(...arguments);vo(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("Uncaught error:",r,n)}render(){var r;return this.state.hasError?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:f.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),f.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an unexpected error. This might be due to a data consistency issue."}),f.jsx("div",{className:"bg-gray-100 p-3 rounded mb-4 overflow-auto max-h-32 text-xs font-mono text-red-800",children:(r=this.state.error)==null?void 0:r.message}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Reload Application"}),f.jsx("button",{onClick:()=>{window.confirm("Delete all local data and reset? This cannot be undone.")&&(indexedDB.deleteDatabase("CourseManagementDB"),localStorage.clear(),window.location.reload())},className:"flex-1 px-4 py-2 bg-red-100 text-red-700 border border-red-200 rounded hover:bg-red-200 transition",children:"Reset Data"})]})]})}):this.props.children}}Jp.createRoot(document.getElementById("root")).render(f.jsx(ks.StrictMode,{children:f.jsx(zB,{children:f.jsx(UB,{})})}));
